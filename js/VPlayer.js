!function(t) {
  var e = {};
  function i(s) {
      if (e[s])
          return e[s].exports;
      var a = e[s] = {
          i: s,
          l: !1,
          exports: {}
      };
      return t[s].call(a.exports, a, a.exports, i),
      a.l = !0,
      a.exports
  }
  i.m = t,
  i.c = e,
  i.d = function(t, e, s) {
      i.o(t, e) || Object.defineProperty(t, e, {
          enumerable: !0,
          get: s
      })
  }
  ,
  i.r = function(t) {
      "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(t, Symbol.toStringTag, {
          value: "Module"
      }),
      Object.defineProperty(t, "__esModule", {
          value: !0
      })
  }
  ,
  i.t = function(t, e) {
      if (1 & e && (t = i(t)),
      8 & e)
          return t;
      if (4 & e && "object" == typeof t && t && t.__esModule)
          return t;
      var s = Object.create(null);
      if (i.r(s),
      Object.defineProperty(s, "default", {
          enumerable: !0,
          value: t
      }),
      2 & e && "string" != typeof t)
          for (var a in t)
              i.d(s, a, function(e) {
                  return t[e]
              }
              .bind(null, a));
      return s
  }
  ,
  i.n = function(t) {
      var e = t && t.__esModule ? function() {
          return t.default
      }
      : function() {
          return t
      }
      ;
      return i.d(e, "a", e),
      e
  }
  ,
  i.o = function(t, e) {
      return Object.prototype.hasOwnProperty.call(t, e)
  }
  ,
  i.p = "//a.msstatic.com/huya/h5player/room/2202141108/",
  i(i.s = "xUJ5")
}({
  YuTi: function(t, e) {
      t.exports = function(t) {
          return t.webpackPolyfill || (t.deprecate = function() {}
          ,
          t.paths = [],
          t.children || (t.children = []),
          Object.defineProperty(t, "loaded", {
              enumerable: !0,
              get: function() {
                  return t.l
              }
          }),
          Object.defineProperty(t, "id", {
              enumerable: !0,
              get: function() {
                  return t.i
              }
          }),
          t.webpackPolyfill = 1),
          t
      }
  },
  bfxC: function(module, exports) {
      module.exports = function anonymous(locals, escapeFn, include, rethrow) {
          rethrow = rethrow || function(t, e, i, s, a) {
              var r = e.split("\n")
                , n = Math.max(s - 3, 0)
                , o = Math.min(r.length, s + 3)
                , h = a(i)
                , u = r.slice(n, o).map((function(t, e) {
                  var i = e + n + 1;
                  return (i == s ? " >> " : "    ") + i + "| " + t
              }
              )).join("\n");
              throw t.path = h,
              t.message = (h || "ejs") + ":" + s + "\n" + u + "\n\n" + t.message,
              t
          }
          ,
          escapeFn = escapeFn || function(t) {
              return null == t ? "" : String(t).replace(_MATCH_HTML, encode_char)
          }
          ;
          var _ENCODE_HTML_RULES = {
              "&": "&amp;",
              "<": "&lt;",
              ">": "&gt;",
              '"': "&#34;",
              "'": "&#39;"
          }
            , _MATCH_HTML = /[&<>'"]/g;
          function encode_char(t) {
              return _ENCODE_HTML_RULES[t] || t
          }
          var __line = 1
            , __lines = '<div class="player-wrap" id="player-wrap">\n    <div class="player-video" id="player-video">\n        \x3c!-- <img id="hy-video-capture"> --\x3e\n        <div id="hy-watermark" class="hy-watermark-normal"></div>\n        <div id="player-watermark"></div>\n        <div id="player-replayicon"></div>\n        <div id="player-ext-wrap-under-barrage"></div>\n        <div id="player-mouse-event-wrap"></div>\n        <div id="danmuwrap">\n            <div id="danmudiv"></div>\n            <div id="danmudiv2"></div>\n        </div>\n    </div>\n    <div class="player-loading" id="player-loading">\n        <div class="player-loading-content">\n            <div class="player-loading-logo"></div>\n            <div class="player-loading-text">正在加载</div>\n            <div class="player-loading-progress" alt="进度条"></div>\n            <div class="player-loading-changeline">\n                <p>目前网络有点卡，试试下面的方法吧</p>\n                <p>推荐去PC端观看，占用更少CPU、更流畅</p>\n                <div class="change-line-g">\n                    <div  id="change-line-btn">切换线路</div>\n                    <div  id="download-pc-btn">去PC端看<i></i></div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div id="player-nobel-open"></div>\n    <div id="player-resource-wrap"></div>\n    <div id="player-left-head">\n        <div id="player-check-room">\n            <ul></ul>\n        </div>\n         <div id="player-link-mic">\n             <ul></ul>\n         </div>\n        <div id="player-multi-pk">\n             <ul></ul>\n         </div>\n    </div>\n    <div id="player-pay-room-wrap"></div>\n    <div id="player-ext-wrap"></div>\n    <div class="play-list-btn" id="play-list-btn">\n        <i></i>\n        <span></span>\n    </div>\n</div>\n<div id="huya-ab-fixed"></div>\n<div id="huya-ab"></div>\n<div class="player-ctrl-wrap" id="player-ctrl-wrap"></div>\n<div class="player-guess-wrap" id="player-guess-wrap"></div>\n<div class="player-gift-wrap" id="player-gift-wrap"></div>\n<div id="player-ob-watch-wrap"></div>\n<div id="player-marquee-wrap" class="player-marquee-wrap"></div>\n<div id="player-pc-watch-btn"><i></i><span></span></div>\n<div id="player-danmu-report">\n    <i></i><em id="player-danmu-copy">复制</em><span></span>\n</div>\n<div id="danmu-copy-tips"></div>\n<div id="player-community-contaier"></div>\n<div id="player-fullpage-right-btn"></div>\n<div id="pc-watch-download-tips"><span></span></div>\n<div id="player-secret-wrap"></div>\n<div class="player-common-toast"></div>'
            , __filename = "vsrc/vplayer.ejs";
          try {
              var __output = "";
              function __append(t) {
                  null != t && (__output += t)
              }
              with (locals || {})
                  __append('<div class="player-wrap" id="player-wrap">\n    <div class="player-video" id="player-video">\n        \x3c!-- <img id="hy-video-capture"> --\x3e\n        <div id="hy-watermark" class="hy-watermark-normal"></div>\n        <div id="player-watermark"></div>\n        <div id="player-replayicon"></div>\n        <div id="player-ext-wrap-under-barrage"></div>\n        <div id="player-mouse-event-wrap"></div>\n        <div id="danmuwrap">\n            <div id="danmudiv"></div>\n            <div id="danmudiv2"></div>\n        </div>\n    </div>\n    <div class="player-loading" id="player-loading">\n        <div class="player-loading-content">\n            <div class="player-loading-logo"></div>\n            <div class="player-loading-text">正在加载</div>\n            <div class="player-loading-progress" alt="进度条"></div>\n            <div class="player-loading-changeline">\n                <p>目前网络有点卡，试试下面的方法吧</p>\n                <p>推荐去PC端观看，占用更少CPU、更流畅</p>\n                <div class="change-line-g">\n                    <div  id="change-line-btn">切换线路</div>\n                    <div  id="download-pc-btn">去PC端看<i></i></div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div id="player-nobel-open"></div>\n    <div id="player-resource-wrap"></div>\n    <div id="player-left-head">\n        <div id="player-check-room">\n            <ul></ul>\n        </div>\n         <div id="player-link-mic">\n             <ul></ul>\n         </div>\n        <div id="player-multi-pk">\n             <ul></ul>\n         </div>\n    </div>\n    <div id="player-pay-room-wrap"></div>\n    <div id="player-ext-wrap"></div>\n    <div class="play-list-btn" id="play-list-btn">\n        <i></i>\n        <span></span>\n    </div>\n</div>\n<div id="huya-ab-fixed"></div>\n<div id="huya-ab"></div>\n<div class="player-ctrl-wrap" id="player-ctrl-wrap"></div>\n<div class="player-guess-wrap" id="player-guess-wrap"></div>\n<div class="player-gift-wrap" id="player-gift-wrap"></div>\n<div id="player-ob-watch-wrap"></div>\n<div id="player-marquee-wrap" class="player-marquee-wrap"></div>\n<div id="player-pc-watch-btn"><i></i><span></span></div>\n<div id="player-danmu-report">\n    <i></i><em id="player-danmu-copy">复制</em><span></span>\n</div>\n<div id="danmu-copy-tips"></div>\n<div id="player-community-contaier"></div>\n<div id="player-fullpage-right-btn"></div>\n<div id="pc-watch-download-tips"><span></span></div>\n<div id="player-secret-wrap"></div>\n<div class="player-common-toast"></div>'),
                  __line = 65;
              return __output
          } catch (e) {
              rethrow(e, __lines, __filename, __line, escapeFn)
          }
      }
  },
  f08Q: function(t, e, i) {
      (function(t) {
          var i, s, a, r;
          function n(t) {
              return (n = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(t) {
                  return typeof t
              }
              : function(t) {
                  return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t
              }
              )(t)
          }
          r = function() {
              return function(t) {
                  var e = {};
                  function i(s) {
                      if (e[s])
                          return e[s].exports;
                      var a = e[s] = {
                          i: s,
                          l: !1,
                          exports: {}
                      };
                      return t[s].call(a.exports, a, a.exports, i),
                      a.l = !0,
                      a.exports
                  }
                  return i.m = t,
                  i.c = e,
                  i.d = function(t, e, s) {
                      i.o(t, e) || Object.defineProperty(t, e, {
                          enumerable: !0,
                          get: s
                      })
                  }
                  ,
                  i.r = function(t) {
                      "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(t, Symbol.toStringTag, {
                          value: "Module"
                      }),
                      Object.defineProperty(t, "__esModule", {
                          value: !0
                      })
                  }
                  ,
                  i.t = function(t, e) {
                      if (1 & e && (t = i(t)),
                      8 & e)
                          return t;
                      if (4 & e && "object" == n(t) && t && t.__esModule)
                          return t;
                      var s = Object.create(null);
                      if (i.r(s),
                      Object.defineProperty(s, "default", {
                          enumerable: !0,
                          value: t
                      }),
                      2 & e && "string" != typeof t)
                          for (var a in t)
                              i.d(s, a, function(e) {
                                  return t[e]
                              }
                              .bind(null, a));
                      return s
                  }
                  ,
                  i.n = function(t) {
                      var e = t && t.__esModule ? function() {
                          return t.default
                      }
                      : function() {
                          return t
                      }
                      ;
                      return i.d(e, "a", e),
                      e
                  }
                  ,
                  i.o = function(t, e) {
                      return Object.prototype.hasOwnProperty.call(t, e)
                  }
                  ,
                  i.p = "",
                  i(i.s = 64)
              }([function(t, e, i) {
                  "use strict";
                  var s = i(12)
                    , a = i(6)
                    , r = 99;
                  function o() {
                      return a.a.getDateTimeStr() + " "
                  }
                  var h = !1
                    , u = {
                      _data: [],
                      _length: 0,
                      debug: function() {
                          var t = o()
                            , e = Array.apply(null, arguments);
                          e[0] = t + e[0],
                          r <= -1 && console.log.apply(console, e)
                      },
                      log: function(t) {
                          var e = o()
                            , i = Array.apply(null, arguments);
                          i[0] = e + i[0],
                          r <= 0 && console.log.apply(console, i),
                          u.record(i, "log")
                      },
                      info: function(t) {
                          var e = o()
                            , i = Array.apply(null, arguments);
                          i[0] = e + i[0],
                          r <= 1 && console.info.apply(console, i),
                          u.record(i, "info")
                      },
                      warn: function(t) {
                          var e = o()
                            , i = Array.apply(null, arguments);
                          i[0] = e + i[0],
                          r <= 2 && console.warn.apply(console, i),
                          u.record(i, "warn")
                      },
                      error: function(t) {
                          var e = o()
                            , i = Array.apply(null, arguments);
                          i[0] = e + i[0],
                          r <= 3 && console.error.apply(console, i),
                          u.record(i, "error")
                      },
                      group: function(t) {
                          var e = o()
                            , i = Array.apply(null, arguments);
                          if (i[0] = e + i[0],
                          r <= 1) {
                              var s = console.groupCollapsed || console.group || console.log;
                              s.apply(console, i)
                          }
                          u.record(i, "group")
                      },
                      groupEnd: function() {
                          console.groupEnd && console.groupEnd.apply(console)
                      },
                      setLevel: function(t) {
                          t != r && (console.log(o() + " set log level from " + r + " to " + t),
                          r = t)
                      },
                      getLevel: function() {
                          return r
                      },
                      record: function(t, e) {
                          1100 === u._length && (u._data.splice(0, 100),
                          u._length = 1e3);
                          var i = 0
                            , s = (t.shift() || "").toString();
                          for (s = s.replace(/\%c/gi, (function(t, e) {
                              return i++,
                              ""
                          }
                          )); i-- && t.length; )
                              t.shift();
                          for (var a = 0, r = t.length; a < r; a++)
                              "object" == n(t[a]) && (t[a] = "");
                          t.unshift(s);
                          var o = t.join(" ");
                          u._length++,
                          u._data.push("[".concat(e, "]").concat(o))
                      },
                      getLog: function() {
                          return h || (h = !0,
                          u._data.unshift(s.a.platform + " " + s.a.name + " " + s.a.version.string)),
                          u._data
                      },
                      logcss: function(t, e, i) {
                          var s = "font-weight:900";
                          return t && (s += ";color:" + t),
                          e && (s += ";background:" + e),
                          i && (s += ";border:3px solid " + i),
                          s
                      },
                      padNum: function(t, e) {
                          var i = t.toString().length
                            , s = Math.max(0, e - i);
                          return "0".repeat(s) + t
                      }
                  };
                  e.a = u
              }
              , function(t, e, i) {
                  "use strict";
                  e.a = {
                      KEY_VALUE: "value",
                      KEY_STR: "str",
                      KEY_DIM: "dim",
                      K: "k",
                      LIVE_TYPE: {
                          FLV: 0,
                          P2P: 1,
                          HLS: 2
                      },
                      HEART_TYPE: {
                          START: 0,
                          CONTINUS: 1,
                          END: 2
                      },
                      DIM_COM: {
                          P2P: "p2p",
                          OEXP: "oexp",
                          STREAM_URL: "stream_url",
                          CDNDOMAIN: "cdndomain",
                          STREAM: "stream",
                          CDNP_CONNECT_IP: "cdnp_connect_ip",
                          CDNP_CONNECTED: "cdnp_connected",
                          CDP_ID: "cdp_id",
                          USER_WAN_IP: "user_wan_ip",
                          VIDEO_LOGIN_FAIL: "video_login_fail",
                          ORIGINAL_BITRATE: "original_bitrate",
                          BROWSER_NAME: "browser_name",
                          BROWSER_VERSION: "browser_version",
                          BROWSER_KERNEL: "browser_kernel",
                          BROWSER_KERNEL_VERSION: "browser_kernel_version",
                          SPHD_TYPE: "sphd_type",
                          DPI: "dpi",
                          CDNIP: "cdnip",
                          AUTO_BITRATE: "auto_bitrate",
                          P2P_COOL_FLAG: "p2p_cool_flag",
                          MP_EXPERIMENT: "mp_experiment",
                          ACT_LOAD_TYPE: "act_load_type",
                          STREAM_INDEX: "stream_index",
                          OBS_RENDER_MODE: "obs_render_mode",
                          PLAYER_TYPE: "player_type",
                          LIVE_TYPE: "live_type",
                          STREAM_TYPE: "stream_type",
                          HLS_TYPE: "hls_type",
                          VR_ENABLE: "vr_enable",
                          VR_MODE: "vr_mode",
                          CODEC_TYPE: "codec_type",
                          CDN_CIP: "cdn_cip",
                          CDN_SIP: "cdn_sip",
                          ALT_SVC: "alt_svc",
                          QUIC: "quic",
                          START_TYPE: "start_type",
                          PCDN_ORIGIN: "pcdn_origin",
                          SUB_PCDN_STATE: "sub_pcdn_state",
                          STREAM_TOTAL_DURATION: "stream_total_duration",
                          CODERATE_BPS: "coderatebps",
                          PLAYBACK_RATE: "playbackrate",
                          ANCHOR_UID: "anchoruid",
                          FLV_PCDN_STATE: "flv_pcdn_state",
                          H265: "h265",
                          V_DECODEC: "v_decodec",
                          V_RECV_FRAME: "v_recv_frames",
                          V_TO_DECODE_FRAMES: "v_to_decode_frames",
                          V_DECODE_FRAME: "v_decode_frames",
                          V_PLAY_FRAME: "v_play_frame",
                          V_TO_PLAY_FRAME: "v_to_play_frames",
                          SUB_CHANGE_STATE: "sub_change_state",
                          FORCE_SUB_TYPE: "force_sub_type",
                          MUTE_DATA: "mute_data",
                          VISIBILITY_STATE: "visibility_state",
                          SESSION_ID: "session_id",
                          VIDEO_MIN_BUF: "video_min_buf",
                          AUTO_VERSION: "auto_version",
                          MSE_PLAYER: "mse_player",
                          START_CODERATEBPS: "start_coderatebps",
                          AUTO_OPEN: "auto_open"
                      },
                      DIM_CORE: {
                          VIDEO_BAD_QUALITY_OLD: "video_bad_quality_old",
                          VIDEO_BAD_QUALITY: "video_bad_quality",
                          VIDEO_BAD_REASON: "video_bad_reason",
                          USER_PROPERTY: "user_property",
                          HEART_TYPE: "heart_type",
                          SIGNAL_USER_PROPERTY: "signal_user_property",
                          VIDEO_H265_BAD_QUALITY: "video_h265_bad_quality",
                          AUTO_U_REASON: "auto_u_reason",
                          AUTO_D_REASON: "auto_down_reason",
                          AUTO_HEART_TYPE: "auto_heart_type",
                          AUTO_CODEC_CHANGE_TYPE: "auto_codec_change_type",
                          AUTO_BAD_REASON: "auto_bad_reason",
                          AUTO_BAD_MIN_REASON: "auto_bad_min_reason",
                          DISPATCH_ID: "dispatch_id"
                      },
                      DIM_LINK_STA: {
                          name: "link_sta",
                          CONNECT_SUC: "cns",
                          HAS_DATA: "hd",
                          DATA_ENOUGH: "de",
                          AUDIO_CONFIG: "acf",
                          VIDEO_CONFIG: "vcf",
                          VIDEO_IFRAME: "vif",
                          VIDEO_FRAME: "vf",
                          AUDIO_FRAME: "af",
                          NO_SLICE_DATA: "nsd",
                          H265: "h265"
                      },
                      DIM_LINK_SAM: {
                          name: "link_sam",
                          AUDIO_DTS: "ad",
                          VIDEO_DTS: "vd",
                          AUDIO_RATE: "ar",
                          VIDEO_RATE: "vr",
                          AUDIO_WAIT_PUSH: "awp",
                          VIDEO_WAIT_PUSH: "vwp",
                          AUDIO_WAIT_REASON: "awr",
                          VIDEO_WAIT_REASON: "vwr",
                          AUDIO_WAIT_GAP: "awg",
                          VIDEO_WAIT_GAP: "vwg",
                          VIDEO_DROP_FRAMES: "vdf",
                          VIDEO_AUDIO_GAP: "vag",
                          VIDEO_BUFFER_EMPTY_TIME: "vbet",
                          VIDEO_BUFFER_EMPTY_COUNT: "vbec",
                          SPEED: "sp"
                      },
                      DIM_H265_SAM: {
                          name: "h265_sam",
                          decode_fps: "decode_fps",
                          render_fps: "render_fps",
                          frame_list_len: "frame_list_len"
                      },
                      DIM_EXT: {
                          CDN_IP: "cdn_ip"
                      },
                      CORE: {
                          name: "yspwl.web.live.user.heart20",
                          CDN_TOTAL_BW: "cdn_total_bw",
                          CDN_VALID_BW: "cdn_valid_bw",
                          CDN_REPEAT_BW: "cdn_repeat_bw",
                          P2P_TOTAL_BW: "p2p_total_bw",
                          P2P_REPEAT_BW: "p2p_repeat_bw",
                          P2P_VALID_BW: "p2p_valid_bw",
                          RANGE_TOTAL_BW: "range_total_bw",
                          RANGE_VALID_BW: "range_valid_bw",
                          DEFAULT_BW: "default_bw",
                          FAST_BW: "fast_bw",
                          PATCH_BW: "patch_bw",
                          COMPETE_BW: "compete_bw",
                          FIXED_BW: "fixed_bw",
                          FORCE_BW: "force_bw",
                          SIGNAL_UP_BW: "signal_up_bw",
                          SIGNAL_DOWN_BW: "signal_down_bw",
                          ENC_FLOW: "enc_flow",
                          DEC_FLOW: "dec_flow",
                          DEC_OK_CNT: "dec_ok_cnt",
                          DEC_FAIL_CNT: "dec_fail_cnt",
                          BUFFER_LENGTH: "buffer_length",
                          PLAY_DELAY: "play_delay",
                          DELAY_ANCHOR: "delay_anchor",
                          DELAY_SERVER: "delay_server",
                          DELAY_NET: "delay_net",
                          SVR_DELAY_INFOS: "svr_delay_infos",
                          DELAY_NODE_INFO: "delay_node_info",
                          SVR_LAST_P_DELAY: "svr_last_p_delay",
                          UPLOADER_TYPE: "uploader_type",
                          ENCODER_SOURCE: "encoder_source",
                          OBS_FPS: "obs_fps",
                          OBS_UPLOAD_TS: "obs_upload_ts",
                          VIDEO_BLOCK_COUNT: "video_block_count",
                          VIDEO_BLOCK_DURATION: "video_block_duration",
                          VIDEO_BAD_BUFFER: "video_bad_buffer",
                          VIDEO_CONTINUE_BUFFER: "video_continue_buffer",
                          AUTO_SWITCH_CNT: "auto_switch_cnt",
                          AUTO_SWITCH_SAME_CNT: "auto_switch_same_cnt",
                          AUTO_BAD_QUALITY: "auto_bad_quality",
                          AUTO_BAD_QUALITY_UP: "auto_bad_quality_up",
                          AUTO_BAD_DURATION: "auto_bad_duration",
                          AUTO_BAD_DURATION_UP: "auto_bad_duration_up",
                          AUTO_BAD_SWITCH: "auto_bad_switch",
                          AUTO_BAD_SWITCH_SAME: "auto_bad_switch_same",
                          AUTO_BAD_SWITCH_UP: "auto_bad_switch_up",
                          AUTO_BAD_DONE: "auto_bad_done",
                          AUTO_BAD_BUFFER: "auto_bad_buffer",
                          AUTO_CONTINUE_BUFFER: "auto_continue_buffer",
                          PCDN_TOTAL_BW: "pcdn_total_bw",
                          SWITCH_CDN_CNT: "switch_cdn_cnt",
                          GET_STREAM_CNT: "get_stream_cnt",
                          GET_STREAM_ERROR_CNT: "get_stream_error_cnt",
                          REAL_KBPS_SAMPLE: "real_kbps_sample",
                          REAL_FLAC_KBPS_SAMPLE: "real_flac_kbps_sample",
                          RECV_TOTAL_SAMPLE: "recv_total_sample",
                          RECV_LAN_SAMPLE: "recv_lan_sample",
                          HAS_PUNCH_NODES: "has_punch_nodes",
                          FORWARD_REJECT_CNT: "forward_reject_cnt",
                          FRAME_BUFFER_DELAY: "frame_buffer_delay",
                          STREAM_BUFFERED: "stream_buffered"
                      },
                      UPDOWN_INFO: {
                          name: "updown_info",
                          UPLINK_BW: "uplink_bw",
                          DOWNLINK_BW: "downlink_bw",
                          UPLINK_CNT: "uplink_cnt",
                          UPLINK_LIMIT_CNT: "uplink_limit_cnt"
                      },
                      SIGNAL_HEART20: {
                          name: "yspwl.web.live.signal.heart20",
                          STREAM_NAME: "stream_name",
                          STREAM_DELAY: "stream_delay",
                          FULL_FRAME_NUM: "full_frame_num",
                          LOST_FRAME_NUM: "lost_frame_num",
                          P2P_FLOW_DANMU: "p2p_flow_danmu",
                          P2P_FLOW_EMPTY: "p2p_flow_empty",
                          MIN_DELAY: "min_delay",
                          MAX_DELAY: "max_delay",
                          AVE_DELAY: "ave_delay",
                          SER_2_REC_DELAY: "ser_2_rec_delay",
                          REC_2_MERGE_DELAY: "rec_2_merge_delay",
                          MERGE_2_NOTIFY_DELAY: "merge_2_notify_delay",
                          CDN_FLOW_DANMU_VALID: "cdn_flow_danmu_valid",
                          CDN_FLOW_DANMU_TOTAL: "cdn_flow_danmu_total",
                          CDN_FLOW_EMPTY_VALID: "cdn_flow_empty_valid",
                          CDN_FLOW_EMPTY_TOTAL: "cdn_flow_empty_total"
                      },
                      HLS_INFO: {
                          name: "hls_info",
                          M3U8_CNT: "m3u8_cnt",
                          M3U8_SUC_CNT: "m3u8_suc_cnt",
                          M3U8_FAIL_CNT: "m3u8_fail_cnt",
                          M3U8_EMPTY_CNT: "m3u8_empty_cnt",
                          M3U8_WRONG_CNT: "m3u8_wrong_cnt",
                          M3U8_TIMEOUT_CNT: "m3u8_timeout_cnt",
                          TS_CNT: "ts_cnt",
                          TS_SUC_CNT: "ts_suc_cnt",
                          TS_FAIL_CNT: "ts_fail_cnt",
                          TS_TIMEOUT_CNT: "ts_timeout_cnt",
                          TS_OPEN_AVG: "ts_open_avg",
                          TS_LOADED_AVG: "ts_loaded_avg",
                          TS_SPEED_AVG: "ts_speed_avg",
                          TS_SIZE_AVG: "ts_size_avg"
                      },
                      FRAME_INFO: {
                          name: "frame_info",
                          LATE_SEQS: "late_seqs",
                          LOSS_FRAMES: "loss_frames",
                          PLAY_FRAMES: "play_frames",
                          DTS_JUMPPAUSE_CNT: "dts_jumppause_cnt",
                          SKIP_PAUSE_CNT: "skip_pause_cnt",
                          EMPTY_FRAMES: "empty_frames",
                          FULL_RATIO: "full_ratio"
                      },
                      SUB_INFO: {
                          name: "sub_info",
                          TOTAL_CNT: "total_cnt",
                          SUCC_CNT: "succ_cnt",
                          FAIL_CNT: "fail_cnt",
                          TIMEOUT_CNT: "timeout_cnt",
                          KICK_CNT: "kick_cnt",
                          TRY_CNT: "try_cnt",
                          CMP_TOTAL_CNT: "cmp_total_cnt",
                          CMP_SUCC_CNT: "cmp_succ_cnt",
                          CMP_FAIL_CNT: "cmp_fail_cnt",
                          CMP_TIMEOUT_CNT: "cmp_timeout_cnt",
                          FORCE_CNT: "force_cnt"
                      },
                      PUNCH_INFO: {
                          name: "punch_info",
                          TOTAL_CNT: "total_cnt",
                          VALID_CNT: "valid_cnt",
                          TRY_CNT: "try_cnt",
                          SUCC_CNT: "succ_cnt",
                          BACK_CNT: "back_cnt",
                          BACK_SUCC_CNT: "back_succ_cnt",
                          BACK_TRY_CNT: "back_try_cnt"
                      },
                      PUNCH_BACK_RET: {
                          name: "punch_back_ret"
                      },
                      RESEND_INFO: {
                          name: "resend_info",
                          RESEND_CNT: "resend_cnt",
                          TIMEOUT_CNT: "timeout_cnt",
                          ERROR_CNT: "error_cnt",
                          SLICE_CNT: "slice_cnt",
                          RESPOND_CNT: "respond_cnt",
                          LATE_CNT: "late_cnt",
                          MISS_CNT: "miss_cnt",
                          REPEAT_CNT: "repeat_cnt",
                          REPEAT_SUCC_CNT: "repeat_succ_cnt",
                          REPEAT_FAIL_CNT: "repeat_fail_cnt",
                          LIMIT_CNT: "limit_cnt"
                      },
                      SUBSTREAM_INFO: {
                          name: "substream_info",
                          FIXED_CNT: "fixed_cnt",
                          FORCE_CNT: "force_cnt",
                          COMPETE_CNT: "compete_cnt"
                      },
                      FORCESUB_REASON: {
                          name: "forcesub_reason",
                          NOPEER_CNT: "nopeer_cnt",
                          SUBEND_CNT: "subend_cnt",
                          TIMEOUT_CNT: "timeout_cnt"
                      },
                      SUB_RETURN: {
                          sub_name: "sub_return",
                          switch_name: "switch_return",
                          last_name: "last_return"
                      },
                      NONODE_RETURN: {
                          name: "nonode_return",
                          PRESENTER_CNT: "presenter_cnt",
                          UPLINK_LESS_CNT: "uplink_less_cnt",
                          PULL_SAME_CNT: "pull_same_cnt",
                          SUBED_CNT: "subed_cnt",
                          COOL_CNT: "cool_cnt",
                          DELAY_CNT: "delay_cnt",
                          RTT_CNT: "rtt_cnt",
                          LATE_CNT: "late_cnt",
                          FAST_CNT: "fast_cnt",
                          NONE_CNT: "none_cnt"
                      },
                      AUTO_INFO: {
                          name: "auto_info",
                          UP_CNT: "up_cnt",
                          DOWN_CNT: "down_cnt",
                          BACK_CNT: "back_cnt"
                      },
                      P2P_TCP_TYPE: {
                          name: "p2p_tcp_type"
                      },
                      P2P_TCP_STATE: {
                          name: "p2p_tcp_state"
                      },
                      PCDN_BW_DATA: {
                          name: "pcdn_bw_data"
                      },
                      AI_CONTROL_DATA: {
                          name: "ai_control_data",
                          AI_P2P_CNT: "ai_p2p_cnt",
                          AI_FLV_CNT: "ai_flv_cnt",
                          AI_P2P_TIMEOUT_CNT: "ai_p2p_timeout_cnt",
                          AI_FLV_TIMEOUT_CNT: "ai_flv_timeout_cnt",
                          AI_P2P_ERROR_CNT: "ai_p2p_error_cnt",
                          AI_FLV_ERROR_CNT: "ai_flv_error_cnt",
                          AI_P2P_SWITCH_CNT: "ai_p2p_switch_cnt",
                          AI_FLV_SWITCH_CNT: "ai_flv_switch_cnt",
                          AI_P2P_NOT_SWITCH_CNT: "ai_p2p_not_switch_cnt",
                          AI_FLV_NOT_SWITCH_CNT: "ai_flv_not_switch_cnt",
                          AI_FLV_ERROR_SWITCH_CNT: "ai_flv_error_switch_cnt",
                          AI_FLV_ERROR_NOT_SWITCH_CNT: "ai_flv_error_not_switch_cnt：flv",
                          AI_START_P2P_CNT: "ai_start_p2p_cnt",
                          AI_START_FLV_CNT: "ai_start_flv_cnt"
                      },
                      ACT: {
                          name: "yspwl.web.live.user.act",
                          field: "act_type",
                          SWITCH_BITRATE: "switch_bitrate",
                          SWITCH_AUTO: "switch_auto",
                          SWITCH_LINE: "switch_line",
                          SWITCH_PTS: "switch_pts",
                          FAST_SAMPLE: "fast_sample",
                          NO_PICTURE: "no_picture",
                          LINK_STA: "link_sta",
                          HLS_PLAY_SUCC: "hls_play_succ",
                          HLS_LOAD_SUCC: "hls_load_succ",
                          P2P_PLAY_FAIL: "p2p_play_fail",
                          P2P_LOAD_VIDEO: "p2p_load_video",
                          P2P_RESTART: "p2p_restart",
                          TCP_NO_SLICE: "tcp_no_slice",
                          TCP_OPEN_TIME: "tcp_open_time",
                          HTTP_CODE_: "http_code_",
                          TCP_TIMEOUT: "tcp_timeout",
                          P2P_COOLING: "p2p_cooling",
                          CONNECT_VIDEO_TS: "connect_video_ts",
                          RECV_VIDEO_TS: "recv_video_ts",
                          FIRST_VIDEO_PKG_TS: "first_video_pkg_ts",
                          FIRST_VIDEO_IFRAME_TS: "first_video_iframe_ts",
                          VIDEO_IFRAME_TS: "video_iframe_ts",
                          FIRST_VIDEO_RENDER_TS: "first_video_render_ts",
                          VIDEO_PLAYED_TS: "video_played_ts",
                          VIDEO_LOAD_TS: "video_load_ts",
                          VIDEO_GET_VP_TS: "video_get_vp_ts",
                          VIDEO_LOGIN_TS: "video_login_ts",
                          LOAD_M3U8_TS: "load_m3u8_ts",
                          FIRST_FRAG_LOAD_TS: "first_frag_load_ts",
                          FIRST_FRAG_LOADED_TS: "first_frag_loaded_ts",
                          FIRST_FRAG_SIZE: "first_frag_size",
                          SIGNAL_TURN_BACK: "signal_turn_back",
                          SWITCH_COST: "switch_cost",
                          OB_BG_DURATION: "ob_bg_duration",
                          LOAD_P2PLIB_ERROR: "load_p2plib_error",
                          LOAD_PCDNLIB_ERROR: "load_pcdnlib_error",
                          PCDN_TO_CDN: "pcdn_to_cdn",
                          MUTE_STATUS: "mute_status",
                          NO_PICTURE2: "no_picture2",
                          H265_WORKER_LOAD_TS: "h265_worker_load_ts",
                          H265_STATUS: "h265_status",
                          MOSAIC_STATUS: "mosaic_status"
                      },
                      ROOM_HEART60: {
                          name: "yspwl.web.liveroom.user.heart1",
                          SESSION_ID: "session_id",
                          NOW_TS: "now_ts",
                          MAX_NO_RENDER_DU: "max_no_render_du",
                          NO_RENDER_DURATION: "no_render_duration",
                          REPEAT_PIC_TS: "repeat_pic_ts"
                      }
                  }
              }
              , function(t, e, i) {
                  "use strict";
                  function s(t, e) {
                      if (!(t instanceof e))
                          throw new TypeError("Cannot call a class as a function")
                  }
                  i.d(e, "a", (function() {
                      return s
                  }
                  ))
              }
              , function(t, e, i) {
                  "use strict";
                  function s(t, e) {
                      for (var i = 0; i < e.length; i++) {
                          var s = e[i];
                          s.enumerable = s.enumerable || !1,
                          s.configurable = !0,
                          "value"in s && (s.writable = !0),
                          Object.defineProperty(t, s.key, s)
                      }
                  }
                  function a(t, e, i) {
                      return e && s(t.prototype, e),
                      i && s(t, i),
                      t
                  }
                  i.d(e, "a", (function() {
                      return a
                  }
                  ))
              }
              , function(t, e, i) {
                  "use strict";
                  var s = i(2)
                    , a = i(3)
                    , r = i(9)
                    , o = i(0)
                    , h = i(46)
                    , u = i(7)
                    , l = i(12)
                    , c = new (function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.pushGop = !1,
                          this.jitBufLen = 3e3,
                          this.jitMaxBufLen = 4e3,
                          this.jitMinBufLen = 2e3,
                          this.resendPlayThreshold = 1800,
                          this.mutilLinkConfig = [[0, 4e3], [8, 4]],
                          this.resendModeConfig = [[0, 4e3], [1, 2]],
                          this.resendMode = 1,
                          this.resendWaitLimitList = {
                              500: 3e3,
                              2e3: 3e3,
                              4e3: 3e3,
                              8e3: 3e3,
                              1e4: 3e3,
                              12e3: 3500,
                              2e4: 5e3
                          },
                          this.noUrgentResentBuffer = 2e3,
                          this.latency = [[3e3, 2e3, 4e3, 2e3], [1e3, 500, 1500, 1500]],
                          this.jitTest = [2e3, 5e3, 1500],
                          this.jitPid = [],
                          this.hlsJitCfg = [6e3, 4e3, 8e3],
                          this.hlsUseFetch = 100,
                          this.obsUseFull = 0,
                          this.obsFullRatio = 1,
                          this.obsBgRatio = 0,
                          this.obsFaceRatio = 0,
                          this.obsSrAudio = 1,
                          this.obsFrame = 0,
                          this.obsSyncTs = 50,
                          this.obsSeekTs = 200,
                          this.obsSeekJumpTs = 0,
                          this.obsRateTs = 10,
                          this.baseSubs = 10,
                          this.urgentResend = 1,
                          this.urgentResendAudio = 1,
                          this.crossCdn = 0,
                          this.p2pWssLines = "all",
                          this.connectTotalTime = 6e3,
                          this.connectTimeout = 2e3,
                          this.connectPcdnTimeout = 4e3,
                          this.flowTimeout = 2e3,
                          this.flowRetryTimes = 3,
                          this.renderTimeout = 4e3,
                          this.noDataTimeout = 3e3,
                          this.noPcdnDataTimeout = 1e3,
                          this.testResender = 0,
                          this.maxResendTs = 3e3,
                          this.minResendTs = 200,
                          this.maxResendTimes = 2,
                          this.resendGapTs = 400,
                          this.resendMinCnt = 10,
                          this.resendDelayTs = 400,
                          this.patchSubTs = 250,
                          this.http2Channel = "",
                          this.deleteH264Aud = [],
                          this.useChangeRate = [],
                          this.freeBufferBitrate = 1e4,
                          this.needCooling = 1,
                          this.needQueue = 1,
                          this.queueTime = 3e3,
                          this.punchedCoolingTime = 3e4,
                          this.delayCloseNum = 200,
                          this.punchTimeout = 1e6,
                          this.maxPunchedCnt = 15,
                          this.maxPunchedCntMore = 30,
                          this.maxNodeCnt = 30,
                          this.punchBackCooling = 2e4,
                          this.punchIgnoreTime = 3e5,
                          this.coefficient = 8,
                          this.trySubNum = 5,
                          this.trySubTime = 5e3,
                          this.fastTime = 5e3,
                          this.lostSeqTime = 6,
                          this.sliceLate = 500,
                          this.sliceFast = 2e3,
                          this.sliceConstraints = 6e3,
                          this.badDelay = 2e3,
                          this.emuteDelay = 1800,
                          this.switchDelay = 500,
                          this.aliveTimeout = 1e3,
                          this.resubTime = 3e4,
                          this.sliceTimeout = 2e3,
                          this.maxPeerStreamNum = 7,
                          this.maxPeerStreamNum20M = 4,
                          this.maxUplinkBw = 2e3,
                          this.closeUids = [],
                          this.flvEmptyAudioFrame = 1,
                          this.sendHeartBeatAlone = 0,
                          this.signalNoCdnp = [],
                          this.switchSeamLessLine = 0,
                          this.isProduce = !0,
                          this.coderates = [[15e3, 1, 8e3, 5, 5, 230, 1, 20], [8e3, 1, 4e3, 5, 5, 230, 5, 10], [6e3, 1, 4e3, 5, 5, 170, 5, 10], [4e3, 0, 4e3, 5, 5, 120, 5, 10], [3e3, 0, 4e3, 5, 5, 80, 5, 10], [0, 0, 4e3, 5, 5, 50, 5, 10]],
                          this.swapdomain = {},
                          this.iP2PType = 2,
                          this.danmuZipPids = [],
                          this.randomPercent = 1e4,
                          this.frameBufLen = [2e3, 2e3, 1500, 2500],
                          this.bufferMode = 2,
                          this.bufferConfig = [],
                          this.urgentResendTime = 1500,
                          this.forceSkipFrameTime = 3900,
                          this.frameTimeout = 2500,
                          this.p2pBuffer = [3500, 2500, 4500],
                          this.jitCfg = [[0, 3e3, 2e3, 4e3]],
                          this.jitCfgPid = [],
                          this.jitJump = [2e4, 8e3],
                          this.jitLowLatency = 2e3,
                          this.jitLow = [1500, 1e3, 2e3],
                          this.safariPlayDelay = 500,
                          this.safariFirstLoad = !0,
                          this.jitAB = [],
                          this.waitAudio = 1,
                          this._isFrameBuffer = -1,
                          this.isSubUseHttps = 0,
                          this.pcdnSubsConfig = [1, 1, 1],
                          this.notUsePcdnUids = [],
                          this.isPcdnReportErr = 1,
                          this.isMute = 1,
                          this.isAutoNoPicture = 0,
                          this.playbackrateMin = .95,
                          this.playbackrateMax = 1.05,
                          this.pcdnFlv = 1,
                          this.isAiP2PToFlv = 1,
                          this.randomAIP2PFlvPercent = Math.floor(1e4 * Math.random()),
                          this.aiRandomPercent = 5e3,
                          this.allUidsAiP2P = 0,
                          this.aiABRandomPercent = 2e3,
                          this.aiUids = [],
                          this.aiBlackUids = [],
                          this.aiBlack2Uids = [],
                          this.isAutoH265 = 0,
                          this.renderDelta = 300,
                          this.h265Config = [[[2e3, 4e3], [4e4, 4e4]], [4e3, 2e3, 500], 75, [[2e3, 4e3], [3, 4]], 30, 3, [!0, !0]],
                          this.h265Config2 = [6, 1],
                          this.h265BlackUids = [],
                          this.h265NoPushVideoDis = 2e4,
                          this.randomH265Percent = Math.floor(1e4 * Math.random()),
                          this.h265PercentConfig = 1e5,
                          this.enableAiMosaic = 0,
                          this.aiMosaicUis = [],
                          this.aiRequestInterval = 5e3,
                          this.aiBathRequestInterval = 3e4,
                          this.aiBufferEmptyRequestInterval = 3e5,
                          this.playerdata = {
                              profileP2POpt: ""
                          },
                          this.isCommonAb = 1,
                          this.aiP2PFlvConfig = [5e3, 5],
                          this.closePcdnBitrate = 8e3,
                          this.closePcdn500 = 500,
                          this.closePlayBackRateCfg = [[90, 91, 92, 93, 96], 0],
                          this.setVideoCTCfg = [-100, 1500, 1e4],
                          this.sliceQuantityPerSecond = 1e3,
                          this.useNewPloy = 1,
                          this.minPlayout = 300,
                          this.maxPlayout = 500,
                          this.playoutUids = [],
                          this.isMuteAct = 1,
                          this.useAV1 = !1,
                          this.useAV1PidList = [],
                          this.useAV1LinesAndBitRates = [[], 0],
                          this.isClosePlayBackRate = 1,
                          this.pcdnAbConnectData = [0, [1e3, 2e3, 3e3, 4e3]],
                          this.isUseWebWorkerTick = 1,
                          this.platform = u.a.PLATFORM_TYPE_NAME.web,
                          this.av1PercentConfig = 5e3,
                          this.isConfigSupportH265 = 1,
                          this.abUseAv1 = 1,
                          this.platform = u.a.PLATFORM_TYPE_NAME.web,
                          this.h265GameIds = [!0, []],
                          this.isNoVideoReport = 0,
                          this.simdAbPercentConfig = 5e3,
                          this.isH265Filter4MCfg = [1, 1, 1, 1080],
                          this.useNewParser = 1,
                          this.maxGop = 3e3,
                          this.autoCfg = {
                              close: 0,
                              closeLines: [],
                              closePids: [],
                              upGap: 0,
                              downGap: 15e3,
                              backGap: 15e3,
                              upPer: .8,
                              downPer: .3,
                              downNowPer: .2,
                              waitPer: .8,
                              downBitrate: 2e3,
                              slow: .85,
                              bufCnt: 10,
                              sucPer: .9,
                              sampleTime: 200,
                              minTime: 1e4,
                              maxTime: 3e5,
                              sysTime: 1e4,
                              evalTime: 300,
                              highRate: 4e3,
                              badBuf: 2e3,
                              badCnt: 3,
                              badS: [1e4, 3],
                              badL: [6e4, 5],
                              noRederTime: 12e4,
                              monitorTime: 15e3
                          },
                          this.continueBufferDeltaStart = 6e3,
                          this.continueBufferDeltaEnd = 3e3,
                          this.autoBufferScore = 1e3,
                          this.autoConnectScore = 500,
                          this.autoFirstScore = 500,
                          this.autoPtsScore = 500,
                          this.force_auto_count = 9999,
                          this.force_auto_effective_time = 2592e5,
                          this.autoReportCfg = [1, 3, 0, 1],
                          this.isWebAutoAB = 0,
                          this.maxBitRate = 500,
                          this.recSysExpiredTime = 6e4
                      }
                      return Object(a.a)(t, [{
                          key: "initByBitrate",
                          value: function(t) {
                              if (this.maxPeerStreamNum = t >= 1e4 ? this.maxPeerStreamNum20M : 7,
                              this.resendMode = 1,
                              this.resendModeConfig && this.resendModeConfig[0].length === this.resendModeConfig[1].length)
                                  for (var e = this.resendModeConfig[0].length - 1; e >= 0; e--)
                                      if (t >= this.resendModeConfig[0][e]) {
                                          this.resendMode = this.resendModeConfig[1][e];
                                          break
                                      }
                          }
                      }, {
                          key: "isAutoClose",
                          value: function(t, e) {
                              if (1 === this.autoCfg.close || -1 !== this.autoCfg.closeLines.indexOf(Number(t)))
                                  return !0;
                              for (var i = this.autoCfg.closePids.length, s = 0; s < i; s++) {
                                  var a = this.autoCfg.closePids[s];
                                  if (Number(a.pid) === Number(e))
                                      return !a.hasOwnProperty("lines") || -1 !== a.lines.indexOf(t)
                              }
                              return !1
                          }
                      }, {
                          key: "setLowLatency",
                          value: function(t) {
                              t && t.setJitter(this.jitLow[0], this.jitLow[1], this.jitLow[2])
                          }
                      }, {
                          key: "setJitterCfg",
                          value: function(t, e, i) {
                              this.setJitterAB(t, e, i) || this.setJitterByPid(t, e, i) || this.setJitterByRate(t, i, this.jitCfg)
                          }
                      }, {
                          key: "setJitterAB",
                          value: function(t, e, i) {
                              if (this.jitAB.length > 0) {
                                  var s = this.jitAB[0]
                                    , a = this.jitAB[1]
                                    , r = this.jitAB[2];
                                  if ("all" === s || -1 !== s.indexOf(e + "")) {
                                      var n = this.getGroupNum(r.length);
                                      return o.a.log("setJitterAB name=".concat(a, " group=").concat(n)),
                                      this.setJitterByRate(t, i, r[n]),
                                      !0
                                  }
                              }
                              return !1
                          }
                      }, {
                          key: "getGroupNum",
                          value: function(t) {
                              for (var e = 1e4 * Math.random(), i = t - 1; i < t; i--)
                                  if (e > 1e4 / t * i)
                                      return i;
                              return 0
                          }
                      }, {
                          key: "setJitterByPid",
                          value: function(t, e, i) {
                              for (var s = 0; s < this.jitCfgPid.length; s++) {
                                  var a = this.jitCfgPid[s];
                                  if (-1 !== a[0].indexOf(e + ""))
                                      return o.a.log("setJitterByPid"),
                                      this.setJitterByRate(t, i, a[1]),
                                      !0
                              }
                              return !1
                          }
                      }, {
                          key: "setJitterByRate",
                          value: function(t, e, i) {
                              for (var s = 0; s < i.length; s++) {
                                  var a = i[s];
                                  if (e >= a[0])
                                      return t && t.setJitter(a[1], a[2], a[3]),
                                      !0
                              }
                              return !1
                          }
                      }, {
                          key: "init",
                          value: function(t) {
                              if (t) {
                                  Object.assign(this, t),
                                  o.a.group("Configs");
                                  var e = ["Configs:"];
                                  for (var i in this) {
                                      var s = this[i];
                                      "string" == typeof s && ("pushGop" == i ? s = !!Number(s) : "coderates" == i || "testCoderates" == i || "swapdomain" == i ? (s = s.replace(/[↵\s+\n]/gm, ""),
                                      s = JSON.parse(s)) : "p2pWssLines" != i && "http2Channel" != i && (s = Number(s))),
                                      this[i] = s,
                                      "object" == n(s) && (s = JSON.stringify(s)),
                                      i = r.b.padStrLen(i, 18, !1),
                                      e.push("\t" + i + " => " + s)
                                  }
                                  o.a.log(e.join("\n")),
                                  o.a.groupEnd(),
                                  o.a.log("Config", this)
                              }
                          }
                      }, {
                          key: "setAiP2PToFlv",
                          value: function(t) {
                              this.isAiP2PToFlv = t
                          }
                      }, {
                          key: "setUseAV1",
                          value: function(t) {
                              var e = this.useAV1PidList
                                , i = t.presenterUid
                                , s = !1
                                , a = this.useAV1LinesAndBitRates[0]
                                , r = this.useAV1LinesAndBitRates[1];
                              e.forEach((function(t) {
                                  i && t.toString() == i.toString() && (s = !0)
                              }
                              )),
                              s && (a.forEach((function(e) {
                                  e == t.lineType && (s = !1)
                              }
                              )),
                              t.curBitrate < Number(r) && (s = !1)),
                              this.useAV1 = s,
                              s && (this.autoCfg.close = 1)
                          }
                      }, {
                          key: "isCloseP2P",
                          value: function(t) {
                              return t && this.closeUids && -1 !== this.closeUids.indexOf(t)
                          }
                      }, {
                          key: "getEnableAiMosaic",
                          value: function(t) {
                              return !!this.enableAiMosaic
                          }
                      }, {
                          key: "setMute",
                          value: function() {
                              var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 1;
                              this.isMute = t
                          }
                      }, {
                          key: "setUseAuto",
                          value: function(t) {
                              t && (this.isConfigSupportH265 = 0)
                          }
                      }, {
                          key: "getEnableJumpBuffer",
                          value: function() {
                              var t = l.a.version.major
                                , e = this.closePlayBackRateCfg.length > 0 && (1 == this.closePlayBackRateCfg[1] || -1 != this.closePlayBackRateCfg[0].indexOf(t));
                              return l.a.chrome && e
                          }
                      }, {
                          key: "isFrameBuffer",
                          get: function() {
                              return h.a.P2P_ONLY
                          }
                      }]),
                      t
                  }());
                  e.a = c
              }
              , function(t, e, i) {
                  "use strict";
                  i.d(e, "a", (function() {
                      return s
                  }
                  )),
                  i.d(e, "b", (function() {
                      return a
                  }
                  ));
                  var s = {
                      PLAY_STATUS: "PLAY_STATUS",
                      PLAY_CARTON: "PLAY_CARTON",
                      PLAY_TIME_STATUS: "PLAY_TIME_STATUS",
                      VIDEO_PLAY: "VIDEO_PLAY",
                      VIDEO_PLAYING: "VIDEO_PLAYING",
                      VIDEO_PAUSE: "VIDEO_PAUSE",
                      VIDEO_BAD_QUALITY: "VIDEO_BAD_QUALITY",
                      METADATA: "METADATA",
                      RECV_VIDEO_FRAME: "RECV_VIDEO_FRAME",
                      VIDEO_STOP: "VIDEO_STOP",
                      VIDEO_SEEK: "VIDEO_SEEK",
                      BROWSER_PAUSE: "BROWSER_PAUSE",
                      AUDIO_PLAY: "AUDIO_PLAY",
                      AUDIO_SOUND: "AUDIO_SOUND",
                      ANCHOR_STOP: "ANCHOR_STOP",
                      VIDEO_LINK_CLOSE: "VIDEO_LINK_CLOSE",
                      NO_VIDEO: "NO_VIDEO",
                      HLS_URL_UNAVAILABLE: "HLS_URL_UNAVAILABLE",
                      HLS_URL_LOAD_TIMEOUT: "HLS_URL_LOAD_TIMEOUT",
                      HLS_MAINFEST_LOAD_TIMEOUT: "HLS_MAINFEST_LOAD_TIMEOUT",
                      FLV_URL_UNAVAILABLE: "FLV_URL_UNAVAILABLE",
                      FLV_URL_LOAD_TIMEOUT: "FLV_URL_LOAD_TIMEOUT",
                      H5_PLAYER_ERROR: "H5_PLAYER_ERROR",
                      PAUSE_5S_RETRY: "PAUSE_5S_RETRY",
                      NO_DATA_RECEIVED: "NO_DATA_RECEIVED",
                      P2P_REPORT: "P2P_REPORT",
                      DATA_METRIC: "DATA_METRIC",
                      DATA_METRIC2: "DATA_METRIC2",
                      P2P_TIMEOUT: "P2P_TIMEOUT",
                      FLV_TO_P2P: "FLV_TO_P2P",
                      FLV_TRY_TO_P2P: "FLV_TRY_TO_P2P",
                      FLAC_AUDIO_START: "FLAC_AUDIO_START",
                      FLAC_AUDIO_ERROR: "FLAC_AUDIO_ERROR",
                      FLAC_AUDIO_NEED_RETRY: "FLAC_AUDIO_NEED_RETRY",
                      SIGNAL_PLAY: "SIGNAL_PLAY",
                      SIGNAL_HEART: "SIGNAL_HEART",
                      SIGNAL_DATA: "SIGNAL_DATA",
                      SIGNAL_ERROR: "SIGNAL_ERROR",
                      H264_SEI_PLAY: "H264_SEI_PLAY",
                      TRANS_END: "TRANS_END",
                      NEED_UPDATE_M3U8: "NEED_UPDATE_M3U8",
                      PLAYBACK_UPDATE: "PLAYBACK_UPDATE",
                      PLAYBACK_M3U8_UPDATED: "PLAYBACK_M3U8_UPDATED",
                      PLAYBACK_DIF_CDN: "PLAYBACK_DIF_CDN",
                      UPDATE_INTERSITY: "UPDATE_INTERSITY",
                      PLAY_DOWNLINK_INFO: "PLAY_DOWNLINK_INFO",
                      PLAY_FRAME_BUFFER: "PLAY_FRAME_BUFFER",
                      WEBRTC_VIDEO_ERROR: "WEBRTC_VIDEO_ERROR",
                      SWITCH_DONE: "SWITCH_DONE",
                      AUTO_BITRATE_CHANGED: "AUTO_BITRATE_CHANGED",
                      AUTO_FORCE_RSP: "AUTO_FORCE_RSP",
                      VISIBILITY_CHANGE: "VISIBILITY_CHANGE",
                      REPLAY_VIDEO: "REPLAY_VIDEO",
                      P2P_PLAYING_EVENT: "P2P_PLAYING_EVENT",
                      TURN_TO_H264: "TURN_TO_H264",
                      H265_VIDEO_RETRY: "H265_VIDEO_RETRY",
                      H265_PLAY: "H265_PLAY",
                      PAUSE_5SEC_ERROR: "PAUSE_5SEC_ERROR"
                  }
                    , a = {
                      VIDEO_PLAYING: "VIDEO_PLAYING",
                      VIDEO_STOP: "VIDEO_STOP",
                      VIDEO_CACHING: "VIDEO_CACHING",
                      BROWSER_PAUSE: "BROWSER_PAUSE",
                      AUDIO_START: "AUDIO_START",
                      AUDIO_STOP: "AUDIO_STOP",
                      AUDIO_PLAYING: "AUDIO_PLAYING"
                  };
                  e.c = s
              }
              , function(t, e, i) {
                  "use strict";
                  function s(t, e) {
                      var i = t.toString().length
                        , s = Math.max(0, e - i)
                        , a = "";
                      if (s > 0)
                          for (var r = 0; r < s; r++)
                              a += "0";
                      return a + t
                  }
                  var a = 0
                    , r = {
                      now: function() {
                          if (void 0 !== window.performance) {
                              var t = window.performance;
                              if (void 0 !== t.now)
                                  return ~~t.now();
                              if (void 0 !== t.webkitNow)
                                  return ~~t.webkitNow();
                              if (void 0 !== t.mozNow)
                                  return ~~t.mozNow();
                              if (void 0 !== t.msNow)
                                  return ~~t.msNow()
                          }
                          0 === a && (a = Date.now() - 1);
                          var e = Date.now() - a;
                          return e > 4294967295 ? (a += 4294967295,
                          e - 4294967295) : e
                      },
                      utc: function() {
                          return Math.round(Date.now() / 1e3)
                      },
                      getDateStr: function() {
                          var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : NaN
                            , e = null
                            , i = (e = t ? new Date(t) : new Date).getFullYear()
                            , a = s(e.getMonth() + 1, 2)
                            , r = s(e.getDate(), 2);
                          return "".concat(i, "-").concat(a, "-").concat(r)
                      },
                      getTimeStr: function() {
                          var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : NaN
                            , e = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1]
                            , i = null
                            , a = s((i = t ? new Date(t) : new Date).getHours(), 2)
                            , r = s(i.getMinutes(), 2)
                            , n = s(i.getSeconds(), 2)
                            , o = "".concat(a, ":").concat(r, ":").concat(n);
                          if (e) {
                              var h = s(i.getMilliseconds(), 3);
                              o += "." + h
                          }
                          return o
                      },
                      getDateTimeStr: function() {
                          var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : NaN
                            , e = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1]
                            , i = null
                            , a = (i = t ? new Date(t) : new Date).getFullYear()
                            , r = s(i.getMonth() + 1, 2)
                            , n = s(i.getDate(), 2)
                            , o = s(i.getHours(), 2)
                            , h = s(i.getMinutes(), 2)
                            , u = s(i.getSeconds(), 2)
                            , l = "".concat(a, "-").concat(r, "-").concat(n, " ").concat(o, ":").concat(h, ":").concat(u);
                          if (e) {
                              var c = s(i.getMilliseconds(), 3);
                              l += "." + c
                          }
                          return l
                      }
                  };
                  e.a = r
              }
              , function(t, e, i) {
                  "use strict";
                  var s = i(10)
                    , a = {
                      SLICE_SPEED: 12.5,
                      MAX_PACKET_CNT: 1e4,
                      SWITCH_INTERVAL: 10,
                      MAX_DELAY: 66e4,
                      DEFAULT_DELAY: 65535,
                      SUBSCRIBE_TIMEOUT: 1e4,
                      PUNCH_BACK_COOLING: 2e4,
                      PUNCH_IGNORE_TIME: 3e5,
                      SUB_TIMEOUT: 5e3,
                      RESUB_TIMEOUT: 3e4,
                      STREAM_DELAY: 2e3,
                      EMULATE_DELAY: 1800,
                      MAX_DEPTH: 1,
                      PROXY_NUM: 3,
                      MAX_PEER_STREAM_NUM: 8,
                      MAX_PUSH_NUM: 3,
                      MAX_PULL_NUM: 3,
                      SLICE_DELAY: 100,
                      SLICE_LATE: 50,
                      SLICE_FAST: 50,
                      SLICE_TIMEOUT: 2e3,
                      SWITCH_DELAY: 500,
                      StreamType: {
                          NONE: 0,
                          FORCE: 1,
                          FIXED: 2,
                          COMPETE: 3,
                          PEER: 4
                      },
                      LeaveReason: {
                          PING_DIF: 1,
                          RESET: 2
                      },
                      DEL_REASON: {
                          CHANNEL_CLOSE: 1,
                          CHANNEL_ERROR: 2,
                          NODE_LEAVE: 3,
                          SERVER_REJECT: 5,
                          PEER_ERROR: 6,
                          PEER_TIMEOUT: 7,
                          PING_TIMEOUT: 8,
                          OTHER_SID: 9,
                          EMPTY_SLICE: 10,
                          SUB_TIMEOUT: 11,
                          SUB_FAIL_TIMES: 12,
                          NODE_REJECT: 13,
                          DIF_CDNP: 14,
                          PEER_HANDLER_ERR: 15
                      },
                      PERIOD: {
                          UPLINK_CALC: 10,
                          CHECK_SEED: 20,
                          GET_NODE: 5
                      },
                      SubType: {
                          SUBSCRIBE_FORCE: 0,
                          SUBSCRIBE_NORMAL: 1
                      },
                      LoadVideoTimeoutReason: {
                          FLV_DISCONNECTED: 0,
                          FLV_CONNECTED: 1,
                          FLV_CONNECT_ERROR: 2,
                          FLV_RECV_DATA: 3,
                          FLV_DATA_INVALID: 4,
                          FLV_STARTPLAY: 5,
                          FLV_PLAYERROR: 6,
                          HLS_DISCONNECTED: 7,
                          HLS_LOADMANIFEST_ERROR: 8,
                          HLS_LOADMANIFEST_SUCCESS: 9,
                          HLS_LOADFRAMENT: 10,
                          HLS_LOADFRAMENT_ERROR: 11,
                          HLS_LOADFRAMENT_SUCCESS: 12,
                          HLS_PLAY_ERROR: 13
                      },
                      SubResCode: {
                          ACCEPT_SUBSCRIBE: 0,
                          EMPTY_UPLOAD_NUM: 1,
                          DETECT_SUBSCRIBE_CYCLE: 2,
                          EMPTY_PEER_INFO: 3,
                          SUBSCRIBE_UPLINK_NOT_ENOUGH: 4,
                          PUBLISHER_KICK_OFF: 5,
                          NOT_SUBSCRIBER: 6,
                          INVALID_SUB_STREAM: 7,
                          ACCEPT_BY_SUBSCRIBER_UPLINK: 9,
                          INVALID_STREAMID: 10,
                          SERVER_EMPTY_BW: 11,
                          PUBLISHER_LEAVE: 12,
                          DIFFERENT_VIDEO_PROXY: 13,
                          OLD_VERSION_REQ: 14,
                          INVALID_TREE_DEPTH: 15,
                          INVALID_MAX_SUBSTREAM_NUM: 16,
                          STREAM_LATE: 17,
                          DEPTH_LARGE: 18,
                          STREAM_LIMIT: 19,
                          SLICE_LARGE: 20,
                          NOT_FOUND_PKG: 21,
                          KICK_OUT: 22,
                          SELF_WORST: 23,
                          SLICE_LATE: 24,
                          SLICE_FAST: 25,
                          RESTART: 26,
                          RESET: 27,
                          DIF_BASE_SUBS: 28
                      },
                      VIDEO_COMPETE_UID: 4294967295,
                      VIDEO_FORCE_UID: 0,
                      VIDEO_FIXED_UID: -1,
                      VIDEO_DEFAULT_UID: -2,
                      isProxyUid: function(t) {
                          return t === a.VIDEO_COMPETE_UID || t === a.VIDEO_FORCE_UID || t === a.VIDEO_FIXED_UID || t === a.VIDEO_DEFAULT_UID
                      },
                      isCompete: function(t) {
                          return t === a.VIDEO_COMPETE_UID
                      },
                      isForce: function(t) {
                          return t === a.VIDEO_FORCE_UID
                      },
                      isFixed: function(t) {
                          return t === a.VIDEO_FIXED_UID
                      },
                      isDefault: function(t) {
                          return t === a.VIDEO_DEFAULT_UID
                      },
                      isSliceJumpFromPeer: function(t, e) {
                          return e.isFromPeer && t > 0 && e.seq - t > 10 * a.LOST_SEQ_NUM
                      },
                      offerReject: {
                          REASON_NOTSTART: 1,
                          REASON_PUNCHFAILED_CD: 2,
                          REASON_PUNCHED_FULL: 3,
                          REASON_QUOTA_EXHAUST: 4,
                          REASON_VERSION: 5,
                          REASON_DIF_LINE: 6,
                          REASON_FAIL: 7,
                          REASON_IGNORE: 8,
                          REASON_HAS_NODE: 9,
                          REASON_WAITING: 10,
                          REASON_OTHER: 100
                      },
                      offerRejectTime: 12e4,
                      punchBackRet: {
                          SUC: 0,
                          DIF_STREAM: 1,
                          CLOSING: 2,
                          COOLING: 3,
                          REQUEST: 4,
                          REJECT: 5
                      },
                      restartReason: {
                          RANGE_SEQ_MAX: 1,
                          RANGE_SEQ_LARGE: 2,
                          CDN_JUMP: 3,
                          PLAYER_NO_DATA: 4,
                          LOST_SEQ: 5,
                          CONNECT: 6,
                          WORKER_ERROR: 7,
                          MULTI_CDN: 8,
                          FLV_TO_P2P: 9,
                          PLAYER_ERROR: 10,
                          PLAYER_DISPOSE: 11,
                          LOST_SEQ_JUMP: 12
                      },
                      turnToFlvReason: {
                          FULL_PLAY_FAIL: 1,
                          FULL_CONNECT_TIMEOUT: 2,
                          SUB_CONNECT_TIMEOUT: 3,
                          FULL_NO_DATA: 4,
                          SUB_NO_DATA: 5,
                          P2P_ARGS_ERROR: 6,
                          P2P_COOLING: 7,
                          FLV_TO_P2P_FAIL: 8,
                          FLV_TO_P2P_FULL_STREAM_COMPLETE: 9,
                          FULL_ERROR: 10,
                          FULL_CLOSE: 11,
                          SUB_ERROR: 12,
                          SUB_CLOSE: 13,
                          RESTART_TIMES: 14,
                          SIGNAL_TIMEOUT: 15,
                          PROBE_TIMEOUT: 16,
                          PROBE_ERROR: 17,
                          NO_DATA_TIMEOUT: 18,
                          IS_NOT_FIRST_FETCH: 19,
                          VIDEO_BUFFER_EMPTY: 20
                      },
                      userProperty: {
                          SERVER_CLOSE: 1,
                          CLIENT_CLOSE: 2,
                          BROWSER_UN_SUPPORT: 3,
                          FLASH: 4,
                          UNKNOW: 5,
                          P2P: 6,
                          FIRST_FULL_CONNECT_TIMEOUT: 7,
                          FIRST_FULL_PLAY_FAIL: 8,
                          FIRST_FULL_NO_DATA: 17,
                          RESTART_RANGE_MAX: 9,
                          RESTART_RANGE_LARGE: 10,
                          RESTART_CONNECT: 11,
                          RESTART_MUTI_CDN: 12,
                          RESTART_PLAYER_NO_DATA: 13,
                          RESTART_PLAYER_ERROR: 14,
                          SUB_NO_DATA: 15,
                          SUB_CONNECT_TIMEOUT: 16,
                          P2P_ARGS_ERROR: 18,
                          FLV_TO_P2P: 19,
                          LOST_SEQ: 20,
                          P2P_COOLING: 21,
                          IS_NOT_FIRST_FETCH: 22,
                          VIDEO_BUFFER_EMPTY: 23
                      },
                      h265TurnToH264Reason: {
                          DECODE_ERROR: 1,
                          RENDER_ERROR: 2
                      },
                      pauseReason: {
                          FLV_NO_BUFF: 1,
                          FLV_UNKNOW_PAUSE: 2,
                          FLV_NET_SLOW: 3,
                          P2P_NO_BUFF: 4,
                          P2P_UNKNOW_PAUSE: 5,
                          P2P_FULL_LOADER_NO_DATA: 10,
                          P2P_FULL_LOADER_CONNECT_FAIL: 11,
                          P2P_SUB_LOADER_NO_DATA: 12,
                          P2P_SUB_LOADER_CONNECT_FAIL: 13,
                          FLV_NO_DATA: 14,
                          P2P_NO_SLICE: 15,
                          P2P_RESEND_SKIP_FRAME: 20,
                          P2P_RESEND_TOOLATE: 21,
                          P2P_RESEND_TIMEOUT: 22,
                          P2P_RESEND_ERROR: 23,
                          P2P_RESEND_MISSING: 24,
                          P2P_DTS_JUMP: 25,
                          P2P_NET_SLOW: 26
                      },
                      DataType: {
                          SIGNALLING: 0,
                          PING: 1,
                          SLICE: 2
                      },
                      LOST_SEQ_NUM: 4e3,
                      initConfig: function(t, e) {
                          for (var i = e.coderates, r = null, n = 0; n < i.length; n++)
                              if (r = i[n],
                              t > Number(r[0])) {
                                  a.PROXY_NUM = Number(r[1]),
                                  a.SLICE_DELAY = Number(r[2]),
                                  a.MAX_PUSH_NUM = Number(r[3]),
                                  a.MAX_PULL_NUM = Number(r[4]),
                                  a.SLICE_LARGE = Number(r[5]);
                                  break
                              }
                          a.MAX_PEER_STREAM_NUM = Number(e.maxPeerStreamNum) || 8;
                          var o = a.SLICE_SPEED * s.a.baseSubs * (t / 1e3);
                          a.SLICE_LATE = parseInt(o * ((Number(e.sliceLate) || 1e3) / 1e3)),
                          a.SLICE_FAST = parseInt(o * ((Number(e.sliceFast) || 2e3) / 1e3)),
                          a.STREAM_DELAY = Number(e.badDelay) || 2e3,
                          a.EMULATE_DELAY = Number(e.emuteDelay) || 1800,
                          a.RESUB_TIMEOUT = Number(e.resubTime) || 3e4,
                          a.SLICE_TIMEOUT = Number(e.sliceTimeout) || 2e3,
                          a.SWITCH_DELAY = Number(e.switchDelay) || 500
                      },
                      HLS_LOAD_TYPE: {
                          FETCH: 1,
                          XHR: 2
                      },
                      PLATFORM_TYPE: {
                          web: 100,
                          mini_app: 102,
                          wap: 103,
                          huya_liveshareh5: 104,
                          adr: 2,
                          ios: 3
                      },
                      PLATFORM_TYPE_NAME: {
                          web: "web",
                          wap: "wap"
                      },
                      H5_ERROR_CODE: {
                          VIDEO_ERROR: -1e3,
                          PLAY_TIMEOUT: -1001
                      },
                      VISIBILITY_STATE: {
                          VISIBLE: "visible",
                          HIDDEN: "hidden",
                          PRERENDER: "prerender"
                      }
                  };
                  e.a = a
              }
              , function(t, e, i) {
                  "use strict";
                  var s = i(0)
                    , a = i(6)
                    , r = i(63)
                    , n = i.n(r)
                    , o = i(4)
                    , h = !1
                    , u = []
                    , l = 0
                    , c = null;
                  function d(t, e) {
                      for (var i = 0, s = u.length; i < s; i++) {
                          var a = u[i];
                          if (a.callback == t && a.thisObj == e)
                              return a
                      }
                      return null
                  }
                  function p(t, e, i) {
                      var a = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : null
                        , r = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 0;
                      if ((i = 0 | (Number(i) || 0)) < 10 || i % 10 != 0 || !t)
                          return s.a.error("Timer.add Invalide interval value or callback function."),
                          !1;
                      var n = d(t, e);
                      return n || (n = {
                          callback: t,
                          thisObj: e,
                          bindCallback: e ? t.bind(e) : t,
                          param: a
                      },
                      u.push(n)),
                      n.times = r,
                      n.tickCount = 0,
                      n.interval = i / 10,
                      n.delayDel = !1,
                      f(),
                      !0
                  }
                  function f() {
                      c && 1 == Number(o.a.isUseWebWorkerTick) ? c.postMessage("start") : !l && u.length > 0 && (l = setInterval(_, 10))
                  }
                  function _() {
                      if (0 != u.length) {
                          h = !0;
                          for (var t = a.a.now(), e = u.length - 1; e >= 0; e--) {
                              var i = u[e];
                              if (i && !i.delayDel) {
                                  if (++i.tickCount % i.interval == 0) {
                                      var s = i.bindCallback
                                        , r = i.tickCount / i.interval;
                                      s(t, r, i.param),
                                      i.times > 0 && i.times <= r && i.tickCount > 0 && u.splice(e, 1)
                                  }
                              } else
                                  u.splice(e, 1)
                          }
                          h = !1
                      } else
                          c && 1 == Number(o.a.isUseWebWorkerTick) ? c.postMessage("stop") : (clearInterval(l),
                          l = 0)
                  }
                  e.a = {
                      initWorker: function() {
                          (c = n()(66)).addEventListener("message", (function(t) {
                              _()
                          }
                          )),
                          c.addEventListener("error", (function(t) {
                              s.a.error("TimerWorker.error:", t.lineno + "," + t.colno, t.message),
                              c.terminate(),
                              c = null,
                              s.a.warn("[ TimerWorker terminate ]"),
                              f()
                          }
                          ))
                      },
                      has: function(t, e) {
                          return !!d(t, e)
                      },
                      add: p,
                      remove: function(t, e) {
                          for (var i = 0, s = u.length; i < s; i++) {
                              var a = u[i];
                              if (a.callback == t && a.thisObj == e)
                                  return h ? a.delayDel = !0 : u.splice(i, 1),
                                  !0
                          }
                          return !1
                      },
                      once: function(t, e, i, s) {
                          p(t, e, i + 10, s, 1)
                      },
                      getSize: function() {
                          return u.length
                      }
                  }
              }
              , function(t, e, i) {
                  "use strict";
                  i.d(e, "a", (function() {
                      return o
                  }
                  ));
                  var s = i(2)
                    , a = i(3)
                    , r = i(4)
                    , n = (i(0),
                  function() {
                      function t() {
                          Object(s.a)(this, t)
                      }
                      return Object(a.a)(t, null, [{
                          key: "turnStr",
                          value: function(t, e, i) {
                              for (var s = t.toString(e), a = s.length; a < i; a++)
                                  s = "0" + s;
                              return s
                          }
                      }, {
                          key: "rotl64",
                          value: function(e, i) {
                              var s = t.turnStr(e, 2, 64)
                                , a = s.substring(0, 32)
                                , r = s.substring(32)
                                , n = r.substr(i, 32 - i) + r.substr(0, i);
                              return parseInt(a + n, 2)
                          }
                      }, {
                          key: "rotr64",
                          value: function(e, i) {
                              var s = t.turnStr(e, 2, 64)
                                , a = s.substring(0, 32)
                                , r = s.substring(32)
                                , n = r.substr(32 - i, i) + r.substr(0, 32 - i);
                              return parseInt(a + n, 2)
                          }
                      }, {
                          key: "rotUid",
                          value: function(e, i) {
                              return 0 === e && (e = "1234" + t.turnStr(parseInt(9999 * Math.random()), 10, 4)),
                              isNaN(i) && (i = 0),
                              e = parseInt(e),
                              i = parseInt(i),
                              t.rotl64(e, 8)
                          }
                      }, {
                          key: "revertUid",
                          value: function(e, i) {
                              return e = parseInt(e),
                              t.rotr64(e, 8)
                          }
                      }, {
                          key: "inet_ntoa",
                          value: function(t) {
                              var e, i, s, a = new Uint8Array(4), r = new DataView(a.buffer);
                              return r.setUint32(0, t),
                              e = r.getUint8(0),
                              i = r.getUint8(1),
                              s = r.getUint8(2),
                              r.getUint8(3) + "." + s + "." + i + "." + e
                          }
                      }, {
                          key: "ip2uint",
                          value: function(t) {
                              for (var e = 0, i = t.split("."), s = 0; s < i.length; s++)
                                  e |= Number(i[s]) << 8 * s;
                              return e < 0 && (e += 4294967296),
                              e
                          }
                      }, {
                          key: "isBiggerUint",
                          value: function(t, e) {
                              return t !== e && (t > e ? t - e < 2147483647 : !(e - t < 2147483647))
                          }
                      }, {
                          key: "isEqualOrBiggerUint",
                          value: function(t, e) {
                              return t === e || (t > e ? t - e < 2147483647 : !(e - t < 2147483647))
                          }
                      }, {
                          key: "isUintMax",
                          value: function(t) {
                              return 4294967295 === t
                          }
                      }, {
                          key: "isUint64Max",
                          value: function(t) {
                              return 0x10000000000000000 === t
                          }
                      }, {
                          key: "getQueryString",
                          value: function(t) {
                              var e = new RegExp("(^|&)" + t + "=([^&]*)(&|$)")
                                , i = window.location.search.substr(1).match(e);
                              return null != i ? unescape(i[2]) : null
                          }
                      }, {
                          key: "printHexBytes",
                          value: function(t) {
                              for (var e = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1], i = new DataView(t.buffer), s = e ? 10 : 0, a = []; s < i.byteLength; ) {
                                  var r = i.getUint8(s++);
                                  (r = r.toString(16).toUpperCase()).length < 2 && (r = "0" + r),
                                  a.push(r, "\t"),
                                  s % 10 == 0 && a.push("\n")
                              }
                              console.log(a.join("") + "\tsize:", i.byteLength)
                          }
                      }, {
                          key: "getCookie",
                          value: function(t) {
                              for (var e = t + "=", i = document.cookie.split(";"), s = 0, a = i.length; s < a; s++) {
                                  var r = i[s].trim();
                                  if (0 == r.indexOf(e))
                                      return r.substr(e.length)
                              }
                              return ""
                          }
                      }, {
                          key: "formatByteSize",
                          value: function(t) {
                              var e = t / 1024;
                              return e > 1024 ? (e /= 1024).toFixed(1) + "MB" : e.toFixed(1) + "KB"
                          }
                      }, {
                          key: "padStrLen",
                          value: function(t, e) {
                              var i = arguments.length > 2 && void 0 !== arguments[2] && arguments[2];
                              if (t.length >= e)
                                  return t;
                              var s = " ".repeat(e - t.length);
                              return i ? s + t : t + s
                          }
                      }, {
                          key: "xhr",
                          value: function(t, e, i, s, a) {
                              var r = new XMLHttpRequest;
                              r.overrideMimeType("text/plain; charset=x-user-defined"),
                              r.addEventListener("readystatechange", (function t() {
                                  4 === r.readyState && (200 === r.status || 304 === r.status ? s(r.response) : a(r.status),
                                  r.removeEventListener("readystatechange", t),
                                  r = void 0)
                              }
                              )),
                              r.open(e, t, !0),
                              r.send(i)
                          }
                      }, {
                          key: "getAv1Random",
                          value: function(t, e) {
                              if (!t)
                                  return !1;
                              var i = localStorage.av1PresentUid
                                , s = t.presenterUid;
                              localStorage.randomAv1Percent && i == s || (localStorage.randomAv1Percent = Math.floor(1e4 * Math.random()));
                              var a = Number(localStorage.randomAv1Percent);
                              return localStorage.av1PresentUid = t.presenterUid,
                              a < e
                          }
                      }, {
                          key: "is64bitSoftware",
                          value: function() {
                              return -1 != navigator.userAgent.indexOf("Macintosh") || -1 != navigator.userAgent.indexOf("x64")
                          }
                      }, {
                          key: "isGameIdSupport265",
                          value: function(t, e) {
                              if (t[0])
                                  return !0;
                              var i = !1;
                              return t[1].map((function(t) {
                                  e && e.toString() == t.toString() && (i = !0)
                              }
                              )),
                              i
                          }
                      }, {
                          key: "unescapeHTML",
                          value: function(t) {
                              return (t = "" + t).replace(/&lt;/g, "<").replace(/&gt;/g, ">").replace(/&amp;/g, "&").replace(/&quot;/g, '"').replace(/&apos;/g, "'").replace(/&#39;/g, "'").replace("↵", "")
                          }
                      }, {
                          key: "getSdkAbRandom",
                          value: function(t) {
                              var e = localStorage.abPresentUid;
                              localStorage.randomAbPercent && e == t.presenterUid || (localStorage.randomAbPercent = Math.floor(1e4 * Math.random()));
                              var i = Number(localStorage.randomAbPercent);
                              return localStorage.abPresentUid = t.presenterUid,
                              i < r.a.simdAbPercentConfig
                          }
                      }]),
                      t
                  }());
                  function o(t) {
                      return atob(t)
                  }
                  n.indateLocalStorage = {
                      set: function(t, e, i) {
                          var s = {
                              value: e,
                              expirse: new Date(i).getTime()
                          };
                          localStorage.setItem(t, JSON.stringify(s))
                      },
                      get: function(t) {
                          var e = JSON.parse(localStorage.getItem(t));
                          if (null !== e) {
                              if (!(null != e.expirse && e.expirse < (new Date).getTime()))
                                  return e.value;
                              localStorage.removeItem(t)
                          }
                          return null
                      },
                      update: function(t, e) {
                          var i = JSON.parse(localStorage.getItem(t));
                          i && (i.value = e,
                          localStorage.setItem(t, JSON.stringify(i)))
                      }
                  },
                  n.IntMax = 2147483647,
                  n.IntMin = -2147483647,
                  n.UintMax = 4294967295,
                  e.b = n
              }
              , function(t, e, i) {
                  "use strict";
                  var s = i(2)
                    , a = i(3)
                    , r = i(0)
                    , n = new (function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.version = 1100,
                          this.baseSubs = 10,
                          this.uid = 0,
                          this.sGuid = "",
                          this.roomId = 0,
                          this.uuid = 0,
                          this.convertUid = 0,
                          this.appId = 66,
                          this.appid = 66,
                          this.p2pCooling = !1,
                          this.flvTryToP2P = 0
                      }
                      return Object(a.a)(t, [{
                          key: "initUUId",
                          value: function() {
                              0 === this.uuid && (this.uuid = Number((Date.now() % 1e10 * 1e3 + (1e3 * Math.random() | 0)) % 4294967295));
                              var t = Number(localStorage.appid);
                              t && (this.appid = t,
                              r.a.warn("--- test appid " + t + " ---", this))
                          }
                      }]),
                      t
                  }());
                  e.a = n
              }
              , function(t, e, i) {
                  "use strict";
                  function s(t) {
                      return (s = Object.setPrototypeOf ? Object.getPrototypeOf : function(t) {
                          return t.__proto__ || Object.getPrototypeOf(t)
                      }
                      )(t)
                  }
                  i.d(e, "a", (function() {
                      return s
                  }
                  ))
              }
              , function(t, e, i) {
                  "use strict";
                  var s = {};
                  self || (self = window),
                  function() {
                      var t = self.navigator.userAgent.toLowerCase()
                        , e = /(edge)\/([\w.]+)/.exec(t) || /(edg)\/([\w.]+)/.exec(t) || /(opr)[\/]([\w.]+)/.exec(t) || /(chrome)[ \/]([\w.]+)/.exec(t) || /(iemobile)[\/]([\w.]+)/.exec(t) || /(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(t) || /(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(t) || /(webkit)[ \/]([\w.]+)/.exec(t) || /(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t) || /(msie) ([\w.]+)/.exec(t) || t.indexOf("trident") >= 0 && /(rv)(?::| )([\w.]+)/.exec(t) || t.indexOf("compatible") < 0 && /(firefox)[ \/]([\w.]+)/.exec(t) || []
                        , i = /(ipad)/.exec(t) || /(ipod)/.exec(t) || /(windows phone)/.exec(t) || /(iphone)/.exec(t) || /(kindle)/.exec(t) || /(android)/.exec(t) || /(windows)/.exec(t) || /(mac)/.exec(t) || /(linux)/.exec(t) || /(cros)/.exec(t) || []
                        , a = {
                          browser: e[5] || e[3] || e[1] || "",
                          version: e[2] || e[4] || "0",
                          majorVersion: e[4] || e[2] || "0",
                          platform: i[0] || ""
                      }
                        , r = {};
                      if (a.browser) {
                          r[a.browser] = !0;
                          var n = a.majorVersion.split(".");
                          r.version = {
                              major: parseInt(a.majorVersion, 10),
                              string: a.version
                          },
                          n.length > 1 && (r.version.minor = parseInt(n[1], 10)),
                          n.length > 2 && (r.version.build = parseInt(n[2], 10))
                      }
                      for (var o in a.platform && (r[a.platform] = !0),
                      (r.chrome || r.opr || r.safari) && (r.webkit = !0),
                      (r.rv || r.iemobile) && (r.rv && delete r.rv,
                      a.browser = "msie",
                      r.msie = !0),
                      r.edge && (delete r.edge,
                      a.browser = "msedge",
                      r.chrome = !0),
                      r.edg && (delete r.edg,
                      a.browser = "msedge",
                      r.chrome = !0),
                      r.opr && (a.browser = "opera",
                      r.opera = !0),
                      r.safari && r.android && (a.browser = "android",
                      r.android = !0),
                      r.name = a.browser,
                      r.platform = a.platform,
                      s)
                          s.hasOwnProperty(o) && delete s[o];
                      Object.assign(s, r)
                  }(),
                  s.version || (s.version = {
                      major: 0,
                      minor: 0,
                      build: 0,
                      string: "0.0.0"
                  }),
                  e.a = s
              }
              , function(t, e, i) {
                  "use strict";
                  i.d(e, "a", (function() {
                      return u
                  }
                  ));
                  var s = i(11);
                  function a() {
                      if ("undefined" == typeof Reflect || !Reflect.construct)
                          return !1;
                      if (Reflect.construct.sham)
                          return !1;
                      if ("function" == typeof Proxy)
                          return !0;
                      try {
                          return Date.prototype.toString.call(Reflect.construct(Date, [], (function() {}
                          ))),
                          !0
                      } catch (t) {
                          return !1
                      }
                  }
                  function r(t) {
                      return (r = "function" == typeof Symbol && "symbol" == n(Symbol.iterator) ? function(t) {
                          return n(t)
                      }
                      : function(t) {
                          return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : n(t)
                      }
                      )(t)
                  }
                  var o = i(16);
                  function h(t, e) {
                      return !e || "object" !== r(e) && "function" != typeof e ? Object(o.a)(t) : e
                  }
                  function u(t) {
                      return function() {
                          var e, i = Object(s.a)(t);
                          if (a()) {
                              var r = Object(s.a)(this).constructor;
                              e = Reflect.construct(i, arguments, r)
                          } else
                              e = i.apply(this, arguments);
                          return h(this, e)
                      }
                  }
              }
              , function(t, e, i) {
                  "use strict";
                  function s(t, e) {
                      return (s = Object.setPrototypeOf || function(t, e) {
                          return t.__proto__ = e,
                          t
                      }
                      )(t, e)
                  }
                  function a(t, e) {
                      if ("function" != typeof e && null !== e)
                          throw new TypeError("Super expression must either be null or a function");
                      t.prototype = Object.create(e && e.prototype, {
                          constructor: {
                              value: t,
                              writable: !0,
                              configurable: !0
                          }
                      }),
                      e && s(t, e)
                  }
                  i.d(e, "a", (function() {
                      return a
                  }
                  ))
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = {}
                    , a = {
                      setTaf: function(t) {
                          return s = t
                      }
                  };
                  e.default = a,
                  a.UserId = function() {
                      this.lUid = 0,
                      this.sGuid = "",
                      this.sToken = "",
                      this.sHuYaUA = "",
                      this.sCookie = "",
                      this.iTokenType = 0
                  }
                  ,
                  a.UserId.prototype._clone = function() {
                      return new a.UserId
                  }
                  ,
                  a.UserId.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.UserId.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.UserId.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lUid),
                      t.writeString(1, this.sGuid),
                      t.writeString(2, this.sToken),
                      t.writeString(3, this.sHuYaUA),
                      t.writeString(4, this.sCookie),
                      t.writeInt32(5, this.iTokenType)
                  }
                  ,
                  a.UserId.prototype.readFrom = function(t) {
                      this.lUid = t.readInt64(0, !1, this.lUid),
                      this.sGuid = t.readString(1, !1, this.sGuid),
                      this.sToken = t.readString(2, !1, this.sToken),
                      this.sHuYaUA = t.readString(3, !1, this.sHuYaUA),
                      this.sCookie = t.readString(4, !1, this.sCookie),
                      this.iTokenType = t.readInt32(5, !1, this.iTokenType)
                  }
                  ,
                  a.VideoGatewayProxy2VGPingReq = function() {
                      this.lLocalTime = 0
                  }
                  ,
                  a.VideoGatewayProxy2VGPingReq.prototype._clone = function() {
                      return new a.VideoGatewayProxy2VGPingReq
                  }
                  ,
                  a.VideoGatewayProxy2VGPingReq.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.VideoGatewayProxy2VGPingReq.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.VideoGatewayProxy2VGPingReq.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lLocalTime)
                  }
                  ,
                  a.VideoGatewayProxy2VGPingReq.prototype.readFrom = function(t) {
                      this.lLocalTime = t.readInt64(0, !1, this.lLocalTime)
                  }
                  ,
                  a.VideoGatewayProxy2VGPingRsp = function() {
                      this.lLocalTime = 0
                  }
                  ,
                  a.VideoGatewayProxy2VGPingRsp.prototype._clone = function() {
                      return new a.VideoGatewayProxy2VGPingRsp
                  }
                  ,
                  a.VideoGatewayProxy2VGPingRsp.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.VideoGatewayProxy2VGPingRsp.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.VideoGatewayProxy2VGPingRsp.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lLocalTime)
                  }
                  ,
                  a.VideoGatewayProxy2VGPingRsp.prototype.readFrom = function(t) {
                      this.lLocalTime = t.readInt64(0, !1, this.lLocalTime)
                  }
                  ,
                  a.GetInfoFromVGReq = function() {
                      this.lUid = 0,
                      this.iServiceType = 0,
                      this.iClientType = 0,
                      this.iClientIp = 0,
                      this.iTerminalType = 0,
                      this.iRequestVPType = 0,
                      this.sMsg = new s.BinBuffer,
                      this.iUri = 0,
                      this.sProtoName = "",
                      this.lSid = 0,
                      this.vStreamName = new s.Vector(new s.STRING),
                      this.tId = new a.UserId
                  }
                  ,
                  a.GetInfoFromVGReq.prototype._clone = function() {
                      return new a.GetInfoFromVGReq
                  }
                  ,
                  a.GetInfoFromVGReq.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.GetInfoFromVGReq.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.GetInfoFromVGReq.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lUid),
                      t.writeInt32(1, this.iServiceType),
                      t.writeInt32(2, this.iClientType),
                      t.writeInt64(3, this.iClientIp),
                      t.writeInt32(4, this.iTerminalType),
                      t.writeInt32(5, this.iRequestVPType),
                      t.writeBytes(6, this.sMsg),
                      t.writeInt64(7, this.iUri),
                      t.writeString(8, this.sProtoName),
                      t.writeInt64(9, this.lSid),
                      t.writeVector(10, this.vStreamName),
                      t.writeStruct(11, this.tId)
                  }
                  ,
                  a.GetInfoFromVGReq.prototype.readFrom = function(t) {
                      this.lUid = t.readInt64(0, !1, this.lUid),
                      this.iServiceType = t.readInt32(1, !1, this.iServiceType),
                      this.iClientType = t.readInt32(2, !1, this.iClientType),
                      this.iClientIp = t.readInt64(3, !1, this.iClientIp),
                      this.iTerminalType = t.readInt32(4, !1, this.iTerminalType),
                      this.iRequestVPType = t.readInt32(5, !1, this.iRequestVPType),
                      this.sMsg = t.readBytes(6, !1, this.sMsg),
                      this.iUri = t.readInt64(7, !1, this.iUri),
                      this.sProtoName = t.readString(8, !1, this.sProtoName),
                      this.lSid = t.readInt64(9, !1, this.lSid),
                      this.vStreamName = t.readVector(10, !1, this.vStreamName),
                      this.tId = t.readStruct(11, !1, this.tId)
                  }
                  ,
                  a.GetInfoFromVGRsp = function() {
                      this.lUid = 0,
                      this.ServerId = 0,
                      this.sMsg = new s.BinBuffer,
                      this.iUri = 0,
                      this.sProtoName = ""
                  }
                  ,
                  a.GetInfoFromVGRsp.prototype._clone = function() {
                      return new a.GetInfoFromVGRsp
                  }
                  ,
                  a.GetInfoFromVGRsp.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.GetInfoFromVGRsp.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.GetInfoFromVGRsp.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lUid),
                      t.writeInt64(1, this.ServerId),
                      t.writeBytes(2, this.sMsg),
                      t.writeInt64(3, this.iUri),
                      t.writeString(4, this.sProtoName)
                  }
                  ,
                  a.GetInfoFromVGRsp.prototype.readFrom = function(t) {
                      this.lUid = t.readInt64(0, !1, this.lUid),
                      this.ServerId = t.readInt64(1, !1, this.ServerId),
                      this.sMsg = t.readBytes(2, !1, this.sMsg),
                      this.iUri = t.readInt64(3, !1, this.iUri),
                      this.sProtoName = t.readString(4, !1, this.sProtoName)
                  }
                  ,
                  a.GetCdnTokenExReq = function() {
                      this.sFlvUrl = "",
                      this.sStreamName = "",
                      this.iLoopTime = 0,
                      this.tId = new a.UserId,
                      this.iAppId = 66
                  }
                  ,
                  a.GetCdnTokenExReq.prototype._clone = function() {
                      return new a.GetCdnTokenExReq
                  }
                  ,
                  a.GetCdnTokenExReq.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.GetCdnTokenExReq.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.GetCdnTokenExReq.prototype.writeTo = function(t) {
                      t.writeString(0, this.sFlvUrl),
                      t.writeString(1, this.sStreamName),
                      t.writeInt32(2, this.iLoopTime),
                      t.writeStruct(3, this.tId),
                      t.writeInt32(4, this.iAppId)
                  }
                  ,
                  a.GetCdnTokenExReq.prototype.readFrom = function(t) {
                      this.sFlvUrl = t.readString(0, !1, this.sFlvUrl),
                      this.sStreamName = t.readString(1, !1, this.sStreamName),
                      this.iLoopTime = t.readInt32(2, !1, this.iLoopTime),
                      this.tId = t.readStruct(3, !1, this.tId),
                      this.iAppId = t.readInt32(4, !1, this.iAppId)
                  }
                  ,
                  a.GetCdnTokenExRsp = function() {
                      this.sFlvToken = "",
                      this.iExpireTime = 0
                  }
                  ,
                  a.GetCdnTokenExRsp.prototype._clone = function() {
                      return new a.GetCdnTokenExRsp
                  }
                  ,
                  a.GetCdnTokenExRsp.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.GetCdnTokenExRsp.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.GetCdnTokenExRsp.prototype.writeTo = function(t) {
                      t.writeString(0, this.sFlvToken),
                      t.writeInt32(1, this.iExpireTime)
                  }
                  ,
                  a.GetCdnTokenExRsp.prototype.readFrom = function(t) {
                      this.sFlvToken = t.readString(0, !1, this.sFlvToken),
                      this.iExpireTime = t.readInt32(1, !1, this.iExpireTime)
                  }
                  ,
                  a.LiveScenarioType = {
                      ECommon_Live: 0,
                      EAudio_Only: 1,
                      EVideo_Only: 2,
                      ELink_Live: 3
                  },
                  a.LimitedStreamInfo = function() {
                      this.iVerMin = 0,
                      this.iVerMax = 0,
                      this.sCdnType = "",
                      this.iIsMaster = 0,
                      this.lChannelId = 0,
                      this.lSubChannelId = 0,
                      this.lPresenterUid = 0,
                      this.sStreamName = "",
                      this.sFlvUrl = "",
                      this.sFlvUrlSuffix = "",
                      this.sFlvAntiCode = "",
                      this.sHlsUrl = "",
                      this.sHlsUrlSuffix = "",
                      this.sHlsAntiCode = "",
                      this.iLineIndex = 0,
                      this.iIsMultiStream = 0,
                      this.iPCPriorityRate = 0,
                      this.iWebPriorityRate = 0,
                      this.iMobilePriorityRate = 0,
                      this.vFlvIPList = new s.Vector(new s.STRING),
                      this.iIsP2PSupport = 0,
                      this.sP2pUrl = "",
                      this.sP2pUrlSuffix = "",
                      this.sP2pAntiCode = "",
                      this.lFreeFlag = 0
                  }
                  ,
                  a.LimitedStreamInfo.prototype._clone = function() {
                      return new a.LimitedStreamInfo
                  }
                  ,
                  a.LimitedStreamInfo.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.LimitedStreamInfo.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.LimitedStreamInfo.prototype.writeTo = function(t) {
                      t.writeInt32(0, this.iVerMin),
                      t.writeInt32(1, this.iVerMax),
                      t.writeString(2, this.sCdnType),
                      t.writeInt32(3, this.iIsMaster),
                      t.writeInt64(4, this.lChannelId),
                      t.writeInt64(5, this.lSubChannelId),
                      t.writeInt64(6, this.lPresenterUid),
                      t.writeString(7, this.sStreamName),
                      t.writeString(8, this.sFlvUrl),
                      t.writeString(9, this.sFlvUrlSuffix),
                      t.writeString(10, this.sFlvAntiCode),
                      t.writeString(11, this.sHlsUrl),
                      t.writeString(12, this.sHlsUrlSuffix),
                      t.writeString(13, this.sHlsAntiCode),
                      t.writeInt32(14, this.iLineIndex),
                      t.writeInt32(15, this.iIsMultiStream),
                      t.writeInt32(16, this.iPCPriorityRate),
                      t.writeInt32(17, this.iWebPriorityRate),
                      t.writeInt32(18, this.iMobilePriorityRate),
                      t.writeVector(19, this.vFlvIPList),
                      t.writeInt32(20, this.iIsP2PSupport),
                      t.writeString(21, this.sP2pUrl),
                      t.writeString(22, this.sP2pUrlSuffix),
                      t.writeString(23, this.sP2pAntiCode),
                      t.writeInt64(24, this.lFreeFlag)
                  }
                  ,
                  a.LimitedStreamInfo.prototype.readFrom = function(t) {
                      this.iVerMin = t.readInt32(0, !1, this.iVerMin),
                      this.iVerMax = t.readInt32(1, !1, this.iVerMax),
                      this.sCdnType = t.readString(2, !1, this.sCdnType),
                      this.iIsMaster = t.readInt32(3, !1, this.iIsMaster),
                      this.lChannelId = t.readInt64(4, !1, this.lChannelId),
                      this.lSubChannelId = t.readInt64(5, !1, this.lSubChannelId),
                      this.lPresenterUid = t.readInt64(6, !1, this.lPresenterUid),
                      this.sStreamName = t.readString(7, !1, this.sStreamName),
                      this.sFlvUrl = t.readString(8, !1, this.sFlvUrl),
                      this.sFlvUrlSuffix = t.readString(9, !1, this.sFlvUrlSuffix),
                      this.sFlvAntiCode = t.readString(10, !1, this.sFlvAntiCode),
                      this.sHlsUrl = t.readString(11, !1, this.sHlsUrl),
                      this.sHlsUrlSuffix = t.readString(12, !1, this.sHlsUrlSuffix),
                      this.sHlsAntiCode = t.readString(13, !1, this.sHlsAntiCode),
                      this.iLineIndex = t.readInt32(14, !1, this.iLineIndex),
                      this.iIsMultiStream = t.readInt32(15, !1, this.iIsMultiStream),
                      this.iPCPriorityRate = t.readInt32(16, !1, this.iPCPriorityRate),
                      this.iWebPriorityRate = t.readInt32(17, !1, this.iWebPriorityRate),
                      this.iMobilePriorityRate = t.readInt32(18, !1, this.iMobilePriorityRate),
                      this.vFlvIPList = t.readVector(19, !1, this.vFlvIPList),
                      this.iIsP2PSupport = t.readInt32(20, !1, this.iIsP2PSupport),
                      this.sP2pUrl = t.readString(21, !1, this.sP2pUrl),
                      this.sP2pUrlSuffix = t.readString(22, !1, this.sP2pUrlSuffix),
                      this.sP2pAntiCode = t.readString(23, !1, this.sP2pAntiCode),
                      this.lFreeFlag = t.readInt64(24, !1, this.lFreeFlag)
                  }
                  ,
                  a.ClassifiedStreamInfoPack = function() {
                      this.iLiveScenarioType = 0,
                      this.vStreamInfo = new s.Vector(new a.LimitedStreamInfo),
                      this.vCdnList = new s.Vector(new s.STRING),
                      this.lLiveId = 0,
                      this.sLinkGroupId = "",
                      this.mStreamRatioWeb = new s.Map(new s.STRING,new s.INT32),
                      this.mStreamRatioPC = new s.Map(new s.STRING,new s.INT32),
                      this.mStreamRatioMobile = new s.Map(new s.STRING,new s.INT32)
                  }
                  ,
                  a.ClassifiedStreamInfoPack.prototype._clone = function() {
                      return new a.ClassifiedStreamInfoPack
                  }
                  ,
                  a.ClassifiedStreamInfoPack.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.ClassifiedStreamInfoPack.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.ClassifiedStreamInfoPack.prototype.writeTo = function(t) {
                      t.writeInt32(0, this.iLiveScenarioType),
                      t.writeVector(1, this.vStreamInfo),
                      t.writeVector(2, this.vCdnList),
                      t.writeInt64(3, this.lLiveId),
                      t.writeString(4, this.sLinkGroupId),
                      t.writeMap(5, this.mStreamRatioWeb),
                      t.writeMap(6, this.mStreamRatioPC),
                      t.writeMap(7, this.mStreamRatioMobile)
                  }
                  ,
                  a.ClassifiedStreamInfoPack.prototype.readFrom = function(t) {
                      this.iLiveScenarioType = t.readInt32(0, !1, this.iLiveScenarioType),
                      this.vStreamInfo = t.readVector(1, !1, this.vStreamInfo),
                      this.vCdnList = t.readVector(2, !1, this.vCdnList),
                      this.lLiveId = t.readInt64(3, !1, this.lLiveId),
                      this.sLinkGroupId = t.readString(4, !1, this.sLinkGroupId),
                      this.mStreamRatioWeb = t.readMap(5, !1, this.mStreamRatioWeb),
                      this.mStreamRatioPC = t.readMap(6, !1, this.mStreamRatioPC),
                      this.mStreamRatioMobile = t.readMap(7, !1, this.mStreamRatioMobile)
                  }
                  ,
                  a.LivingStreamInfoNotice = function() {
                      this.lPresenterUid = 0,
                      this.lLiveId = 0,
                      this.mStreamInfo = new s.Map(new s.INT32,new a.ClassifiedStreamInfoPack)
                  }
                  ,
                  a.LivingStreamInfoNotice.prototype._clone = function() {
                      return new a.LivingStreamInfoNotice
                  }
                  ,
                  a.LivingStreamInfoNotice.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.LivingStreamInfoNotice.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.LivingStreamInfoNotice.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lPresenterUid),
                      t.writeInt64(1, this.lLiveId),
                      t.writeMap(2, this.mStreamInfo)
                  }
                  ,
                  a.LivingStreamInfoNotice.prototype.readFrom = function(t) {
                      this.lPresenterUid = t.readInt64(0, !1, this.lPresenterUid),
                      this.lLiveId = t.readInt64(1, !1, this.lLiveId),
                      this.mStreamInfo = t.readMap(2, !1, this.mStreamInfo)
                  }
                  ,
                  a.LivingStreamEndNotice = function() {
                      this.sStreamName = "",
                      this.sCdnType = "",
                      this.iLineIndex = 0,
                      this.lLiveId = 0,
                      this.iLiveScenarioType = 0
                  }
                  ,
                  a.LivingStreamEndNotice.prototype._clone = function() {
                      return new a.LivingStreamEndNotice
                  }
                  ,
                  a.LivingStreamEndNotice.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.LivingStreamEndNotice.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.LivingStreamEndNotice.prototype.writeTo = function(t) {
                      t.writeString(0, this.sStreamName),
                      t.writeString(1, this.sCdnType),
                      t.writeInt32(2, this.iLineIndex),
                      t.writeInt64(3, this.lLiveId),
                      t.writeInt32(4, this.iLiveScenarioType)
                  }
                  ,
                  a.LivingStreamEndNotice.prototype.readFrom = function(t) {
                      this.sStreamName = t.readString(0, !1, this.sStreamName),
                      this.sCdnType = t.readString(1, !1, this.sCdnType),
                      this.iLineIndex = t.readInt32(2, !1, this.iLineIndex),
                      this.lLiveId = t.readInt64(3, !1, this.lLiveId),
                      this.iLiveScenarioType = t.readInt32(4, !1, this.iLiveScenarioType)
                  }
                  ,
                  a.GetLivingStreamInfoReq = function() {
                      this.tId = new a.UserId,
                      this.lTopSid = 0,
                      this.lSubSid = 0,
                      this.lPresenterUid = 0,
                      this.sTraceSource = ""
                  }
                  ,
                  a.GetLivingStreamInfoReq.prototype._clone = function() {
                      return new a.GetLivingStreamInfoReq
                  }
                  ,
                  a.GetLivingStreamInfoReq.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.GetLivingStreamInfoReq.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.GetLivingStreamInfoReq.prototype.writeTo = function(t) {
                      t.writeStruct(0, this.tId),
                      t.writeInt64(1, this.lTopSid),
                      t.writeInt64(2, this.lSubSid),
                      t.writeInt64(3, this.lPresenterUid),
                      t.writeString(4, this.sTraceSource)
                  }
                  ,
                  a.GetLivingStreamInfoReq.prototype.readFrom = function(t) {
                      this.tId = t.readStruct(0, !1, this.tId),
                      this.lTopSid = t.readInt64(1, !1, this.lTopSid),
                      this.lSubSid = t.readInt64(2, !1, this.lSubSid),
                      this.lPresenterUid = t.readInt64(3, !1, this.lPresenterUid),
                      this.sTraceSource = t.readString(4, !1, this.sTraceSource)
                  }
                  ,
                  a.GetLivingStreamInfoRsp = function() {
                      this.bIsLiving = 0,
                      this.tNotice = new a.LivingStreamInfoNotice,
                      this.bIsSelfLiving = 0
                  }
                  ,
                  a.GetLivingStreamInfoRsp.prototype._clone = function() {
                      return new a.GetLivingStreamInfoRsp
                  }
                  ,
                  a.GetLivingStreamInfoRsp.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.GetLivingStreamInfoRsp.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.GetLivingStreamInfoRsp.prototype.writeTo = function(t) {
                      t.writeInt32(0, this.bIsLiving),
                      t.writeStruct(1, this.tNotice),
                      t.writeInt32(2, this.bIsSelfLiving)
                  }
                  ,
                  a.GetLivingStreamInfoRsp.prototype.readFrom = function(t) {
                      this.bIsLiving = t.readInt32(0, !1, this.bIsLiving),
                      this.tNotice = t.readStruct(1, !1, this.tNotice),
                      this.bIsSelfLiving = t.readInt32(2, !1, this.bIsSelfLiving)
                  }
                  ,
                  a.VideoClientReportReq = function() {
                      this.iReportType = 0,
                      this.sReportString = "",
                      this.sMsg = new s.BinBuffer,
                      this.lUid = 0
                  }
                  ,
                  a.VideoClientReportReq.prototype._clone = function() {
                      return new a.VideoClientReportReq
                  }
                  ,
                  a.VideoClientReportReq.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.VideoClientReportReq.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.VideoClientReportReq.prototype.writeTo = function(t) {
                      t.writeInt32(0, this.iReportType),
                      t.writeString(1, this.sReportString),
                      t.writeBytes(2, this.sMsg),
                      t.writeInt64(3, this.lUid)
                  }
                  ,
                  a.VideoClientReportReq.prototype.readFrom = function(t) {
                      this.iReportType = t.readInt32(0, !1, this.iReportType),
                      this.sReportString = t.readString(1, !1, this.sReportString),
                      this.sMsg = t.readBytes(2, !1, this.sMsg),
                      this.lUid = t.readInt64(3, !1, this.lUid)
                  }
                  ,
                  a.LiveMeetingSyncNotice = function() {
                      this.tStat = new a.MeetingStat,
                      this.vSeats = new s.Vector(new a.MeetingSeat),
                      this.iVersion = 0,
                      this.sMessage = ""
                  }
                  ,
                  a.LiveMeetingSyncNotice.prototype._clone = function() {
                      return new a.LiveMeetingSyncNotice
                  }
                  ,
                  a.LiveMeetingSyncNotice.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.LiveMeetingSyncNotice.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.LiveMeetingSyncNotice.prototype.writeTo = function(t) {
                      t.writeStruct(0, this.tStat),
                      t.writeVector(1, this.vSeats),
                      t.writeInt32(2, this.iVersion),
                      t.writeString(3, this.sMessage)
                  }
                  ,
                  a.LiveMeetingSyncNotice.prototype.readFrom = function(t) {
                      this.tStat = t.readStruct(0, !1, this.tStat),
                      this.vSeats = t.readVector(1, !1, this.vSeats),
                      this.iVersion = t.readInt32(2, !1, this.iVersion),
                      this.sMessage = t.readString(3, !1, this.sMessage)
                  }
                  ,
                  a.MeetingStat = function() {
                      this.lPresenterUid = 0,
                      this.sPresenterNick = "",
                      this.sPresenterAvatarUrl = "",
                      this.mpContext = new s.Map(new s.STRING,new s.STRING),
                      this.iVersion = 0,
                      this.iCurAction = 0,
                      this.sPassword = "",
                      this.lSessionId = 0,
                      this.vApplyList = new s.Vector(new a.ApplyUser),
                      this.iState = 0,
                      this.iSilence = 0,
                      this.iActiveTime = 0,
                      this.iLastSyncTime = 0,
                      this.mpUserSession = new s.Map(new s.INT64,new s.STRING),
                      this.iBeginTime = 0,
                      this.iPresenterGender = 0,
                      this.tTransferRoom = new a.TransferLiveRoomState,
                      this.iMode = 0,
                      this.iModeV2 = 0
                  }
                  ,
                  a.MeetingStat.prototype._clone = function() {
                      return new a.MeetingStat
                  }
                  ,
                  a.MeetingStat.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.MeetingStat.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.MeetingStat.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lPresenterUid),
                      t.writeString(1, this.sPresenterNick),
                      t.writeString(2, this.sPresenterAvatarUrl),
                      t.writeMap(4, this.mpContext),
                      t.writeInt32(5, this.iVersion),
                      t.writeInt32(6, this.iCurAction),
                      t.writeString(7, this.sPassword),
                      t.writeInt64(8, this.lSessionId),
                      t.writeVector(9, this.vApplyList),
                      t.writeInt32(10, this.iState),
                      t.writeInt32(11, this.iSilence),
                      t.writeInt32(12, this.iActiveTime),
                      t.writeInt32(13, this.iLastSyncTime),
                      t.writeMap(14, this.mpUserSession),
                      t.writeInt32(15, this.iBeginTime),
                      t.writeInt32(16, this.iPresenterGender),
                      t.writeStruct(17, this.tTransferRoom),
                      t.writeInt32(18, this.iMode),
                      t.writeInt32(19, this.iModeV2)
                  }
                  ,
                  a.MeetingSeat = function() {
                      this.mpContext = new s.Map(new s.STRING,new s.STRING),
                      this.iPos = 0,
                      this.iLocked = 0,
                      this.lUid = 0,
                      this.sNick = "",
                      this.sAvatarUrl = "",
                      this.iMute = 0,
                      this.iVersion = 0,
                      this.iCurAction = 0,
                      this.iActiveTime = 0,
                      this.iSilence = 0,
                      this.iGender = 0,
                      this.lOfferSeatTimeStamp = 0,
                      this.iSilenceTime = 0,
                      this.iMuteTime = 0,
                      this.iSeatType = 0,
                      this.iSeatTypeV2 = 0,
                      this.sSeatUrl = "",
                      this.sCharm = "",
                      this.sName = "",
                      this.sSourceUrl = ""
                  }
                  ,
                  a.MeetingSeat.prototype._clone = function() {
                      return new a.MeetingSeat
                  }
                  ,
                  a.MeetingSeat.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.MeetingSeat.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.MeetingSeat.prototype.writeTo = function(t) {
                      t.writeMap(0, this.mpContext),
                      t.writeInt32(1, this.iPos),
                      t.writeInt32(2, this.iLocked),
                      t.writeInt64(3, this.lUid),
                      t.writeString(4, this.sNick),
                      t.writeString(5, this.sAvatarUrl),
                      t.writeInt32(7, this.iMute),
                      t.writeInt32(8, this.iVersion),
                      t.writeInt32(9, this.iCurAction),
                      t.writeInt32(10, this.iActiveTime),
                      t.writeInt32(11, this.iSilence),
                      t.writeInt32(12, this.iGender),
                      t.writeInt64(13, this.lOfferSeatTimeStamp),
                      t.writeInt32(14, this.iSilenceTime),
                      t.writeInt32(15, this.iMuteTime),
                      t.writeInt32(16, this.iSeatType),
                      t.writeInt32(17, this.iSeatTypeV2),
                      t.writeString(18, this.sSeatUrl),
                      t.writeString(19, this.sCharm),
                      t.writeString(20, this.sName),
                      t.writeString(21, this.sSourceUrl)
                  }
                  ,
                  a.MeetingSeat.prototype.readFrom = function(t) {
                      this.mpContext = t.readMap(0, !1, this.mpContext),
                      this.iPos = t.readInt32(1, !1, this.iPos),
                      this.iLocked = t.readInt32(2, !1, this.iLocked),
                      this.lUid = t.readInt64(3, !1, this.lUid),
                      this.sNick = t.readString(4, !1, this.sNick),
                      this.sAvatarUrl = t.readString(5, !1, this.sAvatarUrl),
                      this.iMute = t.readInt32(7, !1, this.iMute),
                      this.iVersion = t.readInt32(8, !1, this.iVersion),
                      this.iCurAction = t.readInt32(9, !1, this.iCurAction),
                      this.iActiveTime = t.readInt32(10, !1, this.iActiveTime),
                      this.iSilence = t.readInt32(11, !1, this.iSilence),
                      this.iGender = t.readInt32(12, !1, this.iGender),
                      this.lOfferSeatTimeStamp = t.readInt64(13, !1, this.lOfferSeatTimeStamp),
                      this.iSilenceTime = t.readInt32(14, !1, this.iSilenceTime),
                      this.iMuteTime = t.readInt32(15, !1, this.iMuteTime),
                      this.iSeatType = t.readInt32(16, !1, this.iSeatType),
                      this.iSeatTypeV2 = t.readInt32(17, !1, this.iSeatTypeV2),
                      this.sSeatUrl = t.readString(18, !1, this.sSeatUrl),
                      this.sCharm = t.readString(19, !1, this.sCharm),
                      this.sName = t.readString(20, !1, this.sName),
                      this.sSourceUrl = t.readString(21, !1, this.sSourceUrl)
                  }
                  ,
                  a.ApplyUser = function() {
                      this.lUid = 0,
                      this.sNick = "",
                      this.sAvatarUrl = "",
                      this.lActiveTime = 0,
                      this.mpContext = new s.Map(new s.STRING,new s.STRING),
                      this.iGender = 0,
                      this.sStreamName = "",
                      this.iSeatType = 0
                  }
                  ,
                  a.ApplyUser.prototype._clone = function() {
                      return new a.ApplyUser
                  }
                  ,
                  a.ApplyUser.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.ApplyUser.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.ApplyUser.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lUid),
                      t.writeString(1, this.sNick),
                      t.writeString(2, this.sAvatarUrl),
                      t.writeInt64(3, this.lActiveTime),
                      t.writeMap(4, this.mpContext),
                      t.writeInt32(5, this.iGender),
                      t.writeString(6, this.sStreamName),
                      t.writeInt32(7, this.iSeatType)
                  }
                  ,
                  a.ApplyUser.prototype.readFrom = function(t) {
                      this.lUid = t.readInt64(0, !1, this.lUid),
                      this.sNick = t.readString(1, !1, this.sNick),
                      this.sAvatarUrl = t.readString(2, !1, this.sAvatarUrl),
                      this.lActiveTime = t.readInt64(3, !1, this.lActiveTime),
                      this.mpContext = t.readMap(4, !1, this.mpContext),
                      this.iGender = t.readInt32(5, !1, this.iGender),
                      this.sStreamName = t.readString(6, !1, this.sStreamName),
                      this.iSeatType = t.readInt32(7, !1, this.iSeatType)
                  }
                  ,
                  a.TransferLiveRoomState = function() {
                      this.lTargetUid = 0,
                      this.iInviteTime = 0,
                      this.iTokeOverTime = 0,
                      this.iBeginLiveTime = 0,
                      this.lNewLiveId = 0,
                      this.iInviteExpire = 0,
                      this.iState = 0,
                      this.iResult = 0,
                      this.iSuccessTime = 0,
                      this.sTargetNick = ""
                  }
                  ,
                  a.TransferLiveRoomState.prototype._clone = function() {
                      return new a.TransferLiveRoomState
                  }
                  ,
                  a.TransferLiveRoomState.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.TransferLiveRoomState.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.TransferLiveRoomState.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lTargetUid),
                      t.writeInt32(1, this.iInviteTime),
                      t.writeInt32(2, this.iTokeOverTime),
                      t.writeInt32(3, this.iBeginLiveTime),
                      t.writeInt64(4, this.lNewLiveId),
                      t.writeInt32(5, this.iInviteExpire),
                      t.writeInt32(6, this.iState),
                      t.writeInt32(7, this.iResult),
                      t.writeInt32(8, this.iSuccessTime),
                      t.writeString(9, this.sTargetNick)
                  }
                  ,
                  a.TransferLiveRoomState.prototype.readFrom = function(t) {
                      this.lTargetUid = t.readInt64(0, !1, this.lTargetUid),
                      this.iInviteTime = t.readInt32(1, !1, this.iInviteTime),
                      this.iTokeOverTime = t.readInt32(2, !1, this.iTokeOverTime),
                      this.iBeginLiveTime = t.readInt32(3, !1, this.iBeginLiveTime),
                      this.lNewLiveId = t.readInt64(4, !1, this.lNewLiveId),
                      this.iInviteExpire = t.readInt32(5, !1, this.iInviteExpire),
                      this.iState = t.readInt32(6, !1, this.iState),
                      this.iResult = t.readInt32(7, !1, this.iResult),
                      this.iSuccessTime = t.readInt32(8, !1, this.iSuccessTime),
                      this.sTargetNick = t.readString(9, !1, this.sTargetNick)
                  }
                  ,
                  a.GetP2PStreamInfoReq = function() {
                      this.lUid = 0,
                      this.sStreamName = "",
                      this.iP2PType = 0
                  }
                  ,
                  a.GetP2PStreamInfoReq.prototype._clone = function() {
                      return new a.GetP2PStreamInfoReq
                  }
                  ,
                  a.GetP2PStreamInfoReq.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.GetP2PStreamInfoReq.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.GetP2PStreamInfoReq.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lUid),
                      t.writeString(1, this.sStreamName),
                      t.writeInt32(2, this.iP2PType)
                  }
                  ,
                  a.GetP2PStreamInfoReq.prototype.readFrom = function(t) {
                      this.lUid = t.readInt64(0, !1, this.lUid),
                      this.sStreamName = t.readString(1, !1, this.sStreamName),
                      this.iP2PType = t.readInt32(2, !1, this.iP2PType)
                  }
                  ,
                  a.GetP2PStreamInfoRsp = function() {
                      this.lUid = 0,
                      this.sStreamName = "",
                      this.iP2PType = 0,
                      this.sP2PToken = "",
                      this.iP2PExpireTime = 0,
                      this.sP2PUrl = "",
                      this.sCodecType = "",
                      this.sCdnBrand = "",
                      this.mpOption = new s.Map(new s.INT16,new s.INT64),
                      this.line = 0
                  }
                  ,
                  a.GetP2PStreamInfoRsp.prototype._clone = function() {
                      return new a.GetP2PStreamInfoRsp
                  }
                  ,
                  a.GetP2PStreamInfoRsp.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.GetP2PStreamInfoRsp.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.GetP2PStreamInfoRsp.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lUid),
                      t.writeString(1, this.sStreamName),
                      t.writeInt32(2, this.iP2PType),
                      t.writeString(3, this.sP2PToken),
                      t.writeInt32(4, this.iP2PExpireTime),
                      t.writeString(5, this.sP2PUrl),
                      t.writeString(6, this.sCodecType),
                      t.writeString(7, this.sCdnBrand),
                      t.writeMap(8, this.mpOption),
                      t.writeUInt8(9, this.line)
                  }
                  ,
                  a.GetP2PStreamInfoRsp.prototype.readFrom = function(t) {
                      this.lUid = t.readInt64(0, !1, this.lUid),
                      this.sStreamName = t.readString(1, !1, this.sStreamName),
                      this.iP2PType = t.readInt32(2, !1, this.iP2PType),
                      this.sP2PToken = t.readString(3, !1, this.sP2PToken),
                      this.iP2PExpireTime = t.readInt32(4, !1, this.iP2PExpireTime),
                      this.sP2PUrl = t.readString(5, !1, this.sP2PUrl),
                      this.sCodecType = t.readString(6, !1, this.sCodecType),
                      this.sCdnBrand = t.readString(7, !1, this.sCdnBrand),
                      this.mpOption = t.readMap(8, !1, this.mpOption),
                      this.line = t.readUInt8(9, !1, this.line)
                  }
                  ,
                  a.GetP2PStreamTokenExReq = function() {
                      this.sStreamName = "",
                      this.iLoopTime = 0
                  }
                  ,
                  a.GetP2PStreamTokenExReq.prototype._clone = function() {
                      return new a.GetP2PStreamTokenExReq
                  }
                  ,
                  a.GetP2PStreamTokenExReq.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.GetP2PStreamTokenExReq.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.GetP2PStreamTokenExReq.prototype.writeTo = function(t) {
                      t.writeString(0, this.sStreamName),
                      t.writeInt32(1, this.iLoopTime)
                  }
                  ,
                  a.GetP2PStreamTokenExReq.prototype.readFrom = function(t) {
                      this.sStreamName = t.readString(0, !1, this.sStreamName),
                      this.iLoopTime = t.readInt32(1, !1, this.iLoopTime)
                  }
                  ,
                  a.GetP2PStreamTokenExRsp = function() {
                      this.sP2PToken = "",
                      this.iExpireTime = 0
                  }
                  ,
                  a.GetP2PStreamTokenExRsp.prototype._clone = function() {
                      return new a.GetP2PStreamTokenExRsp
                  }
                  ,
                  a.GetP2PStreamTokenExRsp.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.GetP2PStreamTokenExRsp.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.GetP2PStreamTokenExRsp.prototype.writeTo = function(t) {
                      t.writeString(0, this.sP2PToken),
                      t.writeInt32(1, this.iExpireTime)
                  }
                  ,
                  a.GetP2PStreamTokenExRsp.prototype.readFrom = function(t) {
                      this.sP2PToken = t.readString(0, !1, this.sP2PToken),
                      this.iExpireTime = t.readInt32(1, !1, this.iExpireTime)
                  }
                  ,
                  a.HttpDnsItem = function() {
                      this.vIp = new s.Vector(new s.STRING),
                      this.iExpireTime = 0,
                      this.vIpv6 = new s.Vector(new s.STRING)
                  }
                  ,
                  a.HttpDnsItem.prototype._clone = function() {
                      return new a.HttpDnsItem
                  }
                  ,
                  a.HttpDnsItem.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.HttpDnsItem.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.HttpDnsItem.prototype.writeTo = function(t) {
                      t.writeVector(0, this.vIp),
                      t.writeInt64(1, this.iExpireTime),
                      t.writeVector(2, this.vIpv6)
                  }
                  ,
                  a.HttpDnsItem.prototype.readFrom = function(t) {
                      this.vIp = t.readVector(0, !1, this.vIp),
                      this.iExpireTime = t.readInt64(1, !1, this.iExpireTime),
                      this.vIpv6 = t.readVector(2, !1, this.vIpv6)
                  }
                  ,
                  a.QueryHttpDnsReq = function() {
                      this.lUid = 0,
                      this.sUA = "",
                      this.vDomain = new s.Vector(new s.STRING),
                      this.sAppSrc = ""
                  }
                  ,
                  a.QueryHttpDnsReq.prototype._clone = function() {
                      return new a.QueryHttpDnsReq
                  }
                  ,
                  a.QueryHttpDnsReq.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.QueryHttpDnsReq.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.QueryHttpDnsReq.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lUid),
                      t.writeString(1, this.sUA),
                      t.writeVector(2, this.vDomain),
                      t.writeString(3, this.sAppSrc)
                  }
                  ,
                  a.QueryHttpDnsReq.prototype.readFrom = function(t) {
                      this.lUid = t.readInt64(0, !1, this.lUid),
                      this.sUA = t.readString(1, !1, this.sUA),
                      this.vDomain = t.readVector(2, !1, this.vDomain),
                      this.sAppSrc = t.readString(3, !1, this.sAppSrc)
                  }
                  ,
                  a.QueryHttpDnsRsp = function() {
                      this.mDomain2Ip = new s.Map(new s.STRING,new a.HttpDnsItem)
                  }
                  ,
                  a.QueryHttpDnsRsp.prototype._clone = function() {
                      return new a.QueryHttpDnsRsp
                  }
                  ,
                  a.QueryHttpDnsRsp.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.QueryHttpDnsRsp.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.QueryHttpDnsRsp.prototype.writeTo = function(t) {
                      t.writeMap(0, this.mDomain2Ip)
                  }
                  ,
                  a.QueryHttpDnsRsp.prototype.readFrom = function(t) {
                      this.mDomain2Ip = t.readMap(0, !1, this.mDomain2Ip)
                  }
                  ,
                  a.WSTimeSyncReq = function() {
                      this.sGuid = "",
                      this.lClientTime = 0
                  }
                  ,
                  a.WSTimeSyncReq.prototype._clone = function() {
                      return new a.WSTimeSyncReq
                  }
                  ,
                  a.WSTimeSyncReq.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.WSTimeSyncReq.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.WSTimeSyncReq.prototype.writeTo = function(t) {
                      t.writeString(0, this.sGuid),
                      t.writeInt64(1, this.lClientTime)
                  }
                  ,
                  a.WSTimeSyncReq.prototype.readFrom = function(t) {
                      this.sGuid = t.readString(0, !1, this.sGuid),
                      this.lClientTime = t.readInt64(1, !1, this.lClientTime)
                  }
                  ,
                  a.WSTimeSyncRsp = function() {
                      this.lServerTime = 0
                  }
                  ,
                  a.WSTimeSyncRsp.prototype._clone = function() {
                      return new a.WSTimeSyncRsp
                  }
                  ,
                  a.WSTimeSyncRsp.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.WSTimeSyncRsp.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.WSTimeSyncRsp.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lServerTime)
                  }
                  ,
                  a.WSTimeSyncRsp.prototype.readFrom = function(t) {
                      this.lServerTime = t.readInt64(0, !1, this.lServerTime)
                  }
                  ,
                  a.MediaUserId = function() {
                      this.lUid = 0,
                      this.sGuid = "",
                      this.sToken = "",
                      this.sUA = "",
                      this.sCookie = "",
                      this.iTokenType = 0,
                      this.iAppid = 0,
                      this.bAnonymous = 0,
                      this.sStrUid = ""
                  }
                  ,
                  a.MediaUserId.prototype._clone = function() {
                      return new a.MediaUserId
                  }
                  ,
                  a.MediaUserId.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.MediaUserId.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.MediaUserId.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lUid),
                      t.writeString(1, this.sGuid),
                      t.writeString(2, this.sToken),
                      t.writeString(3, this.sUA),
                      t.writeString(4, this.sCookie),
                      t.writeInt32(5, this.iTokenType),
                      t.writeInt32(6, this.iAppid),
                      t.writeInt32(7, this.bAnonymous),
                      t.writeString(8, this.sStrUid)
                  }
                  ,
                  a.MediaUserId.prototype.readFrom = function(t) {
                      this.lUid = t.readInt64(0, !1, this.lUid),
                      this.sGuid = t.readString(1, !1, this.sGuid),
                      this.sToken = t.readString(2, !1, this.sToken),
                      this.sUA = t.readString(3, !1, this.sUA),
                      this.sCookie = t.readString(4, !1, this.sCookie),
                      this.iTokenType = t.readInt32(5, !1, this.iTokenType),
                      this.iAppid = t.readInt32(6, !1, this.iAppid),
                      this.bAnonymous = t.readInt32(7, !1, this.bAnonymous),
                      this.sStrUid = t.readString(8, !1, this.sStrUid)
                  }
                  ,
                  a.LoginVerifyReq = function() {
                      this.tId = new a.MediaUserId,
                      this.iCookieDeadTime = 0
                  }
                  ,
                  a.LoginVerifyReq.prototype._clone = function() {
                      return new a.LoginVerifyReq
                  }
                  ,
                  a.LoginVerifyReq.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.LoginVerifyReq.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.LoginVerifyReq.prototype.writeTo = function(t) {
                      t.writeStruct(0, this.tId),
                      t.writeInt32(1, this.iCookieDeadTime)
                  }
                  ,
                  a.LoginVerifyReq.prototype.readFrom = function(t) {
                      this.tId = t.readStruct(0, !1, this.tId),
                      this.iCookieDeadTime = t.readInt32(1, !1, this.iCookieDeadTime)
                  }
                  ,
                  a.LoginVerifyRsp = function() {
                      this.iResCode = 0,
                      this.lUid = 0,
                      this.sCookie = "",
                      this.sUid = "",
                      this.iAppId = 0
                  }
                  ,
                  a.LoginVerifyRsp.prototype._clone = function() {
                      return new a.LoginVerifyRsp
                  }
                  ,
                  a.LoginVerifyRsp.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.LoginVerifyRsp.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.LoginVerifyRsp.prototype.writeTo = function(t) {
                      t.writeInt32(0, this.iResCode),
                      t.writeInt64(1, this.lUid),
                      t.writeString(2, this.sCookie),
                      t.writeString(3, this.sUid),
                      t.writeInt32(4, this.iAppId)
                  }
                  ,
                  a.LoginVerifyRsp.prototype.readFrom = function(t) {
                      this.iResCode = t.readInt32(0, !1, this.iResCode),
                      this.lUid = t.readInt64(1, !1, this.lUid),
                      this.sCookie = t.readString(2, !1, this.sCookie),
                      this.sUid = t.readString(3, !1, this.sUid),
                      this.iAppId = t.readInt32(4, !1, this.iAppId)
                  }
                  ,
                  a.JoinMediaGroupReq = function() {
                      this.tId = new a.MediaUserId,
                      this.vGroupId = new s.Vector(new s.STRING)
                  }
                  ,
                  a.JoinMediaGroupReq.prototype._clone = function() {
                      return new a.JoinMediaGroupReq
                  }
                  ,
                  a.JoinMediaGroupReq.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.JoinMediaGroupReq.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.JoinMediaGroupReq.prototype.writeTo = function(t) {
                      t.writeStruct(0, this.tId),
                      t.writeVector(1, this.vGroupId)
                  }
                  ,
                  a.JoinMediaGroupReq.prototype.readFrom = function(t) {
                      this.tId = t.readStruct(0, !1, this.tId),
                      this.vGroupId = t.readVector(1, !1, this.vGroupId)
                  }
                  ,
                  a.JoinMediaGroupRsp = function() {
                      this.iCode = 0,
                      this.sMsg = "",
                      this.vGroupId = new s.Vector(new s.STRING)
                  }
                  ,
                  a.JoinMediaGroupRsp.prototype._clone = function() {
                      return new a.JoinMediaGroupRsp
                  }
                  ,
                  a.JoinMediaGroupRsp.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.JoinMediaGroupRsp.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.JoinMediaGroupRsp.prototype.writeTo = function(t) {
                      t.writeInt32(0, this.iCode),
                      t.writeString(1, this.sMsg),
                      t.writeVector(2, this.vGroupId)
                  }
                  ,
                  a.JoinMediaGroupRsp.prototype.readFrom = function(t) {
                      this.iCode = t.readInt32(0, !1, this.iCode),
                      this.sMsg = t.readString(1, !1, this.sMsg),
                      this.vGroupId = t.readVector(2, !1, this.vGroupId)
                  }
                  ,
                  a.QuitMediaGroupReq = function() {
                      this.tId = new a.MediaUserId,
                      this.vGroupId = new s.Vector(new s.STRING)
                  }
                  ,
                  a.QuitMediaGroupReq.prototype._clone = function() {
                      return new a.QuitMediaGroupReq
                  }
                  ,
                  a.QuitMediaGroupReq.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.QuitMediaGroupReq.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.QuitMediaGroupReq.prototype.writeTo = function(t) {
                      t.writeStruct(0, this.tId),
                      t.writeVector(1, this.vGroupId)
                  }
                  ,
                  a.QuitMediaGroupReq.prototype.readFrom = function(t) {
                      this.tId = t.readStruct(0, !1, this.tId),
                      this.vGroupId = t.readVector(1, !1, this.vGroupId)
                  }
                  ,
                  a.QuitMediaGroupRsp = function() {
                      this.iCode = 0,
                      this.sMsg = "",
                      this.vGroupId = new s.Vector(new s.STRING)
                  }
                  ,
                  a.QuitMediaGroupRsp.prototype._clone = function() {
                      return new a.QuitMediaGroupRsp
                  }
                  ,
                  a.QuitMediaGroupRsp.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.QuitMediaGroupRsp.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.QuitMediaGroupRsp.prototype.writeTo = function(t) {
                      t.writeInt32(0, this.iCode),
                      t.writeString(1, this.sMsg),
                      t.writeVector(2, this.vGroupId)
                  }
                  ,
                  a.QuitMediaGroupRsp.prototype.readFrom = function(t) {
                      this.iCode = t.readInt32(0, !1, this.iCode),
                      this.sMsg = t.readString(1, !1, this.sMsg),
                      this.vGroupId = t.readVector(2, !1, this.vGroupId)
                  }
                  ,
                  a.ikk = 1,
                  a.skk = "123",
                  a.eIType = {
                      k4AM: 10001,
                      k6AM: 10002
                  },
                  a.EM_PCDN_MODE = {
                      E_PcdnMode_Min: 0,
                      E_PcdnMode_P2pHttpSubstream: 1,
                      E_PcdnMode_P2pOutsideSdkSubstream: 2,
                      E_PcdnMode_FlvHttpFullstream: 3,
                      E_PcdnMode_FlvOutsideSdkFullstream: 4,
                      E_PcdnMode_Max: 255
                  },
                  a.EM_BUSI_TYPE = {
                      E_BusiType_Min: 0,
                      E_BusiType_Live: 1,
                      E_BusiType_Max: 255
                  },
                  a.EM_CLINET_TYPE = {
                      E_CLIENT_MIN: 0,
                      E_CLIENT_PC: 1,
                      E_CLIENT_ADR: 2,
                      E_CLIENT_IOS: 3,
                      E_CLIENT_WEB: 4,
                      E_CLIENT_MAX: 255
                  },
                  a.ERR_CODE_FOR_HY_PCDNGW_CLIENT_RSP = {
                      E_SUCCESS: 0,
                      E_HYGW_ERR: 1,
                      E_PCDNGW_40X: 2,
                      E_PCDNGW_50X: 3,
                      E_PCDNGW_TIO: 4,
                      E_PCDNGW_RSPERR: 5,
                      E_CLIREQ_ERR: 6,
                      E_PCDN_OFF: 7,
                      E_LIMIT_FLOWS: 8
                  },
                  a.MyReq = function() {
                      this.name = "",
                      this.opt = "",
                      this.mMap = new s.Map(new s.STRING,new s.STRING)
                  }
                  ,
                  a.MyReq.prototype._clone = function() {
                      return new a.MyReq
                  }
                  ,
                  a.MyReq.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.MyReq.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.MyReq.prototype.writeTo = function(t) {
                      t.writeString(0, this.name),
                      t.writeString(1, this.opt),
                      t.writeMap(2, this.mMap)
                  }
                  ,
                  a.MyReq.prototype.readFrom = function(t) {
                      this.name = t.readString(0, !1, this.name),
                      this.opt = t.readString(1, !1, this.opt),
                      this.mMap = t.readMap(2, !1, this.mMap)
                  }
                  ,
                  a.MyRsp = function() {
                      this.value = 0,
                      this.origin = new a.MyReq,
                      this.types = new s.Vector(new s.INT32),
                      this.eType = 0
                  }
                  ,
                  a.MyRsp.prototype._clone = function() {
                      return new a.MyRsp
                  }
                  ,
                  a.MyRsp.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.MyRsp.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.MyRsp.prototype.writeTo = function(t) {
                      t.writeInt32(0, this.value),
                      t.writeStruct(1, this.origin),
                      t.writeVector(2, this.types),
                      t.writeInt32(3, this.eType)
                  }
                  ,
                  a.MyRsp.prototype.readFrom = function(t) {
                      this.value = t.readInt32(0, !1, this.value),
                      this.origin = t.readStruct(1, !1, this.origin),
                      this.types = t.readVector(2, !1, this.types),
                      this.eType = t.readInt32(3, !1, this.eType)
                  }
                  ,
                  a.ClientQueryPcdnScheduleReq = function() {
                      this.lReqTs = 0,
                      this.lUid = 0,
                      this.sGuid = "",
                      this.lAnchorUid = 0,
                      this.iCdnLine = 0,
                      this.iCliType = 0,
                      this.lBucketPara = 0,
                      this.vPcdnMode = new s.Vector(new s.INT32),
                      this.iBusiType = 0,
                      this.sStreamName = "",
                      this.mPcdnModeCliSupportPcdns = new s.Map(new s.INT32,new s.Vector(new s.STRING))
                  }
                  ,
                  a.ClientQueryPcdnScheduleReq.prototype._clone = function() {
                      return new a.ClientQueryPcdnScheduleReq
                  }
                  ,
                  a.ClientQueryPcdnScheduleReq.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.ClientQueryPcdnScheduleReq.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.ClientQueryPcdnScheduleReq.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lReqTs),
                      t.writeInt64(1, this.lUid),
                      t.writeString(2, this.sGuid),
                      t.writeInt64(3, this.lAnchorUid),
                      t.writeInt32(4, this.iCdnLine),
                      t.writeInt32(5, this.iCliType),
                      t.writeInt64(6, this.lBucketPara),
                      t.writeVector(30, this.vPcdnMode),
                      t.writeInt32(31, this.iBusiType),
                      t.writeString(32, this.sStreamName),
                      t.writeMap(100, this.mPcdnModeCliSupportPcdns)
                  }
                  ,
                  a.ClientQueryPcdnScheduleReq.prototype.readFrom = function(t) {
                      this.lReqTs = t.readInt64(0, !1, this.lReqTs),
                      this.lUid = t.readInt64(1, !1, this.lUid),
                      this.sGuid = t.readString(2, !1, this.sGuid),
                      this.lAnchorUid = t.readInt64(3, !1, this.lAnchorUid),
                      this.iCdnLine = t.readInt32(4, !1, this.iCdnLine),
                      this.iCliType = t.readInt32(5, !1, this.iCliType),
                      this.lBucketPara = t.readInt64(6, !1, this.lBucketPara),
                      this.vPcdnMode = t.readVector(30, !1, this.vPcdnMode),
                      this.iBusiType = t.readInt32(31, !1, this.iBusiType),
                      this.sStreamName = t.readString(32, !1, this.sStreamName),
                      this.mPcdnModeCliSupportPcdns = t.readMap(100, !1, this.mPcdnModeCliSupportPcdns)
                  }
                  ,
                  a.ClientQueryPcdnScheduleRsp = function() {
                      this.lReqTs = 0,
                      this.lRspTs = 0,
                      this.iErrCode = 0,
                      this.mPcdnModeSwitch = new s.Map(new s.INT32,new s.INT32),
                      this.cliProv = "",
                      this.cliIsp = "",
                      this.lUid = 0,
                      this.iCdnLine = 0,
                      this.sStreamName = "",
                      this.mPcdnModePcdnName = new s.Map(new s.INT32,new s.STRING)
                  }
                  ,
                  a.ClientQueryPcdnScheduleRsp.prototype._clone = function() {
                      return new a.ClientQueryPcdnScheduleRsp
                  }
                  ,
                  a.ClientQueryPcdnScheduleRsp.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.ClientQueryPcdnScheduleRsp.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.ClientQueryPcdnScheduleRsp.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lReqTs),
                      t.writeInt64(1, this.lRspTs),
                      t.writeInt32(2, this.iErrCode),
                      t.writeMap(10, this.mPcdnModeSwitch),
                      t.writeString(30, this.cliProv),
                      t.writeString(31, this.cliIsp),
                      t.writeInt64(100, this.lUid),
                      t.writeInt32(101, this.iCdnLine),
                      t.writeString(102, this.sStreamName),
                      t.writeMap(200, this.mPcdnModePcdnName)
                  }
                  ,
                  a.ClientQueryPcdnScheduleRsp.prototype.readFrom = function(t) {
                      this.lReqTs = t.readInt64(0, !1, this.lReqTs),
                      this.lRspTs = t.readInt64(1, !1, this.lRspTs),
                      this.iErrCode = t.readInt32(2, !1, this.iErrCode),
                      this.mPcdnModeSwitch = t.readMap(10, !1, this.mPcdnModeSwitch),
                      this.cliProv = t.readString(30, !1, this.cliProv),
                      this.cliIsp = t.readString(31, !1, this.cliIsp),
                      this.lUid = t.readInt64(100, !1, this.lUid),
                      this.iCdnLine = t.readInt32(101, !1, this.iCdnLine),
                      this.sStreamName = t.readString(102, !1, this.sStreamName),
                      this.mPcdnModePcdnName = t.readMap(200, !1, this.mPcdnModePcdnName)
                  }
                  ,
                  a.ClientGetStunAndPcdnProxyReq = function() {
                      this.lReqTs = 0,
                      this.lUid = 0,
                      this.sStreamname = "",
                      this.iBaseSubs = 0,
                      this.vSub = new s.Vector(new s.INT32),
                      this.sGuid = "",
                      this.lAnchorUid = 0,
                      this.iCdnLine = 0,
                      this.iCliType = 0,
                      this.lBucketPara = 0,
                      this.iBusiType = 0,
                      this.curPcdnName = ""
                  }
                  ,
                  a.ClientGetStunAndPcdnProxyReq.prototype._clone = function() {
                      return new a.ClientGetStunAndPcdnProxyReq
                  }
                  ,
                  a.ClientGetStunAndPcdnProxyReq.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.ClientGetStunAndPcdnProxyReq.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.ClientGetStunAndPcdnProxyReq.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lReqTs),
                      t.writeInt64(1, this.lUid),
                      t.writeString(2, this.sStreamname),
                      t.writeInt32(3, this.iBaseSubs),
                      t.writeVector(4, this.vSub),
                      t.writeString(5, this.sGuid),
                      t.writeInt64(6, this.lAnchorUid),
                      t.writeInt32(7, this.iCdnLine),
                      t.writeInt32(8, this.iCliType),
                      t.writeInt64(9, this.lBucketPara),
                      t.writeInt32(10, this.iBusiType),
                      t.writeString(11, this.curPcdnName)
                  }
                  ,
                  a.ClientGetStunAndPcdnProxyReq.prototype.readFrom = function(t) {
                      this.lReqTs = t.readInt64(0, !1, this.lReqTs),
                      this.lUid = t.readInt64(1, !1, this.lUid),
                      this.sStreamname = t.readString(2, !1, this.sStreamname),
                      this.iBaseSubs = t.readInt32(3, !1, this.iBaseSubs),
                      this.vSub = t.readVector(4, !1, this.vSub),
                      this.sGuid = t.readString(5, !1, this.sGuid),
                      this.lAnchorUid = t.readInt64(6, !1, this.lAnchorUid),
                      this.iCdnLine = t.readInt32(7, !1, this.iCdnLine),
                      this.iCliType = t.readInt32(8, !1, this.iCliType),
                      this.lBucketPara = t.readInt64(9, !1, this.lBucketPara),
                      this.iBusiType = t.readInt32(10, !1, this.iBusiType),
                      this.curPcdnName = t.readString(11, !1, this.curPcdnName)
                  }
                  ,
                  a.PCdnProxyUrl = function() {
                      this.sProtocol = "",
                      this.vUrl = new s.Vector(new s.STRING),
                      this.iStatusPcdn = 0,
                      this.iPcdnThresholdHotDegreeIn = -1,
                      this.iPcdnThresholdHotDegreeKick = -1,
                      this.iPcdnNowHotDegree = -1,
                      this.iPcdnNowPullstreamUcnt = -1,
                      this.iPcdnNowGetpcdnUcnt = -1
                  }
                  ,
                  a.PCdnProxyUrl.prototype._clone = function() {
                      return new a.PCdnProxyUrl
                  }
                  ,
                  a.PCdnProxyUrl.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.PCdnProxyUrl.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.PCdnProxyUrl.prototype.writeTo = function(t) {
                      t.writeString(0, this.sProtocol),
                      t.writeVector(2, this.vUrl),
                      t.writeInt32(3, this.iStatusPcdn),
                      t.writeInt32(10, this.iPcdnThresholdHotDegreeIn),
                      t.writeInt32(11, this.iPcdnThresholdHotDegreeKick),
                      t.writeInt32(12, this.iPcdnNowHotDegree),
                      t.writeInt32(13, this.iPcdnNowPullstreamUcnt),
                      t.writeInt32(14, this.iPcdnNowGetpcdnUcnt)
                  }
                  ,
                  a.PCdnProxyUrl.prototype.readFrom = function(t) {
                      this.sProtocol = t.readString(0, !1, this.sProtocol),
                      this.vUrl = t.readVector(2, !1, this.vUrl),
                      this.iStatusPcdn = t.readInt32(3, !1, this.iStatusPcdn),
                      this.iPcdnThresholdHotDegreeIn = t.readInt32(10, !1, this.iPcdnThresholdHotDegreeIn),
                      this.iPcdnThresholdHotDegreeKick = t.readInt32(11, !1, this.iPcdnThresholdHotDegreeKick),
                      this.iPcdnNowHotDegree = t.readInt32(12, !1, this.iPcdnNowHotDegree),
                      this.iPcdnNowPullstreamUcnt = t.readInt32(13, !1, this.iPcdnNowPullstreamUcnt),
                      this.iPcdnNowGetpcdnUcnt = t.readInt32(14, !1, this.iPcdnNowGetpcdnUcnt)
                  }
                  ,
                  a.ClientGetStunAndPcdnProxyRsp = function() {
                      this.lReqTs = 0,
                      this.lRspTs = 0,
                      this.lUid = 0,
                      this.sStreamname = "",
                      this.iErrCode = 0,
                      this.iBaseSubs = 0,
                      this.mSubToPullStreamUrl = new s.Map(new s.INT32,new s.Map(new s.STRING,new a.PCdnProxyUrl)),
                      this.cliProv = "",
                      this.cliIsp = "",
                      this.pcdnName = "",
                      this.iCdnLine = 0,
                      this.sPcdnIsp = "",
                      this.sPcdnArea = ""
                  }
                  ,
                  a.ClientGetStunAndPcdnProxyRsp.prototype._clone = function() {
                      return new a.ClientGetStunAndPcdnProxyRsp
                  }
                  ,
                  a.ClientGetStunAndPcdnProxyRsp.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.ClientGetStunAndPcdnProxyRsp.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.ClientGetStunAndPcdnProxyRsp.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lReqTs),
                      t.writeInt64(1, this.lRspTs),
                      t.writeInt64(2, this.lUid),
                      t.writeString(3, this.sStreamname),
                      t.writeInt32(4, this.iErrCode),
                      t.writeInt32(5, this.iBaseSubs),
                      t.writeMap(12, this.mSubToPullStreamUrl),
                      t.writeString(13, this.cliProv),
                      t.writeString(14, this.cliIsp),
                      t.writeString(15, this.pcdnName),
                      t.writeInt32(100, this.iCdnLine),
                      t.writeString(200, this.sPcdnIsp),
                      t.writeString(201, this.sPcdnArea)
                  }
                  ,
                  a.ClientGetStunAndPcdnProxyRsp.prototype.readFrom = function(t) {
                      this.lReqTs = t.readInt64(0, !1, this.lReqTs),
                      this.lRspTs = t.readInt64(1, !1, this.lRspTs),
                      this.lUid = t.readInt64(2, !1, this.lUid),
                      this.sStreamname = t.readString(3, !1, this.sStreamname),
                      this.iErrCode = t.readInt32(4, !1, this.iErrCode),
                      this.iBaseSubs = t.readInt32(5, !1, this.iBaseSubs),
                      this.mSubToPullStreamUrl = t.readMap(12, !1, this.mSubToPullStreamUrl),
                      this.cliProv = t.readString(13, !1, this.cliProv),
                      this.cliIsp = t.readString(14, !1, this.cliIsp),
                      this.pcdnName = t.readString(15, !1, this.pcdnName),
                      this.iCdnLine = t.readInt32(100, !1, this.iCdnLine),
                      this.sPcdnIsp = t.readString(200, !1, this.sPcdnIsp),
                      this.sPcdnArea = t.readString(201, !1, this.sPcdnArea)
                  }
                  ,
                  a.ClientGetPcdnP2pOutsideSdkSubstreamInfoReq = function() {
                      this.lReqTs = 0,
                      this.lUid = 0,
                      this.sGuid = "",
                      this.lAnchorUid = 0,
                      this.iCdnLine = 0,
                      this.sStreamname = "",
                      this.iBaseSubs = 0,
                      this.vSub = new s.Vector(new s.INT32),
                      this.iCliType = 0,
                      this.lBucketPara = 0,
                      this.iBusiType = 0,
                      this.vCliSupportPcdns = new s.Vector(new s.STRING),
                      this.curPcdnName = ""
                  }
                  ,
                  a.ClientGetPcdnP2pOutsideSdkSubstreamInfoReq.prototype._clone = function() {
                      return new a.ClientGetPcdnP2pOutsideSdkSubstreamInfoReq
                  }
                  ,
                  a.ClientGetPcdnP2pOutsideSdkSubstreamInfoReq.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.ClientGetPcdnP2pOutsideSdkSubstreamInfoReq.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.ClientGetPcdnP2pOutsideSdkSubstreamInfoReq.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lReqTs),
                      t.writeInt64(1, this.lUid),
                      t.writeString(2, this.sGuid),
                      t.writeInt64(3, this.lAnchorUid),
                      t.writeInt32(4, this.iCdnLine),
                      t.writeString(5, this.sStreamname),
                      t.writeInt32(6, this.iBaseSubs),
                      t.writeVector(7, this.vSub),
                      t.writeInt32(8, this.iCliType),
                      t.writeInt64(9, this.lBucketPara),
                      t.writeInt32(10, this.iBusiType),
                      t.writeVector(11, this.vCliSupportPcdns),
                      t.writeString(12, this.curPcdnName)
                  }
                  ,
                  a.ClientGetPcdnP2pOutsideSdkSubstreamInfoReq.prototype.readFrom = function(t) {
                      this.lReqTs = t.readInt64(0, !1, this.lReqTs),
                      this.lUid = t.readInt64(1, !1, this.lUid),
                      this.sGuid = t.readString(2, !1, this.sGuid),
                      this.lAnchorUid = t.readInt64(3, !1, this.lAnchorUid),
                      this.iCdnLine = t.readInt32(4, !1, this.iCdnLine),
                      this.sStreamname = t.readString(5, !1, this.sStreamname),
                      this.iBaseSubs = t.readInt32(6, !1, this.iBaseSubs),
                      this.vSub = t.readVector(7, !1, this.vSub),
                      this.iCliType = t.readInt32(8, !1, this.iCliType),
                      this.lBucketPara = t.readInt64(9, !1, this.lBucketPara),
                      this.iBusiType = t.readInt32(10, !1, this.iBusiType),
                      this.vCliSupportPcdns = t.readVector(11, !1, this.vCliSupportPcdns),
                      this.curPcdnName = t.readString(12, !1, this.curPcdnName)
                  }
                  ,
                  a.ClientGetPcdnP2pOutsideSdkSubstreamInfoRsp = function() {
                      this.lReqTs = 0,
                      this.lRspTs = 0,
                      this.iErrCode = 0,
                      this.sPcdnName = "",
                      this.mP2pSubstreamUrl = new s.Map(new s.INT32,new s.STRING),
                      this.cliProv = "",
                      this.cliIsp = "",
                      this.lUid = 0,
                      this.iCdnLine = 0,
                      this.sStreamname = ""
                  }
                  ,
                  a.ClientGetPcdnP2pOutsideSdkSubstreamInfoRsp.prototype._clone = function() {
                      return new a.ClientGetPcdnP2pOutsideSdkSubstreamInfoRsp
                  }
                  ,
                  a.ClientGetPcdnP2pOutsideSdkSubstreamInfoRsp.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.ClientGetPcdnP2pOutsideSdkSubstreamInfoRsp.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.ClientGetPcdnP2pOutsideSdkSubstreamInfoRsp.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lReqTs),
                      t.writeInt64(1, this.lRspTs),
                      t.writeInt32(2, this.iErrCode),
                      t.writeString(10, this.sPcdnName),
                      t.writeMap(11, this.mP2pSubstreamUrl),
                      t.writeString(30, this.cliProv),
                      t.writeString(31, this.cliIsp),
                      t.writeInt64(100, this.lUid),
                      t.writeInt32(101, this.iCdnLine),
                      t.writeString(102, this.sStreamname)
                  }
                  ,
                  a.ClientGetPcdnP2pOutsideSdkSubstreamInfoRsp.prototype.readFrom = function(t) {
                      this.lReqTs = t.readInt64(0, !1, this.lReqTs),
                      this.lRspTs = t.readInt64(1, !1, this.lRspTs),
                      this.iErrCode = t.readInt32(2, !1, this.iErrCode),
                      this.sPcdnName = t.readString(10, !1, this.sPcdnName),
                      this.mP2pSubstreamUrl = t.readMap(11, !1, this.mP2pSubstreamUrl),
                      this.cliProv = t.readString(30, !1, this.cliProv),
                      this.cliIsp = t.readString(31, !1, this.cliIsp),
                      this.lUid = t.readInt64(100, !1, this.lUid),
                      this.iCdnLine = t.readInt32(101, !1, this.iCdnLine),
                      this.sStreamname = t.readString(102, !1, this.sStreamname)
                  }
                  ,
                  a.ClientGetPcdnFlvOutsideSdkFullstreamInfoReq = function() {
                      this.lReqTs = 0,
                      this.lUid = 0,
                      this.sGuid = "",
                      this.lAnchorUid = 0,
                      this.iCdnLine = 0,
                      this.sStreamName = "",
                      this.iRatio = 0,
                      this.sCodec = "",
                      this.iCliType = 0,
                      this.lBucketPara = 0,
                      this.iBusiType = 0,
                      this.vCliSupportPcdns = new s.Vector(new s.STRING),
                      this.curPcdnName = ""
                  }
                  ,
                  a.ClientGetPcdnFlvOutsideSdkFullstreamInfoReq.prototype._clone = function() {
                      return new a.ClientGetPcdnFlvOutsideSdkFullstreamInfoReq
                  }
                  ,
                  a.ClientGetPcdnFlvOutsideSdkFullstreamInfoReq.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.ClientGetPcdnFlvOutsideSdkFullstreamInfoReq.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.ClientGetPcdnFlvOutsideSdkFullstreamInfoReq.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lReqTs),
                      t.writeInt64(1, this.lUid),
                      t.writeString(2, this.sGuid),
                      t.writeInt64(3, this.lAnchorUid),
                      t.writeInt32(4, this.iCdnLine),
                      t.writeString(5, this.sStreamName),
                      t.writeInt32(6, this.iRatio),
                      t.writeString(7, this.sCodec),
                      t.writeInt32(8, this.iCliType),
                      t.writeInt64(9, this.lBucketPara),
                      t.writeInt32(10, this.iBusiType),
                      t.writeVector(11, this.vCliSupportPcdns),
                      t.writeString(12, this.curPcdnName)
                  }
                  ,
                  a.ClientGetPcdnFlvOutsideSdkFullstreamInfoReq.prototype.readFrom = function(t) {
                      this.lReqTs = t.readInt64(0, !1, this.lReqTs),
                      this.lUid = t.readInt64(1, !1, this.lUid),
                      this.sGuid = t.readString(2, !1, this.sGuid),
                      this.lAnchorUid = t.readInt64(3, !1, this.lAnchorUid),
                      this.iCdnLine = t.readInt32(4, !1, this.iCdnLine),
                      this.sStreamName = t.readString(5, !1, this.sStreamName),
                      this.iRatio = t.readInt32(6, !1, this.iRatio),
                      this.sCodec = t.readString(7, !1, this.sCodec),
                      this.iCliType = t.readInt32(8, !1, this.iCliType),
                      this.lBucketPara = t.readInt64(9, !1, this.lBucketPara),
                      this.iBusiType = t.readInt32(10, !1, this.iBusiType),
                      this.vCliSupportPcdns = t.readVector(11, !1, this.vCliSupportPcdns),
                      this.curPcdnName = t.readString(12, !1, this.curPcdnName)
                  }
                  ,
                  a.ClientGetPcdnFlvOutsideSdkFullstreamInfoRsp = function() {
                      this.lReqTs = 0,
                      this.lRspTs = 0,
                      this.iErrCode = 0,
                      this.sPcdnName = "",
                      this.sFlvFullstreamUrl = "",
                      this.cliProv = "",
                      this.cliIsp = "",
                      this.lUid = 0,
                      this.iCdnLine = 0,
                      this.sStreamName = "",
                      this.iRatio = 0,
                      this.sTransUid = ""
                  }
                  ,
                  a.ClientGetPcdnFlvOutsideSdkFullstreamInfoRsp.prototype._clone = function() {
                      return new a.ClientGetPcdnFlvOutsideSdkFullstreamInfoRsp
                  }
                  ,
                  a.ClientGetPcdnFlvOutsideSdkFullstreamInfoRsp.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.ClientGetPcdnFlvOutsideSdkFullstreamInfoRsp.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.ClientGetPcdnFlvOutsideSdkFullstreamInfoRsp.prototype.writeTo = function(t) {
                      t.writeInt64(0, this.lReqTs),
                      t.writeInt64(1, this.lRspTs),
                      t.writeInt32(2, this.iErrCode),
                      t.writeString(10, this.sPcdnName),
                      t.writeString(11, this.sFlvFullstreamUrl),
                      t.writeString(30, this.cliProv),
                      t.writeString(31, this.cliIsp),
                      t.writeInt64(100, this.lUid),
                      t.writeInt32(101, this.iCdnLine),
                      t.writeString(102, this.sStreamName),
                      t.writeInt32(103, this.iRatio),
                      t.writeString(104, this.sTransUid)
                  }
                  ,
                  a.ClientGetPcdnFlvOutsideSdkFullstreamInfoRsp.prototype.readFrom = function(t) {
                      this.lReqTs = t.readInt64(0, !1, this.lReqTs),
                      this.lRspTs = t.readInt64(1, !1, this.lRspTs),
                      this.iErrCode = t.readInt32(2, !1, this.iErrCode),
                      this.sPcdnName = t.readString(10, !1, this.sPcdnName),
                      this.sFlvFullstreamUrl = t.readString(11, !1, this.sFlvFullstreamUrl),
                      this.cliProv = t.readString(30, !1, this.cliProv),
                      this.cliIsp = t.readString(31, !1, this.cliIsp),
                      this.lUid = t.readInt64(100, !1, this.lUid),
                      this.iCdnLine = t.readInt32(101, !1, this.iCdnLine),
                      this.sStreamName = t.readString(102, !1, this.sStreamName),
                      this.iRatio = t.readInt32(103, !1, this.iRatio),
                      this.sTransUid = t.readString(104, !1, this.sTransUid)
                  }
                  ,
                  a.RecSysInfo = function() {
                      this.sAnchorUid = "",
                      this.sRoomId = "",
                      this.sDispatchId = "",
                      this.iScene = 0,
                      this.sStrategy = "",
                      this.lServerTs = 0,
                      this.lAction = 0,
                      this.sActionReason = "",
                      this.sActValue = ""
                  }
                  ,
                  a.RecSysInfo.prototype._clone = function() {
                      return new a.RecSysInfo
                  }
                  ,
                  a.RecSysInfo.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.RecSysInfo.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.RecSysInfo.prototype.writeTo = function(t) {
                      t.writeString(0, this.sAnchorUid),
                      t.writeString(1, this.sRoomId),
                      t.writeString(2, this.sDispatchId),
                      t.writeInt32(3, this.iScene),
                      t.writeString(4, this.sStrategy),
                      t.writeInt64(5, this.lServerTs),
                      t.writeInt64(6, this.lAction),
                      t.writeString(7, this.sActionReason),
                      t.writeString(8, this.sActValue)
                  }
                  ,
                  a.RecSysInfo.prototype.readFrom = function(t) {
                      this.sAnchorUid = t.readString(0, !1, this.sAnchorUid),
                      this.sRoomId = t.readString(1, !1, this.sRoomId),
                      this.sDispatchId = t.readString(2, !1, this.sDispatchId),
                      this.iScene = t.readInt32(3, !1, this.iScene),
                      this.sStrategy = t.readString(4, !1, this.sStrategy),
                      this.lServerTs = t.readInt64(5, !1, this.lServerTs),
                      this.lAction = t.readInt64(6, !1, this.lAction),
                      this.sActionReason = t.readString(7, !1, this.sActionReason),
                      this.sActValue = t.readString(8, !1, this.sActValue)
                  }
                  ,
                  a.RecSysReq = function() {
                      this.tId = new a.MediaUserId,
                      this.sAnchorUid = "",
                      this.sRoomId = "",
                      this.sDispatchId = "",
                      this.iScene = 0,
                      this.bDebug = 0,
                      this.sNet = "",
                      this.sSdkVer = "",
                      this.mAppendInfo = new s.Map(new s.STRING,new s.STRING)
                  }
                  ,
                  a.RecSysReq.prototype._clone = function() {
                      return new a.RecSysReq
                  }
                  ,
                  a.RecSysReq.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.RecSysReq.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.RecSysReq.prototype.writeTo = function(t) {
                      t.writeStruct(0, this.tId),
                      t.writeString(1, this.sAnchorUid),
                      t.writeString(2, this.sRoomId),
                      t.writeString(3, this.sDispatchId),
                      t.writeInt32(4, this.iScene),
                      t.writeInt32(5, this.bDebug),
                      t.writeString(6, this.sNet),
                      t.writeString(7, this.sSdkVer),
                      t.writeMap(8, this.mAppendInfo)
                  }
                  ,
                  a.RecSysReq.prototype.readFrom = function(t) {
                      this.tId = t.readStruct(0, !1, this.tId),
                      this.sAnchorUid = t.readString(1, !1, this.sAnchorUid),
                      this.sRoomId = t.readString(2, !1, this.sRoomId),
                      this.sDispatchId = t.readString(3, !1, this.sDispatchId),
                      this.iScene = t.readInt32(4, !1, this.iScene),
                      this.bDebug = t.readInt32(5, !1, this.bDebug),
                      this.sNet = t.readString(6, !1, this.sNet),
                      this.sSdkVer = t.readString(7, !1, this.sSdkVer),
                      this.mAppendInfo = t.readMap(8, !1, this.mAppendInfo)
                  }
                  ,
                  a.RecSysRsp = function() {
                      this.iStatus = 0,
                      this.sError = "",
                      this.tRecSysInfo = new a.RecSysInfo
                  }
                  ,
                  a.RecSysRsp.prototype._clone = function() {
                      return new a.RecSysRsp
                  }
                  ,
                  a.RecSysRsp.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.RecSysRsp.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.RecSysRsp.prototype.writeTo = function(t) {
                      t.writeInt32(0, this.iStatus),
                      t.writeString(1, this.sError),
                      t.writeStruct(2, this.tRecSysInfo)
                  }
                  ,
                  a.RecSysRsp.prototype.readFrom = function(t) {
                      this.iStatus = t.readInt32(0, !1, this.iStatus),
                      this.sError = t.readString(1, !1, this.sError),
                      this.tRecSysInfo = t.readStruct(2, !1, this.tRecSysInfo)
                  }
                  ,
                  a.RecSysNotice = function() {
                      this.tRecSysInfo = new a.RecSysInfo
                  }
                  ,
                  a.RecSysNotice.prototype._clone = function() {
                      return new a.RecSysNotice
                  }
                  ,
                  a.RecSysNotice.prototype._write = function(t, e, i) {
                      t.writeStruct(e, i)
                  }
                  ,
                  a.RecSysNotice.prototype._read = function(t, e, i) {
                      return t.readStruct(e, !0, i)
                  }
                  ,
                  a.RecSysNotice.prototype.writeTo = function(t) {
                      t.writeStruct(0, this.tRecSysInfo)
                  }
                  ,
                  a.RecSysNotice.prototype.readFrom = function(t) {
                      this.tRecSysInfo = t.readStruct(0, !1, this.tRecSysInfo)
                  }
              }
              , function(t, e, i) {
                  "use strict";
                  function s(t) {
                      if (void 0 === t)
                          throw new ReferenceError("this hasn't been initialised - super() hasn't been called");
                      return t
                  }
                  i.d(e, "a", (function() {
                      return s
                  }
                  ))
              }
              , function(t, e, i) {
                  "use strict";
                  i.d(e, "a", (function() {
                      return a
                  }
                  ));
                  var s = i(44);
                  function a(t) {
                      if ("undefined" == typeof Symbol || null == t[Symbol.iterator]) {
                          if (Array.isArray(t) || (t = Object(s.a)(t))) {
                              var e = 0
                                , i = function() {};
                              return {
                                  s: i,
                                  n: function() {
                                      return e >= t.length ? {
                                          done: !0
                                      } : {
                                          done: !1,
                                          value: t[e++]
                                      }
                                  },
                                  e: function(t) {
                                      throw t
                                  },
                                  f: i
                              }
                          }
                          throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                      }
                      var a, r, n = !0, o = !1;
                      return {
                          s: function() {
                              a = t[Symbol.iterator]()
                          },
                          n: function() {
                              var t = a.next();
                              return n = t.done,
                              t
                          },
                          e: function(t) {
                              o = !0,
                              r = t
                          },
                          f: function() {
                              try {
                                  n || null == a.return || a.return()
                              } finally {
                                  if (o)
                                      throw r
                              }
                          }
                      }
                  }
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(14)
                    , n = i(13)
                    , o = i(25)
                    , h = i(6)
                    , u = i(0)
                    , l = i(15)
                    , c = i(19)
                    , d = i(31)
                    , p = !!Number(localStorage._printProtocol)
                    , f = !!Number(localStorage._printGateway)
                    , _ = function(t) {
                      Object(r.a)(o, t);
                      var e = Object(n.a)(o);
                      function o() {
                          var t;
                          return Object(s.a)(this, o),
                          (t = e.call(this)).WEBSOCKET_CONNECTED = "WEBSOCKET_CONNECTED",
                          t.WEBSOCKET_CLOSED = "WEBSOCKET_CLOSED",
                          t.WEBSOCKET_ERROR = "WEBSOCKET_ERROR",
                          t.TAFLINK_INITED = "TAFLINK_INITED",
                          t._taf = null,
                          t.delayWup = [],
                          t.delayListener = [],
                          t.streamName = null,
                          t.requestId = 1,
                          t
                      }
                      return Object(a.a)(o, [{
                          key: "getRequestId",
                          value: function() {
                              return this.requestId++,
                              1e5 === this.requestId && (this.requestId = 1),
                              this.requestId
                          }
                      }, {
                          key: "getTaf",
                          value: function() {
                              return this._taf
                          }
                      }, {
                          key: "setTafHandler",
                          value: function(t) {
                              var e = h.a.now();
                              u.a.log("%c[TIME] initTafTime=" + e, "color:#A23400;background:#FFF5C2"),
                              t.getTaf && l.default.setTaf(t.getTaf()),
                              t.registerUriMap(v.UriMapping),
                              t.registerWupMap(v.WupMapping),
                              this._taf = t,
                              this._taf.connected ? this._onConnected() : this._taf.addListener(this.WEBSOCKET_CONNECTED, this._onConnected.bind(this)),
                              this.emit(this.TAFLINK_INITED)
                          }
                      }, {
                          key: "_onConnected",
                          value: function() {
                              u.a.log("TafLink._onConnected sendWup size=".concat(this.delayWup.length));
                              var t = this;
                              this.delayWup.forEach((function(e) {
                                  var i = e.servantName
                                    , s = e.funcName
                                    , a = e.data
                                    , r = e.callback
                                    , n = e.once
                                    , o = e.iRequestId
                                    , h = e.noTid;
                                  t.sendWup(i, s, a, r, n, o, h)
                              }
                              )),
                              this.delayWup = [],
                              this.delayListener.forEach((function(e) {
                                  var i = e.p0
                                    , s = e.p1
                                    , a = e.p2;
                                  switch (i) {
                                  case "add":
                                      t.addListener(s, a);
                                      break;
                                  case "remove":
                                      t.removeListener(s, a);
                                      break;
                                  case "dispatch":
                                      t.dispatch(s, a)
                                  }
                              }
                              )),
                              this.delayListener = []
                          }
                      }, {
                          key: "getUserId",
                          value: function() {
                              return this._taf.getUserId()
                          }
                      }, {
                          key: "sendWup",
                          value: function(t, e, i) {
                              var s = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : null
                                , a = !(arguments.length > 4 && void 0 !== arguments[4]) || arguments[4]
                                , r = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : -1
                                , n = arguments.length > 6 && void 0 !== arguments[6] && arguments[6];
                              if (!this.connected)
                                  return u.a.log("TafLink.sendWup connected=false", t, e),
                                  void this.delayWup.push({
                                      servantName: t,
                                      funcName: e,
                                      data: i,
                                      callback: s,
                                      once: a,
                                      iRequestId: r,
                                      noTid: n
                                  });
                              this._taf.sendWup2 ? this._taf.sendWup2(t, e, i, s, a, r, n) : this._taf.sendWup(t, e, i, s, a, r, n)
                          }
                      }, {
                          key: "sendYY",
                          value: function(t, e) {
                              var s = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0
                                , a = !(arguments.length > 3 && void 0 !== arguments[3]) || arguments[3]
                                , r = !(arguments.length > 4 && void 0 !== arguments[4]) || arguments[4];
                              if (this._taf) {
                                  var n = t.constructor.name
                                    , o = c.a[n];
                                  o || "function" != typeof t.marshall || (o = new DataView(t.marshall().buffer).getUint32(4, !0)),
                                  p && u.a.log("%c>>>>>>> " + n, m("#009100"), "uri=" + o, t);
                                  var h = null
                                    , _ = "mediaui"
                                    , v = "getInfoFromVGM";
                                  if ("function" == typeof this._taf.packVGInfo)
                                      h = this._taf.packVGInfo(o, t, this.streamName);
                                  else {
                                      var y = this._taf.getTaf().BinBuffer;
                                      _ = "videogateway",
                                      v = r ? "getInfoFromCdnVG" : "getInfoFromVG",
                                      (h = new l.default.GetInfoFromVGReq).lUid = s || 0,
                                      h.sMsg = new y(t.marshall().buffer),
                                      h.sProtoName = "yy",
                                      h.iUri = o || 0,
                                      h.lSid = 0,
                                      h.tId = this.getUserId()
                                  }
                                  this.sendWup(_, v, h, function(s) {
                                      if (0 != s.sMsg.len) {
                                          if (!s.lUid || !h.lUid || s.lUid == h.lUid) {
                                              var a = new DataView(s.sMsg.buffer)
                                                , o = new d.a(a);
                                              if (!(n = c.a[o.uri]))
                                                  throw f || u.a.log("%c<<<<<<< %crspWup:%c GetInfoFromVG", m("#0000E3"), m("black"), m("#0000E3"), "videogateway", s),
                                                  new Error("[x] Unmatched protocol, uri=".concat(o.uri >> 8, " resCode=").concat(o.resCode, " len=").concat(o.len));
                                              var l = o
                                                , _ = null;
                                              try {
                                                  _ = r ? i(47)("./" + n).default : i(65)("./" + n).default
                                              } catch (t) {
                                                  u.a.warn("[x] Unmatched protocol", o.uri >> 8, n)
                                              }
                                              _ && (l = new _).unmarshall(o),
                                              p && u.a.log("%c<<<<<<< " + n, m("#0000E3"), l),
                                              "function" == typeof e ? e(l) : this.dispatch(o.uri, l)
                                          }
                                      } else
                                          u.a.warn("GetInfoFromVG response an empty pkg.", t, h, s)
                                  }
                                  .bind(this), a)
                              } else
                                  u.a.warn("TafLink.sendYY taf not init!")
                          }
                      }, {
                          key: "addListener",
                          value: function(t, e) {
                              this.connected ? this._taf.addListener(t, e) : this.delayListener.push({
                                  p0: "add",
                                  p1: t,
                                  p2: e
                              })
                          }
                      }, {
                          key: "removeListener",
                          value: function(t, e) {
                              this.connected ? this._taf.removeListener(t, e) : this.delayListener.push({
                                  p0: "remove",
                                  p1: t,
                                  p2: e
                              })
                          }
                      }, {
                          key: "dispatch",
                          value: function(t, e) {
                              this.connected ? this._taf.dispatch(t, e) : this.delayListener.push({
                                  p0: "dispatch",
                                  p1: t,
                                  p2: e
                              })
                          }
                      }, {
                          key: "inited",
                          get: function() {
                              return !!this._taf
                          }
                      }, {
                          key: "connected",
                          get: function() {
                              return this._taf && this._taf.connected
                          }
                      }]),
                      o
                  }(o.EventEmitter);
                  function m(t, e, i) {
                      var s = "font-weight:900";
                      return t && (s += ";color:" + t),
                      e && (s += ";background:" + e),
                      i && (s += ";border:3px solid " + i),
                      s
                  }
                  var v = {
                      UriMapping: {
                          8102: l.default.LivingStreamInfoNotice,
                          8103: l.default.LivingStreamEndNotice,
                          1025601: l.default.LiveMeetingSyncNotice
                      },
                      WupMapping: {
                          getInfoFromVG: l.default.GetInfoFromVGRsp,
                          GetInfoFromVG: l.default.GetInfoFromVGRsp,
                          getInfoFromCdnVG: l.default.GetInfoFromVGRsp,
                          getCdnTokenInfoEx: l.default.GetCdnTokenExRsp,
                          getLivingStreamInfo: l.default.GetLivingStreamInfoRsp,
                          getP2PStreamInfo: l.default.GetP2PStreamInfoRsp,
                          getP2PStreamTokenInfoEx: l.default.GetP2PStreamTokenExRsp,
                          queryHttpDns: l.default.QueryHttpDnsRsp,
                          loginVerify: l.default.LoginVerifyRsp,
                          joinGroup: l.default.JoinMediaGroupRsp,
                          quitGroup: l.default.QuitMediaGroupRsp,
                          wsTimeSync: l.default.WSTimeSyncRsp,
                          onClientGetStunAndPcdnProxyReq: l.default.ClientGetStunAndPcdnProxyRsp,
                          clientQueryPcdnSchedule: l.default.ClientQueryPcdnScheduleRsp,
                          onClientGetPcdnFlvOutsideSdkFullstreamInfo: l.default.ClientGetPcdnFlvOutsideSdkFullstreamInfoRsp,
                          getMediaRec: l.default.RecSysRsp
                      },
                      NoLog: {
                          8102: 1,
                          8103: 1,
                          1025601: 1,
                          getInfoFromVG: 1,
                          GetInfoFromVG: 1,
                          getInfoFromCdnVG: 1,
                          getInfoFromVGM: 1,
                          getCdnTokenInfoEx: 1,
                          videoClientReport: 1
                      }
                  }
                    , y = new _;
                  e.default = y
              }
              , function(t, e, i) {
                  "use strict";
                  var s = {
                      PAudienceGetProxyListReq: 530178,
                      PAudienceGetProxyListRsp: 530434,
                      PNotifyStreamSwitch: 268034,
                      PLoginVideoProxyUniformly: 5650690,
                      PLoginVideoProxyUniformlyRes: 5650434,
                      PNotifyCurrentCdnStream: 2739202,
                      PNotifyCurrentStream4: 2675714,
                      PSubscribeStream3: 2667266,
                      PSubscribeStreamRes3: 2667522,
                      PStreamData3: 2666754,
                      PStopStream3: 2666498,
                      PStopStream: 2560514,
                      PPullStreamData: 2694146,
                      PResendStreamData4: 2689026,
                      PResendStreamDataFailAck: 2694402,
                      PVideoSyncSpeakerTime3: 2674690,
                      PForceConnectVideoProxy3: 2685442,
                      PVideoProxyPing3: 2669570,
                      PVideoProxyPingRes4: 2683650,
                      PNotifyMultiVideo: 2746370,
                      PLoginAndSubscribe: 4097282,
                      PLoginAndSubscribeRes: 4097538,
                      PNotifyUplinkRecvCount3: 2672642,
                      PVideoBroadcast4: 2754050,
                      PUpdateVideoConfig2: 2569474,
                      PVideoQualityStatistics: 2591746,
                      PP2pPing2: 40706,
                      PP2pPing3: 41218,
                      PP2pVideoPing3: 2671874,
                      VIDEOP2P_PFlashP2PKeepAlive: 3072514,
                      VIDEOP2P_PFlashP2PKeepAliveRes: 3072770,
                      P2PGetNodesProxy3: 2673410,
                      P2PGetNodesProxyRes3: 2673666,
                      P2PSubscribeStream3: 2673922,
                      P2PRemoveSubscribe3: 2674178,
                      P2PKeepAlive: 3074562,
                      P2PKeepAliveRes: 3074818,
                      P2PNotifyNodeLeave: 3075074,
                      P2PSyncDepth: 3075330,
                      P2PKeepAliveWebrtc: 3075842,
                      P2PKeepAliveWebrtcRes: 3076098,
                      PP2PWSForward: 2757378,
                      PP2PWSForwardReject: 5653506,
                      P2PSubStream: 3073026,
                      P2PSubStreamRes: 3073282,
                      P2PSyncSubTree: 3073538,
                      P2PTest: 3073794,
                      P2PRemoveSub: 3074306,
                      P2PRemoveSubRes: 3075586,
                      P2PStreamAlive: 3076354,
                      P2POffer: 12316162,
                      P2PAnswer: 12316418,
                      P2PCandidate: 12316674,
                      P2POfferReject: 12316930,
                      P2PRequestOffer: 12317186,
                      P2PVersionFailed: 12317442,
                      P2PPingOverProxy: 12317698,
                      P2PPunchBackReq: 12317954,
                      P2PPunchBackRsp: 12318210,
                      PCDNNotifyUrl: 20740866,
                      PCDNStatusReport: 20741122,
                      PCDNGetUrl: 20741378,
                      PCDNSwitchUrl: 20741634,
                      PCdnP2PWSForward: 53283,
                      PCdnP2PWSForwardReject: 53539,
                      PCdnProxyPing: 26147,
                      PCdnProxyPingRes: 26403,
                      PCdnP2PStatics: 26659,
                      PCdnP2PErrStatics: 26915,
                      PCdnP2pGetNode: 51235,
                      PCdnP2pGetNodeRes: 51491,
                      PCdnP2PNodePingThroughProxy: 52259,
                      PCdnP2PNodePunchThroughProxy: 52515,
                      PCdnP2PUserRegister: 52771,
                      PCdnP2PUserRegisterRes: 53027,
                      PCdnP2pReportLog: 54051,
                      PCdnForceConnectVideoProxy: 54563,
                      PCDNGetProxyListReq: 153635,
                      PCDNGetProxyListRsp: 153891,
                      PCDNGetSliceStreamInfoReq: 154147,
                      PCDNGetSliceStreamInfoRsp: 154403,
                      PCDNSubscribeReq: 768547,
                      PCDNSubscribeRes: 768803,
                      PCDNCompeteSubscribeReq: 769059,
                      PCDNCompeteSubscribeRes: 769315,
                      PCDNForceSubscribeNotify: 769571,
                      PCdnP2pUserUnRegister: 770083,
                      PP2pSliceData: 511779,
                      PP2pSliceAudioData: 512035,
                      PP2pSliceVideoData: 512291,
                      PP2pSliceCommonData: 514083,
                      PP2pSliceSignalData: 514595,
                      PP2pSliceControlData: 1024547,
                      PForceConnectCdnVideoProxy3: 2711042,
                      HuyaDelaySeiData: 17920770
                  };
                  !function t() {
                      if (!t.done) {
                          t.done = !0;
                          var e = [];
                          for (var i in s) {
                              var a = s[i];
                              e.push({
                                  uri: a,
                                  name: i
                              })
                          }
                          e.forEach((function(t) {
                              s[t.uri] = t.name
                          }
                          ))
                      }
                  }(),
                  e.a = s
              }
              , function(t, e, i) {
                  "use strict";
                  var s = i(2)
                    , a = i(3)
                    , r = function() {
                      function t() {
                          var e = !(arguments.length > 0 && void 0 !== arguments[0]) || arguments[0];
                          Object(s.a)(this, t),
                          this.hasHeader = e,
                          this.segments = [],
                          this.data = null,
                          this.totalLen = 0,
                          this.uri = 0,
                          this.hasHeader && (this.pushUInt32(10),
                          this.pushUInt32(this.uri),
                          this.pushUInt16(200))
                      }
                      return Object(a.a)(t, [{
                          key: "marshall",
                          value: function() {
                              if (0 === this.segments.length)
                                  return null;
                              this.data = new Uint8Array(this.totalLen);
                              for (var t = 0, e = 0; e < this.segments.length; ++e) {
                                  var i = this.segments[e];
                                  this.data.set(i, t),
                                  t += i.length
                              }
                              return this.hasHeader && (this.replaceUInt32(0, this.totalLen),
                              this.replaceUInt32(4, this.uri)),
                              this.data
                          }
                      }, {
                          key: "setUri",
                          value: function(t) {
                              this.uri = t
                          }
                      }, {
                          key: "replaceUInt32",
                          value: function(t, e) {
                              new DataView(this.data.buffer).setUint32(t, e, !0)
                          }
                      }, {
                          key: "pushBool",
                          value: function(t) {
                              this.pushUInt8(t ? 1 : 0)
                          }
                      }, {
                          key: "pushUInt8",
                          value: function(t) {
                              var e = new Uint8Array(1);
                              new DataView(e.buffer).setUint8(0, t),
                              this.segments.push(e),
                              this.totalLen++
                          }
                      }, {
                          key: "pushUInt16",
                          value: function(t) {
                              var e = new Uint8Array(2);
                              new DataView(e.buffer).setUint16(0, t, !0),
                              this.segments.push(e),
                              this.totalLen += 2
                          }
                      }, {
                          key: "pushUInt32",
                          value: function(t) {
                              var e = new Uint8Array(4);
                              new DataView(e.buffer).setUint32(0, t, !0),
                              this.segments.push(e),
                              this.totalLen += 4
                          }
                      }, {
                          key: "pushUInt64",
                          value: function(t) {
                              var e = new Uint8Array(8)
                                , i = new DataView(e.buffer)
                                , s = t % 4294967296
                                , a = t / 4294967296 >> 0;
                              i.setUint32(0, s, !0),
                              i.setUint32(4, a, !0),
                              this.segments.push(e),
                              this.totalLen += 8
                          }
                      }, {
                          key: "pushUint8Array",
                          value: function(t) {
                              this.pushUInt16(t.length),
                              this.segments.push(t),
                              this.totalLen += t.length
                          }
                      }, {
                          key: "pushUint8ArrayWithoutLen",
                          value: function(t) {
                              this.segments.push(t),
                              this.totalLen += t.length
                          }
                      }, {
                          key: "pushUint8Array32",
                          value: function(t) {
                              this.pushUInt32(t.length),
                              this.segments.push(t),
                              this.totalLen += t.length
                          }
                      }, {
                          key: "pushUInt32Vector",
                          value: function(t) {
                              this.pushUInt32(t.length);
                              for (var e = 0; e < t.length; e++)
                                  this.pushUInt32(t[e])
                          }
                      }, {
                          key: "pushUInt64Vector",
                          value: function(t) {
                              this.pushUInt32(t.length);
                              for (var e = 0; e < t.length; e++)
                                  this.pushUInt64(t[e])
                          }
                      }, {
                          key: "pushUInt16Vector",
                          value: function(t) {
                              this.pushUInt32(t.length);
                              for (var e = 0; e < t.length; e++)
                                  this.pushUInt16(t[e])
                          }
                      }, {
                          key: "popObjVector",
                          value: function(t) {
                              for (var e = this.popUInt32(), i = [], s = 0; s < e; s++) {
                                  var a = new t;
                                  i.push(a.unmarshall(this))
                              }
                              return i
                          }
                      }, {
                          key: "pushString",
                          value: function(t) {
                              this.pushUInt16(t.length);
                              for (var e = new Uint8Array(t.length), i = new DataView(e.buffer), s = 0; s < t.length; ++s)
                                  i.setUint8(s, t.charCodeAt(s));
                              this.segments.push(e),
                              this.totalLen += t.length
                          }
                      }, {
                          key: "pushString32",
                          value: function(t) {
                              this.pushUInt32(t.length);
                              for (var e = new Uint8Array(t.length), i = new DataView(e.buffer), s = 0; s < t.length; ++s)
                                  i.setUint8(s, t.charCodeAt(s));
                              this.segments.push(e),
                              this.totalLen += t.length
                          }
                      }]),
                      t
                  }();
                  e.a = r
              }
              , function(t, e, i) {
                  "use strict";
                  e.a = {
                      NO_DATA: 1,
                      NO_DECODE: 2,
                      WORKER_ERROR: 3,
                      DECODE_ERROR: 4,
                      RENDER_ERROR: 5,
                      NO_RENDER: 6,
                      RECEIVE_LIST_OUT_LIMIT: 7,
                      YUV_OUT_LIMIT: 8,
                      WASM_TIMEOUT: 9,
                      CREATE_WEBGL_FAIL: 10,
                      CREATE_WORKER_ERROR: 11,
                      AUDIO_FAST: 12,
                      VIDEO_FAST: 13,
                      START_CODE_ERROR: 14,
                      dic: {
                          1: "20s无数据",
                          2: "10s无解码",
                          3: "worker异常",
                          4: "解码失败",
                          5: "渲染失败",
                          6: "10s无渲染",
                          7: "解码前队列大于2000",
                          8: "yuv队列大于300",
                          9: "wasm timeout",
                          10: "创建webgl失败",
                          11: "web worker异常",
                          12: "音频快，视频慢，切264",
                          13: "音频慢，视频快，切264",
                          14: "hevcFindNextStartCode failed"
                      }
                  }
              }
              , function(t, e, i) {
                  t.exports = function(t) {
                      var e = {};
                      function i(s) {
                          if (e[s])
                              return e[s].exports;
                          var a = e[s] = {
                              i: s,
                              l: !1,
                              exports: {}
                          };
                          return t[s].call(a.exports, a, a.exports, i),
                          a.l = !0,
                          a.exports
                      }
                      return i.m = t,
                      i.c = e,
                      i.d = function(t, e, s) {
                          i.o(t, e) || Object.defineProperty(t, e, {
                              enumerable: !0,
                              get: s
                          })
                      }
                      ,
                      i.r = function(t) {
                          "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(t, Symbol.toStringTag, {
                              value: "Module"
                          }),
                          Object.defineProperty(t, "__esModule", {
                              value: !0
                          })
                      }
                      ,
                      i.t = function(t, e) {
                          if (1 & e && (t = i(t)),
                          8 & e)
                              return t;
                          if (4 & e && "object" == n(t) && t && t.__esModule)
                              return t;
                          var s = Object.create(null);
                          if (i.r(s),
                          Object.defineProperty(s, "default", {
                              enumerable: !0,
                              value: t
                          }),
                          2 & e && "string" != typeof t)
                              for (var a in t)
                                  i.d(s, a, function(e) {
                                      return t[e]
                                  }
                                  .bind(null, a));
                          return s
                      }
                      ,
                      i.n = function(t) {
                          var e = t && t.__esModule ? function() {
                              return t.default
                          }
                          : function() {
                              return t
                          }
                          ;
                          return i.d(e, "a", e),
                          e
                      }
                      ,
                      i.o = function(t, e) {
                          return Object.prototype.hasOwnProperty.call(t, e)
                      }
                      ,
                      i.p = "",
                      i(i.s = 0)
                  }([function(t, e, i) {
                      "use strict";
                      function s(t, e) {
                          if (!(t instanceof e))
                              throw new TypeError("Cannot call a class as a function")
                      }
                      function a(t, e) {
                          for (var i = 0; i < e.length; i++) {
                              var s = e[i];
                              s.enumerable = s.enumerable || !1,
                              s.configurable = !0,
                              "value"in s && (s.writable = !0),
                              Object.defineProperty(t, s.key, s)
                          }
                      }
                      function r(t, e, i) {
                          return e && a(t.prototype, e),
                          i && a(t, i),
                          t
                      }
                      function o(t, e) {
                          (null == e || e > t.length) && (e = t.length);
                          for (var i = 0, s = new Array(e); i < e; i++)
                              s[i] = t[i];
                          return s
                      }
                      function h(t, e) {
                          var i = t.toString().length
                            , s = Math.max(0, e - i)
                            , a = "";
                          if (s > 0)
                              for (var r = 0; r < s; r++)
                                  a += "0";
                          return a + t
                      }
                      i.r(e);
                      var u = [];
                      function l() {
                          for (var t, e = function() {
                              var t = new Date
                                , e = t.getFullYear()
                                , i = h(t.getMonth() + 1, 2)
                                , s = h(t.getDate(), 2)
                                , a = h(t.getHours(), 2)
                                , r = h(t.getMinutes(), 2)
                                , n = h(t.getSeconds(), 2);
                              return "[" + "".concat(e, "-").concat(i, "-").concat(s, " ").concat(a, ":").concat(r, ":").concat(n) + "." + h(t.getMilliseconds(), 3) + "][w265]"
                          }(), i = arguments.length, s = new Array(i), a = 0; a < i; a++)
                              s[a] = arguments[a];
                          s[0] = e + s[0],
                          self.logCallback ? (t = self.logCallback).call.apply(t, [null].concat(s)) : u.push(s)
                      }
                      var c = function() {
                          function t(e, i) {
                              s(this, t),
                              this.width = e,
                              this.height = i,
                              this.stridey = this.width,
                              this.strideu = this.stridey / 2,
                              this.stridev = this.stridey / 2
                          }
                          return r(t, [{
                              key: "calc",
                              value: function(t) {
                                  for (var e = new Uint8Array(this.stridey * this.height).fill(128, 0, this.stridey * this.height), i = new Uint8Array(this.strideu * this.height).fill(128, 0, this.strideu * this.height), s = new Uint8Array(this.stridev * this.height).fill(128, 0, this.stridev * this.height), a = new Uint8Array(this.width * this.height * 4), r = 1e3 * window.performance.now(), n = 0; n < t; n++)
                                      this.convertYUV420(e, i, s, this.width, this.height, this.stridey, this.strideu, this.stridev, a);
                                  return 1e3 * window.performance.now() - r
                              }
                          }, {
                              key: "convertYUV420",
                              value: function(t, e, i, s, a, r, n, o, h) {
                                  for (var u, l, c, d, p, f = 0, _ = 0, m = s >> 1, v = m * a, y = 0, T = 0, g = 0, S = 0; S < v; S++)
                                      p = S << 1,
                                      u = 1.164 * (t[y + (d = f << 1)] - 16),
                                      l = e[T + f] - 128,
                                      c = i[g + f] - 128,
                                      h[0 + (p << 2)] = u + 1.596 * c,
                                      h[1 + (p << 2)] = u - .813 * c - .391 * l,
                                      h[2 + (p << 2)] = u + 2.018 * l,
                                      h[3 + (p << 2)] = 255,
                                      u = 1.164 * (t[y + d + 1] - 16),
                                      h[0 + (p + 1 << 2)] = u + 1.596 * c,
                                      h[1 + (p + 1 << 2)] = u - .813 * c - .391 * l,
                                      h[2 + (p + 1 << 2)] = u + 2.018 * l,
                                      h[3 + (p + 1 << 2)] = 255,
                                      ++f === m && (f = 0,
                                      y += r,
                                      T = (++_ >> 1) * n,
                                      g = (_ >> 1) * o)
                              }
                          }]),
                          t
                      }()
                        , d = function() {
                          function t() {
                              s(this, t)
                          }
                          return r(t, null, [{
                              key: "isSupportWasm",
                              value: function() {
                                  return "object" == ("undefined" == typeof WebAssembly ? "undefined" : n(WebAssembly))
                              }
                          }, {
                              key: "isSupportWasmThread",
                              value: function() {
                                  if ("undefined" == typeof SharedArrayBuffer || "undefined" == typeof Atomics)
                                      return l("hevcd", "SharedArrayBuffer undefined or Atomics undefined"),
                                      !1;
                                  var t = new WebAssembly.Memory({
                                      initial: 1,
                                      maximum: 1,
                                      shared: !0
                                  }).buffer instanceof SharedArrayBuffer;
                                  return self.SharedArrayBuffer && self.Atomics && t
                              }
                          }]),
                          t
                      }()
                        , p = function() {
                          function t() {
                              s(this, t),
                              this.cla = "hevcd",
                              this.configs = null,
                              this.costUs = 0,
                              this.reason = 0,
                              this.cores = navigator.hardwareConcurrency,
                              this.is64bit = this.is64bitSoftware(),
                              this.enableCost = !0
                          }
                          return r(t, [{
                              key: "parseConfigs",
                              value: function(t) {
                                  this.configs = t,
                                  l(this.cla, "parse", JSON.stringify(t), "cfg", this.configs.enableWebH265)
                              }
                          }, {
                              key: "isSupportH265",
                              value: function(t, e) {
                                  if (null == this.configs)
                                      return l(this.cla, "isSupportH265 configs==null"),
                                      !1;
                                  this.reason = 0;
                                  var i = this.isConfigEnable() && this.isCPUCoresSatisfy(e) && this.isWasm() && this.isBitrateInRange(e) && this.isCostInRange(e);
                                  return l(this.cla, "isSupportH265", i, "kbps=", e, "costUs", this.costUs.toFixed(0), "cores", this.cores, "64b", this.is64bit, "reason", this.reason, "version", t, "cfg", JSON.stringify(this.configs)),
                                  l("ua:", navigator.userAgent),
                                  {
                                      isSupport: i,
                                      costUs: this.costUs.toFixed(0),
                                      reason: this.reason
                                  }
                              }
                          }, {
                              key: "isWasm",
                              value: function() {
                                  return !!d.isSupportWasm() || (this.reason = 7,
                                  !1)
                              }
                          }, {
                              key: "isConfigEnable",
                              value: function() {
                                  return !(!this.hasOwnProperty("enableWebH265") || 1 != this.configs.enableWebH265 && (this.reason = 1,
                                  1))
                              }
                          }, {
                              key: "isCPUCoresSatisfy",
                              value: function(t) {
                                  if (this.hasOwnProperty("core")) {
                                      var e = this.configs.core[4e3];
                                      if (this.configs.core.hasOwnProperty(t) && (e = this.configs.core[t]),
                                      this.cores > e)
                                          return !0
                                  } else if (this.cores > 4)
                                      return !0;
                                  return this.reason = 2,
                                  !1
                              }
                          }, {
                              key: "is64bitSoftware",
                              value: function() {
                                  return -1 != navigator.userAgent.indexOf("Macintosh") || -1 != navigator.userAgent.indexOf("x64")
                              }
                          }, {
                              key: "isBitrateInRange",
                              value: function(t) {
                                  return d.isSupportWasmThread() ? !(!this.hasOwnProperty("multiThreadBitKbps") || ((t >= 4e3 || 0 == t) && !this.checkX86(t) ? (this.reason = 4,
                                  1) : (!Array.isArray(this.configs.multiThreadBitKbps) || !this.configs.multiThreadBitKbps.includes(t)) && (this.reason = 3,
                                  1))) : (this.reason = 6,
                                  !1)
                              }
                          }, {
                              key: "checkX86",
                              value: function(t) {
                                  if (this.is64bit)
                                      return !0;
                                  if (!this.hasOwnProperty("x86"))
                                      return !1;
                                  var e = !1;
                                  return this.configs.x86.hasOwnProperty(t) && (e = 1 == this.configs.x86[t]),
                                  e
                              }
                          }, {
                              key: "isCostInRange",
                              value: function(t) {
                                  if (!this.enableCost)
                                      return !0;
                                  if (!this.hasOwnProperty("baseCostUs"))
                                      return !1;
                                  var e = this.configs.baseCostUs[2e3];
                                  return this.configs.baseCostUs.hasOwnProperty(t) && (e = this.configs.baseCostUs[t]),
                                  this.costUs = this.getCost(),
                                  this.costUs <= e || (this.reason = 5,
                                  !1)
                              }
                          }, {
                              key: "getCost",
                              value: function() {
                                  var t = this;
                                  if (!this.hasOwnProperty("loopCount"))
                                      return l(this.cla, "getCost configs==null or has no key=loopCount"),
                                      0;
                                  var e = 0;
                                  return localStorage.hasOwnProperty("w265LastCost") && (e = Number(localStorage.w265LastCost)),
                                  this.sid && clearTimeout(this.sid),
                                  this.sid = setTimeout((function() {
                                      var e = new c(120,120);
                                      localStorage.w265LastCost = Math.floor(e.calc(t.configs.loopCount))
                                  }
                                  ), 5e3),
                                  e
                              }
                          }, {
                              key: "hasOwnProperty",
                              value: function(t) {
                                  return !!this.configs.hasOwnProperty(t) || (this.reason = 1,
                                  !1)
                              }
                          }]),
                          t
                      }()
                        , f = function() {
                          function t() {
                              s(this, t),
                              this.configMgr = new p
                          }
                          return r(t, [{
                              key: "parseConfigs",
                              value: function(t) {
                                  this.configMgr.parseConfigs(t)
                              }
                          }, {
                              key: "isSupportH265",
                              value: function(t) {
                                  return this.configMgr.isSupportH265(this.version(), t)
                              }
                          }, {
                              key: "version",
                              value: function() {
                                  return "1.5.2"
                              }
                          }, {
                              key: "setLogCallback",
                              value: function(t) {
                                  var e;
                                  e = t,
                                  self.logCallback = e,
                                  l("Logger setLogCallback"),
                                  u.length > 0 && (u.forEach((function(t) {
                                      var e;
                                      (e = self.logCallback).call.apply(e, [null].concat(function(t) {
                                          return function(t) {
                                              if (Array.isArray(t))
                                                  return o(t)
                                          }(t) || function(t) {
                                              if ("undefined" != typeof Symbol && Symbol.iterator in Object(t))
                                                  return Array.from(t)
                                          }(t) || function(t, e) {
                                              if (t) {
                                                  if ("string" == typeof t)
                                                      return o(t, e);
                                                  var i = Object.prototype.toString.call(t).slice(8, -1);
                                                  return "Object" === i && t.constructor && (i = t.constructor.name),
                                                  "Map" === i || "Set" === i ? Array.from(i) : "Arguments" === i || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i) ? o(t, e) : void 0
                                              }
                                          }(t) || function() {
                                              throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                                          }()
                                      }(t)))
                                  }
                                  )),
                                  u.length = 0)
                              }
                          }, {
                              key: "isStripe",
                              value: function() {
                                  return -1 !== navigator.userAgent.indexOf("Windows")
                              }
                          }], [{
                              key: "getInstance",
                              value: function() {
                                  return this.instance || (this.instance = new t),
                                  this.instance
                              }
                          }]),
                          t
                      }();
                      e.default = f
                  }
                  ]).default
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e),
                  e.default = {
                      STREAM_UNKNOWN: 0,
                      AUDIO_SPEEX: 0,
                      AUDIO_AACPLUS: 1,
                      AUDIO_SILK: 2,
                      AUDIO_AAC_44100HZ_STEREO_128KBPS: 35,
                      AUDIO_AAC_44100HZ_STEREO_160KBPS: 36,
                      AUDIO_AAC_44100HZ_STEREO_192KBPS: 37,
                      AUDIO_ELD_AAC_44100HZ_STEREO: 38,
                      AUDIO_ELD_AAC_SBR_44100HZ_STEREO: 39,
                      SIGNAL_STREAM_DATA: 47,
                      SIGNAL_STREAM_COMPRESS_DATA: 48,
                      AUDIO_MP3: 50,
                      AUDIO_NELLYMOSER: 54,
                      VIDEO_264_START: 401,
                      VIDEO_H264_100K: 401,
                      VIDEO_H264_500K: 405,
                      VIDEO_H264_800K: 408,
                      VIDEO_H264_1200K: 412,
                      VIDEO_H264_1500K: 415,
                      VIDEO_H264_2000K: 420,
                      VIDEO_H264_3000K: 430,
                      VIDEO_H264_4000K: 440,
                      VIDEO_H264_6000K: 460,
                      VIDEO_H264_8000K: 480,
                      VIDEO_H264_END: 480,
                      VIDEO_265_START: 503,
                      VIDEO_H265_300K: 503,
                      VIDEO_H265_500K: 505,
                      VIDEO_H265_800K: 508,
                      VIDEO_H265_1200K: 512,
                      VIDEO_H265_1500K: 515,
                      VIDEO_H265_2000K: 520,
                      VIDEO_H265_3000K: 530,
                      VIDEO_H265_4000K: 540,
                      VIDEO_H265_6000K: 560,
                      VIDEO_H265_8000K: 580,
                      VIDEO_H265_END: 580,
                      VIDEO_H264_EX_BASE: 1e3,
                      VIDEO_H264_EX_START: 1005,
                      VIDEO_H264_EX_500K: 1005,
                      VIDEO_H264_EX_1M: 1010,
                      VIDEO_H264_EX_5M: 1050,
                      VIDEO_H264_EX_8M: 1080,
                      VIDEO_H264_EX_10M: 1100,
                      VIDEO_H264_EX_12M: 1120,
                      VIDEO_H264_EX_15M: 1150,
                      VIDEO_H264_EX_20M: 1200,
                      VIDEO_H264_EX_END: 1200,
                      VIDEO_H265_EX_BASE: 4e3,
                      VIDEO_H265_EX_START: 4005,
                      VIDEO_H265_EX_500K: 4005,
                      VIDEO_H265_EX_1M: 4010,
                      VIDEO_H265_EX_5M: 4050,
                      VIDEO_H265_EX_8M: 4080,
                      VIDEO_H265_EX_10M: 4100,
                      VIDEO_H265_EX_12M: 4120,
                      VIDEO_H265_EX_15M: 4150,
                      VIDEO_H265_EX_20M: 4200,
                      VIDEO_H265_EX_END: 4200
                  }
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(23)
                    , n = i(20)
                    , o = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.streamName = "",
                          this.codecType = 0,
                          this.cdnBrand = 0
                      }
                      return Object(a.a)(t, [{
                          key: "marshall",
                          value: function() {
                              var t = new n.a(!1);
                              return t.pushString(this.streamName),
                              t.pushUInt16(this.codecType),
                              t.pushUInt16(this.cdnBrand),
                              t.marshall()
                          }
                      }, {
                          key: "unmarshall",
                          value: function(t) {
                              return this.streamName = t.popString(),
                              this.codecType = t.popUInt16(),
                              this.cdnBrand = t.popUInt16(),
                              this
                          }
                      }, {
                          key: "getDefCodecRate",
                          value: function() {
                              return this.codecType >= r.default.VIDEO_264_START && this.codecType <= r.default.VIDEO_H264_END ? 100 * (this.codecType - r.default.VIDEO_264_START) : this.codecType >= r.default.VIDEO_265_START && this.codecType <= r.default.VIDEO_H265_END ? 100 * (this.codecType - r.default.VIDEO_265_START) : 128
                          }
                      }, {
                          key: "text",
                          value: function() {
                              return this.streamName + "_" + this.codecType + "_" + this.cdnBrand
                          }
                      }, {
                          key: "equal",
                          value: function(t) {
                              return !!t && this.streamName == t.streamName && this.codecType == t.codecType && this.cdnBrand == t.cdnBrand
                          }
                      }, {
                          key: "isValidID",
                          get: function() {
                              return this.codecType > 0
                          }
                      }, {
                          key: "isH264",
                          get: function() {
                              return this.codecType >= r.default.VIDEO_264_START && this.codecType <= r.default.VIDEO_H264_END
                          }
                      }, {
                          key: "isH265",
                          get: function() {
                              return this.codecType >= r.default.VIDEO_265_START && this.codecType <= r.default.VIDEO_H265_END
                          }
                      }]),
                      t
                  }();
                  e.default = o
              }
              , function(t, e, i) {
                  "use strict";
                  var s, a = "object" == ("undefined" == typeof Reflect ? "undefined" : n(Reflect)) ? Reflect : null, r = a && "function" == typeof a.apply ? a.apply : function(t, e, i) {
                      return Function.prototype.apply.call(t, e, i)
                  }
                  ;
                  s = a && "function" == typeof a.ownKeys ? a.ownKeys : Object.getOwnPropertySymbols ? function(t) {
                      return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))
                  }
                  : function(t) {
                      return Object.getOwnPropertyNames(t)
                  }
                  ;
                  var o = Number.isNaN || function(t) {
                      return t != t
                  }
                  ;
                  function h() {
                      h.init.call(this)
                  }
                  t.exports = h,
                  h.EventEmitter = h,
                  h.prototype._events = void 0,
                  h.prototype._eventsCount = 0,
                  h.prototype._maxListeners = void 0;
                  var u = 10;
                  function l(t) {
                      if ("function" != typeof t)
                          throw new TypeError('The "listener" argument must be of type Function. Received type ' + n(t))
                  }
                  function c(t) {
                      return void 0 === t._maxListeners ? h.defaultMaxListeners : t._maxListeners
                  }
                  function d(t, e, i, s) {
                      var a, r, n, o;
                      if (l(i),
                      void 0 === (r = t._events) ? (r = t._events = Object.create(null),
                      t._eventsCount = 0) : (void 0 !== r.newListener && (t.emit("newListener", e, i.listener ? i.listener : i),
                      r = t._events),
                      n = r[e]),
                      void 0 === n)
                          n = r[e] = i,
                          ++t._eventsCount;
                      else if ("function" == typeof n ? n = r[e] = s ? [i, n] : [n, i] : s ? n.unshift(i) : n.push(i),
                      (a = c(t)) > 0 && n.length > a && !n.warned) {
                          n.warned = !0;
                          var h = new Error("Possible EventEmitter memory leak detected. " + n.length + " " + String(e) + " listeners added. Use emitter.setMaxListeners() to increase limit");
                          h.name = "MaxListenersExceededWarning",
                          h.emitter = t,
                          h.type = e,
                          h.count = n.length,
                          o = h,
                          console && console.warn && console.warn(o)
                      }
                      return t
                  }
                  function p() {
                      if (!this.fired)
                          return this.target.removeListener(this.type, this.wrapFn),
                          this.fired = !0,
                          0 === arguments.length ? this.listener.call(this.target) : this.listener.apply(this.target, arguments)
                  }
                  function f(t, e, i) {
                      var s = {
                          fired: !1,
                          wrapFn: void 0,
                          target: t,
                          type: e,
                          listener: i
                      }
                        , a = p.bind(s);
                      return a.listener = i,
                      s.wrapFn = a,
                      a
                  }
                  function _(t, e, i) {
                      var s = t._events;
                      if (void 0 === s)
                          return [];
                      var a = s[e];
                      return void 0 === a ? [] : "function" == typeof a ? i ? [a.listener || a] : [a] : i ? function(t) {
                          for (var e = new Array(t.length), i = 0; i < e.length; ++i)
                              e[i] = t[i].listener || t[i];
                          return e
                      }(a) : v(a, a.length)
                  }
                  function m(t) {
                      var e = this._events;
                      if (void 0 !== e) {
                          var i = e[t];
                          if ("function" == typeof i)
                              return 1;
                          if (void 0 !== i)
                              return i.length
                      }
                      return 0
                  }
                  function v(t, e) {
                      for (var i = new Array(e), s = 0; s < e; ++s)
                          i[s] = t[s];
                      return i
                  }
                  Object.defineProperty(h, "defaultMaxListeners", {
                      enumerable: !0,
                      get: function() {
                          return u
                      },
                      set: function(t) {
                          if ("number" != typeof t || t < 0 || o(t))
                              throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received ' + t + ".");
                          u = t
                      }
                  }),
                  h.init = function() {
                      void 0 !== this._events && this._events !== Object.getPrototypeOf(this)._events || (this._events = Object.create(null),
                      this._eventsCount = 0),
                      this._maxListeners = this._maxListeners || void 0
                  }
                  ,
                  h.prototype.setMaxListeners = function(t) {
                      if ("number" != typeof t || t < 0 || o(t))
                          throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received ' + t + ".");
                      return this._maxListeners = t,
                      this
                  }
                  ,
                  h.prototype.getMaxListeners = function() {
                      return c(this)
                  }
                  ,
                  h.prototype.emit = function(t) {
                      for (var e = [], i = 1; i < arguments.length; i++)
                          e.push(arguments[i]);
                      var s = "error" === t
                        , a = this._events;
                      if (void 0 !== a)
                          s = s && void 0 === a.error;
                      else if (!s)
                          return !1;
                      if (s) {
                          var n;
                          if (e.length > 0 && (n = e[0]),
                          n instanceof Error)
                              throw n;
                          var o = new Error("Unhandled error." + (n ? " (" + n.message + ")" : ""));
                          throw o.context = n,
                          o
                      }
                      var h = a[t];
                      if (void 0 === h)
                          return !1;
                      if ("function" == typeof h)
                          r(h, this, e);
                      else {
                          var u = h.length
                            , l = v(h, u);
                          for (i = 0; i < u; ++i)
                              r(l[i], this, e)
                      }
                      return !0
                  }
                  ,
                  h.prototype.addListener = function(t, e) {
                      return d(this, t, e, !1)
                  }
                  ,
                  h.prototype.on = h.prototype.addListener,
                  h.prototype.prependListener = function(t, e) {
                      return d(this, t, e, !0)
                  }
                  ,
                  h.prototype.once = function(t, e) {
                      return l(e),
                      this.on(t, f(this, t, e)),
                      this
                  }
                  ,
                  h.prototype.prependOnceListener = function(t, e) {
                      return l(e),
                      this.prependListener(t, f(this, t, e)),
                      this
                  }
                  ,
                  h.prototype.removeListener = function(t, e) {
                      var i, s, a, r, n;
                      if (l(e),
                      void 0 === (s = this._events))
                          return this;
                      if (void 0 === (i = s[t]))
                          return this;
                      if (i === e || i.listener === e)
                          0 == --this._eventsCount ? this._events = Object.create(null) : (delete s[t],
                          s.removeListener && this.emit("removeListener", t, i.listener || e));
                      else if ("function" != typeof i) {
                          for (a = -1,
                          r = i.length - 1; r >= 0; r--)
                              if (i[r] === e || i[r].listener === e) {
                                  n = i[r].listener,
                                  a = r;
                                  break
                              }
                          if (a < 0)
                              return this;
                          0 === a ? i.shift() : function(t, e) {
                              for (; e + 1 < t.length; e++)
                                  t[e] = t[e + 1];
                              t.pop()
                          }(i, a),
                          1 === i.length && (s[t] = i[0]),
                          void 0 !== s.removeListener && this.emit("removeListener", t, n || e)
                      }
                      return this
                  }
                  ,
                  h.prototype.off = h.prototype.removeListener,
                  h.prototype.removeAllListeners = function(t) {
                      var e, i, s;
                      if (void 0 === (i = this._events))
                          return this;
                      if (void 0 === i.removeListener)
                          return 0 === arguments.length ? (this._events = Object.create(null),
                          this._eventsCount = 0) : void 0 !== i[t] && (0 == --this._eventsCount ? this._events = Object.create(null) : delete i[t]),
                          this;
                      if (0 === arguments.length) {
                          var a, r = Object.keys(i);
                          for (s = 0; s < r.length; ++s)
                              "removeListener" !== (a = r[s]) && this.removeAllListeners(a);
                          return this.removeAllListeners("removeListener"),
                          this._events = Object.create(null),
                          this._eventsCount = 0,
                          this
                      }
                      if ("function" == typeof (e = i[t]))
                          this.removeListener(t, e);
                      else if (void 0 !== e)
                          for (s = e.length - 1; s >= 0; s--)
                              this.removeListener(t, e[s]);
                      return this
                  }
                  ,
                  h.prototype.listeners = function(t) {
                      return _(this, t, !0)
                  }
                  ,
                  h.prototype.rawListeners = function(t) {
                      return _(this, t, !1)
                  }
                  ,
                  h.listenerCount = function(t, e) {
                      return "function" == typeof t.listenerCount ? t.listenerCount(e) : m.call(t, e)
                  }
                  ,
                  h.prototype.listenerCount = m,
                  h.prototype.eventNames = function() {
                      return this._eventsCount > 0 ? s(this._events) : []
                  }
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e),
                  e.default = {
                      STREAM_UNKNOWN: 0,
                      AUDIO_SPEEX: 0,
                      AUDIO_AACPLUS: 1,
                      AUDIO_SILK: 2,
                      AUDIO_AAC_44100HZ_STEREO_128KBPS: 35,
                      AUDIO_AAC_44100HZ_STEREO_160KBPS: 36,
                      AUDIO_AAC_44100HZ_STEREO_192KBPS: 37,
                      AUDIO_ELD_AAC_44100HZ_STEREO: 38,
                      AUDIO_ELD_AAC_SBR_44100HZ_STEREO: 39,
                      AUDIO_MP3: 50,
                      AUDIO_NELLYMOSER: 54,
                      VIDEO_264_START: 401,
                      VIDEO_H264_100K: 401,
                      VIDEO_H264_500K: 405,
                      VIDEO_H264_800K: 408,
                      VIDEO_H264_1200K: 412,
                      VIDEO_H264_1500K: 415,
                      VIDEO_H264_2000K: 420,
                      VIDEO_H264_3000K: 430,
                      VIDEO_H264_4000K: 440,
                      VIDEO_H264_6000K: 460,
                      VIDEO_H264_8000K: 480,
                      VIDEO_H264_END: 480,
                      VIDEO_265_START: 503,
                      VIDEO_H265_300K: 503,
                      VIDEO_H265_500K: 505,
                      VIDEO_H265_800K: 508,
                      VIDEO_H265_1200K: 512,
                      VIDEO_H265_1500K: 515,
                      VIDEO_H265_2000K: 520,
                      VIDEO_H265_3000K: 530,
                      VIDEO_H265_4000K: 540,
                      VIDEO_H265_6000K: 560,
                      VIDEO_H265_8000K: 580,
                      VIDEO_H265_END: 580
                  }
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(20)
                    , n = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.ip = 0,
                          this.tcpPorts = [],
                          this.udpPorts = [],
                          this.videoProxyInfo = new Map
                      }
                      return Object(a.a)(t, [{
                          key: "marshall",
                          value: function() {
                              var t = new r.a(!1);
                              return "number" == typeof this.ip ? t.pushUInt32(this.ip) : t.pushUInt32(this.ip2uint(this.ip)),
                              t.pushUInt16Vector(this.tcpPorts),
                              t.pushUInt16Vector(this.udpPorts),
                              t.pushUInt32(this.videoProxyInfo.size),
                              this.videoProxyInfo.forEach((function(e, i) {
                                  t.pushUInt8(i),
                                  t.pushUInt32(e)
                              }
                              )),
                              t.marshall()
                          }
                      }, {
                          key: "unmarshall",
                          value: function(t) {
                              this.ip = this.uint2ip(t.popUInt32()),
                              this.tcpPorts = t.popUInt16Vector(),
                              this.udpPorts = t.popUInt16Vector(),
                              this.videoProxyInfo.clear();
                              for (var e = t.popUInt32(), i = 0; i < e; i++) {
                                  var s = t.popUInt8()
                                    , a = t.popUInt32();
                                  this.videoProxyInfo.set(s, a)
                              }
                              return this
                          }
                      }, {
                          key: "ip2uint",
                          value: function(t) {
                              for (var e = 0, i = t.split("."), s = 0; s < i.length; s++)
                                  e |= Number(i[s]) << 8 * s;
                              return e < 0 && (e += 4294967296),
                              e
                          }
                      }, {
                          key: "uint2ip",
                          value: function(t) {
                              return (255 & t) + "." + (t >> 8 & 255) + "." + (t >> 16 & 255) + "." + (t >> 24 & 255)
                          }
                      }]),
                      t
                  }();
                  e.default = n
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(32)
                    , n = i(26)
                    , o = i(20)
                    , h = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.appid = 0,
                          this.streamType = 0,
                          this.codecType = 0,
                          this.sid = 0,
                          this.startTs = 0,
                          this.serverGenSeq = 0
                      }
                      return Object(a.a)(t, [{
                          key: "marshall",
                          value: function() {
                              var t = new o.a(!1);
                              return t.pushUInt8(this.appid),
                              t.pushUInt8(this.streamType),
                              t.pushUInt16(this.codecType),
                              t.pushUInt64(this.sid),
                              t.pushUInt32(this.startTs),
                              t.pushUInt16(this.serverGenSeq),
                              t.marshall()
                          }
                      }, {
                          key: "unmarshall",
                          value: function(t) {
                              return this.appid = t.popUInt8(),
                              this.streamType = t.popUInt8(),
                              this.codecType = t.popUInt16(),
                              this.sid = t.popUInt64(),
                              this.startTs = t.popUInt32(),
                              this.serverGenSeq = t.popUInt16(),
                              this
                          }
                      }, {
                          key: "text",
                          value: function() {
                              return this.appid + "-" + this.streamType + "-" + this.codecType + "-" + this.sid + "-" + this.startTs + "-" + this.serverGenSeq
                          }
                      }, {
                          key: "equal",
                          value: function(t) {
                              return null !== t && this.appid === t.appid && this.streamType === t.streamType && this.codecType === t.codecType && this.sid === t.sid && this.startTs === t.startTs && this.serverGenSeq === t.serverGenSeq
                          }
                      }, {
                          key: "isValidID",
                          get: function() {
                              return this.appid > 0
                          }
                      }, {
                          key: "isTransStream",
                          get: function() {
                              return 1 == (1 & this.streamType)
                          }
                      }, {
                          key: "isAudioStream",
                          get: function() {
                              return this.streamType >= r.default.STRAEM_TYPE_AUDIO_START
                          }
                      }, {
                          key: "isVideoStream",
                          get: function() {
                              return this.streamType < r.default.STRAEM_TYPE_AUDIO_START
                          }
                      }, {
                          key: "isH264VideoStream",
                          get: function() {
                              return this.isVideoStream && this.codecType >= n.default.VIDEO_264_START && this.codecType <= n.default.VIDEO_H264_END
                          }
                      }, {
                          key: "isH265VideoStream",
                          get: function() {
                              return this.isVideoStream && this.codecType >= n.default.VIDEO_265_START && this.codecType <= n.default.VIDEO_H265_END
                          }
                      }, {
                          key: "videoTypeId",
                          get: function() {
                              return this.appid << 24 | this.streamType << 16 | this.codecType
                          }
                      }, {
                          key: "hashKey",
                          get: function() {
                              return 4294967296 * this.sid + (this.codecType << 16 | this.appid << 8 | this.streamType)
                          }
                      }, {
                          key: "streamId",
                          get: function() {
                              return 281474976710656 * this.streamType + 4294967296 * this.codecType + this.startTs
                          }
                      }]),
                      t
                  }();
                  e.default = h
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(20)
                    , n = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.ip = 0,
                          this.tcpPorts = [],
                          this.udpPorts = [],
                          this.videoProxyInfo = new Map
                      }
                      return Object(a.a)(t, [{
                          key: "marshall",
                          value: function() {
                              var t = new r.a(!1);
                              return "number" == typeof this.ip ? t.pushUInt32(this.ip) : t.pushUInt32(this.ip2uint(this.ip)),
                              t.pushUInt16Vector(this.tcpPorts),
                              t.pushUInt16Vector(this.udpPorts),
                              t.pushUInt32(this.videoProxyInfo.size),
                              this.videoProxyInfo.forEach((function(e, i) {
                                  t.pushUInt8(i),
                                  t.pushUInt32(e)
                              }
                              )),
                              t.marshall()
                          }
                      }, {
                          key: "unmarshall",
                          value: function(t) {
                              this.ip = this.uint2ip(t.popUInt32()),
                              this.tcpPorts = t.popUInt16Vector(),
                              this.udpPorts = t.popUInt16Vector(),
                              this.videoProxyInfo.clear();
                              for (var e = t.popUInt32(), i = 0; i < e; i++) {
                                  var s = t.popUInt8()
                                    , a = t.popUInt32();
                                  this.videoProxyInfo.set(s, a)
                              }
                              return this
                          }
                      }, {
                          key: "ip2uint",
                          value: function(t) {
                              for (var e = 0, i = t.split("."), s = 0; s < i.length; s++)
                                  e |= Number(i[s]) << 8 * s;
                              return e < 0 && (e += 4294967296),
                              e
                          }
                      }, {
                          key: "uint2ip",
                          value: function(t) {
                              return (255 & t) + "." + (t >> 8 & 255) + "." + (t >> 16 & 255) + "." + (t >> 24 & 255)
                          }
                      }]),
                      t
                  }();
                  e.default = n
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(20)
                    , n = i(38)
                    , o = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.sid = 0,
                          this.fuzzyParam = new n.default
                      }
                      return Object(a.a)(t, [{
                          key: "marshall",
                          value: function() {
                              var t = new r.a(!1);
                              return t.pushUInt64(this.sid),
                              t.pushUint8ArrayWithoutLen(this.fuzzyParam.marshall()),
                              t.marshall()
                          }
                      }]),
                      t
                  }();
                  e.default = o
              }
              , function(t, e, i) {
                  "use strict";
                  var s = i(2)
                    , a = i(3)
                    , r = function() {
                      function t(e) {
                          var i = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1];
                          Object(s.a)(this, t),
                          this.view = e,
                          this.pos = 0,
                          this.len = 0,
                          this.uri = 0,
                          this.resCode = 0,
                          !0 === i && (this.len = this.popUInt32(),
                          this.uri = this.popUInt32(),
                          this.resCode = this.popUInt16())
                      }
                      return Object(a.a)(t, [{
                          key: "bytesAvailable",
                          value: function() {
                              return this.view.byteLength - this.pos
                          }
                      }, {
                          key: "popBool",
                          value: function() {
                              return 1 == this.popUInt8()
                          }
                      }, {
                          key: "popUInt8",
                          value: function() {
                              if (this.pos + 1 > this.view.byteLength)
                                  return 0;
                              var t = this.view.getUint8(this.pos);
                              return this.pos++,
                              t
                          }
                      }, {
                          key: "popUInt16",
                          value: function() {
                              if (this.pos + 2 > this.view.byteLength)
                                  return 0;
                              var t = this.view.getUint16(this.pos, !0);
                              return this.pos += 2,
                              t
                          }
                      }, {
                          key: "popUInt32",
                          value: function() {
                              if (this.pos + 4 > this.view.byteLength)
                                  return 0;
                              var t = this.view.getUint32(this.pos, !0);
                              return this.pos += 4,
                              t
                          }
                      }, {
                          key: "popUInt64",
                          value: function() {
                              if (this.pos + 8 > this.view.byteLength)
                                  return 0;
                              var t = this.view.getUint32(this.pos, !0);
                              this.pos += 4;
                              var e = this.view.getUint32(this.pos, !0);
                              return this.pos += 4,
                              4294967296 * e + t
                          }
                      }, {
                          key: "popInt64",
                          value: function() {
                              for (var t = 0, e = (128 & this.view.getUint8(this.pos + 7)) > 0, i = !0, s = 0; s < 8; s++) {
                                  var a = this.view.getUint8(this.pos + s);
                                  e && (i ? 0 != a && (a = 255 & ~(a - 1),
                                  i = !1) : a = 255 & ~a),
                                  t += a * Math.pow(2, 8 * s)
                              }
                              return e && (t = -t),
                              this.pos += 8,
                              t
                          }
                      }, {
                          key: "popUint8Array",
                          value: function() {
                              var t = this.popUInt16();
                              if (this.pos + t > this.view.byteLength)
                                  return null;
                              var e = new Uint8Array(this.view.buffer,this.pos,t);
                              return this.pos += t,
                              e.slice()
                          }
                      }, {
                          key: "popUint8Array32",
                          value: function() {
                              var t = this.popUInt32();
                              if (this.pos + t > this.view.byteLength)
                                  return null;
                              var e = new Uint8Array(this.view.buffer,this.pos,t);
                              return this.pos += t,
                              e.slice()
                          }
                      }, {
                          key: "popUInt64Vector",
                          value: function() {
                              var t = this.popUInt32();
                              if (this.pos + 8 * t > this.view.byteLength)
                                  return null;
                              for (var e = [], i = 0; i < t; i++)
                                  e.push(this.popUInt64());
                              return e
                          }
                      }, {
                          key: "popUInt32Vector",
                          value: function() {
                              var t = this.popUInt32();
                              if (this.pos + 4 * t > this.view.byteLength)
                                  return null;
                              for (var e = [], i = 0; i < t; i++)
                                  e.push(this.popUInt32());
                              return e
                          }
                      }, {
                          key: "popUInt16Vector",
                          value: function() {
                              var t = this.popUInt32();
                              if (this.pos + 2 * t > this.view.byteLength)
                                  return null;
                              for (var e = [], i = 0; i < t; i++)
                                  e.push(this.popUInt16());
                              return e
                          }
                      }, {
                          key: "popString",
                          value: function() {
                              var t = this.popUInt16();
                              if (this.pos + t > this.view.byteLength)
                                  return null;
                              for (var e = [], i = 0; i < t; ++i)
                                  e[i] = String.fromCharCode(this.popUInt8());
                              return e.join("")
                          }
                      }, {
                          key: "popMapKey8Val32",
                          value: function() {
                              for (var t = this.popUInt32(), e = new Map, i = 0; i < t; i++) {
                                  var s = this.popUInt8()
                                    , a = this.popUInt32();
                                  e.set(s, a)
                              }
                              return e
                          }
                      }, {
                          key: "popMapKey64Val64",
                          value: function() {
                              for (var t = this.popUInt32(), e = new Map, i = 0; i < t; i++) {
                                  var s = this.popUInt64()
                                    , a = this.popUInt64();
                                  e.set(s, a)
                              }
                              return e
                          }
                      }]),
                      t
                  }();
                  e.a = r
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e),
                  e.default = {
                      STREAM_VIDEO_RAW: 0,
                      STREAM_VIDEO_TRANSCODE: 1,
                      STREAM_VIDEO_RTMP_RAW: 2,
                      STREAM_VIDEO_RTMP_TRANSCODE: 3,
                      STRAEM_TYPE_AUDIO_START: 32,
                      STREAM_AUDIO_RAW: 32,
                      STREAM_AUDIO_TRANSCODE: 33,
                      STREAM_AUDIO_FLV_RAW: 34,
                      STREAM_AUDIO_FLV_TRANSCODE: 35,
                      STREAM_AUDIO_RTMP_RAW: 36,
                      STREAM_AUDIO_RTMP_TRANSCODE: 37,
                      STREAM_AUDIO_ALL_SID: 39,
                      STREAM_TYPE_UNKNOWN: 255
                  }
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(19)
                    , n = i(20)
                    , o = (i(30),
                  i(37))
                    , h = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.uid = 0,
                          this.version = 0,
                          this.streamNames = [],
                          this.fuzzyQueryKeys = [],
                          this.currentInfo = new o.default,
                          this.appid = 0,
                          this.clientAppid = 0,
                          this.clientType = 0,
                          this.ip = 0,
                          this.sendTime = 0,
                          this.sdkVersion = 0,
                          this.imsi = 0,
                          this.useCase = 0,
                          this.appSysName = "",
                          this.appUA = "",
                          this.retryFailCount = 0,
                          this.extInfo = new Map
                      }
                      return Object(a.a)(t, [{
                          key: "marshall",
                          value: function() {
                              var t = new n.a;
                              return t.setUri(r.a.PAudienceGetProxyListReq),
                              t.pushUInt64(this.uid),
                              t.pushUInt8(this.version),
                              t.pushUInt32(this.streamNames.length),
                              this.streamNames.forEach((function(e) {
                                  t.pushString(e)
                              }
                              )),
                              t.pushUInt32(this.fuzzyQueryKeys.length),
                              this.fuzzyQueryKeys.forEach((function(e) {
                                  t.pushUint8ArrayWithoutLen(e.marshall())
                              }
                              )),
                              t.pushUint8ArrayWithoutLen(this.currentInfo.marshall()),
                              t.pushUInt8(this.appid),
                              t.pushUInt32(this.clientAppid),
                              t.pushUInt32(this.clientType),
                              t.pushUInt32(this.ip),
                              t.pushUInt32(this.sendTime),
                              t.pushUInt32(this.sdkVersion),
                              t.pushUInt64(this.imsi),
                              t.pushUInt8(this.useCase),
                              t.pushString(this.appSysName),
                              t.pushString(this.appUA),
                              t.pushUInt8(this.retryFailCount),
                              t.pushUInt32(this.extInfo.size),
                              this.extInfo.forEach((function(e, i) {
                                  t.pushString(i),
                                  t.pushString(e)
                              }
                              )),
                              t.marshall()
                          }
                      }]),
                      t
                  }();
                  e.default = h
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(24)
                    , n = i(27)
                    , o = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.streamId = new r.default,
                          this.videoProxyInfos = [],
                          this.token = "",
                          this.streamSeqSN = 0,
                          this.quickAccessBeginIndex = 0,
                          this.quickAccessEndIndex = 0,
                          this.ip = 0,
                          this.urlTokenTime = 0,
                          this.urlToken = ""
                      }
                      return Object(a.a)(t, [{
                          key: "unmarshall",
                          value: function(t) {
                              this.streamId.unmarshall(t),
                              this.videoProxyInfos = [];
                              for (var e = t.popUInt32(), i = 0; i < e; i++) {
                                  var s = new n.default;
                                  this.videoProxyInfos.push(s.unmarshall(t))
                              }
                              return this.token = t.popString(),
                              this.streamSeqSN = t.popUInt64(),
                              this.quickAccessBeginIndex = t.popUInt64(),
                              this.quickAccessEndIndex = t.popUInt64(),
                              this.ip = t.popUInt32(),
                              this.urlTokenTime = t.popUInt32(),
                              this.urlToken = t.popString(),
                              this
                          }
                      }]),
                      t
                  }();
                  e.default = o
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(20)
                    , n = i(24)
                    , o = i(27)
                    , h = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.currentProxyInfos = new Map
                      }
                      return Object(a.a)(t, [{
                          key: "marshall",
                          value: function() {
                              var t = new r.a(!1);
                              return t.pushUInt32(this.currentProxyInfos.size),
                              this.currentProxyInfos.forEach((function(e, i) {
                                  t.pushUint8ArrayWithoutLen(i.marshall()),
                                  t.pushUInt32(e.length),
                                  e.forEach((function(e) {
                                      t.pushUint8ArrayWithoutLen(e.marshall())
                                  }
                                  ))
                              }
                              )),
                              t.marshall()
                          }
                      }, {
                          key: "unmarshall",
                          value: function(t) {
                              this.currentProxyInfos.clear();
                              for (var e = t.popUInt32(), i = 0; i < e; i++) {
                                  var s = new n.default;
                                  s.unmarshall(t);
                                  for (var a = [], r = t.popUInt32(), h = 0; h < r; h++) {
                                      var u = new o.default;
                                      a.push(u.unmarshall(t))
                                  }
                                  this.currentProxyInfos.set(s, a)
                              }
                              return this
                          }
                      }]),
                      t
                  }();
                  e.default = h
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(19)
                    , n = i(20)
                    , o = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.seq = 0,
                          this.uri = 0,
                          this.from = 0,
                          this.uid = 0,
                          this.streamSeqSN = 0,
                          this.payload = null
                      }
                      return Object(a.a)(t, [{
                          key: "marshall",
                          value: function() {
                              var t = new n.a;
                              return t.setUri(r.a.PP2pSliceData),
                              t.pushUInt64(this.seq),
                              t.pushUInt32(this.uri),
                              t.pushUInt8(this.from),
                              t.pushUInt64(this.uid),
                              t.pushUInt64(this.streamSeqSN),
                              t.pushUint8Array(this.payload),
                              t.marshall()
                          }
                      }, {
                          key: "unmarshall",
                          value: function(t) {
                              return this.seq = t.popUInt64(),
                              this.uri = t.popUInt32(),
                              this.from = t.popUInt8(),
                              this.uid = t.popUInt64(),
                              this.streamSeqSN = t.popUInt64(),
                              this.payload = t.popUint8Array(),
                              this
                          }
                      }, {
                          key: "isAudio",
                          get: function() {
                              return this.uri == r.a.PP2pSliceAudioData
                          }
                      }, {
                          key: "isVideo",
                          get: function() {
                              return this.uri == r.a.PP2pSliceVideoData
                          }
                      }, {
                          key: "isCtrlSlice",
                          get: function() {
                              return this.uri == r.a.PP2pSliceControlData
                          }
                      }, {
                          key: "isFullSlice",
                          get: function() {
                              return 1 == this.from
                          }
                      }, {
                          key: "isSubSlice",
                          get: function() {
                              return 2 == this.from
                          }
                      }, {
                          key: "isResend",
                          get: function() {
                              return 3 == this.from && 0 == this.uid
                          }
                      }, {
                          key: "isPatchSlice",
                          get: function() {
                              return 4 == this.from
                          }
                      }, {
                          key: "isFromPeer",
                          get: function() {
                              return 0 !== this.uid
                          }
                      }]),
                      t
                  }();
                  e.default = o
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(20)
                    , n = i(28)
                    , o = i(29)
                    , h = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.currentProxyInfos = new Map
                      }
                      return Object(a.a)(t, [{
                          key: "marshall",
                          value: function() {
                              var t = new r.a(!1);
                              return t.pushUInt32(this.currentProxyInfos.size),
                              this.currentProxyInfos.forEach((function(e, i) {
                                  t.pushUint8ArrayWithoutLen(i.marshall()),
                                  t.pushUInt32(e.length),
                                  e.forEach((function(e) {
                                      t.pushUint8ArrayWithoutLen(e.marshall())
                                  }
                                  ))
                              }
                              )),
                              t.marshall()
                          }
                      }, {
                          key: "unmarshall",
                          value: function(t) {
                              this.currentProxyInfos.clear();
                              for (var e = t.popUInt32(), i = 0; i < e; i++) {
                                  var s = new n.default;
                                  s.unmarshall(t);
                                  for (var a = [], r = t.popUInt32(), h = 0; h < r; h++) {
                                      var u = new o.default;
                                      a.push(u.unmarshall(t))
                                  }
                                  this.currentProxyInfos.set(s, a)
                              }
                              return this
                          }
                      }]),
                      t
                  }();
                  e.default = h
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(20)
                    , n = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.h264Only = !1,
                          this.maxCodeRateH264 = 0,
                          this.maxCodeRateH265 = 0,
                          this.reserve = 0
                      }
                      return Object(a.a)(t, [{
                          key: "marshall",
                          value: function() {
                              var t = new r.a(!1);
                              return t.pushBool(this.h264Only),
                              t.pushUInt16(this.maxCodeRateH264),
                              t.pushUInt16(this.maxCodeRateH265),
                              t.pushUInt32(this.reserve),
                              t.marshall()
                          }
                      }, {
                          key: "unmarshall",
                          value: function(t) {
                              return this.h264Only = t.popBool(),
                              this.maxCodeRateH264 = t.popUInt16(),
                              this.maxCodeRateH265 = t.popUInt16(),
                              this.reserve = t.popUInt32(),
                              this
                          }
                      }]),
                      t
                  }();
                  e.default = n
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = (i(19),
                  i(40))
                    , n = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.uid = 0,
                          this.allocatedStreams = new Map,
                          this.clientAppid = 0,
                          this.clientType = 0,
                          this.sendTime = 0,
                          this.userArea = 0,
                          this.videoGroupId = 0,
                          this.retryType = 0,
                          this.retryFreq = 0,
                          this.result = 0,
                          this.proxyType = 0,
                          this.tokenVersion = 0,
                          this.sslUrl = ""
                      }
                      return Object(a.a)(t, [{
                          key: "unmarshall",
                          value: function(t) {
                              this.uid = t.popUInt64(),
                              this.allocatedStreams.clear();
                              for (var e = t.popUInt32(), i = 0; i < e; i++) {
                                  for (var s = t.popString(), a = [], n = t.popUInt32(), o = 0; o < n; o++) {
                                      var h = new r.default;
                                      a.push(h.unmarshall(t))
                                  }
                                  this.allocatedStreams.set(s, a)
                              }
                              return this.clientAppid = t.popUInt32(),
                              this.clientType = t.popUInt32(),
                              this.sendTime = t.popUInt32(),
                              this.userArea = t.popUInt32(),
                              this.videoGroupId = t.popUInt32(),
                              this.retryType = t.popUInt8(),
                              this.retryFreq = t.popUInt16(),
                              this.result = t.popUInt32(),
                              this.proxyType = t.popUInt32(),
                              this.tokenVersion = t.popUInt32(),
                              this.sslUrl = t.popString(),
                              this
                          }
                      }]),
                      t
                  }();
                  e.default = n
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(28)
                    , n = i(29)
                    , o = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.streamId = new r.default,
                          this.videoProxyInfos = [],
                          this.token = ""
                      }
                      return Object(a.a)(t, [{
                          key: "unmarshall",
                          value: function(t) {
                              this.streamId.unmarshall(t),
                              this.videoProxyInfos = [];
                              for (var e = t.popUInt32(), i = 0; i < e; i++) {
                                  var s = new n.default;
                                  this.videoProxyInfos.push(s.unmarshall(t))
                              }
                              return this.token = t.popString(),
                              this
                          }
                      }]),
                      t
                  }();
                  e.default = o
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.uid = 0,
                          this.encoderSource = 0,
                          this.uploadType = 0,
                          this.frameDts = 0,
                          this.caputureTime = 0,
                          this.encodeEndTime = 0,
                          this.sendFrameTime = 0
                      }
                      return Object(a.a)(t, [{
                          key: "unmarshall",
                          value: function(t) {
                              this.uid = t.popUInt64(),
                              this.encoderSource = t.popUInt8(),
                              this.uploadType = t.popUInt8(),
                              this.frameDts = t.popUInt64(),
                              this.caputureTime = t.popUInt64(),
                              this.encodeEndTime = t.popUInt64(),
                              this.sendFrameTime = t.popUInt64()
                          }
                      }]),
                      t
                  }();
                  e.default = r
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(43)
                    , n = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.dtsGapSum = 0,
                          this.delaySum = 0,
                          this.serverInfos = []
                      }
                      return Object(a.a)(t, [{
                          key: "unmarshall",
                          value: function(t) {
                              this.dtsGapSum = t.popInt64(),
                              this.delaySum = t.popUInt64();
                              for (var e = t.popUInt32(); e > 0; ) {
                                  e--;
                                  var i = new r.default;
                                  i.unmarshall(t),
                                  this.serverInfos.push(i)
                              }
                          }
                      }]),
                      t
                  }();
                  e.default = n
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.enable = 0,
                          //!=0时表示有效数据
                          this.proxyIdLow = 0,
                          this.proxyIdHigh = 0,
                          this.proxyType = 0,
                          this.serverDelay = 0,
                          this.lastPeriodDelay = 0
                      }
                      return Object(a.a)(t, [{
                          key: "unmarshall",
                          value: function(t) {
                              this.enable = t.popUInt8(),
                              this.proxyIdLow = t.popUInt32(),
                              this.proxyIdHigh = t.popUInt32(),
                              this.proxyType = t.popUInt16(),
                              this.serverDelay = t.popUInt32(),
                              this.lastPeriodDelay = t.popUInt32()
                          }
                      }, {
                          key: "getProxyIdStr",
                          value: function() {
                              return this.proxyIdHigh.toString(16) + this.proxyIdLow.toString(16)
                          }
                      }]),
                      t
                  }();
                  e.default = r
              }
              , function(t, e, i) {
                  "use strict";
                  function s(t, e) {
                      (null == e || e > t.length) && (e = t.length);
                      for (var i = 0, s = new Array(e); i < e; i++)
                          s[i] = t[i];
                      return s
                  }
                  function a(t, e) {
                      if (t) {
                          if ("string" == typeof t)
                              return s(t, e);
                          var i = Object.prototype.toString.call(t).slice(8, -1);
                          return "Object" === i && t.constructor && (i = t.constructor.name),
                          "Map" === i || "Set" === i ? Array.from(i) : "Arguments" === i || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i) ? s(t, e) : void 0
                      }
                  }
                  i.d(e, "a", (function() {
                      return a
                  }
                  ))
              }
              , function(t, e, i) {
                  "use strict";
                  var s = {
                      buildAbsoluteURL: function(t, e) {
                          if (e = e.trim(),
                          /^[a-z]+:/i.test(e))
                              return e;
                          var i = null
                            , a = null
                            , r = /^([^#]*)(.*)$/.exec(e);
                          r && (a = r[2],
                          e = r[1]);
                          var n = /^([^\?]*)(.*)$/.exec(e);
                          n && (i = n[2],
                          e = n[1]);
                          var o = /^([^#]*)(.*)$/.exec(t);
                          o && (t = o[1]);
                          var h = /^([^\?]*)(.*)$/.exec(t);
                          h && (t = h[1]);
                          var u = /^((([a-z]+):)?\/\/[a-z0-9\.-]+(:[0-9]+)?\/)(.*)$/i.exec(t)
                            , l = u[3]
                            , c = u[1]
                            , d = u[5]
                            , p = null;
                          return p = /^\/\//.test(e) ? l + "://" + s.buildAbsolutePath("", e.substring(2)) : /^\//.test(e) ? c + s.buildAbsolutePath("", e.substring(1)) : c + s.buildAbsolutePath(d, e),
                          i && (p += i),
                          a && (p += a),
                          p
                      },
                      buildAbsolutePath: function(t, e) {
                          for (var i, s, a = e, r = "", n = t.replace(/[^\/]*$/, a.replace(/(\/|^)(?:\.?\/+)+/g, "$1")), o = 0; (s = n.indexOf("/../", o)) > -1; o = s + i)
                              i = /^\/(?:\.\.\/)*/.exec(n.slice(s))[0].length,
                              r = (r + n.substring(o, s)).replace(new RegExp("(?:\\/+[^\\/]*){0," + (i - 1) / 3 + "}$"), "/");
                          var h = /\.\.\//g;
                          if (h.test(e)) {
                              var u = t.split("/")
                                , l = e.match(h).length;
                              r = u.splice(0, u.length - 1 - l);
                              var c = n.substr(o);
                              return c.startsWith("/") ? r.join("/") + c : r.join("/") + "/" + c
                          }
                          return r + n.substr(o)
                      },
                      getTimeFromUrl: function(t, e) {
                          var i = e ? /\d+_(\d+)_\d+.ts?/ : /(\d+)_\d+_\d+.ts?/
                            , s = t.match(i);
                          return s ? e ? s[1] : Math.round(s[1] / 1e3) : -1
                      },
                      getVodUrl: function(t, e, i, s) {
                          return "http://106.38.255.95:9123/xcrs/" + t + "_" + e + "_" + i + ".m3u8?btime=" + s
                      }
                  };
                  t.exports = s
              }
              , function(t, e, i) {
                  "use strict";
                  e.a = {
                      OLD: 0,
                      P2P_FRAME: 1,
                      P2P_ONLY: 2
                  }
              }
              , function(t, e, i) {
                  var s = {
                      "./CdnAllocateInfo": 34,
                      "./CdnAllocateInfo.js": 34,
                      "./CdnGroupID": 24,
                      "./CdnGroupID.js": 24,
                      "./CdnGroupUsers": 48,
                      "./CdnGroupUsers.js": 48,
                      "./CurrentCdnProxyInfo": 35,
                      "./CurrentCdnProxyInfo.js": 35,
                      "./ESliceConfig": 49,
                      "./ESliceConfig.js": 49,
                      "./IpInfo": 50,
                      "./IpInfo.js": 50,
                      "./PCDNGetProxyListReq": 51,
                      "./PCDNGetProxyListReq.js": 51,
                      "./PCDNGetProxyListRsp": 52,
                      "./PCDNGetProxyListRsp.js": 52,
                      "./PP2pSliceAudioData": 53,
                      "./PP2pSliceAudioData.js": 53,
                      "./PP2pSliceControlData": 54,
                      "./PP2pSliceControlData.js": 54,
                      "./PP2pSliceData": 36,
                      "./PP2pSliceData.js": 36,
                      "./PP2pSliceVideoData": 55,
                      "./PP2pSliceVideoData.js": 55,
                      "./SlaveProxyInfo": 27,
                      "./SlaveProxyInfo.js": 27,
                      "./StreamCodecType": 23,
                      "./StreamCodecType.js": 23
                  };
                  function a(t) {
                      var e = r(t);
                      return i(e)
                  }
                  function r(t) {
                      if (!i.o(s, t)) {
                          var e = new Error("Cannot find module '" + t + "'");
                          throw e.code = "MODULE_NOT_FOUND",
                          e
                      }
                      return s[t]
                  }
                  a.keys = function() {
                      return Object.keys(s)
                  }
                  ,
                  a.resolve = r,
                  t.exports = a,
                  a.id = 47
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(20)
                    , n = i(24)
                    , o = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.cdnGroupId = new n.default,
                          this.userCnt = 0,
                          this.virUserCnt = 0,
                          this.codeRate = 0
                      }
                      return Object(a.a)(t, [{
                          key: "marshall",
                          value: function() {
                              var t = new r.a(!1);
                              return t.pushUint8ArrayWithoutLen(this.cdnGroupId.marshall()),
                              t.pushUInt32(this.userCnt),
                              t.pushUInt32(this.virUserCnt),
                              t.pushUInt32(this.codeRate),
                              t.marshall()
                          }
                      }, {
                          key: "unmarshall",
                          value: function(t) {
                              return this.cdnGroupId.unmarshall(t),
                              this.userCnt = t.popUInt32(),
                              this.virUserCnt = t.popUInt32(),
                              this.codeRate = t.popUInt32(),
                              this
                          }
                      }]),
                      t
                  }();
                  e.default = o
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e),
                  e.default = {
                      eSliceCfgStartIndexH: 1,
                      eSliceCfgStartIndexL: 2,
                      eSliceCfgIStampc: 3,
                      eSliceCfgPreQuickIndex: 5,
                      eSliceCfgFAPatchIndexH: 8,
                      eSliceCfgFAPatchIndexL: 9,
                      eSliceCfgStreamIdH: 10,
                      eSliceCfgStreamIdL: 11
                  }
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.ip = 0,
                          this.tcpPorts = [],
                          this.udpPorts = []
                      }
                      return Object(a.a)(t, [{
                          key: "unmarshall",
                          value: function(t) {
                              return this.ip = t.popUInt32(),
                              this.tcpPorts = t.popUInt16Vector(),
                              this.udpPorts = t.popUInt16Vector(),
                              this
                          }
                      }]),
                      t
                  }();
                  e.default = r
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(17)
                    , a = i(2)
                    , r = i(3)
                    , n = i(19)
                    , o = i(20)
                    , h = (i(24),
                  i(35))
                    , u = function() {
                      function t() {
                          Object(a.a)(this, t),
                          this.uid = 0,
                          this.version = 0,
                          this.cdnGroupIdList = [],
                          this.currentInfo = new h.default,
                          this.appid = 0,
                          this.clientAppid = 0,
                          this.clientType = 0,
                          this.ip = 0,
                          this.sendTime = 0,
                          this.sdkVersion = 0,
                          this.imsi = 0,
                          this.appId = 0,
                          this.anchorStreamNam2UId = new Map
                      }
                      return Object(r.a)(t, [{
                          key: "marshall",
                          value: function() {
                              var t = new o.a;
                              t.setUri(n.a.PCDNGetProxyListReq),
                              t.pushUInt64(this.uid),
                              t.pushUInt8(this.version),
                              t.pushUInt32(this.cdnGroupIdList.length),
                              this.cdnGroupIdList.forEach((function(e) {
                                  t.pushUint8ArrayWithoutLen(e.marshall())
                              }
                              )),
                              t.pushUint8ArrayWithoutLen(this.currentInfo.marshall()),
                              t.pushUInt8(this.appid),
                              t.pushUInt32(this.clientAppid),
                              t.pushUInt32(this.clientType),
                              t.pushUInt32(this.ip),
                              t.pushUInt32(this.sendTime),
                              t.pushUInt32(this.sdkVersion),
                              t.pushUInt64(this.imsi),
                              t.pushUInt32(this.appId),
                              t.pushUInt32(this.anchorStreamNam2UId.size);
                              var e, i = Object(s.a)(this.anchorStreamNam2UId.keys());
                              try {
                                  for (i.s(); !(e = i.n()).done; ) {
                                      var a = e.value;
                                      t.pushString(a),
                                      t.pushUInt64(this.anchorStreamNam2UId.get(a))
                                  }
                              } catch (t) {
                                  i.e(t)
                              } finally {
                                  i.f()
                              }
                              return t.marshall()
                          }
                      }]),
                      t
                  }();
                  e.default = u
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = (i(19),
                  i(34))
                    , n = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.uid = 0,
                          this.allocatedStreams = [],
                          this.clientAppid = 0,
                          this.clientType = 0,
                          this.sendTime = 0,
                          this.userArea = 0,
                          this.videoGroupId = 0,
                          this.retryType = 0,
                          this.retryFreq = 0,
                          this.result = 0,
                          this.proxyType = 0,
                          this.tokenVersion = 0,
                          this.sslUrl = "",
                          this.appId = 0
                      }
                      return Object(a.a)(t, [{
                          key: "unmarshall",
                          value: function(t) {
                              this.uid = t.popUInt64(),
                              this.allocatedStreams = [];
                              for (var e = t.popUInt32(), i = 0; i < e; i++) {
                                  var s = new r.default;
                                  this.allocatedStreams.push(s.unmarshall(t))
                              }
                              return this.clientAppid = t.popUInt32(),
                              this.clientType = t.popUInt32(),
                              this.sendTime = t.popUInt32(),
                              this.userArea = t.popUInt32(),
                              this.videoGroupId = t.popUInt32(),
                              this.retryType = t.popUInt8(),
                              this.retryFreq = t.popUInt16(),
                              this.result = t.popUInt32(),
                              this.proxyType = t.popUInt32(),
                              this.tokenVersion = t.popUInt32(),
                              this.sslUrl = t.popString(),
                              this.appId = t.popUInt32(),
                              this
                          }
                      }]),
                      t
                  }();
                  e.default = n
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(19)
                    , n = i(20)
                    , o = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.seq = 0,
                          this.checkSum = 0,
                          this.codecType = 0,
                          this.streamData = null
                      }
                      return Object(a.a)(t, [{
                          key: "marshall",
                          value: function() {
                              var t = new n.a;
                              return t.setUri(r.a.PP2pSliceAudioData),
                              t.pushUInt8(this.checkSum),
                              t.pushUInt16(this.codecType),
                              t.pushUint8Array(this.streamData),
                              t.marshall()
                          }
                      }, {
                          key: "unmarshall",
                          value: function(t) {
                              return this.checkSum = t.popUInt8(),
                              this.codecType = t.popUInt16(),
                              this.streamData = t.popUint8Array(),
                              this
                          }
                      }]),
                      t
                  }();
                  e.default = o
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(19)
                    , n = i(20)
                    , o = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.seq = 0,
                          this.strData = null
                      }
                      return Object(a.a)(t, [{
                          key: "marshall",
                          value: function() {
                              var t = new n.a;
                              return t.setUri(r.a.PP2pSliceControlData),
                              t.pushUint8Array(this.strData),
                              t.marshall()
                          }
                      }, {
                          key: "unmarshall",
                          value: function(t) {
                              return this.strData = t.popUint8Array(),
                              this
                          }
                      }]),
                      t
                  }();
                  e.default = o
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(19)
                    , n = i(20)
                    , o = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.seq = 0,
                          this.uid = 0,
                          this.isResend = !1,
                          this.checkSum = 0,
                          this.seqNum = 0,
                          this.frameNum = 0,
                          this.frameId = 0,
                          this.config = new Map,
                          this.streamData = null
                      }
                      return Object(a.a)(t, [{
                          key: "marshall",
                          value: function() {
                              var t = new n.a;
                              return t.setUri(r.a.PP2pSliceVideoData),
                              t.pushUInt8(this.checkSum),
                              t.pushUInt16(this.seqNum),
                              t.pushUInt16(this.frameNum),
                              t.pushUInt32(this.frameId),
                              t.pushUInt32(this.config.size),
                              this.config.forEach((function(e, i) {
                                  t.pushUInt8(i),
                                  t.pushUInt32(e)
                              }
                              )),
                              t.pushUint8Array(this.streamData),
                              t.marshall()
                          }
                      }, {
                          key: "unmarshall",
                          value: function(t) {
                              this.checkSum = t.popUInt8(),
                              this.seqNum = t.popUInt16(),
                              this.frameNum = t.popUInt16(),
                              this.frameId = t.popUInt32(),
                              this.config.clear();
                              for (var e = t.popUInt32(), i = 0; i < e; i++) {
                                  var s = t.popUInt8()
                                    , a = t.popUInt32();
                                  this.config.set(s, a)
                              }
                              return this.streamData = t.popUint8Array(),
                              this
                          }
                      }]),
                      t
                  }();
                  e.default = o
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(20)
                    , n = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.strToken = ""
                      }
                      return Object(a.a)(t, [{
                          key: "marshall",
                          value: function() {
                              var t = new r.a(!1);
                              return t.pushString(this.strToken),
                              t.marshall()
                          }
                      }]),
                      t
                  }();
                  e.default = n
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.ip = 0,
                          this.tcpPorts = [],
                          this.udpPorts = []
                      }
                      return Object(a.a)(t, [{
                          key: "unmarshall",
                          value: function(t) {
                              return this.ip = t.popUInt32(),
                              this.tcpPorts = t.popUInt16Vector(),
                              this.udpPorts = t.popUInt16Vector(),
                              this
                          }
                      }]),
                      t
                  }();
                  e.default = r
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e),
                  e.default = {
                      ACCEPT_SUBSCRIBE: 0,
                      EMPTY_UPLINK_BW: 1,
                      DETECT_SUBSCRIBE_CYCLE: 2,
                      EMPTY_PEER_INFO: 3,
                      SUBSCRIBE_UPLINK_NOT_ENOUGH: 4,
                      PUBLISHER_KICK_OFF: 5,
                      NOT_SUBSCRIBER: 6,
                      INVALID_SUB_STREAM: 7,
                      ACCEPT_BY_SUBSCRIBER_UPLINK: 9,
                      INVALID_STREAMID: 10,
                      SERVER_EMPTY_BW: 11,
                      PUBLISHER_LEAVE: 12,
                      DIFFERENT_VIDEO_PROXY: 13,
                      OLD_VERSION_REQ: 14,
                      SUBSCRIBER_NO_PERMISSION: 15
                  }
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.ssrc = 0,
                          this.framenum = 0,
                          this.type = 0,
                          this.framebase = 0,
                          this.critical = !1,
                          this.payload = null,
                          this.transMode = 0,
                          this.packData = !1,
                          this.bHasVideoSid = !1,
                          this.byteVoiceMarks = 0,
                          this.capTimeStamp = 0,
                          this.m_isMarshalVoiceMarks = !1
                      }
                      return Object(a.a)(t, [{
                          key: "unmarshall",
                          value: function(e) {
                              this.capTimeStamp = e.popUInt32(),
                              this.ssrc = e.popUInt8();
                              var i = e.popUInt8();
                              return this.type = e.popUInt16(),
                              this.framebase = e.popUInt32(),
                              this.payload = e.popUint8Array(),
                              e.bytesAvailable() ? this.byteVoiceMarks = e.popUInt8() : this.byteVoiceMarks = t.VOICE_MARK_KEY_BIT0,
                              this.framenum = i & t.FRAMENUM_MASK,
                              this.critical = !!(i & t.CRITICAL_MASK),
                              this.bHasVideoSid = !!(i & t.VIDEOSID_MASK),
                              this.transMode = 1 + ((i & t.FTMMODE_MASK) >> 4),
                              this
                          }
                      }, {
                          key: "setIsKeyVoice",
                          value: function(e) {
                              this.byteVoiceMarks |= e ? t.VOICE_MARK_KEY_BIT0 : 0
                          }
                      }, {
                          key: "isKeyVoice",
                          get: function() {
                              return this.byteVoiceMarks & t.VOICE_MARK_KEY_BIT0
                          }
                      }]),
                      t
                  }();
                  r.FRAMENUM_MASK = 15,
                  r.FTMMODE_MASK = 48,
                  r.VIDEOSID_MASK = 64,
                  r.CRITICAL_MASK = 128,
                  r.VOICE_MARK_KEY_BIT0 = 1,
                  e.default = r
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(20)
                    , n = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.strToken = ""
                      }
                      return Object(a.a)(t, [{
                          key: "marshall",
                          value: function() {
                              var t = new r.a(!1);
                              return t.pushString(this.strToken),
                              t.marshall()
                          }
                      }]),
                      t
                  }();
                  e.default = n
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.systime = 0,
                          this.encode_delay = 0,
                          this.send_buffer = 0
                      }
                      return Object(a.a)(t, [{
                          key: "unmarshall",
                          value: function(t) {
                              this.systime = t.popUInt64(),
                              this.encode_delay = t.popUInt32(),
                              this.send_buffer = t.popUInt32()
                          }
                      }]),
                      t
                  }();
                  e.default = r
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(41)
                    , n = i(42)
                    , o = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.anchorSei = new r.default,
                          this.serverSei = new n.default
                      }
                      return Object(a.a)(t, [{
                          key: "unmarshall",
                          value: function(t) {
                              this.anchorSei.unmarshall(t),
                              this.serverSei.unmarshall(t)
                          }
                      }]),
                      t
                  }();
                  e.default = o
              }
              , function(t, e, i) {
                  function s(t) {
                      var e = {};
                      function i(s) {
                          if (e[s])
                              return e[s].exports;
                          var a = e[s] = {
                              i: s,
                              l: !1,
                              exports: {}
                          };
                          return t[s].call(a.exports, a, a.exports, i),
                          a.l = !0,
                          a.exports
                      }
                      i.m = t,
                      i.c = e,
                      i.i = function(t) {
                          return t
                      }
                      ,
                      i.d = function(t, e, s) {
                          i.o(t, e) || Object.defineProperty(t, e, {
                              configurable: !1,
                              enumerable: !0,
                              get: s
                          })
                      }
                      ,
                      i.r = function(t) {
                          Object.defineProperty(t, "__esModule", {
                              value: !0
                          })
                      }
                      ,
                      i.n = function(t) {
                          var e = t && t.__esModule ? function() {
                              return t.default
                          }
                          : function() {
                              return t
                          }
                          ;
                          return i.d(e, "a", e),
                          e
                      }
                      ,
                      i.o = function(t, e) {
                          return Object.prototype.hasOwnProperty.call(t, e)
                      }
                      ,
                      i.p = "/",
                      i.oe = function(t) {
                          throw console.error(t),
                          t
                      }
                      ;
                      var s = i(i.s = ENTRY_MODULE);
                      return s.default || s
                  }
                  function a(t) {
                      return (t + "").replace(/[.?*+^$[\]\\(){}|-]/g, "\\$&")
                  }
                  function r(t, e, s) {
                      var r = {};
                      r[s] = [];
                      var n = e.toString()
                        , o = n.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);
                      if (!o)
                          return r;
                      for (var h, u = o[1], l = new RegExp("(\\\\n|\\W)" + a(u) + "\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g"); h = l.exec(n); )
                          "dll-reference" !== h[3] && r[s].push(h[3]);
                      for (l = new RegExp("\\(" + a(u) + '\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g"); h = l.exec(n); )
                          t[h[2]] || (r[s].push(h[1]),
                          t[h[2]] = i(h[1]).m),
                          r[h[2]] = r[h[2]] || [],
                          r[h[2]].push(h[4]);
                      for (var c, d = Object.keys(r), p = 0; p < d.length; p++)
                          for (var f = 0; f < r[d[p]].length; f++)
                              c = r[d[p]][f],
                              isNaN(1 * c) || (r[d[p]][f] = 1 * r[d[p]][f]);
                      return r
                  }
                  function n(t) {
                      return Object.keys(t).reduce((function(e, i) {
                          return e || t[i].length > 0
                      }
                      ), !1)
                  }
                  t.exports = function(t, e) {
                      e = e || {};
                      var a = {
                          main: i.m
                      }
                        , o = e.all ? {
                          main: Object.keys(a.main)
                      } : function(t, e) {
                          for (var i = {
                              main: [e]
                          }, s = {
                              main: []
                          }, a = {
                              main: {}
                          }; n(i); )
                              for (var o = Object.keys(i), h = 0; h < o.length; h++) {
                                  var u = o[h]
                                    , l = i[u].pop();
                                  if (a[u] = a[u] || {},
                                  !a[u][l] && t[u][l]) {
                                      a[u][l] = !0,
                                      s[u] = s[u] || [],
                                      s[u].push(l);
                                      for (var c = r(t, t[u][l], u), d = Object.keys(c), p = 0; p < d.length; p++)
                                          i[d[p]] = i[d[p]] || [],
                                          i[d[p]] = i[d[p]].concat(c[d[p]])
                                  }
                              }
                          return s
                      }(a, t)
                        , h = "";
                      Object.keys(o).filter((function(t) {
                          return "main" !== t
                      }
                      )).forEach((function(t) {
                          for (var e = 0; o[t][e]; )
                              e++;
                          o[t].push(e),
                          a[t][e] = "(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",
                          h = h + "var " + t + " = (" + s.toString().replace("ENTRY_MODULE", JSON.stringify(e)) + ")({" + o[t].map((function(e) {
                              return JSON.stringify(e) + ": " + a[t][e].toString()
                          }
                          )).join(",") + "});\n"
                      }
                      )),
                      h = h + "new ((" + s.toString().replace("ENTRY_MODULE", JSON.stringify(t)) + ")({" + o.main.map((function(t) {
                          return JSON.stringify(t) + ": " + a.main[t].toString()
                      }
                      )).join(",") + "}))(self);";
                      var u = new window.Blob([h],{
                          type: "text/javascript"
                      });
                      if (e.bare)
                          return u;
                      var l = (window.URL || window.webkitURL || window.mozURL || window.msURL).createObjectURL(u)
                        , c = new window.Worker(l);
                      return c.objectURL = l,
                      c
                  }
              }
              , function(t, e, i) {
                  t.exports = i(68)
              }
              , function(t, e, i) {
                  var s = {
                      "./ApToken": 56,
                      "./ApToken.js": 56,
                      "./CurrentProxyInfo": 37,
                      "./CurrentProxyInfo.js": 37,
                      "./FuzzyQueryKey": 30,
                      "./FuzzyQueryKey.js": 30,
                      "./FuzzyQueryParam": 38,
                      "./FuzzyQueryParam.js": 38,
                      "./IpInfo": 57,
                      "./IpInfo.js": 57,
                      "./PAudienceGetProxyListReq": 33,
                      "./PAudienceGetProxyListReq.js": 33,
                      "./PAudienceGetProxyListRsp": 39,
                      "./PAudienceGetProxyListRsp.js": 39,
                      "./SlaveProxyInfo": 29,
                      "./SlaveProxyInfo.js": 29,
                      "./StreamAllocateInfo": 40,
                      "./StreamAllocateInfo.js": 40,
                      "./StreamCodecType": 26,
                      "./StreamCodecType.js": 26,
                      "./StreamGroupID": 28,
                      "./StreamGroupID.js": 28,
                      "./StreamType": 32,
                      "./StreamType.js": 32,
                      "./SubscribeResCode": 58,
                      "./SubscribeResCode.js": 58,
                      "./VoiceChatEx": 59,
                      "./VoiceChatEx.js": 59,
                      "./VpToken": 60,
                      "./VpToken.js": 60
                  };
                  function a(t) {
                      var e = r(t);
                      return i(e)
                  }
                  function r(t) {
                      if (!i.o(s, t)) {
                          var e = new Error("Cannot find module '" + t + "'");
                          throw e.code = "MODULE_NOT_FOUND",
                          e
                      }
                      return s[t]
                  }
                  a.keys = function() {
                      return Object.keys(s)
                  }
                  ,
                  a.resolve = r,
                  t.exports = a,
                  a.id = 65
              }
              , function(t, e) {
                  t.exports = function(t) {
                      console.log("[ Timer worker init ]");
                      var e = null;
                      function i() {
                          clearInterval(e),
                          e = null
                      }
                      t.addEventListener("message", (function(s) {
                          switch (s.data) {
                          case "start":
                              i(),
                              e = setInterval((function() {
                                  t.postMessage({})
                              }
                              ), 10);
                              break;
                          case "stop":
                              i()
                          }
                      }
                      )),
                      t.addEventListener("messageerror", (function(t) {
                          console.error("[TimerWorker.messageerror]", t)
                      }
                      ))
                  }
              }
              , function(t, e, i) {
                  var s = {
                      "./AnchorDtsSei": 41,
                      "./AnchorDtsSei.js": 41,
                      "./AnchorSeiInfo": 61,
                      "./AnchorSeiInfo.js": 61,
                      "./HuyaDelaySeiData": 62,
                      "./HuyaDelaySeiData.js": 62,
                      "./ServerDtsSei": 42,
                      "./ServerDtsSei.js": 42,
                      "./ServerNodeInfo": 43,
                      "./ServerNodeInfo.js": 43
                  };
                  function a(t) {
                      var e = r(t);
                      return i(e)
                  }
                  function r(t) {
                      if (!i.o(s, t)) {
                          var e = new Error("Cannot find module '" + t + "'");
                          throw e.code = "MODULE_NOT_FOUND",
                          e
                      }
                      return s[t]
                  }
                  a.keys = function() {
                      return Object.keys(s)
                  }
                  ,
                  a.resolve = r,
                  t.exports = a,
                  a.id = 67
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = i(5)
                    , o = i(4)
                    , u = i(18)
                    , l = i(0)
                    , c = i(6)
                    , d = i(1)
                    , p = function() {
                      function t(e) {
                          var i = e.eventEmiter
                            , a = e.stat;
                          Object(s.a)(this, t),
                          this.eventEmiter = i,
                          this.stat = a,
                          this.isSendLoadTime = !1,
                          this.isSendH265 = !1,
                          this.hasP2P = 0,
                          this.restartReason = -1,
                          this.restartTimes = 0,
                          this.turnToFlvReason = -1,
                          this.turnToFlvTimes = 0,
                          this.httpError = !1,
                          this.busiSource = ""
                      }
                      return Object(a.a)(t, [{
                          key: "sendCdnTime",
                          value: function(t, e, i) {
                              if (!this.isSendLoadTime)
                                  if (this.isSendLoadTime = !0,
                                  e) {
                                      var s = Math.max(0, t.connectVideoTime - t.startTime)
                                        , a = t.firstVideoPkgTime - t.connectVideoTime
                                        , r = t.firstIFrameTime1 - t.connectVideoTime
                                        , n = t.firstIFrameTime2 - t.firstIFrameTime1
                                        , o = t.firstRenderTime - t.firstIFrameTime2
                                        , h = t.onPlayTime - t.firstRenderTime
                                        , u = t.recvDataTime - t.startTime
                                        , l = (t.onPlayTime,
                                      t.startTime,
                                      t.firstP2POnDataTime - t.startTime);
                                      l = l < 0 ? 0 : l;
                                      var c = 0;
                                      t.firstP2PIframeTime > 0 && (c = (c = t.firstP2PIframeTime - t.startTime) < 0 ? 0 : c);
                                      var p = [t.hyPlayerLoadTs, u, s, 0, 0, i, 0, 0, 0, l, c]
                                        , f = [this.stat.createAct(d.a.ACT.CONNECT_VIDEO_TS, {
                                          value: [s]
                                      }), this.stat.createAct(d.a.ACT.FIRST_VIDEO_PKG_TS, {
                                          value: [a]
                                      }), this.stat.createAct(d.a.ACT.FIRST_VIDEO_IFRAME_TS, {
                                          value: [r]
                                      }), this.stat.createAct(d.a.ACT.VIDEO_IFRAME_TS, {
                                          value: [n]
                                      }), this.stat.createAct(d.a.ACT.FIRST_VIDEO_RENDER_TS, {
                                          value: [o]
                                      }), this.stat.createAct(d.a.ACT.VIDEO_PLAYED_TS, {
                                          value: [h]
                                      }), this.stat.createAct(d.a.ACT.VIDEO_LOAD_TS, {
                                          value: p
                                      })];
                                      this.sendMetrics(f)
                                  } else {
                                      var _ = t.getVPTime - t.startTime
                                        , m = Math.max(0, t.connectVideoTime - t.getVPTime)
                                        , v = t.loginTime - t.connectVideoTime
                                        , y = t.firstVideoPkgTime - t.loginTime
                                        , T = t.firstIFrameTime - t.firstVideoPkgTime
                                        , g = t.firstRenderTime - t.firstIFrameTime
                                        , S = t.onPlayTime - t.firstRenderTime
                                        , P = t.onPlayTime - t.startTime
                                        , E = [this.stat.createAct(d.a.ACT.VIDEO_GET_VP_TS, {
                                          value: [_]
                                      }), this.stat.createAct(d.a.ACT.CONNECT_VIDEO_TS, {
                                          value: [m]
                                      }), this.stat.createAct(d.a.ACT.VIDEO_LOGIN_TS, {
                                          value: [v]
                                      }), this.stat.createAct(d.a.ACT.FIRST_VIDEO_PKG_TS, {
                                          value: [y]
                                      }), this.stat.createAct(d.a.ACT.FIRST_VIDEO_IFRAME_TS, {
                                          value: [T]
                                      }), this.stat.createAct(d.a.ACT.FIRST_VIDEO_RENDER_TS, {
                                          value: [g]
                                      }), this.stat.createAct(d.a.ACT.VIDEO_PLAYED_TS, {
                                          value: [S]
                                      }), this.stat.createAct(d.a.ACT.VIDEO_LOAD_TS, {
                                          value: [P]
                                      })];
                                      this.sendMetrics(E)
                                  }
                          }
                      }, {
                          key: "sendFlvTime",
                          value: function(t, e, i, s) {
                              var a = arguments.length > 4 && void 0 !== arguments[4] && arguments[4]
                                , r = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : 0
                                , n = arguments.length > 6 && void 0 !== arguments[6] ? arguments[6] : 0
                                , o = arguments.length > 7 && void 0 !== arguments[7] ? arguments[7] : 0
                                , h = arguments.length > 8 && void 0 !== arguments[8] ? arguments[8] : 0
                                , u = arguments.length > 9 && void 0 !== arguments[9] ? arguments[9] : 0;
                              if ((!this.isSendLoadTime || a) && (this.isSendLoadTime = !0,
                              !(t > 1e4 || e > 1e4))) {
                                  var l = 0;
                                  n && (l += 1),
                                  r && (l += 2),
                                  this.stat.setComDim(d.a.DIM_COM.ACT_LOAD_TYPE, l);
                                  var c = [t, i, e, r, n, o, 0, 0, 0, h, u]
                                    , p = [this.stat.createAct(d.a.ACT.VIDEO_LOAD_TS, {
                                      value: c
                                  }), this.stat.createAct(d.a.ACT.CONNECT_VIDEO_TS, {
                                      value: [e]
                                  }), this.stat.createAct(d.a.ACT.RECV_VIDEO_TS, {
                                      value: [i, s]
                                  })];
                                  this.sendMetrics(p)
                              }
                          }
                      }, {
                          key: "sendWebRtcTime",
                          value: function(t, e, i, s, a) {
                              this.isSendLoadTime = !0,
                              this.stat.setActDim("p2p", "3");
                              var r = [this.stat.createAct(d.a.ACT.VIDEO_LOAD_TS, {
                                  value: [t, 0, 0, 0, 0, e, i, s, a]
                              })];
                              this.sendMetrics(r)
                          }
                      }, {
                          key: "sendHlsTime",
                          value: function(t, e, i, s, a, r) {
                              var n = arguments.length > 6 && void 0 !== arguments[6] ? arguments[6] : 0
                                , o = arguments.length > 7 && void 0 !== arguments[7] ? arguments[7] : 0;
                              if (!this.isSendLoadTime) {
                                  var h = 0;
                                  if (o && (h += 1),
                                  n && (h += 2),
                                  this.stat.setComDim(d.a.DIM_COM.ACT_LOAD_TYPE, h),
                                  this.isSendLoadTime = !0,
                                  !(e > 1e4 || i > 1e4 || a > 1e4)) {
                                      var u = [this.stat.createAct(d.a.ACT.VIDEO_LOAD_TS, {
                                          value: [e, t, 0, n, o],
                                          str: [this.busiSource]
                                      }), this.stat.createAct(d.a.ACT.LOAD_M3U8_TS, {
                                          value: [i, t]
                                      }), this.stat.createAct(d.a.ACT.FIRST_FRAG_LOAD_TS, {
                                          value: [s, t]
                                      }), this.stat.createAct(d.a.ACT.FIRST_FRAG_LOADED_TS, {
                                          value: [a, t]
                                      }), this.stat.createAct(d.a.ACT.FIRST_FRAG_SIZE, {
                                          value: [r, t]
                                      })];
                                      this.sendMetrics(u)
                                  }
                              }
                          }
                      }, {
                          key: "setBusiSource",
                          value: function(t) {
                              this.busiSource = t
                          }
                      }, {
                          key: "sendMP4Time",
                          value: function() {
                              var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}
                                , e = t.loadTime;
                              if (!(e > 1e4)) {
                                  var i = [this.stat.createAct(d.a.ACT.VIDEO_LOAD_TS, {
                                      value: [e],
                                      str: [this.busiSource]
                                  })];
                                  this.sendMetrics(i)
                              }
                          }
                      }, {
                          key: "sendMetrics",
                          value: function(t) {
                              this.eventEmiter.trigger(r.c.DATA_METRIC2, t)
                          }
                      }, {
                          key: "sendOldMetrics",
                          value: function(t) {
                              this.eventEmiter.trigger(r.c.DATA_METRIC, t)
                          }
                      }]),
                      t
                  }();
                  p.METRIC = {
                      VIDEO_FLOW_LINE: "video.flow.line",
                      VIDEO_FLOW_P2P: "video.flow.p2p",
                      VIDEO_BAD_QUALITY_RATIO: "video.video_bad_quality_ratio",
                      WEB_HLS_PLAY_VIDEO_RATIO: "web.hls.play_video_ratio",
                      WEB_HLS_PLAY_SUC_RATIO: "web.hls.play_suc_ratio",
                      WEB_P2P_PLAY_RATIO: "web.p2p.play_ratio",
                      WEB_P2P_PUNCH: "web.p2p.punch",
                      WEB_P2P_BW_P2P_VALID: "web.p2p.bw_p2p_valid",
                      WEB_P2P_BW_P2P_REPEAT: "web.p2p.bw_p2p_repeat",
                      WEB_P2P_BW_P2P_TOTAL: "web.p2p.bw_p2p_total",
                      WEB_P2P_BW_CDN_VALID: "web.p2p.bw_cdn_valid",
                      WEB_P2P_BW_CDN_REPEAT: "web.p2p.bw_cdn_repeat",
                      WEB_P2P_BW_CDN_TOTAL: "web.p2p.bw_cdn_total",
                      WEB_P2P_BW_RANGE_VALID: "web.p2p.bw_range_valid",
                      WEB_P2P_BW_RANGE_TOTAL: "web.p2p.bw_range_total",
                      WEB_P2P_PLAY_FAIL: "web.p2p.play_fail",
                      WEB_P2P_LOAD_RATIO: "web.p2p.load_ratio",
                      WEB_P2P_CDN_RESTART: "web.p2p.cdn_restart",
                      WEB_P2P_TCP_NO_SLICE: "web.p2p.tcp_no_slice",
                      WEB_P2P_TCP_OPEN_TIME: "web.p2p.tcp_open_time",
                      WEB_P2P_HTTP_CODE: "web.p2p.http_code_",
                      WEB_P2P_TCP_TIMEOUT: "web.p2p.tcp_timeout",
                      WEB_H265: "web.h265",
                      SDK_P2P_TCP: "sdk.p2p.tcp",
                      SDK_VIDEO_LOGIN_SUC: "sdk.video.login_suc",
                      SDK_P2P_COOLING: "sdk.p2p.cooling",
                      SDK_P2P_SERVER_OPEN: "sdk.p2p.server_open",
                      SDK_P2P_USER_PROPERTY: "sdk.p2p.user_property",
                      VIDEO_VIDEO_BAD_QUALITY_5M_RATIO: "video.video_bad_quality_5m_ratio",
                      VIDEO_VIDEO_LOAD_ERROR: "video_load_error",
                      RECV_DANMU_CARTON: "recv_danmu_carton",
                      SDK_P2P_DETAILS: "sdk.p2p.details",
                      SDK_P2P_FORCE_REASON: "sdk.p2p.force_reason",
                      SDK_P2P_DEFAULT_REASON: "sdk.p2p.default_reason",
                      SDK_P2P_VALID_RET: "sdk.p2p.valid_ret",
                      SDK_P2P_GET_NODE: "sdk.p2p.get_node",
                      WEB_USER: "web.user"
                  },
                  p.INTERVAL = {
                      SDK_VIDEO_QUALITY: "sdk.video.quality",
                      SDK_VIDEO_QUALITY_5M: "sdk.video.quality_5m",
                      SDK_CALC_FLOW: "sdk.calc.flow",
                      SDK_P2P_TCP: "sdk.p2p.tcp",
                      SDK_P2P_FLOW: "sdk.p2p.flow",
                      SDK_P2P_PUNCH: "sdk.p2p.punch",
                      SDK_P2P_SUB: "sdk.p2p.sub",
                      SDK_P2P_RESEND: "sdk.p2p.resend",
                      SDK_P2P_DELAY: "sdk.p2p.resend",
                      SDK_P2P_OTHER: "sdk.p2p.other"
                  },
                  p.TRIGGER = {
                      SDK_HLS_PLAY: "sdk.hls.play",
                      SDK_HLS_LOAD: "sdk.hls.load",
                      SDK_MSE_ERROR: "sdk.mse.error",
                      SDK_P2P_LOAD: "sdk.p2p.load",
                      SDK_P2P_LOAD_SAMPLE: "sdk.p2p.load_sample",
                      SDK_P2P_RESTART: "sdk.p2p.restart",
                      SDK_WEB_H265: "sdk.web.h265"
                  };
                  var f = p
                    , _ = i(12)
                    , m = i(17)
                    , v = i(9)
                    , y = function() {
                      function t() {
                          var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 10;
                          Object(s.a)(this, t),
                          this.maxSize = e,
                          this.sum = 0,
                          this.list = [],
                          this.idx = 0,
                          this.cur = 0
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              this.sum = 0,
                              this.list = [],
                              this.idx = 0,
                              this.cur = 0
                          }
                      }, {
                          key: "addCur",
                          value: function(t) {
                              this.cur += t
                          }
                      }, {
                          key: "calculate",
                          value: function() {
                              this.add(this.cur);
                              var t = this.cur;
                              return this.cur = 0,
                              t
                          }
                      }, {
                          key: "add",
                          value: function(t) {
                              this.sum += t,
                              this.list.length < this.maxSize ? this.list.push(t) : (this.sum -= this.list[this.idx],
                              this.list[this.idx] = t),
                              this.idx++,
                              this.idx >= this.maxSize && (this.idx = 0)
                          }
                      }, {
                          key: "average",
                          value: function() {
                              return 0 === this.list.length ? v.b.UintMax : Math.round(this.sum / this.list.length)
                          }
                      }, {
                          key: "getSamples",
                          value: function() {
                              return this.list
                          }
                      }, {
                          key: "max",
                          value: function() {
                              if (0 === this.list.length)
                                  return v.b.UintMax;
                              var t, e = 0, i = Object(m.a)(this.list);
                              try {
                                  for (i.s(); !(t = i.n()).done; ) {
                                      var s = t.value;
                                      s > e && (e = s)
                                  }
                              } catch (t) {
                                  i.e(t)
                              } finally {
                                  i.f()
                              }
                              return e
                          }
                      }, {
                          key: "min",
                          value: function() {
                              var t, e = v.b.UintMax, i = Object(m.a)(this.list);
                              try {
                                  for (i.s(); !(t = i.n()).done; ) {
                                      var s = t.value;
                                      s < e && (e = s)
                                  }
                              } catch (t) {
                                  i.e(t)
                              } finally {
                                  i.f()
                              }
                              return e
                          }
                      }]),
                      t
                  }()
                    , T = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.speed = new y(20),
                          this.rtt = new y(20),
                          this.p2p = 0
                      }
                      return Object(a.a)(t, [{
                          key: "addSpeed",
                          value: function(t) {
                              var e = parseInt(t.replace("KB", ""));
                              this.speed.add(e)
                          }
                      }, {
                          key: "addRtt",
                          value: function(t) {
                              this.rtt.add(t)
                          }
                      }, {
                          key: "setP2p",
                          value: function(t) {
                              this.p2p = t
                          }
                      }, {
                          key: "getP2p",
                          value: function() {
                              return this.p2p
                          }
                      }, {
                          key: "getResult",
                          value: function() {
                              return {
                                  speed: this.speed.getSamples(),
                                  rtt: this.rtt.getSamples(),
                                  p2p: this.p2p
                              }
                          }
                      }]),
                      t
                  }()
                    , g = i(16)
                    , S = i(11);
                  function P(t, e) {
                      for (; !Object.prototype.hasOwnProperty.call(t, e) && null !== (t = Object(S.a)(t)); )
                          ;
                      return t
                  }
                  function E(t, e, i) {
                      return (E = "undefined" != typeof Reflect && Reflect.get ? Reflect.get : function(t, e, i) {
                          var s = P(t, e);
                          if (s) {
                              var a = Object.getOwnPropertyDescriptor(s, e);
                              return a.get ? a.get.call(i) : a.value
                          }
                      }
                      )(t, e, i || t)
                  }
                  var I = i(14)
                    , A = i(13)
                    , C = i(7)
                    , k = i(8)
                    , b = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.fpsIndex = 0,
                          this.fpsArr = [],
                          this.fpsMap = new Map,
                          this.started = !1,
                          this.recvFps = new y(20),
                          this.perSecondIndex = 0,
                          this.perSecondArr = [],
                          this.perSecondMap = new Map
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              this.fpsArr = [],
                              this.fpsMap.clear(),
                              this.started = !1,
                              this.recvFps.reset(),
                              k.a.remove(this.onFrameTimer, this),
                              this.perSecondIndex = 0,
                              this.perSecondArr = [],
                              this.perSecondMap.clear()
                          }
                      }, {
                          key: "onFrameTimer",
                          value: function(t, e) {
                              this.recvFps.calculate()
                          }
                      }, {
                          key: "addDts",
                          value: function(t) {
                              var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;
                              this.recvFps.addCur(1),
                              this.started || (this.started = !0,
                              k.a.add(this.onFrameTimer, this, 1e3));
                              var i = parseInt(t / 1e3);
                              if (this.fpsMap.has(i))
                                  this.fpsMap.set(i, this.fpsMap.get(i) + 1);
                              else {
                                  this.fpsIndex >= 10 && (this.fpsIndex = 0);
                                  var s = this.fpsArr[this.fpsIndex];
                                  this.fpsMap.delete(s),
                                  this.fpsArr[this.fpsIndex] = i,
                                  this.fpsMap.set(i, 1),
                                  this.fpsIndex++
                              }
                              e && this.addDataSize(i, e)
                          }
                      }, {
                          key: "getRecvFps",
                          value: function() {
                              var t = this.recvFps.average();
                              return t === v.b.UintMax ? 0 : t
                          }
                      }, {
                          key: "getFps",
                          value: function() {
                              if (this.fpsArr.length > 1) {
                                  var e = this.fpsArr[1]
                                    , i = this.fpsMap.get(e)
                                    , s = 0
                                    , a = i;
                                  return t.FIXED_FPS.forEach((function(t) {
                                      var e = t > i ? t - i : i - t;
                                      e < 3 && (0 === s || e < s) && (s = e,
                                      a = t)
                                  }
                                  )),
                                  a
                              }
                              return 0
                          }
                      }, {
                          key: "addDataSize",
                          value: function(t, e) {
                              if (this.perSecondMap.has(t))
                                  this.perSecondMap.set(t, this.perSecondMap.get(t) + e);
                              else {
                                  this.perSecondIndex >= 10 && (this.perSecondIndex = 0);
                                  var i = this.perSecondArr[this.perSecondIndex];
                                  this.perSecondMap.delete(i),
                                  this.perSecondArr[this.perSecondIndex] = t,
                                  this.perSecondMap.set(t, e),
                                  this.perSecondIndex++
                              }
                          }
                      }, {
                          key: "getRealBitrate",
                          value: function() {
                              var t = 0
                                , e = this.perSecondArr.length;
                              if (e > 1) {
                                  var i = this.perSecondArr[e - 2];
                                  t = this.perSecondMap.get(i)
                              }
                              return parseInt(8 * t / 1e3)
                          }
                      }]),
                      t
                  }();
                  b.FIXED_FPS = [0, 15, 20, 24, 30, 40, 48, 60];
                  var R = b
                    , L = function() {
                      function t() {
                          Object(s.a)(this, t)
                      }
                      return Object(a.a)(t, null, [{
                          key: "init",
                          value: function() {
                              var e;
                              for (e in t.types = {
                                  av01: [],
                                  av1C: [],
                                  avc1: [],
                                  avcC: [],
                                  hvc1: [],
                                  hvcC: [],
                                  btrt: [],
                                  dinf: [],
                                  dref: [],
                                  esds: [],
                                  ftyp: [],
                                  hdlr: [],
                                  mdat: [],
                                  mdhd: [],
                                  mdia: [],
                                  mfhd: [],
                                  minf: [],
                                  moof: [],
                                  moov: [],
                                  mp4a: [],
                                  mvex: [],
                                  mvhd: [],
                                  sdtp: [],
                                  stbl: [],
                                  stco: [],
                                  stsc: [],
                                  stsd: [],
                                  stsz: [],
                                  stts: [],
                                  tfdt: [],
                                  tfhd: [],
                                  traf: [],
                                  trak: [],
                                  trun: [],
                                  trex: [],
                                  tkhd: [],
                                  vmhd: [],
                                  smhd: []
                              },
                              t.types)
                                  t.types.hasOwnProperty(e) && (t.types[e] = [e.charCodeAt(0), e.charCodeAt(1), e.charCodeAt(2), e.charCodeAt(3)]);
                              var i = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 118, 105, 100, 101, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 86, 105, 100, 101, 111, 72, 97, 110, 100, 108, 101, 114, 0])
                                , s = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 115, 111, 117, 110, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 83, 111, 117, 110, 100, 72, 97, 110, 100, 108, 101, 114, 0]);
                              t.HDLR_TYPES = {
                                  video: i,
                                  audio: s
                              };
                              var a = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 12, 117, 114, 108, 32, 0, 0, 0, 1])
                                , r = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]);
                              t.STTS = t.STSC = t.STCO = r,
                              t.STSZ = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]),
                              t.VMHD = new Uint8Array([0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0]),
                              t.SMHD = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 0]),
                              t.STSD = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1]);
                              var n = new Uint8Array([105, 115, 111, 109])
                                , o = new Uint8Array([97, 118, 99, 49])
                                , h = new Uint8Array([0, 0, 0, 1]);
                              t.FTYP = t.box(t.types.ftyp, n, h, n, o),
                              t.DINF = t.box(t.types.dinf, t.box(t.types.dref, a))
                          }
                      }, {
                          key: "box",
                          value: function(t) {
                              for (var e, i = Array.prototype.slice.call(arguments, 1), s = 8, a = i.length, r = a; a--; )
                                  s += i[a].byteLength;
                              for ((e = new Uint8Array(s))[0] = s >> 24 & 255,
                              e[1] = s >> 16 & 255,
                              e[2] = s >> 8 & 255,
                              e[3] = 255 & s,
                              e.set(t, 4),
                              a = 0,
                              s = 8; a < r; a++)
                                  e.set(i[a], s),
                                  s += i[a].byteLength;
                              return e
                          }
                      }, {
                          key: "hdlr",
                          value: function(e) {
                              return t.box(t.types.hdlr, t.HDLR_TYPES[e])
                          }
                      }, {
                          key: "mdat",
                          value: function(e) {
                              return t.box(t.types.mdat, e)
                          }
                      }, {
                          key: "mdhd",
                          value: function(e, i) {
                              return t.box(t.types.mdhd, new Uint8Array([0, 0, 0, 0, 0, 0, 0, 2, 0, 0, 0, 3, e >> 24 & 255, e >> 16 & 255, e >> 8 & 255, 255 & e, i >> 24, i >> 16 & 255, i >> 8 & 255, 255 & i, 85, 196, 0, 0]))
                          }
                      }, {
                          key: "mdia",
                          value: function(e) {
                              return t.box(t.types.mdia, t.mdhd(e.timescale, e.duration), t.hdlr(e.type), t.minf(e))
                          }
                      }, {
                          key: "mfhd",
                          value: function(e) {
                              return t.box(t.types.mfhd, new Uint8Array([0, 0, 0, 0, e >> 24, e >> 16 & 255, e >> 8 & 255, 255 & e]))
                          }
                      }, {
                          key: "minf",
                          value: function(e) {
                              return "audio" === e.type ? t.box(t.types.minf, t.box(t.types.smhd, t.SMHD), t.DINF, t.stbl(e)) : t.box(t.types.minf, t.box(t.types.vmhd, t.VMHD), t.DINF, t.stbl(e))
                          }
                      }, {
                          key: "moof",
                          value: function(e, i, s) {
                              return t.box(t.types.moof, t.mfhd(e), t.traf(s, i))
                          }
                      }, {
                          key: "moov",
                          value: function(e) {
                              for (var i = e.length, s = []; i--; )
                                  s[i] = t.trak(e[i]);
                              return t.box.apply(null, [t.types.moov, t.mvhd(e[0].timescale, e[0].duration)].concat(s).concat(t.mvex(e)))
                          }
                      }, {
                          key: "mvex",
                          value: function(e) {
                              for (var i = e.length, s = []; i--; )
                                  s[i] = t.trex(e[i]);
                              return t.box.apply(null, [t.types.mvex].concat(s))
                          }
                      }, {
                          key: "mvhd",
                          value: function(e, i) {
                              var s = new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 2, e >> 24 & 255, e >> 16 & 255, e >> 8 & 255, 255 & e, i >> 24 & 255, i >> 16 & 255, i >> 8 & 255, 255 & i, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 255, 255, 255, 255]);
                              return t.box(t.types.mvhd, s)
                          }
                      }, {
                          key: "sdtp",
                          value: function(e) {
                              var i, s, a = e.samples || [], r = new Uint8Array(4 + a.length);
                              for (s = 0; s < a.length; s++)
                                  i = a[s].flags,
                                  r[s + 4] = i.dependsOn << 4 | i.isDependedOn << 2 | i.hasRedundancy;
                              return t.box(t.types.sdtp, r)
                          }
                      }, {
                          key: "stbl",
                          value: function(e) {
                              return t.box(t.types.stbl, t.stsd(e), t.box(t.types.stts, t.STTS), t.box(t.types.stsc, t.STSC), t.box(t.types.stsz, t.STSZ), t.box(t.types.stco, t.STCO))
                          }
                      }, {
                          key: "av01",
                          value: function(e) {
                              var i = e.bytes
                                , s = e.width
                                , a = e.height;
                              return t.box(t.types.av01, new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, s >> 8 & 255, 255 & s, a >> 8 & 255, 255 & a, 0, 72, 0, 0, 0, 72, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24, 255, 255]), t.box(t.types.av1C, i))
                          }
                      }, {
                          key: "avc1",
                          value: function(e) {
                              var i, s, a, r = [], n = [];
                              for (i = 0; i < e.sps.length; i++)
                                  a = (s = e.sps[i]).byteLength,
                                  r.push(a >>> 8 & 255),
                                  r.push(255 & a),
                                  r = r.concat(Array.prototype.slice.call(s));
                              for (i = 0; i < e.pps.length; i++)
                                  a = (s = e.pps[i]).byteLength,
                                  n.push(a >>> 8 & 255),
                                  n.push(255 & a),
                                  n = n.concat(Array.prototype.slice.call(s));
                              var o = t.box(t.types.avcC, new Uint8Array([1, r[3], r[4], r[5], 255, 224 | e.sps.length].concat(r).concat([e.pps.length]).concat(n)))
                                , h = e.width
                                , u = e.height;
                              return t.box(t.types.avc1, new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, h >> 8 & 255, 255 & h, u >> 8 & 255, 255 & u, 0, 72, 0, 0, 0, 72, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24, 255, 255]), o, t.box(t.types.btrt, new Uint8Array([0, 28, 156, 128, 0, 45, 198, 192, 0, 45, 198, 192])))
                          }
                      }, {
                          key: "hvc1",
                          value: function(e) {
                              var i, s, a, r = [], n = [], o = [];
                              for (r.push(161),
                              r.push(e.vps.length >>> 8 & 255),
                              r.push(255 & e.vps.length),
                              i = 0; i < e.vps.length; i++)
                                  a = (s = e.vps[i]).byteLength,
                                  r.push(a >>> 8 & 255),
                                  r.push(255 & a),
                                  r = r.concat(Array.prototype.slice.call(s));
                              for (n.push(162),
                              n.push(e.sps.length >>> 8 & 255),
                              n.push(255 & e.sps.length),
                              i = 0; i < e.sps.length; i++)
                                  a = (s = e.sps[i]).byteLength,
                                  n.push(a >>> 8 & 255),
                                  n.push(255 & a),
                                  n = n.concat(Array.prototype.slice.call(s));
                              var h = []
                                , u = 0;
                              for (i = 0; i < n.length; )
                                  s = n[i],
                                  2 !== u || 3 !== s ? (0 === s ? u++ : u = 0,
                                  h.push(s),
                                  ++i) : (++i,
                                  u = 0);
                              for (o.push(163),
                              o.push(e.pps.length >>> 8 & 255),
                              o.push(255 & e.pps.length),
                              i = 0; i < e.pps.length; i++)
                                  a = (s = e.pps[i]).byteLength,
                                  o.push(a >>> 8 & 255),
                                  o.push(255 & a),
                                  o = o.concat(Array.prototype.slice.call(s));
                              var l = t.box(t.types.hvcC, new Uint8Array([1, h[8], h[9], h[10], h[11], h[12], h[13], h[14], h[15], h[16], h[17], h[18], h[19], 240, 0, 255, 253, 248, 248, 0, 0, 15].concat([3]).concat(r).concat(n).concat(o)))
                                , c = e.width
                                , d = e.height;
                              return t.box(t.types.hvc1, new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, c >> 8 & 255, 255 & c, d >> 8 & 255, 255 & d, 0, 72, 0, 0, 0, 72, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 24, 255, 255]), l, t.box(t.types.btrt, new Uint8Array([0, 28, 156, 128, 0, 45, 198, 192, 0, 45, 198, 192])))
                          }
                      }, {
                          key: "esds",
                          value: function(t) {
                              var e = t.config.length;
                              return new Uint8Array([0, 0, 0, 0, 3, 23 + e, 0, 1, 0, 4, 15 + e, 64, 21, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 5].concat([e]).concat(t.config).concat([6, 1, 2]))
                          }
                      }, {
                          key: "mp4a",
                          value: function(e) {
                              var i = e.audiosamplerate;
                              return t.box(t.types.mp4a, new Uint8Array([0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, e.channelCount, 0, 16, 0, 0, 0, 0, i >> 8 & 255, 255 & i, 0, 0]), t.box(t.types.esds, t.esds(e)))
                          }
                      }, {
                          key: "stsd",
                          value: function(e) {
                              return "audio" === e.type ? t.box(t.types.stsd, t.STSD, t.mp4a(e)) : e.isHevc ? t.box(t.types.stsd, t.STSD, t.hvc1(e)) : e.isAV01 ? t.box(t.types.stsd, t.STSD, t.av01(e)) : t.box(t.types.stsd, t.STSD, t.avc1(e))
                          }
                      }, {
                          key: "tkhd",
                          value: function(e) {
                              var i = e.id
                                , s = e.duration
                                , a = e.width
                                , r = e.height;
                              return t.box(t.types.tkhd, new Uint8Array([0, 0, 0, 7, 0, 0, 0, 0, 0, 0, 0, 0, i >> 24 & 255, i >> 16 & 255, i >> 8 & 255, 255 & i, 0, 0, 0, 0, s >> 24, s >> 16 & 255, s >> 8 & 255, 255 & s, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 64, 0, 0, 0, a >> 8 & 255, 255 & a, 0, 0, r >> 8 & 255, 255 & r, 0, 0]))
                          }
                      }, {
                          key: "traf",
                          value: function(e, i) {
                              var s = t.sdtp(e)
                                , a = e.id;
                              return t.box(t.types.traf, t.box(t.types.tfhd, new Uint8Array([0, 0, 0, 0, a >> 24, a >> 16 & 255, a >> 8 & 255, 255 & a])), t.box(t.types.tfdt, new Uint8Array([0, 0, 0, 0, i >> 24, i >> 16 & 255, i >> 8 & 255, 255 & i])), t.trun(e, s.length + 16 + 16 + 8 + 16 + 8 + 8), s)
                          }
                      }, {
                          key: "trak",
                          value: function(e) {
                              return e.duration = e.duration || 4294967295,
                              t.box(t.types.trak, t.tkhd(e), t.mdia(e))
                          }
                      }, {
                          key: "trex",
                          value: function(e) {
                              var i = e.id;
                              return t.box(t.types.trex, new Uint8Array([0, 0, 0, 0, i >> 24, i >> 16 & 255, i >> 8 & 255, 255 & i, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1]))
                          }
                      }, {
                          key: "trun",
                          value: function(e, i) {
                              var s, a, r, n, o, h, u = e.samples || [], l = u.length, c = 12 + 16 * l, d = new Uint8Array(c);
                              for (i += 8 + c,
                              d.set([0, 0, 15, 1, l >>> 24 & 255, l >>> 16 & 255, l >>> 8 & 255, 255 & l, i >>> 24 & 255, i >>> 16 & 255, i >>> 8 & 255, 255 & i], 0),
                              s = 0; s < l; s++)
                                  r = (a = u[s]).duration,
                                  n = a.size,
                                  o = a.flags,
                                  h = a.cts,
                                  d.set([r >>> 24 & 255, r >>> 16 & 255, r >>> 8 & 255, 255 & r, n >>> 24 & 255, n >>> 16 & 255, n >>> 8 & 255, 255 & n, o.isLeading << 2 | o.dependsOn, o.isDependedOn << 6 | o.hasRedundancy << 4 | o.paddingValue << 1 | o.isNonSync, 61440 & o.degradPrio, 15 & o.degradPrio, h >>> 24 & 255, h >>> 16 & 255, h >>> 8 & 255, 255 & h], 12 + 16 * s);
                              return t.box(t.types.trun, d)
                          }
                      }, {
                          key: "initSegment",
                          value: function(e) {
                              t.types || t.init();
                              var i, s = t.moov(e);
                              return (i = new Uint8Array(t.FTYP.byteLength + s.byteLength)).set(t.FTYP),
                              i.set(s, t.FTYP.byteLength),
                              i
                          }
                      }]),
                      t
                  }()
                    , w = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.mse = e,
                          this.audioISGenerated = !1,
                          this.videoISGenerated = !1,
                          this.PES2MP4SCALEFACTOR = 1,
                          this.PES_TIMESCALE = 9e4,
                          this.MP4_TIMESCALE = this.PES_TIMESCALE / this.PES2MP4SCALEFACTOR,
                          this._forceFirstIDR = !(!_.a.chrome || !(_.a.version.major < 50 || 50 === _.a.version.major && _.a.version.build < 2661))
                      }
                      return Object(a.a)(t, [{
                          key: "destroy",
                          value: function() {
                              this.reset()
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              this.insertDiscontinuity(),
                              this.switchLevel()
                          }
                      }, {
                          key: "insertDiscontinuity",
                          value: function() {
                              this._initPTS = this._initDTS = this.nextAacPts = this.nextAvcDts = void 0
                          }
                      }, {
                          key: "getInitDts",
                          value: function() {
                              return void 0 !== this._initDTS ? this._initDTS / 90 : void 0
                          }
                      }, {
                          key: "switchLevel",
                          value: function() {
                              var t = !(arguments.length > 0 && void 0 !== arguments[0]) || arguments[0]
                                , e = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1];
                              l.a.log("mp4-remuxer.switchLevel"),
                              t && (this.videoISGenerated = !1),
                              e && (this.audioISGenerated = !1)
                          }
                      }, {
                          key: "remux",
                          value: function(t, e, i, s) {
                              Number(localStorage._printMp4Remux) && l.a.debug("\n### Audio", t, "\n### Video", e),
                              this.audioISGenerated || this.generateAudioIS(t, i),
                              this.videoISGenerated || this.isWebglRender || this.generateVideoIS(e, i),
                              this.initTs(t, e, i),
                              e.samples.length && (this.isWebglRender ? this.renderVideo(e, s) : this.remuxVideo(e, s)),
                              t.samples.length && this.remuxAudio(t, s),
                              this.mse.onFragParsed()
                          }
                      }, {
                          key: "initTs",
                          value: function(t, e, i) {
                              if (null == this._initPTS) {
                                  var s = t.samples
                                    , a = e.samples
                                    , r = s.length
                                    , n = a.length
                                    , o = this.PES_TIMESCALE;
                                  0 === r && 0 === n ? l.a.warn("mp4-remuxer.initTs have no nbAudio&nbVideo") : 0 === n ? (this._initPTS = s[0].pts - o * i,
                                  this._initDTS = s[0].dts - o * i) : 0 === r ? (this._initPTS = a[0].pts - o * i,
                                  this._initDTS = a[0].dts - o * i) : (this._initPTS = Math.min(a[0].pts, s[0].pts) - o * i,
                                  this._initDTS = Math.min(a[0].dts, s[0].dts) - o * i),
                                  l.a.log("mp4-remuxer initDTS/initPTS=[".concat(this._initDTS, ", ").concat(this._initPTS, "]"))
                              }
                          }
                      }, {
                          key: "generateAudioIS",
                          value: function(t, e) {
                              if (t.config) {
                                  var i = {
                                      audioMoov: L.initSegment([t]),
                                      audioCodec: t.codec,
                                      audioChannelCount: t.channelCount
                                  };
                                  this.mse.onInitSegment(i),
                                  this.audioISGenerated = !0
                              }
                          }
                      }, {
                          key: "generateVideoIS",
                          value: function(t, e) {
                              if (t.isAV01 || t.sps && t.pps) {
                                  var i = {
                                      videoMoov: L.initSegment([t]),
                                      videoCodec: t.isAV01 ? t.codec : "avc1.640033",
                                      videoWidth: 1280,
                                      videoHeight: 720
                                  };
                                  this.mse.onInitSegment(i),
                                  this.videoISGenerated = !0
                              }
                          }
                      }, {
                          key: "remuxVideo",
                          value: function(t, e) {
                              var i, s, a, r, n, o, h, u, c, d, p, f, _, m, v = 8, y = this.PES2MP4SCALEFACTOR, T = [], g = t.isAV01 ? 0 : 4 * t.naluCnt;
                              for (h = new Uint8Array(t.len + g + 8),
                              (i = new DataView(h.buffer)).setUint32(0, h.byteLength),
                              h.set(L.types.mdat, 4); t.samples.length; ) {
                                  for (a = t.samples.shift(),
                                  n = 0; a.units.length; )
                                      s = (o = a.units.shift()).data.byteLength,
                                      "av01" != a.type && (i.setUint32(v, s),
                                      v += 4,
                                      n += 4),
                                      h.set(o.data, v),
                                      v += s,
                                      n += s;
                                  if (p = a.pts - this._initDTS,
                                  ((f = a.dts - this._initDTS) < 0 || p < 0) && l.a.log("warn"),
                                  void 0 !== d)
                                      _ = this._PTSNormalize(p, d),
                                      m = this._PTSNormalize(f, d),
                                      r.duration = (m - d) / y,
                                      r.duration < 0 && (Number(localStorage._printMp4RemuxVideo) && l.a.warn("mp4-remuxer.remuxVideo invalid sample duration at pts=" + a.pts / 90 + " dts=" + a.dts / 90 + " duration=" + r.duration / 90),
                                      r.duration = 0,
                                      m = d);
                                  else {
                                      var S, P = this.nextAvcDts || f;
                                      _ = this._PTSNormalize(p, P),
                                      m = this._PTSNormalize(f, P),
                                      S = Math.round((m - P) / 90),
                                      (e || Math.abs(S) < 600) && S && (S > 1 && Number(localStorage._printMp4RemuxVideo) ? l.a.warn("mp4-remuxer.remuxVideo hole=" + S + " filling it") : S < -1 && Number(localStorage._printMp4RemuxVideo) && l.a.warn("mp4-remuxer.remuxVideo overlapping=" + -S + " detected"),
                                      m = P,
                                      _ = Math.max(_ - S, m)),
                                      Math.max(0, _),
                                      c = Math.max(0, m)
                                  }
                                  var E = a.key;
                                  r = {
                                      size: n,
                                      duration: 0,
                                      cts: (_ - m) / y,
                                      flags: {
                                          isLeading: 0,
                                          degradPrio: 0,
                                          hasRedundancy: 0,
                                          dependsOn: E ? 2 : 1,
                                          isDependedOn: E ? 1 : 0,
                                          isNonSync: E ? 0 : 1
                                      }
                                  },
                                  T.push(r),
                                  d = m
                              }
                              this._forceFirstIDR && (T[0].flags.dependsOn = 2,
                              T[0].flags.isNonSync = 0),
                              void 0 !== t.endDts ? (r.duration = (90 * t.endDts - this._initDTS - m) / y,
                              r.duration < 0 ? (r.duration = 0,
                              this.nextAvcDts = m) : this.nextAvcDts = 90 * t.endDts - this._initDTS) : (T.length >= 2 && (r.duration = T[T.length - 2].duration),
                              this.nextAvcDts = m + r.duration * y),
                              t.len = 0,
                              t.naluCnt = 0,
                              t.samples = T,
                              u = L.moof(t.sn, c / y, t),
                              t.samples = [];
                              var I = {
                                  type: "video",
                                  data: this._mergeBoxes(u, h)
                              };
                              this.mse.onFragParsing(I)
                          }
                      }, {
                          key: "remuxAudio",
                          value: function(t, e) {
                              var i, s, a, r, n, o, h, u, c, d, p, f = 8, _ = this.PES_TIMESCALE, m = this.PES2MP4SCALEFACTOR, v = [];
                              for (r = new Uint8Array(t.len + 8),
                              new DataView(r.buffer).setUint32(0, r.byteLength),
                              r.set(L.types.mdat, 4); t.samples.length; ) {
                                  if (a = (i = t.samples.shift()).unit,
                                  r.set(a, f),
                                  f += a.byteLength,
                                  u = i.pts - this._initDTS,
                                  c = i.dts - this._initDTS,
                                  void 0 !== h)
                                      d = this._PTSNormalize(u, h),
                                      p = this._PTSNormalize(c, h),
                                      s.duration = (p - h) / m,
                                      s.duration < 0 && (Number(localStorage._printMp4RemuxAudio) && l.a.warn("mp4-remuxer.remuxAudio invalid AAC sample duration at PTS=" + i.pts + " duration=" + s.duration),
                                      s.duration = 0,
                                      d = p = h);
                                  else {
                                      var y, T = this.nextAacPts || u;
                                      d = this._PTSNormalize(u, T),
                                      p = this._PTSNormalize(c, T),
                                      y = Math.round(1e3 * (d - T) / _),
                                      (e || Math.abs(y) < 600) && y && (d = p = T),
                                      Math.max(0, d),
                                      o = Math.max(0, p)
                                  }
                                  s = {
                                      size: a.byteLength,
                                      cts: 0,
                                      duration: 0,
                                      flags: {
                                          isLeading: 0,
                                          isDependedOn: 0,
                                          hasRedundancy: 0,
                                          degradPrio: 0,
                                          dependsOn: 1
                                      }
                                  },
                                  v.push(s),
                                  h = p
                              }
                              v.length >= 2 && (s.duration = v[v.length - 2].duration),
                              this.nextAacPts = d + s.duration * m,
                              t.len = 0,
                              t.samples = v,
                              n = L.moof(t.sn, o / m, t),
                              t.samples = [];
                              var g = {
                                  type: "audio",
                                  data: this._mergeBoxes(n, r)
                              };
                              this.mse.onFragParsing(g)
                          }
                      }, {
                          key: "renderVideo",
                          value: function(t, e) {
                              this.mse.h265Proxy.pushVideoFrame(t, e)
                          }
                      }, {
                          key: "_mergeBoxes",
                          value: function(t, e) {
                              var i = new Uint8Array(t.byteLength + e.byteLength);
                              return i.set(t, 0),
                              i.set(e, t.byteLength),
                              i
                          }
                      }, {
                          key: "_PTSNormalize",
                          value: function(t, e) {
                              var i;
                              if (void 0 === e)
                                  return t;
                              for (i = e < t ? -8589934592 : 8589934592; Math.abs(t - e) > 4294967296; )
                                  t += i;
                              return t
                          }
                      }, {
                          key: "timescale",
                          get: function() {
                              return this.MP4_TIMESCALE
                          }
                      }, {
                          key: "isWebglRender",
                          get: function() {
                              return this.mse.h265Proxy && this.mse.h265Proxy.renderInited
                          }
                      }]),
                      t
                  }()
                    , O = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.data = e,
                          this.bytesAvailable = this.data.byteLength,
                          this.word = 0,
                          this.bitsAvailable = 0
                      }
                      return Object(a.a)(t, [{
                          key: "loadWord",
                          value: function() {
                              var t = this.data.byteLength - this.bytesAvailable
                                , e = new Uint8Array(4)
                                , i = Math.min(4, this.bytesAvailable);
                              if (0 === i)
                                  throw new Error("no bytes available");
                              e.set(this.data.subarray(t, t + i)),
                              this.word = new DataView(e.buffer).getUint32(0),
                              this.bitsAvailable = 8 * i,
                              this.bytesAvailable -= i
                          }
                      }, {
                          key: "skipBits",
                          value: function(t) {
                              var e;
                              this.bitsAvailable > t ? (this.word <<= t,
                              this.bitsAvailable -= t) : (t -= this.bitsAvailable,
                              t -= (e = t >> 3) >> 3,
                              this.bytesAvailable -= e,
                              this.loadWord(),
                              this.word <<= t,
                              this.bitsAvailable -= t)
                          }
                      }, {
                          key: "readBits",
                          value: function(t) {
                              var e = Math.min(this.bitsAvailable, t)
                                , i = this.word >>> 32 - e;
                              return t > 32 && l.a.error("Cannot read more than 32 bits at a time"),
                              this.bitsAvailable -= e,
                              this.bitsAvailable > 0 ? this.word <<= e : this.bytesAvailable > 0 && this.loadWord(),
                              (e = t - e) > 0 ? i << e | this.readBits(e) : i
                          }
                      }, {
                          key: "skipLZ",
                          value: function() {
                              var t;
                              for (t = 0; t < this.bitsAvailable; ++t)
                                  if (0 != (this.word & 2147483648 >>> t))
                                      return this.word <<= t,
                                      this.bitsAvailable -= t,
                                      t;
                              return this.loadWord(),
                              t + this.skipLZ()
                          }
                      }, {
                          key: "skipUEG",
                          value: function() {
                              this.skipBits(1 + this.skipLZ())
                          }
                      }, {
                          key: "skipEG",
                          value: function() {
                              this.skipBits(1 + this.skipLZ())
                          }
                      }, {
                          key: "readUEG",
                          value: function() {
                              var t = this.skipLZ();
                              return this.readBits(t + 1) - 1
                          }
                      }, {
                          key: "readEG",
                          value: function() {
                              var t = this.readUEG();
                              return 1 & t ? 1 + t >>> 1 : -1 * (t >>> 1)
                          }
                      }, {
                          key: "readBoolean",
                          value: function() {
                              return 1 === this.readBits(1)
                          }
                      }, {
                          key: "readUByte",
                          value: function() {
                              return this.readBits(8)
                          }
                      }, {
                          key: "skipScalingList",
                          value: function(t) {
                              var e, i = 8, s = 8;
                              for (e = 0; e < t; e++)
                                  0 !== s && (s = (i + this.readEG() + 256) % 256),
                                  i = 0 === s ? i : s
                          }
                      }, {
                          key: "readSPS",
                          value: function() {
                              var t, e, i, s, a, r, n, o = 0, h = 0, u = 0, l = 0, c = 0;
                              if (this.readUByte(),
                              t = this.readUByte(),
                              this.readBits(5),
                              this.skipBits(3),
                              this.readUByte(),
                              this.skipUEG(),
                              100 === t || 110 === t || 122 === t || 144 === t || 244 === t || 44 === t || 83 === t || 86 === t || 118 === t || 128 === t || 138 === t) {
                                  var d = this.readUEG();
                                  if (3 === d && this.skipBits(1),
                                  this.skipUEG(),
                                  this.skipUEG(),
                                  this.skipBits(1),
                                  this.readBoolean())
                                      for (r = 3 !== d ? 8 : 12,
                                      n = 0; n < r; n++)
                                          this.readBoolean() && (n < 6 ? this.skipScalingList(16) : this.skipScalingList(64))
                              }
                              this.skipUEG();
                              var p = this.readUEG();
                              if (0 === p)
                                  this.readUEG();
                              else if (1 === p)
                                  for (this.skipBits(1),
                                  this.skipEG(),
                                  this.skipEG(),
                                  e = this.readUEG(),
                                  n = 0; n < e; n++)
                                      this.skipEG();
                              if (this.skipUEG(),
                              this.skipBits(1),
                              i = this.readUEG(),
                              s = this.readUEG(),
                              0 === (a = this.readBits(1)) && this.skipBits(1),
                              this.skipBits(1),
                              this.readBoolean() && (o = this.readUEG(),
                              h = this.readUEG(),
                              u = this.readUEG(),
                              l = this.readUEG()),
                              this.readBoolean() && (this.readBoolean() && 255 === this.readUByte() && (this.readBits(16),
                              this.readBits(16)),
                              this.readBoolean() && this.skipBits(1),
                              this.readBoolean() && (this.readBits(3),
                              this.skipBits(1),
                              this.readBoolean() && (this.readUByte(),
                              this.readUByte(),
                              this.readUByte())),
                              this.readBoolean() && (this.readUEG(),
                              this.readUEG()),
                              this.readBoolean())) {
                                  var f = this.readBits(32);
                                  c = this.readBits(32) / f,
                                  this.readBoolean() && (c = Math.ceil(c / 2))
                              }
                              return {
                                  fps: c,
                                  width: 16 * (i + 1) - 2 * o - 2 * h,
                                  height: (2 - a) * (s + 1) * 16 - (u + l) * (a ? 2 : 4)
                              }
                          }
                      }, {
                          key: "readSliceType",
                          value: function() {
                              return this.readUByte(),
                              this.readUEG(),
                              this.readUEG()
                          }
                      }]),
                      t
                  }()
                    , D = function() {
                      function t() {
                          Object(s.a)(this, t)
                      }
                      return Object(a.a)(t, null, [{
                          key: "getSilentFrame",
                          value: function(t, e) {
                              if (2 === t) {
                                  if (1 === e)
                                      return new Uint8Array([0, 200, 0, 128, 35, 128]);
                                  if (2 === e)
                                      return new Uint8Array([33, 0, 73, 144, 2, 25, 0, 35, 128]);
                                  if (3 === e)
                                      return new Uint8Array([0, 200, 0, 128, 32, 132, 1, 38, 64, 8, 100, 0, 142]);
                                  if (4 === e)
                                      return new Uint8Array([0, 200, 0, 128, 32, 132, 1, 38, 64, 8, 100, 0, 128, 44, 128, 8, 2, 56]);
                                  if (5 === e)
                                      return new Uint8Array([0, 200, 0, 128, 32, 132, 1, 38, 64, 8, 100, 0, 130, 48, 4, 153, 0, 33, 144, 2, 56]);
                                  if (6 === e)
                                      return new Uint8Array([0, 200, 0, 128, 32, 132, 1, 38, 64, 8, 100, 0, 130, 48, 4, 153, 0, 33, 144, 2, 0, 178, 0, 32, 8, 224])
                              } else {
                                  if (1 === e)
                                      return new Uint8Array([1, 64, 34, 128, 163, 78, 230, 128, 186, 8, 0, 0, 0, 28, 6, 241, 193, 10, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 94]);
                                  if (2 === e)
                                      return new Uint8Array([1, 64, 34, 128, 163, 94, 230, 128, 186, 8, 0, 0, 0, 0, 149, 0, 6, 241, 161, 10, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 94]);
                                  if (3 === e)
                                      return new Uint8Array([1, 64, 34, 128, 163, 94, 230, 128, 186, 8, 0, 0, 0, 0, 149, 0, 6, 241, 161, 10, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 94])
                              }
                              return null
                          }
                      }]),
                      t
                  }();
                  D.emptyAacFrameAdts = [255, 241, 92, 64, 18, 64, 252, 0, 208, 32, 6, 238, 90, 119, 128, 0, 128, 0, 0, 0, 0, 26, 37, 65, 0, 13, 237, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 28],
                  D.emptyAacFrame = [0, 208, 32, 6, 238, 90, 119, 128, 0, 128, 0, 0, 0, 0, 26, 37, 65, 0, 13, 237, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 28],
                  D.emptyAacFrame_44_1 = [1, 64, 34, 128, 163, 78, 129, 64, 0, 0, 0, 0, 4, 96, 6, 246, 81, 10, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 90, 94];
                  var N = D
                    , F = function() {
                      function t(e, i) {
                          Object(s.a)(this, t),
                          this.mse = e,
                          this.remuxer = i,
                          this.width = 0,
                          this.height = 0,
                          this.lastSN = 0,
                          this.lastLevel = 0,
                          this.PES_TIMESCALE = 9e4,
                          this.lastTsData = null,
                          this.lastPos = 0,
                          this.hasRemux = !1,
                          this.fragStartTs = 0,
                          this.vFps = new R,
                          this.aFps = new R,
                          this._initPts = 0,
                          this.nextAudioPts = 0
                      }
                      return Object(a.a)(t, [{
                          key: "getFps",
                          value: function() {
                              return this.vFps && this.vFps.getFps()
                          }
                      }, {
                          key: "getAudioFps",
                          value: function() {
                              return this.aFps && this.aFps.getFps()
                          }
                      }, {
                          key: "getStartTs",
                          value: function() {
                              return this.fragStartTs
                          }
                      }, {
                          key: "destroy",
                          value: function() {
                              this.switchLevel(),
                              this.duration = 0
                          }
                      }, {
                          key: "probe",
                          value: function(t) {
                              return t.length >= 564 && 71 === t[0] && 71 === t[188] && 71 === t[376]
                          }
                      }, {
                          key: "resetAVData",
                          value: function() {
                              this._avcTrack && (this._avcTrack.len = 0,
                              this._avcTrack.naluCnt = 0,
                              this._avcTrack.samples = []),
                              this._aacTrack && (this._aacTrack.len = 0,
                              this._aacTrack.samples = [])
                          }
                      }, {
                          key: "pushAllData",
                          value: function() {
                              this._avcTrack && this._avcTrack.sn > 0 && this.remuxTs(this._aacTrack, this._avcTrack, this._avcTrack.sn)
                          }
                      }, {
                          key: "switchLevel",
                          value: function() {
                              var t = this.createTrack;
                              !this._avcTrack && (this._avcTrack = t("video")),
                              !this._aacTrack && (this._aacTrack = t("audio")),
                              !this._id3Track && (this._id3Track = t("id3")),
                              this.pmtParsed = !1,
                              this._pmtId = -1,
                              this.remuxer.switchLevel()
                          }
                      }, {
                          key: "createTrack",
                          value: function(t) {
                              return {
                                  type: t,
                                  id: -1,
                                  sn: 0,
                                  samples: [],
                                  len: 0,
                                  naluCnt: 0
                              }
                          }
                      }, {
                          key: "insertDiscontinuity",
                          value: function() {
                              this.switchLevel(),
                              this.remuxer.insertDiscontinuity(),
                              this.mse.insertDiscontinuity()
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              this.vFps.reset(),
                              this.aFps.reset(),
                              this.hasRemux = !1,
                              this.lastTsData = null,
                              this._avcTrack && (this._avcTrack.sps = null,
                              this._avcTrack.pps = null,
                              this._avcTrack.len = 0,
                              this._avcTrack.naluCnt = 0,
                              this._avcTrack.samples = []),
                              this._aacTrack && (this._aacTrack.len = 0,
                              this._aacTrack.naluCnt = 0,
                              this._aacTrack.samples = [])
                          }
                      }, {
                          key: "resetTsData",
                          value: function() {
                              var t = this._avcTrack
                                , e = this._aacTrack
                                , i = this._id3Track;
                              e && (t.pesData = null,
                              e.pesData = null,
                              i.pesData = null,
                              this.lastTsData = null),
                              this.fragStartTs = 0
                          }
                      }, {
                          key: "appendTsData",
                          value: function(t, e) {
                              var i;
                              e && this.resetTsData(),
                              t instanceof Uint8Array || (t = new Uint8Array(t));
                              var s = this.lastTsData
                                , a = this.lastPos;
                              if (s) {
                                  var r = s.byteLength - a
                                    , n = r + t.byteLength;
                                  (i = new Uint8Array(n)).set(s.slice(a), 0),
                                  i.set(t, r)
                              } else
                                  i = t;
                              return this.lastPos = 0,
                              this.lastTsData = i,
                              i
                          }
                      }, {
                          key: "syncOffset",
                          value: function(t) {
                              for (var e = Math.min(188, t.length - 564), i = 0; i < e; ) {
                                  if (71 === t[i] && 71 === t[i + 188] && 71 === t[i + 376])
                                      return i;
                                  i++
                              }
                              return -1
                          }
                      }, {
                          key: "parseTs",
                          value: function(t) {
                              var e = t.data
                                , i = t.audioCodec
                                , s = t.videoCodec
                                , a = t.timeOffset
                                , r = t.duration
                                , n = t.discontinuity
                                , o = t._discontinuity
                                , h = t.level
                                , u = t.sn
                                , c = t.seeking
                                , d = t.hlsDT
                                , p = t.tsDT
                                , f = (e = this.appendTsData(e, c)).length;
                              this.audioCodec = i,
                              this.videoCodec = s,
                              this.timeOffset = a,
                              this.duration = r,
                              this.contiguous = !1,
                              n || o ? (l.a.log("TsParser.parseTs discontinuity detected"),
                              this.insertDiscontinuity()) : h !== this.lastLevel ? (l.a.log("TsParser.parseTs level switch detected"),
                              this.switchLevel(),
                              this.lastLevel = h) : u === this.lastSN + 1 && (this.contiguous = !0),
                              this.lastSN = u,
                              this.contiguous || (this.aacOverFlow = null),
                              this._avcTrack || this.insertDiscontinuity();
                              var m = this.syncOffset(e);
                              if (!(m < 0)) {
                                  this.lastPos = f -= (f + m) % 188,
                                  f === e.length && (this.lastTsData = null);
                                  for (var v, y, T, g, S, P = this._avcTrack, E = this._aacTrack, I = this._id3Track, A = this.pmtParsed, C = P.pesData, k = E.pesData, b = I.pesData, R = P.id, L = E.id, w = I.id, O = m; O < f; O += 188)
                                      if (71 === e[O]) {
                                          if (v = !!(64 & e[O + 1]),
                                          y = ((31 & e[O + 1]) << 8) + e[O + 2],
                                          (48 & e[O + 3]) >> 4 > 1) {
                                              if ((T = O + 5 + e[O + 4]) === O + 188)
                                                  continue
                                          } else
                                              T = O + 4;
                                          A ? (g = (S = O + 188) - T,
                                          y === R ? (v && (C && this._parseAVCPES(this._parsePES(C, a, d, p)),
                                          C = {
                                              data: [],
                                              size: 0
                                          }),
                                          C && (C.data.push(e.subarray(T, S)),
                                          C.size += g)) : y === L ? (v && (k && (this._parseAACPES(this._parsePES(k, a, d, p)),
                                          !this.hasRemux && P.samples.length > 1 && this.remuxTs(E, P, u)),
                                          k = {
                                              data: [],
                                              size: 0
                                          }),
                                          k && (k.data.push(e.subarray(T, S)),
                                          k.size += g)) : y === w && (v && (b && this._parseID3PES(this._parsePES(b, a, d, p)),
                                          b = {
                                              data: [],
                                              size: 0
                                          }),
                                          b && (b.data.push(e.subarray(T, S)),
                                          b.size += g))) : (v && (T += e[T] + 1),
                                          0 === y ? this._parsePAT(e, T) : y === this._pmtId && (this._parsePMT(e, T),
                                          A = this.pmtParsed = !0,
                                          R = this._avcTrack.id,
                                          L = this._aacTrack.id,
                                          w = this._id3Track.id))
                                      } else
                                          l.a.error("TsParser.parseTs ERROR: TS packet did not start with 0x47");
                                  if (C && (P.pesData = C),
                                  k && (E.pesData = k),
                                  b && (I.pesData = b),
                                  E.samples.length > 1 || this.maxVideo()) {
                                      if (0 === E.samples.length && "firefox" === _.a.name && this.mse.reloadInError && !this.mse.isLive)
                                          return void this.mse.reloadInError();
                                      this.remuxTs(E, P, u)
                                  }
                              }
                          }
                      }, {
                          key: "maxVideo",
                          value: function() {
                              var t = this._avcTrack;
                              if (t.samples.length > 1) {
                                  var e = t.samples[0];
                                  return (t.samples[t.samples.length - 1].dts - e.dts) / 90 > 2e3
                              }
                              return !1
                          }
                      }, {
                          key: "remuxTs",
                          value: function(t, e, i) {
                              t.sn = e.sn = i,
                              this.hasRemux = !0;
                              try {
                                  if (!this._initPts) {
                                      var s = t.samples.length > 0 ? t.samples[0].pts : 0
                                        , a = e.samples.length > 0 ? e.samples[0].pts : 0;
                                      this._initPts = Math.min(s, a)
                                  }
                                  this.remuxAudio(t, e.samples.length > 0)
                              } catch (t) {
                                  l.a.error("remux ts error: ", t)
                              }
                              this.remuxer.remux(t, e, this.timeOffset, this.contiguous)
                          }
                      }, {
                          key: "remuxAudio",
                          value: function(t, e) {
                              var i = 9216e4 / t.audiosamplerate;
                              0 == this.nextAudioPts && (this.nextAudioPts = this._initPts);
                              for (var s = this.nextAudioPts, a = t.samples, r = 0, n = s; r < a.length; r++) {
                                  var o = a[r].pts
                                    , h = o - n
                                    , u = Math.abs(1e3 * h / t.timescale);
                                  if (h <= -i && e)
                                      0 === r && (l.a.warn("Audio frame @ ".concat((o / t.timescale).toFixed(3), "s \n                        overlaps nextAudioPts by ").concat(Math.round(1e3 * h / t.timescale), " ms.")),
                                      this.nextAudioPts = s = n = o);
                                  else if (h > i && u < 1e4 && e) {
                                      var c = Math.round(h / i);
                                      (n = o - c * i) < 0 && (c--,
                                      n += i),
                                      0 === r && (this.nextAudioPts = s = n),
                                      l.a.warn("[mp4-remuxer]: Injecting ".concat(c, " audio frame nextPts=").concat(n, " @ ").concat((n / t.timescale).toFixed(3), "s \n                    due to ").concat(Math.round(1e3 * h / t.timescale), " ms gap."));
                                      for (var d = 0; d < c; d++) {
                                          var p = Math.max(n, 0)
                                            , f = N.getSilentFrame(t.config[0], t.channelCount)
                                            , _ = {
                                              unit: f,
                                              pts: Math.round(p),
                                              dts: Math.round(p)
                                          };
                                          a.splice(r, 0, _),
                                          t.len += f.length,
                                          n += i,
                                          r++
                                      }
                                  }
                                  n += i,
                                  this.nextAudioPts = n
                              }
                          }
                      }, {
                          key: "_parsePAT",
                          value: function(t, e) {
                              var i = t[e + 8] << 8 | t[e + 9];
                              1 == i && (this._pmtId = (31 & t[e + 10]) << 8 | t[e + 11]),
                              l.a.log("TsParser._parsePAT program_number=".concat(i, " pmtId=").concat(this._pmtId))
                          }
                      }, {
                          key: "_parsePMT",
                          value: function(t, e) {
                              var i = e + 3 + ((15 & t[e + 1]) << 8 | t[e + 2]) - 4;
                              for (e += 12 + ((15 & t[e + 10]) << 8 | t[e + 11]); e < i; ) {
                                  var s = t[e]
                                    , a = (31 & t[e + 1]) << 8 | t[e + 2];
                                  switch (s) {
                                  case 15:
                                      this._aacTrack.id = a;
                                      break;
                                  case 21:
                                      this._id3Track.id = a;
                                      break;
                                  case 27:
                                      this._avcTrack.id = a;
                                      break;
                                  default:
                                      l.a.log("unkown stream type:" + t[e])
                                  }
                                  e += 5 + ((15 & t[e + 3]) << 8 | t[e + 4])
                              }
                              l.a.log("TsParser._parsePMT aacTrack.id=".concat(this._aacTrack.id, " avcTrack.id=").concat(this._avcTrack.id))
                          }
                      }, {
                          key: "_parsePES",
                          value: function(t) {
                              var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
                                , i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0
                                , s = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 0
                                , a = t.data[0]
                                , r = (a[0] << 16) + (a[1] << 8) + a[2];
                              if (1 != r)
                                  return null;
                              var n, o, h = (a[4] << 8) + a[5], u = a[7];
                              192 & u && ((n = 536870912 * (14 & a[9]) + 4194304 * (255 & a[10]) + 16384 * (254 & a[11]) + 128 * (255 & a[12]) + (254 & a[13]) / 2) > 4294967295 && (n -= 8589934592),
                              64 & u ? (o = 536870912 * (14 & a[14]) + 4194304 * (255 & a[15]) + 16384 * (254 & a[16]) + 128 * (255 & a[17]) + (254 & a[18]) / 2) > 4294967295 && (o -= 8589934592) : o = n);
                              var l = a[8]
                                , c = l + 9;
                              t.data[0] = t.data[0].subarray(c),
                              t.size -= c;
                              for (var d = 0, p = new Uint8Array(t.size); t.data.length; )
                                  a = t.data.shift(),
                                  p.set(a, d),
                                  d += a.byteLength;
                              return s > i && s - i - 1e3 * e > 0 && (n -= 90 * (s - i - 1e3 * e),
                              o -= 90 * (s - i - 1e3 * e)),
                              {
                                  data: p,
                                  pts: n,
                                  dts: o,
                                  len: h
                              }
                          }
                      }, {
                          key: "_parseAVCPES",
                          value: function(t) {
                              if (null != t) {
                                  0 === this.fragStartTs && (this.fragStartTs = t.pts / this.PES_TIMESCALE);
                                  var e, i = this._avcTrack, s = i.samples, a = this._parseAVCNALu(t.data), r = [], n = 0;
                                  0 === a.length && s.length > 0 && this._pushToPreUnit(t.data),
                                  t.data = null;
                                  var o, h = !1, u = !1, c = "", p = Object(m.a)(a);
                                  try {
                                      for (p.s(); !(o = p.n()).done; ) {
                                          var f = o.value;
                                          switch (f.type) {
                                          case 1:
                                              u = !0;
                                              break;
                                          case 5:
                                              u = !0,
                                              h = !0,
                                              i.idr = !0;
                                              break;
                                          case 6:
                                              u = !0;
                                              break;
                                          case 7:
                                              if (u = !0,
                                              !i.sps) {
                                                  i.sps = [f.data],
                                                  i.timescale = this.remuxer.timescale,
                                                  i.duration = this.remuxer.timescale * this.duration;
                                                  var _ = new O(f.data).readSPS();
                                                  this.width = i.width = _.width,
                                                  this.height = i.height = _.height,
                                                  this.mse && this.mse.setResolution && this.mse.setResolution(this.width, this.height);
                                                  for (var v = f.data.subarray(1, 4), y = "avc1.", T = 0; T < 3; T++) {
                                                      var g = v[T].toString(16);
                                                      g.length < 2 && (g = "0" + g),
                                                      y += g
                                                  }
                                                  i.codec = y
                                              }
                                              break;
                                          case 8:
                                              u = !0,
                                              i.pps || (i.pps = [f.data]);
                                              break;
                                          case 9:
                                              u = !0;
                                              break;
                                          default:
                                              u = !1,
                                              c += "unknown NAL " + f.type + " "
                                          }
                                          u && (r.push(f),
                                          n += f.data.byteLength)
                                      }
                                  } catch (t) {
                                      p.e(t)
                                  } finally {
                                      p.f()
                                  }
                                  c.length,
                                  i.idr && this.mse.setExceptionStat(d.a.DIM_LINK_STA.VIDEO_IFRAME, 1),
                                  i.codec && this.mse.setExceptionStat(d.a.DIM_LINK_STA.VIDEO_CONFIG, 1),
                                  i.sps && i.pps && !i.idr || r.length && (!0 === h || i.sps) && (this.mse && (this.mse.curVideoDts = parseInt(t.dts / 90)),
                                  this.mse && this.mse.setExceptionStat(d.a.DIM_LINK_STA.VIDEO_FRAME, 1),
                                  this.vFps.addDts(t.dts / 90),
                                  e = {
                                      units: r,
                                      dts: t.dts,
                                      pts: t.pts,
                                      key: h
                                  },
                                  s.push(e),
                                  i.len += n,
                                  i.naluCnt += r.length)
                              } else
                                  l.a.error("TsParser._parseAVCPES pes is null.")
                          }
                      }, {
                          key: "_parseAVCNALu",
                          value: function(t) {
                              for (var e, i, s, a, r, n, o = 0, h = t.byteLength, u = 0, l = []; o < h; )
                                  switch (e = t[o++],
                                  u) {
                                  case 0:
                                      0 === e && (u = 1);
                                      break;
                                  case 1:
                                      u = 0 === e ? 2 : 0;
                                      break;
                                  case 2:
                                  case 3:
                                      0 === e ? u = 3 : 1 === e ? (a = 31 & t[o],
                                      r ? (s = {
                                          data: t.subarray(r, o - u - 1),
                                          type: n
                                      },
                                      l.push(s)) : (i = o - u - 1) && this._pushToPreUnit(t.subarray(0, i)),
                                      o < h ? (r = o,
                                      n = a,
                                      u = 0) : u = -1) : u = 0
                                  }
                              return r && (s = {
                                  data: t.subarray(r, h),
                                  type: n
                              },
                              l.push(s)),
                              l
                          }
                      }, {
                          key: "_pushToPreUnit",
                          value: function(t) {
                              var e = this._avcTrack.samples.length;
                              if (0 != e) {
                                  var i = this._avcTrack.samples[e - 1]
                                    , s = i.units[i.units.length - 1]
                                    , a = new Uint8Array(s.data.byteLength + t.byteLength);
                                  a.set(s.data, 0),
                                  a.set(t, s.data.byteLength),
                                  s.data = a,
                                  this._avcTrack.len += t.byteLength
                              }
                          }
                      }, {
                          key: "_parseAACPES",
                          value: function(t) {
                              var e = this;
                              if (null != t) {
                                  var i, s, a, r, n, o, h, u, c = this._aacTrack, p = t.data, f = p.length, _ = 0;
                                  if (this.aacOverFlow) {
                                      var m = new Uint8Array(this.aacOverFlow.byteLength + p.byteLength);
                                      m.set(this.aacOverFlow, 0),
                                      m.set(p, this.aacOverFlow.byteLength),
                                      p = m,
                                      this.aacOverFlow = null
                                  }
                                  for (s = 0; s < f - 1 && (255 !== p[s] || 240 != (240 & p[s + 1])); s++)
                                      ;
                                  if (s && (s < f - 1 ? (h = "AAC PES did not start with ADTS header, offset:".concat(s),
                                  u = !1) : (h = "no ADTS header found in AAC PES",
                                  u = !0),
                                  l.a.error("TsParser._parseAACPES ERROR:".concat(h)),
                                  u))
                                      return;
                                  var v = function(t) {
                                      c.config = t.config,
                                      c.audiosamplerate = t.samplerate,
                                      c.channelCount = t.channelCount,
                                      c.codec = t.codec,
                                      c.timescale = e.remuxer.timescale,
                                      c.duration = e.remuxer.timescale * e.duration,
                                      e.mse && e.mse.setExceptionStat(d.a.DIM_LINK_STA.AUDIO_CONFIG, 1),
                                      l.a.log("TsParser._parseAACPES parsed codec:".concat(c.codec, ",rate:").concat(t.samplerate, ",nb channel:").concat(t.channelCount))
                                  };
                                  if (this.mse && this.mse.isLive)
                                      c.audiosamplerate || v(this._ADTStoAudioConfig(p, s, this.audioCodec));
                                  else {
                                      var y = this._ADTStoAudioConfig(p, s, this.audioCodec);
                                      c.audiosamplerate ? c.audiosamplerate !== y.samplerate && this.mse && this.mse.onParseError(99) : v(y)
                                  }
                                  for (; s + 5 < f; ) {
                                      if (a = 1 & p[s + 1] ? 7 : 9,
                                      r = (3 & p[s + 3]) << 11,
                                      r |= p[s + 4] << 3,
                                      r |= (224 & p[s + 5]) >>> 5,
                                      (r -= a) < 0)
                                          return void l.a.error("TsParser._parseAACPES adtsFrameSize:".concat(r, ", adtsStartOffset:").concat(s, ", len:").concat(f));
                                      if (0 != r) {
                                          if (!((n = s + a) + r <= f))
                                              break;
                                          for (o = Math.round(t.pts + 1024 * _ * this.PES_TIMESCALE / c.audiosamplerate),
                                          i = {
                                              unit: p.subarray(n, n + r),
                                              pts: o,
                                              dts: o
                                          },
                                          this.aFps.addDts(o / 90),
                                          this.mse && (this.mse.curAudioDts = parseInt(o / 90)),
                                          this.mse && this.mse.setExceptionStat(d.a.DIM_LINK_STA.AUDIO_FRAME, 1),
                                          c.samples.push(i),
                                          c.len += r,
                                          s += a + r,
                                          _++; s < f - 1 && (255 !== p[s] || 240 != (240 & p[s + 1])); s++)
                                              ;
                                      } else
                                          s += a
                                  }
                                  s < f && (this.aacOverFlow = p.subarray(s, f))
                              } else
                                  l.a.error("TsParser._parseAACPES pes is null.")
                          }
                      }, {
                          key: "_ADTStoAudioConfig",
                          value: function(e, i, s) {
                              var a = t.AdtsSampleingRates
                                , r = 1 + ((192 & e[i + 2]) >>> 6)
                                , n = (60 & e[i + 2]) >>> 2;
                              if (!(n > a.length - 1)) {
                                  var o, h, u = (1 & e[i + 2]) << 2 | (192 & e[i + 3]) >>> 6, c = navigator.userAgent.toLowerCase();
                                  return -1 !== c.indexOf("firefox") ? n >= 6 ? (r = 5,
                                  h = new Array(4),
                                  o = n - 3) : (r = 2,
                                  h = new Array(2),
                                  o = n) : -1 !== c.indexOf("android") ? -1 !== c.indexOf("mqqbrowser") ? (r = 2,
                                  h = new Array(2),
                                  o = n) : (r = 5,
                                  h = new Array(4),
                                  o = n) : (r = 5,
                                  h = new Array(4),
                                  s && (-1 !== s.indexOf("mp4a.40.29") || -1 !== s.indexOf("mp4a.40.5")) || !s && n >= 6 ? o = n - 3 : (s && -1 !== s.indexOf("mp4a.40.2") && (n >= 6 || 1 === u) && (r = 2,
                                  h = new Array(2)),
                                  o = n)),
                                  h[0] = r << 3,
                                  h[0] |= (14 & n) >> 1,
                                  h[1] |= (1 & n) << 7,
                                  h[1] |= u << 3,
                                  5 === r && (h[1] |= (14 & o) >> 1,
                                  h[2] = (1 & o) << 7,
                                  h[2] |= 8,
                                  h[3] = 0),
                                  {
                                      config: h,
                                      samplerate: a[n],
                                      channelCount: u,
                                      codec: "mp4a.40." + r
                                  }
                              }
                              l.a.error("TsParser._ADTStoAudioConfig ERROR:invalid ADTS sampling index:".concat(n))
                          }
                      }, {
                          key: "_parseID3PES",
                          value: function(t) {
                              this._id3Track.samples.push(t)
                          }
                      }]),
                      t
                  }();
                  F.AdtsSampleingRates = [96e3, 88200, 64e3, 48e3, 44100, 32e3, 24e3, 22050, 16e3, 12e3, 11025, 8e3, 7350];
                  var M, U = F, B = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.size = 0,
                          this.buffers = []
                      }
                      return Object(a.a)(t, [{
                          key: "destroy",
                          value: function() {
                              this.reset()
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              l.a.log("FlvCacher.reset", this.size),
                              this.size = 0,
                              this.buffers = []
                          }
                      }, {
                          key: "append",
                          value: function(t) {
                              0 !== t.length && (this.buffers.push(t),
                              this.size += t.length)
                          }
                      }, {
                          key: "getByte",
                          value: function(t) {
                              for (var e = 0, i = 0; i < this.buffers.length; ++i) {
                                  var s = this.buffers[i];
                                  if (e + s.length > t)
                                      return s[t - e];
                                  e += s.length
                              }
                              return l.a.warn("FlvCacher.getByte has no offset=" + t),
                              0
                          }
                      }, {
                          key: "popFrame",
                          value: function() {
                              if (0 === this.size)
                                  return null;
                              if (0 === this.buffers.length)
                                  return l.a.error("FlvCacher.popFront error no buffers, size:" + this.size + " not eq 0"),
                                  this.reset(),
                                  null;
                              if (this.size <= Ct.TAG_HEADER_LEN + Ct.PREV_TAG_SIZE_LEN)
                                  return null;
                              var t = (this.getByte(1) << 16) + (this.getByte(2) << 8) + this.getByte(3)
                                , e = Ct.TAG_HEADER_LEN + t + Ct.PREV_TAG_SIZE_LEN;
                              if (this.size < e)
                                  return null;
                              if (1 === this.buffers.length) {
                                  if (this.buffers[0].length === e)
                                      return this.size -= e,
                                      this.buffers.shift();
                                  var i = this.buffers[0].slice(0, e);
                                  return this.buffers[0] = this.buffers[0].slice(e),
                                  this.size -= e,
                                  i
                              }
                              for (var s, a = new Uint8Array(e), r = 0, n = 0; r < e; ) {
                                  var o = e - r;
                                  if (this.buffers[0].length > o) {
                                      s = this.buffers[0].slice(0, o),
                                      a.set(s, n),
                                      n += o,
                                      r += o,
                                      this.buffers[0] = this.buffers[0].slice(o),
                                      this.size -= o;
                                      break
                                  }
                                  s = this.buffers.shift(),
                                  a.set(s, n),
                                  n += s.length,
                                  r += s.length,
                                  this.size -= s.length
                              }
                              return a
                          }
                      }]),
                      t
                  }(), V = (M = new ArrayBuffer(2),
                  new DataView(M).setInt16(0, 256, !0),
                  256 === new Int16Array(M)[0]), x = function() {
                      function t() {
                          Object(s.a)(this, t)
                      }
                      return Object(a.a)(t, null, [{
                          key: "parseObject",
                          value: function(e, i, s) {
                              var a = t.parseString(e, i)
                                , r = t.parseScript(e, i + a.size);
                              return {
                                  data: {
                                      name: a.data,
                                      value: r.data
                                  },
                                  size: r.size
                              }
                          }
                      }, {
                          key: "parseVariable",
                          value: function(e, i, s) {
                              return t.parseObject(e, i, s)
                          }
                      }, {
                          key: "parseDate",
                          value: function(t, e, i) {
                              if (i < 10)
                                  throw new Error("Data size invalid when parse Date");
                              var s = new DataView(t,e)
                                , a = s.getFloat64(0, !V)
                                , r = s.getInt16(8, !V);
                              return {
                                  data: new Date(a += 60 * r * 1e3),
                                  size: 10
                              }
                          }
                      }, {
                          key: "parseString",
                          value: function(t, e) {
                              var i = new DataView(t,e)
                                , s = i.getUint16(0, !V)
                                , a = "";
                              if (s > 0)
                                  for (var r = 0; r < s; r++)
                                      a += String.fromCharCode(i.getUint8(r + 2));
                              return {
                                  data: a,
                                  size: 2 + s
                              }
                          }
                      }, {
                          key: "parseMetadata",
                          value: function(e) {
                              var i = t.parseScript(e, 0);
                              return t.parseScript(e, i.size, e.length - i.size)
                          }
                      }, {
                          key: "parseScript",
                          value: function(e, i, s) {
                              var a = i
                                , r = new Uint8Array(e).buffer
                                , n = new DataView(r,0,s)
                                , o = null
                                , h = n.getUint8(a);
                              switch (a += 1,
                              h) {
                              case 0:
                                  o = n.getFloat64(a, !V),
                                  a += 8;
                                  break;
                              case 1:
                                  o = !!n.getUint8(a),
                                  a += 1;
                                  break;
                              case 2:
                                  var u = t.parseString(r, a);
                                  o = u.data,
                                  a += u.size;
                                  break;
                              case 3:
                                  for (o = {}; a < s - 3; ) {
                                      var l = t.parseObject(r, a, s - i);
                                      if (o[l.data.name] = l.data.value,
                                      a = l.size,
                                      0 === n.getUint8(a) && 0 === n.getUint8(a + 1) && 9 === n.getUint8(a + 2)) {
                                          a += 3;
                                          break
                                      }
                                  }
                                  break;
                              case 8:
                                  for (o = {},
                                  a += 4; a < s - 8; ) {
                                      var c = t.parseVariable(r, a);
                                      o[c.data.name] = c.data.value,
                                      a = c.size
                                  }
                                  a <= s - 3 && 9 == (16777215 & n.getUint32(a - 1, !V)) && (a += 3);
                                  break;
                              case 10:
                                  o = [];
                                  var d = n.getUint32(a, !V);
                                  a += 4;
                                  for (var p = 0; p < d; p++) {
                                      var f = t.parseScript(r, a);
                                      o.push(f.data),
                                      a = f.size
                                  }
                                  break;
                              case 11:
                                  var _ = t.parseDate(r, a + 1, s - 1);
                                  o = _.data,
                                  a += _.size;
                                  break;
                              case 12:
                                  var m = t.parseString(r, a + 1);
                                  o = m.data,
                                  a += m.size;
                                  break;
                              default:
                                  a = s,
                                  console.log("AMF", "Unsupported AMF value type " + h)
                              }
                              return {
                                  data: o,
                                  size: a
                              }
                          }
                      }, {
                          key: "getStr",
                          value: function(t, e, i) {
                              for (var s = "", a = 0; a < i; a++)
                                  s += String.fromCharCode(t[e++]);
                              return s
                          }
                      }]),
                      t
                  }(), H = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.listeners = {}
                      }
                      return Object(a.a)(t, [{
                          key: "clear",
                          value: function() {
                              this.listeners = {}
                          }
                      }, {
                          key: "has",
                          value: function(t, e, i) {
                              var s = this.listeners[t];
                              if (!s)
                                  return !1;
                              for (var a = 0, r = s.length; a < r; a++) {
                                  var n = s[a];
                                  if (n.callback == e && n.thisObj == i)
                                      return !0
                              }
                              return !1
                          }
                      }, {
                          key: "on",
                          value: function(t, e, i, s) {
                              if (!this.has(t, e, i)) {
                                  var a = this.listeners[t] || [];
                                  a.push({
                                      priority: s || 0,
                                      callback: e,
                                      thisObj: i,
                                      bindCallback: i ? e.bind(i) : e
                                  }),
                                  a.sort((function(t, e) {
                                      return e.priority - t.priority
                                  }
                                  )),
                                  this.listeners[t] = a
                              }
                          }
                      }, {
                          key: "off",
                          value: function(t, e, i) {
                              var s = this.listeners[t];
                              if (s)
                                  for (var a = s.length - 1; a >= 0; a--) {
                                      var r = s[a];
                                      if (r.callback == e && r.thisObj == i)
                                          return void s.splice(a, 1)
                                  }
                          }
                      }, {
                          key: "trigger",
                          value: function(t, e) {
                              var i = this.listeners[t];
                              if (i)
                                  for (var s = i.length - 1; s >= 0; s--)
                                      (0,
                                      i[s].bindCallback)(e)
                          }
                      }]),
                      t
                  }(), G = i(31), j = i(19), W = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i() {
                          var t;
                          return Object(s.a)(this, i),
                          (t = e.call(this)).printProtocol = !!Number(localStorage._printProtocol),
                          t
                      }
                      return Object(a.a)(i, [{
                          key: "onData",
                          value: function(t, e) {
                              var i = this.unmarshall(t, e);
                              this.trigger(t, i)
                          }
                      }, {
                          key: "unmarshall",
                          value: function(t, e) {
                              var i = new G.a(e)
                                , s = j.a[t]
                                , a = i
                                , r = null;
                              try {
                                  r = this.getClass(s)
                              } catch (e) {
                                  l.a.warn("%c[x] Unmatched protocol ".concat(t >> 8, " ").concat(s), "color:red;background:#FFF0F0")
                              }
                              return r && (void 0 === (a = new r).unmarshall ? l.a.error("[x]" + s + ".unmarshall undefined!") : a.unmarshall(i)),
                              this.printProtocol && !Y[s] && l.a.debug("%c<<<<< " + s, function(t, e, i) {
                                  var s = "font-weight:900";
                                  return s += ";color:" + t
                              }("#0000E3"), a),
                              a
                          }
                      }, {
                          key: "getClass",
                          value: function(t) {
                              return null
                          }
                      }]),
                      i
                  }(H), Y = {
                      PCdnProxyPing: 1,
                      PCdnProxyPingRes: 1,
                      PP2pSliceAudioData: 1,
                      PP2pSliceVideoData: 1,
                      PP2pSliceControlData: 1,
                      PCdnP2pGetNode: 1,
                      PCdnP2pGetNodeRes: 1,
                      P2POffer: 1,
                      P2PAnswer: 1,
                      P2PCandidate: 1,
                      P2POfferReject: 1,
                      P2PRequestOffer: 1,
                      PCdnP2PWSForward: 1,
                      PCdnP2PWSForwardReject: 1,
                      PCdnP2pReportLog: 1,
                      PCDNSubscribeReq: 1,
                      PCDNSubscribeRes: 1,
                      PCDNCompeteSubscribeReq: 1,
                      PCDNCompeteSubscribeRes: 1,
                      P2PPunchBackReq: 1,
                      P2PPunchBackRsp: 1,
                      HuyaDelaySeiData: 1
                  }, q = W, K = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.osTime = 0,
                          this.syncLocalTime = 0,
                          this.rttList = []
                      }
                      return Object(a.a)(t, [{
                          key: "convertToSrvTime",
                          value: function(t) {
                              if (0 === this.osTime)
                                  return 0;
                              var e = t - this.osTime;
                              return this.syncLocalTime + e
                          }
                      }, {
                          key: "isFinishNtp",
                          value: function() {
                              return 0 !== this.osTime
                          }
                      }, {
                          key: "ntpProcess",
                          value: function(t, e) {
                              var i = c.a.now()
                                , s = i - t
                                , a = Math.round(e + s / 2);
                              if (0 === this.osTime && 0 === this.syncLocalTime)
                                  this.osTime = i,
                                  this.syncLocalTime = a,
                                  this.rttList.push(s);
                              else if (this.rttList.length < 10)
                                  this.osTime = i,
                                  this.syncLocalTime = a,
                                  this.rttList.push(s);
                              else {
                                  for (var r = [], n = 0; n < this.rttList.length; ++n)
                                      r.push(this.rttList[n]);
                                  r.sort((function(t, e) {
                                      return t - e
                                  }
                                  ));
                                  for (var o = 0, h = 0; h < 4; ++h)
                                      o += r[h];
                                  var u = o >> 2;
                                  (4 * s > 3 * u && 4 * s < 5 * u || s > 6e4) && (this.osTime = i,
                                  this.syncLocalTime = a),
                                  this.rttList.shift(),
                                  this.rttList.push(s),
                                  r = null
                              }
                          }
                      }]),
                      t
                  }(), z = i(10), J = i(15).default, Q = i(18).default, X = new (function() {
                      function t() {
                          Object(s.a)(this, t),
                          this._info = new K,
                          this._clientTime = 0,
                          this._requestId = 0,
                          this._onWsTimeSyncBind = this._onWsTimeSync.bind(this)
                      }
                      return Object(a.a)(t, [{
                          key: "start",
                          value: function() {
                              this.wsTimeSync(),
                              k.a.add(this._onTimer, this, 1e3)
                          }
                      }, {
                          key: "_onTimer",
                          value: function(t, e) {
                              e % 60 == 0 && this.wsTimeSync()
                          }
                      }, {
                          key: "wsTimeSync",
                          value: function() {
                              "" !== z.a.sGuid && (this._req || (this._req = new J.WSTimeSyncReq),
                              this._requestId = Q.getRequestId(),
                              this._clientTime = c.a.now(),
                              this._req.sGuid = z.a.sGuid,
                              this._req.lClientTime = this._clientTime,
                              Q.sendWup("launch", "wsTimeSync", this._req, this._onWsTimeSyncBind, !0, this._requestId))
                          }
                      }, {
                          key: "_onWsTimeSync",
                          value: function(t) {
                              this._info.ntpProcess(this._clientTime, Number(t.lServerTime))
                          }
                      }, {
                          key: "getSyncTime",
                          value: function() {
                              return this._info.convertToSrvTime(c.a.now())
                          }
                      }, {
                          key: "isFinishNtp",
                          value: function() {
                              return this._info.isFinishNtp()
                          }
                      }]),
                      t
                  }()), Z = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this._split = e,
                          this._str = ""
                      }
                      return Object(a.a)(t, [{
                          key: "isEmpty",
                          value: function() {
                              return "" === this._str
                          }
                      }, {
                          key: "addStr",
                          value: function(t) {
                              this._str.length > 0 && (this._str += this._split),
                              this._str += t
                          }
                      }, {
                          key: "getStr",
                          value: function() {
                              return this._str
                          }
                      }]),
                      t
                  }(), $ = [72, 85, 89, 65, 58], tt = [44, 162, 222, 9, 181, 23, 71, 219, 187, 85, 164, 254, 127, 194, 252, 78], et = {
                      HUMEN: "00000001",
                      DELAY: "00000200",
                      VOLUME: "00000400",
                      IFRAME: "00000600"
                  }, it = function(t) {
                      Object(I.a)(r, t);
                      var e = Object(A.a)(r);
                      function r() {
                          return Object(s.a)(this, r),
                          e.call(this)
                      }
                      return Object(a.a)(r, [{
                          key: "getClass",
                          value: function(t) {
                              return i(67)("./" + t).default
                          }
                      }]),
                      r
                  }(q), st = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this._mse = e,
                          this._protoHandler = new it,
                          this._proto = null,
                          this._netDelaySum = 0,
                          this._c2cDelaySum = 0,
                          this._svrDelaySum = 0,
                          this._delayCnt = 0,
                          this._curAnchorDelay = 0,
                          this._offset = 0,
                          this.initDts = 0,
                          this.initSeiDts = 0
                      }
                      return Object(a.a)(t, [{
                          key: "getStat",
                          value: function() {
                              if (0 === this._delayCnt)
                                  return null;
                              var t = {
                                  fields: {},
                                  dims: {}
                              };
                              if (this._delayCnt > 0 && (t.fields[d.a.CORE.DELAY_ANCHOR] = Math.floor(this._c2cDelaySum / this._delayCnt),
                              t.fields[d.a.CORE.DELAY_SERVER] = Math.floor(this._svrDelaySum / this._delayCnt),
                              t.fields[d.a.CORE.DELAY_NET] = Math.floor(this._netDelaySum / this._delayCnt),
                              this._proto)) {
                                  t.dims[d.a.CORE.UPLOADER_TYPE] = this._proto.anchorSei.uploadType + "",
                                  t.dims[d.a.CORE.ENCODER_SOURCE] = this._proto.anchorSei.encoderSource + "";
                                  var e = new Z(",")
                                    , i = new Z(",")
                                    , s = new Z(",");
                                  this._proto.serverSei.serverInfos.forEach((function(t) {
                                      t.enable > 0 && (e.addStr(t.getProxyIdStr() + "-" + t.proxyType),
                                      t.serverDelay > 0 && t.serverDelay < 1e4 && i.addStr(t.proxyType + ":" + t.serverDelay),
                                      t.lastPeriodDelay > 0 && t.lastPeriodDelay < 1e4 && s.addStr(t.proxyType + ":" + t.lastPeriodDelay))
                                  }
                                  )),
                                  e.isEmpty() || (t.dims[d.a.CORE.DELAY_NODE_INFO] = e.getStr()),
                                  i.isEmpty() || (t.dims[d.a.CORE.SVR_DELAY_INFOS] = i.getStr()),
                                  s.isEmpty() || (t.dims[d.a.CORE.SVR_LAST_P_DELAY] = s.getStr())
                              }
                              return this._netDelaySum = 0,
                              this._c2cDelaySum = 0,
                              this._svrDelaySum = 0,
                              this._delayCnt = 0,
                              this._proto = null,
                              t
                          }
                      }, {
                          key: "_record",
                          value: function(t, e) {
                              this._proto = e;
                              var i = X.getSyncTime()
                                , s = t - e.serverSei.dtsGapSum - e.anchorSei.frameDts
                                , a = i - e.anchorSei.sendFrameTime - s;
                              if (this.initSeiDts != e.anchorSei.frameDts && (this._mse.offsetDts = t - e.anchorSei.frameDts),
                              this.initSeiDts = e.anchorSei.frameDts,
                              0 < a && a < 3e4) {
                                  var r = i - e.anchorSei.caputureTime - s;
                                  this._netDelaySum += a,
                                  this._c2cDelaySum += r,
                                  this._svrDelaySum += a - e.serverSei.delaySum,
                                  this._delayCnt++,
                                  this._curAnchorDelay = r || this._curAnchorDelay,
                                  this._curAnchorDelay > 3e5 && (this._curAnchorDelay = 0),
                                  this._mse.setSeiDelay(this._curAnchorDelay)
                              }
                          }
                      }, {
                          key: "parseSei",
                          value: function(e, i, s, a) {
                              if (e += this.initDts,
                              this._offset = 0,
                              s == t.H265_CODEC_TYPE ? (i = this._nalUintExtractRbsp(i),
                              this._offset += 2) : s == t.AV1_CODEC_TYPE || (this._offset += 1),
                              this._getValue(i),
                              this._getValue(i),
                              this._getH265Len(i),
                              this._isHuya(i)) {
                                  var r = i.subarray(this._offset)
                                    , n = this._getType(r);
                                  a[n] = 1,
                                  n === et.DELAY ? this._parseDelay(e, r) : n === et.HUMEN ? this._mse.saveH264SeiData(e, r) : n === et.VOLUME && this._mse.parser && this._mse.parser.parseScriptTagMixAudio && this._mse.parser.parseScriptTagMixAudio(this._getStr(r), e)
                              }
                          }
                      }, {
                          key: "_nalUintExtractRbsp",
                          value: function(t) {
                              for (var e = new Uint8Array(t.length), i = t.length, s = 0, a = 0; s + 2 < i; )
                                  t[s] || t[s + 1] || 3 !== t[s + 2] ? e[a++] = t[s++] : (e[a++] = t[s++],
                                  e[a++] = t[s++],
                                  s++);
                              for (; s < i; )
                                  e[a++] = t[s++];
                              return e.subarray(0, a)
                          }
                      }, {
                          key: "_getStr",
                          value: function(t) {
                              for (var e = t.length, i = new Uint8Array(t.length), s = 0; s < e; s++)
                                  i[s] = t[s];
                              e = this._getLength(t) + 8 + 16 + 2;
                              for (var a = 26, r = new DataView(i.buffer), n = []; a + 9 <= e; ) {
                                  var o = 4294967296 * r.getUint32(a, !1) + r.getUint32(a + 4, !1)
                                    , h = r.getUint8(a + 8);
                                  n.push(o + "_" + h),
                                  a += 9
                              }
                              return n.join(",")
                          }
                      }, {
                          key: "_getLength",
                          value: function(t) {
                              for (var e = "", i = 9; i < 26; i++)
                                  e += String.fromCharCode(t[i]);
                              return parseInt(e)
                          }
                      }, {
                          key: "_getValue",
                          value: function(t) {
                              for (var e = 0, i = t.length; this._offset < i; ) {
                                  if (e += t[this._offset],
                                  255 !== t[this._offset]) {
                                      this._offset++;
                                      break
                                  }
                                  this._offset++
                              }
                              return e
                          }
                      }, {
                          key: "_parseDelay",
                          value: function(t, e) {
                              if (X.isFinishNtp())
                                  for (var i = this._decodeData(e), s = i.length, a = new DataView(i.buffer), r = 0; r + 10 < s; ) {
                                      var n = a.getUint32(r, !0)
                                        , o = a.getUint32(r + 4, !0);
                                      if (0 === n || n > s)
                                          break;
                                      if (o === j.a.HuyaDelaySeiData) {
                                          var h = new DataView(i.buffer,r,n)
                                            , u = this._protoHandler.unmarshall(o, h);
                                          this._record(t, u)
                                      }
                                      r += n
                                  }
                          }
                      }, {
                          key: "_decodeData",
                          value: function(t) {
                              for (var e = this._decodeBase64(t), i = e.length, s = new Uint8Array(i), a = 0; a < i; a++)
                                  s[a] = e.charCodeAt(a);
                              return s
                          }
                      }, {
                          key: "_decodeBase64",
                          value: function(t) {
                              for (var e = "", i = this._getPayloadLen(t), s = 0; s < i; s++)
                                  e += String.fromCharCode(t[s + 26]);
                              return atob(e)
                          }
                      }, {
                          key: "_getPayloadLen",
                          value: function(t) {
                              for (var e = "", i = 0; i < 16; i++)
                                  e += String.fromCharCode(t[i + 9]);
                              return parseInt(e)
                          }
                      }, {
                          key: "_getType",
                          value: function(t) {
                              for (var e = "", i = 0; i < 8; i++)
                                  e += String.fromCharCode(t[i]);
                              return e
                          }
                      }, {
                          key: "_getH265Len",
                          value: function(t) {
                              for (var e = 0, i = 0; i < 16 && t[this._offset] === tt[i]; i++)
                                  this._offset++,
                                  e++;
                              return e
                          }
                      }, {
                          key: "_isHuya",
                          value: function(t) {
                              for (var e = 0; e < 5; e++) {
                                  if (t[this._offset] !== $[e])
                                      return !1;
                                  this._offset++
                              }
                              return !0
                          }
                      }]),
                      t
                  }();
                  st.H264_CODEC_TYPE = 0,
                  st.H265_CODEC_TYPE = 1,
                  st.AV1_CODEC_TYPE = 2,
                  st.SEI_TYPES = et;
                  var at = st
                    , rt = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this._bytes = e,
                          this._bitIndex = 0,
                          this._bitLen = 8 * e.byteLength
                      }
                      return Object(a.a)(t, [{
                          key: "getBits",
                          value: function(t) {
                              var e = Math.floor(this._bitIndex / 8)
                                , i = 8 - this._bitIndex % 8
                                , s = this._bytes[e] & (1 << i) - 1;
                              if (t <= i)
                                  return this._bitIndex += t,
                                  s >>> i - t;
                              var a = t - i;
                              return this._bitIndex += i,
                              (s << a | this.getBits(a)) >>> 0
                          }
                      }, {
                          key: "skipBits",
                          value: function(t) {
                              this._bitIndex += t
                          }
                      }, {
                          key: "getBytes",
                          value: function(t) {
                              if (this._bitIndex % 8 != 0)
                                  throw new Error("can't get bytes from mid-byte: bit index=" + this._bitIndex);
                              var e = Math.floor(this._bitIndex / 8);
                              return this._bitIndex += 8 * t,
                              this._bytes.subarray(e, e + t)
                          }
                      }, {
                          key: "bytePosition",
                          get: function() {
                              return Math.floor(this._bitIndex / 8)
                          }
                      }, {
                          key: "bitposition",
                          get: function() {
                              return this._bitIndex
                          }
                      }]),
                      t
                  }()
                    , nt = function() {
                      function t() {
                          Object(s.a)(this, t)
                      }
                      return Object(a.a)(t, null, [{
                          key: "leb128",
                          value: function(t) {
                              for (var e = 0, i = 0; i < 8; i++) {
                                  var s = t.getBits(8);
                                  if (e |= (127 & s) << 7 * i,
                                  !(128 & s))
                                      break
                              }
                              return e
                          }
                      }, {
                          key: "parseOBUHeader",
                          value: function(t) {
                              var e = {}
                                , i = t.bits;
                              return e.obu_forbidden_bit = i.getBits(1),
                              e.obu_type = i.getBits(4),
                              e.obu_extension_flag = i.getBits(1),
                              e.obu_has_size_field = i.getBits(1),
                              e.obu_reserved_1bit = i.getBits(1),
                              1 == e.obu_extension_flag && (e.temporal_id = i.getBits(3),
                              e.spatial_id = i.getBits(2),
                              e.extension_header_reserved_3bits = i.getBits(3)),
                              e
                          }
                      }, {
                          key: "uvlc",
                          value: function(t) {
                              for (var e = 0; !t.getBits(1); )
                                  ++e;
                              return e >= 32 ? 0 : t.getBits(e) + (1 << e) - 1
                          }
                      }, {
                          key: "color_config",
                          value: function(e) {
                              var i = {};
                              return i.high_bitdepth = e.getBits(1),
                              2 == i.seq_profile && i.high_bitdepth ? (i.twelve_bit = e.getBits(1),
                              i.BitDepth = i.twelve_bit ? 12 : 10) : i.BitDepth = i.high_bitdepth ? 10 : 8,
                              1 == i.seq_profile ? i.mono_chrome = 0 : i.mono_chrome = e.getBits(1),
                              i.color_description_present_flag = e.getBits(1),
                              i.color_description_present_flag ? (i.color_primaries = e.getBits(8),
                              i.transfer_characteristics = e.getBits(8),
                              i.matrix_coefficients = e.getBits(8)) : (i.color_primaries = t.CP_UNSPECIFIED,
                              i.transfer_characteristics = t.TC_UNSPECIFIED,
                              i.matrix_coefficients = t.MC_UNSPECIFIED),
                              i.mono_chrome ? (i.color_range = e.getBits(1),
                              i.subsampling_x = 1,
                              i.subsampling_y = 1,
                              i.chroma_sample_position = t.CSP_UNKNOWN,
                              i.separate_uv_delta_q = 0,
                              i) : (i.color_primaries == t.CP_BT_709 && i.transfer_characteristics == t.TC_SRGB && i.matrix_coefficients == t.MC_IDENTITY ? (i.color_range = 1,
                              i.subsampling_x = 0,
                              i.subsampling_y = 0) : (i.color_range = e.getBits(1),
                              0 == i.seq_profile ? (i.subsampling_x = 1,
                              i.subsampling_y = 1) : 1 == i.seq_profile ? (i.subsampling_x = 0,
                              i.subsampling_y = 0) : 12 == i.BitDepth ? (i.subsampling_x = e.getBits(1),
                              i.subsampling_x ? i.subsampling_y = e.getBits(1) : i.subsampling_y = 0) : (i.subsampling_x = 1,
                              i.subsampling_y = 0),
                              i.subsampling_x && i.subsampling_y && (i.chroma_sample_position = e.getBits(2))),
                              i.separate_uv_delta_q = e.getBits(1),
                              i)
                          }
                      }, {
                          key: "metadata_obu",
                          value: function(e, i) {
                              var s = {}
                                , a = e.bits;
                              if (s.metadata_type = t.leb128(a),
                              s.metadata_type == t.METADATA_TYPE_ITUT_T35) {
                                  s.itu_t_t35_country_code = a.getBits(8),
                                  255 == s.itu_t_t35_country_code && (s.itu_t_t35_country_code_extension_byte = a.getBits(8));
                                  var r = (8 * i - a.bitposition) / 8;
                                  s.itu_t_t35_payload_bytes = a.getBytes(r)
                              } else if (s.metadata_type == t.METADATA_TYPE_HDR_CLL)
                                  s.max_cll = a.getBits(16),
                                  s.max_fall = a.getBits(16);
                              else if (s.metadata_type == t.METADATA_TYPE_HDR_MDCV) {
                                  s.primary_chromaticity_x = [],
                                  s.primary_chromaticity_y = [];
                                  for (var n = 0; n < 3; n++)
                                      s.primary_chromaticity_x[n] = a.getBits(16),
                                      s.primary_chromaticity_y[n] = a.getBits(16);
                                  s.white_point_chromaticity_x = a.getBits(16),
                                  s.white_point_chromaticity_y = a.getBits(16),
                                  s.luminance_max = a.getBits(32),
                                  s.luminance_min = a.getBits(32)
                              } else if (s.metadata_type == t.METADATA_TYPE_SCALABILITY) {
                                  if (s.scalability_mode_idc = a.getBits(8),
                                  s.scalability_mode_idc == t.SCALABILITY_SS) {
                                      if (s.spatial_layers_cnt_minus_1 = a.getBits(2),
                                      s.spatial_layer_dimensions_present_flag = a.getBits(1),
                                      s.spatial_layer_description_present_flag = a.getBits(1),
                                      s.temporal_group_description_present_flag = a.getBits(1),
                                      s.scalability_structure_reserved_3bits = a.getBits(3),
                                      s.spatial_layer_dimensions_present_flag)
                                          for (var o = 0; o <= s.spatial_layers_cnt_minus_1; o++)
                                              s.spatial_layer_max_width[o] = a.getBits(16),
                                              s.spatial_layer_max_height[o] = a.getBits(16);
                                      if (s.spatial_layer_description_present_flag)
                                          for (var h = 0; h <= s.spatial_layers_cnt_minus_1; h++)
                                              s.spatial_layer_ref_id[h] = a.getBits(8);
                                      if (s.temporal_group_description_present_flag) {
                                          s.temporal_group_size = a.getBits(8);
                                          for (var u = 0; u < s.temporal_group_size; u++) {
                                              s.temporal_group_temporal_id[u] = a.getBits(3),
                                              s.temporal_group_temporal_switching_up_point_flag[u] = a.getBits(1),
                                              s.temporal_group_spatial_switching_up_point_flag[u] = a.getBits(1),
                                              s.temporal_group_ref_cnt[u] = a.getBits(3);
                                              for (var l = 0; l < temporal_group_ref_cnt[u]; l++)
                                                  s.temporal_group_ref_pic_diff[u][l] = a.getBits(8)
                                          }
                                      }
                                  }
                              } else
                                  s.metadata_type == t.METADATA_TYPE_TIMECODE && (s.counting_type = a.getBits(5),
                                  s.full_timestamp_flag = a.getBits(1),
                                  s.discontinuity_flag = a.getBits(1),
                                  s.cnt_dropped_flag = a.getBits(1),
                                  s.n_frames = a.getBits(9),
                                  s.full_timestamp_flag ? (s.seconds_value = a.getBits(6),
                                  s.minutes_value = a.getBits(6),
                                  s.hours_value = a.getBits(5)) : (s.seconds_flag = a.getBits(1),
                                  s.seconds_flag && (s.seconds_value = a.getBits(6),
                                  s.minutes_flag = a.getBits(1),
                                  s.minutes_flag && (s.minutes_value = a.getBits(6),
                                  s.hours_flag = a.getBits(1),
                                  s.hours_flag && (s.hours_value = a.getBits(5))))),
                                  s.time_offset_length = a.getBits(5),
                                  s.time_offset_length > 0 && (s.time_offset_value = a.getBits(s.time_offset_length)));
                              return s
                          }
                      }, {
                          key: "sequence_header_obu",
                          value: function(e) {
                              var i = {}
                                , s = e.bits;
                              if (i.seq_profile = s.getBits(3),
                              i.still_picture = s.getBits(1),
                              i.reduced_still_picture_header = s.getBits(1),
                              i.reduced_still_picture_header)
                                  i.timing_info_present_flag = 0,
                                  i.decoder_model_info_present_flag = 0,
                                  i.initial_display_delay_present_flag = 0,
                                  i.operating_points_cnt_minus_1 = 0,
                                  i["operating_point_idc[0]"] = 0,
                                  i["seq_level_idx[0]"] = s.getBits(5),
                                  i["seq_tier[0]"] = 0,
                                  i["decoder_model_present_for_this_op[0]"] = 0,
                                  i["initial_display_delay_present_for_this_op[0]"] = 0;
                              else {
                                  i.timing_info_present_flag = s.getBits(1),
                                  i.timing_info_present_flag ? (i.num_units_in_display_tick = s.getBits(32),
                                  i.time_scale = s.getBits(32),
                                  i.equal_picture_interval = s.getBits(1),
                                  i.equal_picture_interval && (i.num_ticks_per_picture_minus_1 = t.uvlc(s)),
                                  i.decoder_model_info_present_flag = s.getBits(1),
                                  i.decoder_model_info_present_flag && (i.buffer_delay_length_minus_1 = s.getBits(5)),
                                  i.num_units_in_decoding_tick = s.getBits(32),
                                  i.buffer_removal_time_length_minus_1 = s.getBits(5),
                                  i.frame_presentation_time_length_minus_1 = s.getBits(5),
                                  i.initial_display_delay_present_flag = s.getBits(1),
                                  i.operating_points_cnt_minus_1 = s.getBits(5)) : (i.decoder_model_info_present_flag = 0,
                                  i.initial_display_delay_present_flag = s.getBits(1),
                                  i.operating_points_cnt_minus_1 = s.getBits(5));
                                  for (var a = 0; a <= i.operating_points_cnt_minus_1; a++) {
                                      if (i["operating_point_idc[" + a + "]"] = s.getBits(12),
                                      i["seq_level_idx[" + a + "]"] = s.getBits(5),
                                      i["seq_level_idx[" + a + "]"] > 7 ? i["seq_tier[" + a + "]"] = s.getBits(1) : i["seq_tier[" + a + "]"] = 0,
                                      i.decoder_model_info_present_flag) {
                                          if (i["decoder_model_present_for_this_op[" + a + "]"] = s.getBits(1),
                                          i["decoder_model_present_for_this_op[" + a + "]"]) {
                                              var r = i.buffer_delay_length_minus_1 + 1;
                                              i["decoder_buffer_delay[" + a + "]"] = s.getBits(r),
                                              i["encoder_buffer_delay[" + a + "]"] = s.getBits(r),
                                              i["low_delay_mode_flag[" + a + "]"] = s.getBits(1)
                                          }
                                      } else
                                          i["decoder_model_present_for_this_op[" + a + "]"] = 0;
                                      i.initial_display_delay_present_flag && (i["initial_display_delay_present_for_this_op[" + a + "]"] = s.getBits(1)),
                                      i["initial_display_delay_present_for_this_op[" + a + "]"] && (i["initial_display_delay_minus_1[" + a + "]"] = s.getBits(4))
                                  }
                              }
                              return i.frame_width_bits_minus_1 = s.getBits(4),
                              i.frame_height_bits_minus_1 = s.getBits(4),
                              i.max_frame_width_minus_1 = s.getBits(i.frame_width_bits_minus_1 + 1),
                              i.max_frame_height_minus_1 = s.getBits(i.frame_height_bits_minus_1 + 1),
                              i.reduced_still_picture_header ? i.frame_id_numbers_present_flag = 0 : i.frame_id_numbers_present_flag = s.getBits(1),
                              i.frame_id_numbers_present_flag && (i.delta_frame_id_length_minus_2 = s.getBits(4),
                              i.additional_frame_id_length_minus_1 = s.getBits(3)),
                              i.use_128x128_superblock = s.getBits(1),
                              i.enable_filter_intra = s.getBits(1),
                              i.enable_intra_edge_filter = s.getBits(1),
                              i.reduced_still_picture_header ? (i.enable_interintra_compound = 0,
                              i.enable_masked_compound = 0,
                              i.enable_warped_motion = 0,
                              i.enable_dual_filter = 0,
                              i.enable_order_hint = 0,
                              i.enable_jnt_comp = 0,
                              i.enable_ref_frame_mvs = 0,
                              i.seq_force_screen_content_tools = t.SELECT_SCREEN_CONTENT_TOOLS,
                              i.seq_force_integer_mv = 1,
                              i["#OrderHintBits"] = 0) : (i.enable_interintra_compound = s.getBits(1),
                              i.enable_masked_compound = s.getBits(1),
                              i.enable_warped_motion = s.getBits(1),
                              i.enable_dual_filter = s.getBits(1),
                              i.enable_order_hint = s.getBits(1),
                              i.enable_order_hint && (i.enable_jnt_comp = s.getBits(1),
                              i.enable_ref_frame_mvs = s.getBits(1)),
                              i.seq_choose_screen_content_tools = s.getBits(1),
                              i.seq_choose_screen_content_tools ? i.seq_force_screen_content_tools = t.SELECT_SCREEN_CONTENT_TOOLS : i.seq_force_screen_content_tools = s.getBits(1),
                              i.seq_force_screen_content_tools > 0 && (i.seq_choose_integer_mv = s.getBits(1),
                              i.seq_choose_integer_mv ? i.seq_force_integer_mv = 1 : i.seq_force_integer_mv = s.getBits(1)),
                              i.enable_order_hint ? (i.order_hint_bits_minus_1 = s.getBits(3),
                              i["#OrderHintBits"] = i.order_hint_bits_minus_1 + 1) : i["#OrderHintBits"] = 0,
                              i.enable_superres = s.getBits(1),
                              i.enable_cdef = s.getBits(1),
                              i.enable_restoration = s.getBits(1),
                              Object.assign(i, t.color_config(s)),
                              i.film_grain_params_present = s.getBits(1)),
                              i
                          }
                      }, {
                          key: "parseOBU",
                          value: function(e, i, s, a) {
                              for (var r = {
                                  bits: new rt(e)
                              }, n = 0; e.length - n > 1; ) {
                                  var o;
                                  1 == (o = t.parseOBUHeader(r)).obu_extension_flag && n++;
                                  var h, u = e.length - n;
                                  if (h = o.obu_has_size_field ? t.leb128(r.bits) : u - 1 - o.obu_extension_flag,
                                  o.obu_type == t.OBU_SEQUENCE_HEADER && s)
                                      s(t.sequence_header_obu(r));
                                  else if (o.obu_type == t.OBU_METADATA && a) {
                                      var l = t.metadata_obu(r, r.bits.bytePosition + h);
                                      l.itu_t_t35_payload_bytes && a(i, l)
                                  } else
                                      r.bits.skipBits(8 * h);
                                  n = r.bits.bytePosition
                              }
                          }
                      }, {
                          key: "zeroPad",
                          value: function(t, e, i) {
                              t || (t = 0),
                              void 0 === i && (i = 10);
                              for (var s = t.toString(i); s.length < e; )
                                  s = "0" + s;
                              return s
                          }
                      }]),
                      t
                  }();
                  nt.OBU_SEQUENCE_HEADER = 1,
                  nt.OBU_TEMPORAL_DELIMITER = 2,
                  nt.OBU_FRAME_HEADER = 3,
                  nt.OBU_TILE_GROUP = 4,
                  nt.OBU_METADATA = 5,
                  nt.OBU_FRAME = 6,
                  nt.OBU_REDUNDANT_FRAME_HEADER = 7,
                  nt.OBU_TILE_LIST = 8,
                  nt.OBU_PADDING = 15,
                  nt.SELECT_SCREEN_CONTENT_TOOLS = 2,
                  nt.CP_BT_709 = 1,
                  nt.CP_UNSPECIFIED = 2,
                  nt.TC_SRGB = 13,
                  nt.TC_UNSPECIFIED = 2,
                  nt.MC_IDENTITY = 0,
                  nt.MC_UNSPECIFIED = 2,
                  nt.CSP_UNKNOWN = 0,
                  nt.METADATA_TYPE_HDR_CLL = 1,
                  nt.METADATA_TYPE_HDR_MDCV = 2,
                  nt.METADATA_TYPE_SCALABILITY = 3,
                  nt.METADATA_TYPE_ITUT_T35 = 4,
                  nt.METADATA_TYPE_TIMECODE = 5,
                  nt.SCALABILITY_SS = 14;
                  var ot = nt
                    , ht = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.type = -1,
                          this.sn = 0,
                          this.samples = [],
                          this.firstDts = 0,
                          this.playDts = 0,
                          this.lastSampleDts = 0
                      }
                      return Object(a.a)(t, [{
                          key: "destroy",
                          value: function() {
                              this.samples = []
                          }
                      }, {
                          key: "clear",
                          value: function() {
                              this.samples = [],
                              this.firstDts = 0,
                              this.playDts = 0,
                              this.lastSampleDts = 0
                          }
                      }, {
                          key: "addSample",
                          value: function(t) {
                              if (this.lastSampleDts > 0) {
                                  var e = t.ts - this.lastSampleDts;
                                  (e > 100 || e < -100) && l.a.warn("BufferFrame.addSample type=".concat(this.type, " dis=").concat(e, " lastDts=").concat(this.lastSampleDts, " curDts=").concat(t.ts))
                              }
                              return this.lastSampleDts = t.ts,
                              this.samples.push(t),
                              this._setFirstDts(t.ts),
                              this.setPlayDts(t.ts),
                              t.ts - this.playDts
                          }
                      }, {
                          key: "_setFirstDts",
                          value: function(t) {
                              0 === this.firstDts && (this.firstDts = t)
                          }
                      }, {
                          key: "setPlayDts",
                          value: function(t) {
                              0 === this.playDts && (this.playDts = t)
                          }
                      }, {
                          key: "_createTrack",
                          value: function(e) {
                              return {
                                  type: e,
                                  id: e === t.TYPES.video ? 1 : 2,
                                  sn: 0,
                                  samples: [],
                                  len: 0,
                                  duration: 0,
                                  startDts: -1,
                                  endDts: 0,
                                  naluCnt: 0
                              }
                          }
                      }, {
                          key: "getTrack",
                          value: function(t) {
                              var e = this._createTrack(this.type)
                                , i = this._fillTrack(e, t);
                              return i > 0 && this.samples.splice(0, i),
                              e.endDts > 0 && (e.sn = this.sn,
                              this.sn++),
                              e
                          }
                      }, {
                          key: "_fillTrack",
                          value: function(t, e) {
                              return 0
                          }
                      }, {
                          key: "_addTrack",
                          value: function(t, e) {
                              t.samples.push(e),
                              -1 === t.startDts && (t.startDts = e.ts),
                              t.endDts = e.ts,
                              e.av1Bytes && (t.bytes = e.av1Bytes)
                          }
                      }, {
                          key: "getBufferLen",
                          value: function() {
                              var t = this.samples.length;
                              if (t > 1) {
                                  var e = this.samples[0];
                                  return this.samples[t - 1].ts - e.ts
                              }
                              return 0
                          }
                      }, {
                          key: "getSize",
                          value: function() {
                              return this.samples.length
                          }
                      }]),
                      t
                  }();
                  ht.TYPES = {
                      video: "video",
                      audio: "audio"
                  };
                  var ut = ht
                    , lt = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i() {
                          var t;
                          return Object(s.a)(this, i),
                          (t = e.call(this)).type = ut.TYPES.video,
                          t
                      }
                      return Object(a.a)(i, [{
                          key: "_fillTrack",
                          value: function(t, e) {
                              for (var i = 0, s = this.samples.length, a = this.playDts + e, r = 0; r < s; r++) {
                                  var n = this.samples[r];
                                  if (n.ts >= a) {
                                      t.endDts = n.ts;
                                      break
                                  }
                                  i++,
                                  this._addTrack(t, n)
                              }
                              return t.endDts > 0 && (this.playDts = t.endDts),
                              i
                          }
                      }, {
                          key: "_addTrack",
                          value: function(t, e) {
                              E(Object(S.a)(i.prototype), "_addTrack", this).call(this, t, e),
                              t.naluCnt += e.units.length,
                              t.len += e.len
                          }
                      }]),
                      i
                  }(ut)
                    , ct = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i() {
                          var t;
                          return Object(s.a)(this, i),
                          (t = e.call(this)).type = ut.TYPES.audio,
                          t.needEmptyAudioFrame = !0,
                          t.isPureAudio = !1,
                          t.lastAacTs = 0,
                          t.audioObjectType = 5,
                          t.audioChannelCount = 1,
                          t.audioSampleRate = 22050,
                          t.aacTimeLen = 1024e3 / t.audioSampleRate,
                          t
                      }
                      return Object(a.a)(i, [{
                          key: "_setFirstDts",
                          value: function(t) {
                              this.playDts > 0 && 0 === this.firstDts && t > this.playDts && t - this.playDts < this.aacTimeLen && (l.a.log("BufferFrameAudio._setFirstDts reset playDts ".concat(this.playDts, " to ").concat(t)),
                              this.playDts = t),
                              E(Object(S.a)(i.prototype), "_setFirstDts", this).call(this, t)
                          }
                      }, {
                          key: "_fillTrack",
                          value: function(t, e) {
                              for (var i = e, s = this.playDts, a = 0, r = 0, n = 0, o = this.samples.length, h = 0; s < i; s += this.aacTimeLen) {
                                  var u = this.samples[a];
                                  if (h = Math.round(s),
                                  u && u.ts <= h) {
                                      if (a++,
                                      n++,
                                      this._fixDts(u, h),
                                      this._addTrack(t, u),
                                      a >= o) {
                                          s += this.aacTimeLen;
                                          break
                                      }
                                  } else if (!this.isPureAudio && this.needEmptyAudioFrame) {
                                      r++;
                                      var c = {
                                          unit: null,
                                          pts: 0,
                                          dts: 0,
                                          ts: 0
                                      };
                                      22050 === this.audioSampleRate && 2 === this.audioObjectType ? c.unit = new Uint8Array(N.emptyAacFrame) : c.unit = N.getSilentFrame(this.audioObjectType, this.audioChannelCount),
                                      this._fixDts(c, h),
                                      this._addTrack(t, c)
                                  }
                              }
                              return this.playDts = s,
                              r > 0 && l.a.log("BufferFrameAudio add empty frames ".concat(r)),
                              n
                          }
                      }, {
                          key: "_fixDts",
                          value: function(t, e) {
                              t.pts = t.dts = 90 * e,
                              t.ts = e
                          }
                      }, {
                          key: "_addTrack",
                          value: function(t, e) {
                              E(Object(S.a)(i.prototype), "_addTrack", this).call(this, t, e),
                              t.len += e.unit.length
                          }
                      }]),
                      i
                  }(ut)
                    , dt = function() {
                      function t(e, i) {
                          Object(s.a)(this, t),
                          this.popSize = e.bufferSize + e.popDuration,
                          this.waitSize = e.waitSize,
                          this.popDuration = e.popDuration,
                          this.timescale = e.timescale,
                          this.isPureAudio = e.isPureAudio,
                          this.remuxCb = i,
                          this.avcChange = !1,
                          this.inited = !0,
                          this.hasOriginIFrame = !1,
                          this.gop = o.a.maxGop,
                          this.lastKeyFrameDts = 0,
                          this.paused = !1,
                          this.videoConfig = {
                              isHevc: !1,
                              vps: null,
                              sps: null,
                              pps: null,
                              codec: "",
                              width: 0,
                              height: 0
                          },
                          this.audioConfig = {
                              config: null,
                              codec: "mp4a.40.5",
                              audioSampleRate: 22050,
                              aacTimeLen: 1024e3 / 22050,
                              audioObjectType: 5,
                              audioChannelCount: 1
                          },
                          this.vBuffer = new lt,
                          this.aBuffer = new ct
                      }
                      return Object(a.a)(t, [{
                          key: "_updateGop",
                          value: function(t) {
                              !t.key || this.hasOriginIFrame && !t.origin_iframe || (this.lastKeyFrameDts > 0 && (this.gop = Math.min(o.a.maxGop, t.ts - this.lastKeyFrameDts)),
                              this.lastKeyFrameDts = t.ts)
                          }
                      }, {
                          key: "updateVideoConfig",
                          value: function(t, e) {
                              this.videoConfig = t,
                              this.avcChange = e
                          }
                      }, {
                          key: "updateAudioConfig",
                          value: function(t) {
                              this.audioConfig = t,
                              this.aBuffer.audioSampleRate = t.audiosamplerate,
                              this.aBuffer.aacTimeLen = t.aacTimeLen,
                              this.aBuffer.audioObjectType = t.audioObjectType,
                              this.aBuffer.audioChannelCount = t.audioChannelCount
                          }
                      }, {
                          key: "destroy",
                          value: function() {
                              this.remuxCb = null,
                              this.vBuffer.destroy(),
                              this.aBuffer.destroy()
                          }
                      }, {
                          key: "addSample",
                          value: function(e) {
                              this.inited = !1,
                              e.type === t.TYPES.avc || e.type === t.TYPES.av01 ? this._addSampleVideo(e) : e.type === t.TYPES.aac && this._addSmapleAudio(e)
                          }
                      }, {
                          key: "_addSampleVideo",
                          value: function(t) {
                              t.key && t.origin_iframe && !this.hasOriginIFrame && (l.a.log("BufferAv.addSampleVideo find origin_iframe! isIframe=".concat(t.key)),
                              this.hasOriginIFrame = !0),
                              !t.key && t.origin_iframe && l.a.warn("BufferAv.addSampleVideo find origin_iframe sei not in iframe"),
                              this.aBuffer.setPlayDts(t.ts),
                              this._updateGop(t);
                              var e = this.vBuffer.addSample(t);
                              !this.paused && e > this.popSize && (e > this.waitSize || this.aBuffer.getSize() > 0) && this.popBuffer(this.popDuration)
                          }
                      }, {
                          key: "_addSmapleAudio",
                          value: function(t) {
                              var e = this.aBuffer.addSample(t);
                              !this.paused && this.isPureAudio && e > this.popSize && this.popBuffer(this.popDuration)
                          }
                      }, {
                          key: "popBuffer",
                          value: function(t) {
                              var e = this.vBuffer.getTrack(t);
                              e && (0 === e.sn || this.avcChange) && Object.assign(e, this.videoConfig),
                              e.timescale = this.timescale,
                              e.duration = Math.round((e.endDts - e.startDts) * (this.timescale / 1e3)),
                              this.avcChange = !1;
                              var i = null;
                              (i = this.isPureAudio ? this.aBuffer.getTrack(this.aBuffer.playDts + t) : this.aBuffer.getTrack(e.endDts)).config = this.audioConfig.config,
                              i.audiosamplerate = this.audioConfig.audiosamplerate,
                              i.channelCount = this.audioConfig.channelCount,
                              i.codec = this.audioConfig.codec,
                              i.timescale = this.timescale,
                              i.duration = Math.round((i.endDts - i.startDts) * (this.timescale / 1e3)),
                              this.remuxCb && this.remuxCb(e, i)
                          }
                      }, {
                          key: "clearBuffer",
                          value: function() {
                              this.vBuffer.clear(),
                              this.aBuffer.clear()
                          }
                      }, {
                          key: "setNeedEmptyAudioFrame",
                          value: function(t) {
                              this.aBuffer.needEmptyAudioFrame = t
                          }
                      }, {
                          key: "getBufferLen",
                          value: function() {
                              return this.isPureAudio ? this.aBuffer.getBufferLen() : this.vBuffer.getBufferLen()
                          }
                      }, {
                          key: "getSize",
                          value: function() {
                              return this.vBuffer.getSize()
                          }
                      }]),
                      t
                  }();
                  dt.TYPES = {
                      avc: "avc",
                      av01: "av01",
                      aac: "aac"
                  };
                  var pt = dt
                    , ft = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.list = [],
                          this.switchIFrameDts = 0,
                          this.switchIFramePts = 0,
                          this.lastIFrameDts = 0,
                          this.lastIFRamePts = 0
                      }
                      return Object(a.a)(t, [{
                          key: "getDts",
                          value: function() {
                              return this.switchIFrameDts || this.lastIFrameDts
                          }
                      }, {
                          key: "getPts",
                          value: function() {
                              return this.switchIFramePts || this.lastIFRamePts
                          }
                      }, {
                          key: "setSwitchTs",
                          value: function(t, e) {
                              this.switchIFrameDts = t,
                              this.switchIFramePts = e
                          }
                      }, {
                          key: "setLastTs",
                          value: function(t, e) {
                              this.lastIFrameDts = t,
                              this.lastIFRamePts = e
                          }
                      }, {
                          key: "resetPtsSample",
                          value: function() {
                              this.list = []
                          }
                      }, {
                          key: "addPtsSample",
                          value: function(t, e, i, s, a, r) {
                              this.list.push({
                                  dts: t,
                                  pts: e,
                                  dtsGap: i,
                                  ptsGap: s,
                                  hasOrigin: a,
                                  isOrigin: r
                              })
                          }
                      }, {
                          key: "getMetric",
                          value: function() {
                              var t = [0, 0, 0]
                                , e = [0, 0];
                              if (this.list.length > 0) {
                                  var i = this.list[0]
                                    , s = this.list[this.list.length - 1];
                                  t[0] = i.dtsGap,
                                  t[1] = i.ptsGap,
                                  t[2] = this.list.length,
                                  t[3] = 0,
                                  t[4] = s.ptsGap,
                                  e[0] = s.hasOrigin ? 1 : 2,
                                  e[1] = s.isOrigin ? 1 : 2,
                                  e[2] = 0
                              }
                              return {
                                  values: t,
                                  strs: e
                              }
                          }
                      }]),
                      t
                  }()
                    , _t = 0
                    , mt = 0
                    , vt = function() {
                      function t(e, i) {
                          Object(s.a)(this, t),
                          this.config = e,
                          this.remuxCb = i,
                          this.hasVideoConfig = !1,
                          this.needEmptyAudioFrame = !0,
                          this.timescale = 9e4,
                          this.hasFrame = !1,
                          this.state = _t,
                          this.switchTs = new ft,
                          this.avBuffer = this._createBuffer(),
                          this.evalBw = null,
                          this.callbacks = null,
                          this._buffered = null,
                          this.id = mt++,
                          l.a.log("CtrlBuffer.constructor(".concat(this.id, ")")),
                          this._curFrameId = 0
                      }
                      return Object(a.a)(t, [{
                          key: "setCurFrameId",
                          value: function(t) {
                              this._curFrameId = t
                          }
                      }, {
                          key: "setBuffered",
                          value: function(t) {
                              this._buffered = t
                          }
                      }, {
                          key: "addBuffered",
                          value: function(t, e, i) {
                              (t.type === pt.TYPES.avc || t.type === pt.TYPES.av01 && this._buffered) && this._buffered.addSample(this._curFrameId, t.ts, e, i)
                          }
                      }, {
                          key: "destroy",
                          value: function() {
                              this.remuxCb = null,
                              this.callbacks = null,
                              this._destroyBuffer()
                          }
                      }, {
                          key: "_destroyBuffer",
                          value: function() {
                              this.avBuffer && (this.avBuffer.destroy(),
                              this.avBuffer = null)
                          }
                      }, {
                          key: "_createBuffer",
                          value: function() {
                              this._destroyBuffer();
                              var t = new pt(this.config,this.remuxCb);
                              return t.timescale = this.timescale,
                              t.setNeedEmptyAudioFrame(this.needEmptyAudioFrame),
                              t
                          }
                      }, {
                          key: "pause",
                          value: function() {
                              this.avBuffer.paused = !0
                          }
                      }, {
                          key: "play",
                          value: function() {
                              this.avBuffer.paused = !1
                          }
                      }, {
                          key: "isPaused",
                          value: function() {
                              return this.avBuffer.paused
                          }
                      }, {
                          key: "isWaitForIFrame",
                          value: function() {
                              return 1 === this.state
                          }
                      }, {
                          key: "switchBitrate",
                          value: function(t, e, i) {
                              l.a.log("CtrlBuffer(".concat(this.id, ").switchBitrate isDown=").concat(t)),
                              this._lastBitrate = e,
                              this._curBitrate = i,
                              this.state = 1
                          }
                      }, {
                          key: "switchBack",
                          value: function() {
                              l.a.log("CtrlBuffer(".concat(this.id, ").switchBack switchIFramePts=").concat(this.switchTs.getDts(), " lastIFramePts=").concat(this.switchTs.getPts())),
                              this.state = 2,
                              this.avBuffer = this._createBuffer(),
                              this.callbacks && this.callbacks.start(this.switchTs.getDts(), this.switchTs.getPts())
                          }
                      }, {
                          key: "setEval",
                          value: function(t) {
                              this.evalBw = t
                          }
                      }, {
                          key: "addSample",
                          value: function(t) {
                              var e = t.key && (!this.avBuffer.hasOriginIFrame || t.origin_iframe);
                              if (e && this.switchTs.setLastTs(t.ts, t.ts + t.cts),
                              t.type !== pt.TYPES.avc && t.type !== pt.TYPES.av01 || this.evalBw && this.evalBw.addSample(t),
                              2 === this.state && (this.hasFrame || t.type !== pt.TYPES.avc && t.type !== pt.TYPES.av01 || (l.a.log("CtrlBuffer(".concat(this.id, ").addSample first sample dts=").concat(t.ts, " pts=").concat(t.ts + t.cts)),
                              this.hasFrame = !0,
                              this.callbacks && this.callbacks.first())),
                              t.type !== pt.TYPES.avc && t.type !== pt.TYPES.av01 || this.hasVideoConfig)
                                  if (2 === this.state) {
                                      if (t.key) {
                                          var i = t.ts + t.cts
                                            , s = t.ts - this.switchTs.getDts()
                                            , a = i - this.switchTs.getPts();
                                          l.a.log("CtrlBuffer(".concat(this.id, ").addSample find IFrame origin_iframe=").concat(t.origin_iframe, " dts=").concat(t.ts, " pts=").concat(i, " switchDts=").concat(this.switchTs.switchIFrameDts, " switchPts=").concat(this.switchTs.switchIFramePts, " dtsGap=").concat(s, " ptsGap=").concat(a, " iFrameGap=").concat(this.avBuffer.gop)),
                                          1 === Number(o.a.autoReportCfg[0]) && 1 === Number(o.a.autoReportCfg[3]) && a > 0 && (l.a.log("CtrlBuffer.addSample autoReport"),
                                          this.callbacks && this.callbacks.autoReport(Event.P2P_REPORT, 2)),
                                          this.switchTs.addPtsSample(t.ts, i, s, a, this.avBuffer.hasOriginIFrame, t.origin_iframe),
                                          i >= this.switchTs.switchIFramePts && (l.a.log("CtrlBuffer(".concat(this.id, ").addSample find new IFrame, switch done")),
                                          this.state = _t,
                                          this.switchTs.setSwitchTs(0, 0),
                                          this.avBuffer.addSample(t),
                                          this.addBuffered(t, !0, a),
                                          this.callbacks && this.callbacks.done(s, t.ts, a))
                                      }
                                  } else
                                      1 === this.state ? e ? (this._popAllBuffer(),
                                      this.avBuffer.hasOriginIFrame = !1,
                                      this.hasVideoConfig = !1,
                                      this.hasFrame = !1,
                                      this.state = 2,
                                      this.switchTs.setSwitchTs(t.ts, t.ts + t.cts),
                                      this.switchTs.resetPtsSample(),
                                      l.a.log("CtrlBuffer(".concat(this.id, ").addSample find next IFrame origin_iframe=").concat(t.origin_iframe, " dts=").concat(this.switchTs.switchIFrameDts, " pts=").concat(this.switchTs.switchIFramePts, " iFrameGap=").concat(this.avBuffer.gop, ", switch start!")),
                                      this.callbacks && this.callbacks.start(this.switchTs.switchIFrameDts, this.switchTs.switchIFramePts)) : (t.key && l.a.log("CtrlBuffer(".concat(this.id, ").addSample find next IFrame fail, origin_iframe=").concat(t.origin_iframe, " dts=").concat(t.ts, " pts=").concat(t.ts + t.cts)),
                                      this.avBuffer.addSample(t),
                                      this.addBuffered(t, !1, 0)) : (this.avBuffer.addSample(t),
                                      this.addBuffered(t, !1, 0))
                          }
                      }, {
                          key: "_popAllBuffer",
                          value: function() {
                              this.avBuffer && (this.avBuffer.getBufferLen() > 0 && this.avBuffer.popBuffer(Number.MAX_SAFE_INTEGER),
                              this.avBuffer.clearBuffer())
                          }
                      }, {
                          key: "updateVideoConfig",
                          value: function(t, e) {
                              e && this._popAllBuffer(),
                              this.hasVideoConfig = !0,
                              this.avBuffer.updateVideoConfig(t, e)
                          }
                      }, {
                          key: "updateAudioConfig",
                          value: function(t, e) {
                              e && this._popAllBuffer(),
                              this.avBuffer.updateAudioConfig(t)
                          }
                      }, {
                          key: "setNeedEmptyAudioFrame",
                          value: function(t) {
                              this.needEmptyAudioFrame = t,
                              this.avBuffer.setNeedEmptyAudioFrame(t)
                          }
                      }, {
                          key: "getBufferLen",
                          value: function() {
                              return this.avBuffer.getBufferLen()
                          }
                      }, {
                          key: "getLastIFrameDts",
                          value: function() {
                              return this.switchTs.lastIFrameDts
                          }
                      }, {
                          key: "getSize",
                          value: function() {
                              return this.avBuffer.getSize()
                          }
                      }]),
                      t
                  }()
                    , yt = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.hasSample = !1,
                          this.samples = new y(e)
                      }
                      return Object(a.a)(t, [{
                          key: "getSamples",
                          value: function() {
                              return this.samples.getSamples()
                          }
                      }, {
                          key: "addCur",
                          value: function(t, e) {
                              this.hasSample = !0
                          }
                      }, {
                          key: "getResult",
                          value: function() {
                              var t = []
                                , e = this.samples.getSamples()
                                , i = e.length;
                              if (i > 0) {
                                  t.push("size:" + i);
                                  for (var s = 0; s < i; s++)
                                      t.push("".concat(i - s, ":").concat(e[s]))
                              }
                              return t.join(",")
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              var t = this.samples.cur;
                              this.samples.reset(),
                              this.samples.addCur(t)
                          }
                      }]),
                      t
                  }()
                    , Tt = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i() {
                          var t, a = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 100;
                          return Object(s.a)(this, i),
                          (t = e.call(this, a)).lastTs = 0,
                          t
                      }
                      return Object(a.a)(i, [{
                          key: "addCur",
                          value: function(t, e) {
                              E(Object(S.a)(i.prototype), "addCur", this).call(this, t, e);
                              var s = parseInt(e / 1e3);
                              this.lastTs > 0 && this.lastTs !== s && this.samples.calculate(),
                              this.lastTs = s,
                              this.samples.addCur(t)
                          }
                      }]),
                      i
                  }(yt)
                    , gt = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.aSample = new Tt(20),
                          this.vSample = new Tt(20)
                      }
                      return Object(a.a)(t, [{
                          key: "addAudioSample",
                          value: function(t, e) {
                              this.aSample.addCur(t, e)
                          }
                      }, {
                          key: "addVideoSample",
                          value: function(t, e) {
                              this.vSample.addCur(t, e)
                          }
                      }, {
                          key: "getResult",
                          value: function() {
                              var t = []
                                , e = this.aSample.getSamples()
                                , i = this.vSample.getSamples()
                                , s = Math.min(i.length, e.length);
                              if (s > 0) {
                                  t.push("size:".concat(s));
                                  for (var a = 0; a < s; a++)
                                      t.push("".concat(s - a, ":").concat(i[a] + e[a]))
                              }
                              return t.join(",")
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              this.aSample.reset(),
                              this.vSample.reset()
                          }
                      }, {
                          key: "recordStat",
                          value: function(t) {
                              var e = this.getResult();
                              "" !== e && (this.reset(),
                              t.setCoreDim(d.a.CORE.REAL_KBPS_SAMPLE, e))
                          }
                      }]),
                      t
                  }()
                    , St = !!Number(localStorage._dropAudio)
                    , Pt = !!Number(localStorage._dropVideo)
                    , Et = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.lastDts = 0,
                          this.lastPts = 0,
                          this.lastCts = 0,
                          this.dtsStat = [0, 0, 0, 0, 0, 0],
                          this.ptsStat = [0, 0, 0, 0, 0, 0],
                          this.ctsStat = [0, 0, 0, 0, 0, 0],
                          this.playVideoFrameCnt = 0,
                          this.playAudioFrameCnt = 0
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              this.lastDts = this.lastPts = this.lastCts = 0,
                              this.playVideoFrameCnt = this.playAudioFrameCnt = 0,
                              this.dtsStat = [0, 0, 0, 0, 0, 0],
                              this.ptsStat = [0, 0, 0, 0, 0, 0],
                              this.ctsStat = [0, 0, 0, 0, 0, 0]
                          }
                      }, {
                          key: "setTimeStamp",
                          value: function(t, e, i) {
                              this.addStat(this.dtsStat, this.lastDts, t),
                              this.addStat(this.ptsStat, this.lastPts, e),
                              this.addStat(this.ctsStat, this.lastCts, i),
                              this.lastDts = t,
                              this.lastPts = e,
                              this.lastCts = i
                          }
                      }, {
                          key: "addStat",
                          value: function(t, e, i) {
                              if (e > 0 && i > e) {
                                  var s = i - e;
                                  s >= 1e3 ? t[4]++ : s >= 800 ? t[3]++ : s >= 600 ? t[2]++ : s >= 400 ? t[1]++ : s >= 200 && t[0]++
                              }
                          }
                      }]),
                      t
                  }()
                    , It = [43, 138, 8, 0]
                    , At = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i(t, a) {
                          var r;
                          return Object(s.a)(this, i),
                          (r = e.call(this)).mse = t,
                          r.remuxer = a,
                          r.flvCacher = new B,
                          r.fps = new R,
                          r.audioFps = new R,
                          r.sei = new at(t),
                          r.avSample = new gt,
                          r.timeStampStat = new Et,
                          r.emptyFrames = 0,
                          r.ctrlBuffer = new vt({
                              bufferSize: 0,
                              popDuration: 200,
                              timescale: a.timescale,
                              isPureAudio: t.isPureAudio
                          },r._remux.bind(Object(g.a)(r))),
                          r.DEFAULT_GOP = 200,
                          r.bufLen = 400,
                          r.firstBufLen = 400,
                          r.remuxLen = r.firstBufLen,
                          r.maxWaitTime = 2e3,
                          r.pushGop = !1,
                          r.parseFlvHead = !1,
                          r.lengthSizeMinusOne = 0,
                          r.hasRemuxed = !1,
                          r.recvVideoFrameTimeStamp = 0,
                          r.recvVideoFrameNums = 0,
                          r.videoFramePlayDelayTs = 0,
                          r.videoFrameCalculatePlayDelayFrames = 0,
                          r.audioConfig = It.slice(),
                          r.audioSampleRate = 22050,
                          r.aacTimeLen = 1024e3 / r.audioSampleRate,
                          r.validAacTime = 500 * r.aacTimeLen,
                          r.audioChannelCount = 1,
                          r.audioObjectType = 5,
                          r.audioIncreaseTSMap = new Map,
                          r.firstDemuxAudioTS = -1,
                          r.ctrlBuffer.updateAudioConfig({
                              config: r.audioConfig,
                              codec: "mp4a.40.5",
                              audiosamplerate: r.audioSampleRate,
                              aacTimeLen: r.aacTimeLen,
                              audioObjectType: r.audioObjectType,
                              audioChannelCount: r.audioChannelCount
                          }, !1),
                          r.spsUnit = null,
                          r.ppsUnit = null,
                          r.vpsUnit = null,
                          r.videoConfig = {},
                          r.hasCtsZero = !1,
                          r.paused = !1,
                          r.hasEmptyFrames = !1,
                          r.playVideoFrameCnt = 0,
                          r.playVideoLength = 0,
                          r.playAudioFrameCnt = 0,
                          r.playAudioLength = 0,
                          r.playEmptyAudioFrameCnt = 0,
                          r.beginParseTs = 0,
                          r.hasAudioTag = !1,
                          r.lastAacTs = 0,
                          r.hasKeyFrame = !1,
                          r.lastAudioTs = 0,
                          r.lastVideoTs = 0,
                          r.lastParseDts = 0,
                          r.maxaudioptsList = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                          r.last10anduiptsList = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                          r.firstAudioTs = -1,
                          r.showH265Tip = !1,
                          r.appendHighQualityEmptyAudio = !0,
                          r.deleteH264Aud = !1,
                          r.incompleteFlvheaderLen = 0,
                          r.videoFrames = 0,
                          r.audioFrames = 0,
                          r.headCache = null,
                          r.OBUParser = new ot,
                          r.seiTypes = {},
                          r.av1Bytes = 0,
                          r.reset(),
                          r.onAV1SequenceHeaderBind = r.onAV1SequenceHeader.bind(Object(g.a)(r)),
                          r.onAV1MetaDataBind = r.onAV1MetaData.bind(Object(g.a)(r)),
                          r
                      }
                      return Object(a.a)(i, [{
                          key: "printPlayFrameInfo",
                          value: function() {
                              l.a.log("FlvParser.playFrameInfo", this.timeStampStat.playVideoFrameCnt, this.timeStampStat.playAudioFrameCnt)
                          }
                      }, {
                          key: "getLastIFrameDts",
                          value: function() {
                              return this.ctrlBuffer.getLastIFrameDts()
                          }
                      }, {
                          key: "getFrameBufferLen",
                          value: function() {
                              return this.ctrlBuffer.getBufferLen()
                          }
                      }, {
                          key: "getAudioFrames",
                          value: function() {
                              return this.audioFrames
                          }
                      }, {
                          key: "getVideoFrames",
                          value: function() {
                              return this.videoFrames
                          }
                      }, {
                          key: "getFps",
                          value: function() {
                              return this.fps && this.fps.getFps()
                          }
                      }, {
                          key: "getAudioFps",
                          value: function() {
                              return this.audioFps && this.audioFps.getFps()
                          }
                      }, {
                          key: "getFrameReadyed",
                          value: function() {
                              return this.ctrlBuffer.getSize()
                          }
                      }, {
                          key: "setDecoctorTimeAbnormal",
                          value: function() {
                              var t = localStorage.decodeabnormal;
                              if (t && t.split("_").length > 1) {
                                  var e = parseInt(t.split("_")[1])
                                    , i = (new Date).getTime() - e;
                                  i && i > 864e5 ? (this.appendHighQualityEmptyAudio = !0,
                                  localStorage.decodeabnormal = "") : this.appendHighQualityEmptyAudio = !1
                              }
                          }
                      }, {
                          key: "destroy",
                          value: function() {
                              this.reset()
                          }
                      }, {
                          key: "reset",
                          value: function(t) {
                              l.a.log("FlvParser.reset"),
                              this.printFirstVideoTs = !1,
                              this.printFirstAudioTs = !1,
                              this.pfvTs = !1,
                              this.pfaTs = !1,
                              this.fps.reset(),
                              this.audioFps.reset(),
                              this.flvCacher.destroy(),
                              this.timeStampStat.reset(),
                              this.lastParseDts = 0,
                              this.hasAudioTag = !1,
                              this.lastAacTs = 0,
                              this.hasKeyFrame = !1,
                              this.lastAudioTs = 0,
                              this.lastVideoTs = 0,
                              this.showH265Tip = !1,
                              this.bufLen = 400,
                              this.remuxLen = this.firstBufLen,
                              this.hasCtsZero = !1,
                              this.hasRemuxed = !1,
                              this.audioIncreaseTSMap.clear(),
                              this.firstDemuxAudioTS = -1,
                              this.recvVideoFrameTimeStamp = 0,
                              this.recvVideoFrameNums = 0,
                              this.videoFramePlayDelayTs = 0,
                              this.videoFrameCalculatePlayDelayFrames = 0,
                              this.incompleteFlvheaderLen = 0,
                              this.parseFlvHead = !1,
                              this.switchingUrl = !1,
                              this.droppingSample = null,
                              this.decodeIFRTime = 0,
                              this.waitRemuxTime = 0,
                              this.isFirstRemux = !1,
                              this.av1Bytes = 0,
                              this.onAV1SequenceHeaderBind = null,
                              this.onAV1MetaDataBind = null
                          }
                      }, {
                          key: "getPlayStat",
                          value: function() {
                              var t = {
                                  videoFrameCnt: this.playVideoFrameCnt,
                                  videoLength: this.playVideoLength,
                                  audioFrameCnt: this.playAudioFrameCnt,
                                  audioLength: this.playAudioLength,
                                  emptyAudioFrameCnt: this.playEmptyAudioFrameCnt
                              };
                              return this.playVideoFrameCnt = 0,
                              this.playVideoLength = 0,
                              this.playAudioFrameCnt = 0,
                              this.playAudioLength = 0,
                              this.playEmptyAudioFrameCnt = 0,
                              t
                          }
                      }, {
                          key: "setPaused",
                          value: function(t) {
                              this.paused = t
                          }
                      }, {
                          key: "setPushGop",
                          value: function(t) {
                              this.pushGop = t,
                              l.a.log("FlvParser.setPushGop " + t)
                          }
                      }, {
                          key: "setDeleteH264Aud",
                          value: function(t) {
                              this.deleteH264Aud = t,
                              l.a.log("FlvParser.deleteH264Aud " + t)
                          }
                      }, {
                          key: "setNeedEmptyAudioFrame",
                          value: function(t) {
                              this.ctrlBuffer.setNeedEmptyAudioFrame(t),
                              l.a.log("FlvParser.setNeedEmptyAudioFrame " + t)
                          }
                      }, {
                          key: "getParserBufLen",
                          value: function() {
                              return this.ctrlBuffer.getBufferLen()
                          }
                      }, {
                          key: "setDroppingSample",
                          value: function(t) {
                              this.droppingSample = t
                          }
                      }, {
                          key: "parseFlv",
                          value: function(t) {
                              var e = 0;
                              if (this.headCache) {
                                  var s = new Uint8Array(t.length + this.headCache.length);
                                  s.set(this.headCache, 0),
                                  s.set(t, this.headCache.length),
                                  t = s
                              }
                              var a, r = t.length;
                              if (!1 === this.parseFlvHead) {
                                  var n = i.FLV_HEADER_LEN + i.PREV_TAG_SIZE_LEN;
                                  if (r < n)
                                      return l.a.warn("FlvParser.parseFlv flv has no header len=" + r),
                                      void (this.headCache = t.slice());
                                  if (this.headCache = null,
                                  e += n,
                                  !i.probe(t))
                                      return;
                                  this.parseFlvHead = !0,
                                  this.beginParseTs = Date.now()
                              }
                              for (0 === e ? this.flvCacher.append(t) : this.flvCacher.append(t.slice(e)); null !== (a = this.flvCacher.popFrame()); )
                                  this.parseTag(a)
                          }
                      }, {
                          key: "parseTag",
                          value: function(t) {
                              var e = t.length;
                              if (e < i.TAG_HEADER_LEN + i.PREV_TAG_SIZE_LEN)
                                  l.a.warn("FlvParser.parseTag flv has no whole tag len=" + e + " data=" + t);
                              else {
                                  var s = 0
                                    , a = t[s++]
                                    , r = (t[s++] << 16) + (t[s++] << 8) + t[s++];
                                  if (e - (i.TAG_HEADER_LEN + i.PREV_TAG_SIZE_LEN) < r)
                                      l.a.warn("FlvParser.parseTag flv has no enough data dataLen=" + r + " len=" + e);
                                  else if (0 !== r) {
                                      var n = (t[s++] << 16) + (t[s++] << 8) + t[s++] + parseInt(t[s++].toString(16) + "000000", 16);
                                      s += 3,
                                      a === i.VIDEO_TYPE ? (this.avSample.addVideoSample(e, n),
                                      Pt || this.mse.isPureAudio || (this.parseVideo(t, 11, r, n),
                                      this.mse.setExceptionStat(d.a.DIM_LINK_STA.VIDEO_FRAME, 1))) : a === i.AUDIO_TYPE ? (this.avSample.addAudioSample(e, n),
                                      St || this.mse.isPureVideo || (this.parseAudio(t, 11, r, n),
                                      this.mse.setExceptionStat(d.a.DIM_LINK_STA.AUDIO_FRAME, 1))) : a === i.SCRIPT_TYPE ? this.parseScriptTag(t, 11, r, n) : (l.a.warn("%cFlvParser.parseTag discard type=" + a + " len=" + r, "color:white;background:black"),
                                      this.mse && this.mse.onVideoParseInvalid && this.mse.onVideoParseInvalid())
                                  } else
                                      l.a.warn("FlvParser.parseTag flvtag empty type=" + a)
                              }
                          }
                      }, {
                          key: "parseScriptTag",
                          value: function(t, e, s, a) {
                              if (e + i.SCRIPT_AMF1_HEAD_LEN > s)
                                  l.a.log("script too small");
                              else {
                                  t[e++];
                                  var r = (t[e++] << 8) + t[e++]
                                    , n = x.getStr(t, e, r);
                                  e += r,
                                  "onMetaData" === n ? Object.assign(this.mse.metadata, x.parseScript(t, e, t.length).data) : -1 !== n.indexOf("onMixAudio") && this.mse.scriptVolumeInfos.addMixAudio(n.replace("onMixAudio:", ""), a)
                              }
                          }
                      }, {
                          key: "parseVideo",
                          value: function(t, e, s, a) {
                              if (s < 5)
                                  l.a.warn("FlvParser.parseVideo avc videotag not enough dataLen=" + s);
                              else {
                                  var r = t[e] >> 4;
                                  this.codec = 15 & t[e++];
                                  var n = t[e++];
                                  if (5 !== s)
                                      if (0 === n)
                                          this.parseVideoConfig(t, e, s, a);
                                      else if (1 === n) {
                                          if (r == i.IFRAME)
                                              this.mse.setExceptionStat(d.a.DIM_LINK_STA.VIDEO_IFRAME, 1),
                                              this.hasKeyFrame || (this.decodeIFRTime = c.a.now()),
                                              this.hasKeyFrame = !0;
                                          else if (!this.hasKeyFrame)
                                              return void l.a.log("-------- drop video tag has no IFrame", a);
                                          Number(localStorage._printVideoTs) && l.a.debug("%cFlvParser video ts", "color:green", a, a - this.lastVideoTs),
                                          this.lastVideoTs > 0 && a - this.lastVideoTs > 200 && l.a.warn("FlvParser video dts jump lastDts=".concat(this.lastVideoTs, " curDts=").concat(a, " gap=").concat(a - this.lastVideoTs)),
                                          this.lastVideoTs = a,
                                          this.parseVideoNalu(t, e, s, a, r)
                                      } else
                                          2 === n ? l.a.info("%cFlvParser.parseVideo avc_end dataLen=" + s, "color:white;background:black") : l.a.warn("%cFlvParser.parseVideo error avc packet type=" + n, "color:white;background:black");
                                  else
                                      l.a.log("FlvParser.parseVideo avc_empty frameType=" + r + " avcPacketType=" + n)
                              }
                          }
                      }, {
                          key: "onAV1SequenceHeader",
                          value: function(t) {
                              var e = "av01." + t.seq_profile + "." + ot.zeroPad(t["seq_level_idx[0]"], 2) + (t["seq_tier[0]"] ? "H" : "M") + "." + ot.zeroPad(t.BitDepth, 2) + "." + t.mono_chrome + "." + t.subsampling_x + t.subsampling_y + (1 === t.subsampling_x && 1 === t.subsampling_y ? t.chroma_sample_position : 0);
                              t.color_description_present_flag && (e += "." + ot.zeroPad(t.colorPrimaries, 2) + "." + ot.zeroPad(t.transferCharacteristics, 2) + "." + ot.zeroPad(t.matrixCoefficients, 2) + "." + t.color_range);
                              var i = t.max_frame_width_minus_1 + 1
                                , s = t.max_frame_height_minus_1 + 1
                                , a = {
                                  isHevc: !1,
                                  isAV01: !0,
                                  width: i,
                                  height: s,
                                  codec: e
                              };
                              this.mse.setExceptionStat(d.a.DIM_LINK_STA.VIDEO_CONFIG, 1),
                              this.mse.setResolution(i, s),
                              this.remuxer.switchLevel(!1, !1),
                              this.ctrlBuffer.updateVideoConfig(a, !1)
                          }
                      }, {
                          key: "onAV1MetaData",
                          value: function(t, e) {
                              e.itu_t_t35_payload_bytes && this.sei.parseSei(t, e.itu_t_t35_payload_bytes, at.AV1_CODEC_TYPE, this.seiTypes)
                          }
                      }, {
                          key: "parseVideoConfig",
                          value: function(t, e, s, a) {
                              var r, n, o = [], h = [], u = [], c = !1, p = null, f = (e += 3) + s - 5;
                              if (this.isAv01()) {
                                  this.av1Bytes = t.subarray(e, e + s - 5);
                                  var _ = t.subarray(e += 4, e + s);
                                  ot.parseOBU(_, 0, this.onAV1SequenceHeaderBind)
                              } else {
                                  if (this.isHevc()) {
                                      this.showH265Tip || (this.showH265Tip = !0,
                                      l.a.warn("This is a H265 video.")),
                                      this.mse.setExceptionStat(d.a.DIM_LINK_STA.H265, 1);
                                      for (var m = (126 & t[e += 4]) >> 1, v = e; e < f; ) {
                                          if (this.isHevcNal(t, e) || e + 1 === f) {
                                              switch (m) {
                                              case i.NAL_VPS:
                                                  var y = {
                                                      data: t.subarray(v, e),
                                                      type: m
                                                  };
                                                  this.vpsUnit && this.vpsUnit.data.toString(16) !== y.data.toString(16) && (l.a.log("FlvParser.parseVideoConfig vps changed"),
                                                  c = !0),
                                                  this.vpsUnit = y,
                                                  u.push(y.data);
                                                  break;
                                              case i.NAL_SPS:
                                                  var T = {
                                                      data: t.subarray(v, e),
                                                      type: m
                                                  };
                                                  this.spsUnit && this.spsUnit.data.toString(16) !== T.data.toString(16) && (l.a.log("FlvParser.parseVideoConfig sps changed"),
                                                  c = !0),
                                                  this.spsUnit = T,
                                                  o.push(T.data);
                                                  break;
                                              case i.NAL_PPS:
                                                  var g = {
                                                      data: t.subarray(v, e),
                                                      type: m
                                                  };
                                                  this.ppsUnit && this.ppsUnit.data.toString(16) !== g.data.toString(16) && (l.a.log("FlvParser.parseVideoConfig pps changed"),
                                                  c = !0),
                                                  this.ppsUnit = g,
                                                  h.push(g.data)
                                              }
                                              if (e + 4 < f) {
                                                  m = (126 & t[e += 4]) >> 1,
                                                  v = e;
                                                  continue
                                              }
                                          }
                                          e++
                                      }
                                      p = {
                                          isHevc: !0,
                                          isAV01: !1,
                                          vps: u,
                                          sps: o,
                                          pps: h,
                                          codec: "avc1.4d401f",
                                          width: this.mse.width,
                                          height: this.mse.height
                                      },
                                      this.hasCtsZero = !0
                                  } else {
                                      e += 4,
                                      this.lengthSizeMinusOne = 3 & t[e++];
                                      for (var S = 0, P = 0, E = "", I = 31 & t[e++], A = 0; A < I; ++A) {
                                          r = (t[e++] << 8) + t[e++];
                                          var C = {
                                              data: t.subarray(e, e + r),
                                              type: 7
                                          };
                                          this.spsUnit && this.spsUnit.data.toString(16) !== C.data.toString(16) && (l.a.log("FlvParser.parseVideoConfig sps changed"),
                                          c = !0),
                                          this.spsUnit = C,
                                          e += r,
                                          o.push(C.data);
                                          var k = new O(C.data).readSPS();
                                          S = k.width,
                                          P = k.height;
                                          for (var b = C.data.subarray(1, 4), R = "avc1.", L = 0; L < 3; L++) {
                                              var w = b[L].toString(16);
                                              w.length < 2 && (w = "0" + w),
                                              R += w
                                          }
                                          E = R
                                      }
                                      for (var D = t[e++], N = 0; N < D; ++N) {
                                          n = (t[e++] << 8) + t[e++];
                                          var F = {
                                              data: t.subarray(e, e + n),
                                              type: 8
                                          };
                                          this.ppsUnit && this.ppsUnit.data.toString(16) !== F.data.toString(16) && (l.a.log("FlvParser.parseVideoConfig pps changed"),
                                          c = !0),
                                          this.ppsUnit = F,
                                          e += n,
                                          h.push(F.data)
                                      }
                                      p = {
                                          isHevc: !1,
                                          isAV01: !1,
                                          sps: o,
                                          pps: h,
                                          width: S,
                                          height: P,
                                          codec: E
                                      },
                                      this.mse.setExceptionStat(d.a.DIM_LINK_STA.VIDEO_CONFIG, 1),
                                      this.mse.setResolution(S, P)
                                  }
                                  this.remuxer.switchLevel(c, !1),
                                  this.ctrlBuffer.updateVideoConfig(p, c),
                                  l.a.log("FlvParser.parseVideoConfig avccfg dataLen=" + s + " spsLen=" + r + " ppsLen=" + n + " w/h=" + p.width + "/" + p.height + " codec=" + p.codec)
                              }
                          }
                      }, {
                          key: "parseVideoNalu",
                          value: function(t, e, s, a, r) {
                              var n, o, h = [], u = 0, c = r === i.IFRAME, d = (t[e++] << 16) + (t[e++] << 8) + t[e++];
                              0 === d ? this.hasCtsZero || (this.hasCtsZero = !0) : d >= 8388608 ? d -= 16777216 : d > 2500 && d < 3500 ? d = 0 : d > 600 && l.a.warn("FlvParser.parseVideoNalu large cts=" + d + " dts=" + a),
                              c && !this.isAv01() && (this.vpsUnit && (h.push(this.vpsUnit),
                              u += this.vpsUnit.data.length),
                              this.spsUnit && (h.push(this.spsUnit),
                              u += this.spsUnit.data.length),
                              this.ppsUnit && (h.push(this.ppsUnit),
                              u += this.ppsUnit.data.length));
                              var p = e + s - 5
                                , f = !1;
                              if (this.seiTypes = {},
                              this.isAv01()) {
                                  var _ = t.subarray(e, e + s - 5);
                                  h.push({
                                      data: _,
                                      type: 1 === r ? 5 : 1
                                  }),
                                  ot.parseOBU(_, a, null, this.onAV1MetaDataBind),
                                  u += _.length,
                                  n = 1
                              } else if (this.isHevc()) {
                                  var m = this.hevcFindNextStartCode(t, e);
                                  if (!m.found)
                                      return l.a.error("hevcFindNextStartCode failed! dataLen", s),
                                      void this.mse.on265StartCodeError();
                                  for (var v = (126 & t[e += m.startCodeSize]) >> 1, y = e; e < p; )
                                      ((m = this.hevcFindNextStartCode(t, e)).found || e + 1 === p) && (v < 10 && (f = !((98 & v) >> 1)),
                                      o = {
                                          data: t.subarray(y, e),
                                          type: v
                                      },
                                      39 === v ? this.sei.parseSei(a, o.data, at.H265_CODEC_TYPE, this.seiTypes) : (h.push(o),
                                      u += o.data.length),
                                      e + m.startCodeSize < p) ? (v = (126 & t[e += m.startCodeSize]) >> 1,
                                      y = e) : e++
                              } else
                                  for (var T = s - 5; T; ) {
                                      n = 0;
                                      for (var g = 0; g <= this.lengthSizeMinusOne; ++g)
                                          n += t[e++] << 8 * (this.lengthSizeMinusOne - g);
                                      if (T -= this.lengthSizeMinusOne + 1,
                                      0 !== n) {
                                          if (n < 0 || n > s - 5)
                                              break;
                                          if (n > T) {
                                              e += T;
                                              break
                                          }
                                          T -= n,
                                          o = {
                                              data: t.subarray(e, e + n),
                                              type: 1 === r ? 5 : 1
                                          },
                                          this.isH264Sei(o.data) ? this.sei.parseSei(a, o.data, at.H264_CODEC_TYPE, this.seiTypes) : this.isH264NALUPPS(o.data) ? (h.push(o),
                                          u += o.data.length) : this.isH264Aud(o.data) && this.deleteH264Aud || (h.push(o),
                                          u += o.data.length),
                                          e += n
                                      }
                                  }
                              if (u > 0) {
                                  var S = {
                                      type: this.isAv01() ? "av01" : "avc",
                                      units: h,
                                      len: u,
                                      ts: a,
                                      cts: d,
                                      dts: 90 * a,
                                      pts: 90 * (a + d),
                                      key: r === i.IFRAME,
                                      origin_iframe: 1 === this.seiTypes[at.SEI_TYPES.IFRAME],
                                      isBFrameType: f,
                                      av1Bytes: this.av1Bytes
                                  };
                                  if (this.droppingSample && this.droppingSample(S))
                                      return;
                                  this.printFirstVideoTs || (this.printFirstVideoTs = !0,
                                  l.a.log("FlvParser.parseVideo dts=".concat(a, " pts=").concat(S.pts / 90, " isIFrame=").concat(c))),
                                  this.pfvTs || (this.pfvTs = !0,
                                  l.a.log("FlvParser.parseVideo11 dts=".concat(a, " pts=").concat(S.pts / 90, " isIFrame=").concat(c))),
                                  this.fps.addDts(a, s),
                                  this.mse.curVideoDts = a,
                                  this.lastParseDts = a,
                                  this.videoFrames++,
                                  this.timeStampStat.setTimeStamp(a, a + d, d),
                                  this.ctrlBuffer.addSample(S),
                                  this.playVideoFrameCnt++,
                                  this.timeStampStat.playVideoFrameCnt++,
                                  this.playVideoLength += s
                              } else
                                  l.a.warn("FlvParser.parseVideoNalu discard empty nalu dts=" + a + " pts=" + (a + d) + " dataLen=" + s + " naluLen=" + n)
                          }
                      }, {
                          key: "parseAudio",
                          value: function(t, e, s, a) {
                              var r = t[e++] >>> 4
                                , n = !0
                                , o = a;
                              10 != r && l.a.error("FlvParser.parseAudio Unsupported audio codec, soundFormat=" + r),
                              this.calcAudioFrameRate(a),
                              null != this.audioIncreaseTSMap.get(a) && (a = this.audioIncreaseTSMap.get(a)),
                              a < this.lastAudioTs && 0 != this.lastAudioTs && (n = !1);
                              var h = t[e++];
                              if (0 === h)
                                  if (s >= 4) {
                                      var u = t[e] >> 3;
                                      this.audioObjectType = u;
                                      var c = ((7 & t[e]) << 1) + ((128 & t[e + 1]) >> 7);
                                      if (c >= i.AdtsSampleingRates.length)
                                          return void l.a.error("FlvParser.parseAudio SampleingRate out of bounds. samplingIndex=" + c);
                                      this.audioChannelCount = (120 & t[e + 1]) >> 3;
                                      var p = !1
                                        , f = this.getAdtsConfig(u, c, this.audioChannelCount);
                                      f.toString(16) !== this.audioConfig.toString(16) && (this.audioConfig.toString(16) === It.toString(16) && this.remuxer.videoISGenerated && (p = !0),
                                      l.a.warn("FlvParser.parseAudio adts changed old=" + this.audioConfig + " new=" + f)),
                                      this.audioConfig = f,
                                      this.ctrlBuffer.updateAudioConfig({
                                          config: f,
                                          codec: "mp4a.40.5",
                                          audiosamplerate: this.audioSampleRate,
                                          aacTimeLen: this.aacTimeLen,
                                          audioObjectType: this.audioObjectType,
                                          audioChannelCount: this.audioChannelCount
                                      }, p),
                                      this.firstAudioTs = -1,
                                      this.firstDemuxAudioTS = -1,
                                      this.lastAudioTs = 0,
                                      this.remuxer.switchLevel(!1, p),
                                      this.mse.setExceptionStat(d.a.DIM_LINK_STA.AUDIO_CONFIG, 1)
                                  } else
                                      l.a.warn("FlvParser.parseAudio adts error dataLen=" + s + " ts=" + a);
                              else if (1 === h) {
                                  if (this.last10anduiptsList.shift(),
                                  this.last10anduiptsList.push(a),
                                  -1 == this.firstAudioTs && (this.firstAudioTs = a),
                                  -1 == this.firstDemuxAudioTS)
                                      this.firstDemuxAudioTS = a;
                                  else if (a == this.firstDemuxAudioTS)
                                      return void l.a.warn("parseaudio audio too much audio in firstTs ts=" + a);
                                  if (!n)
                                      return void l.a.warn("parseaudio audio ts too small maxlist=" + this.maxaudioptsList + "  now=" + a + "  first=" + this.firstAudioTs + "  last=" + this.lastAudioTs);
                                  for (var _ = 0; _ < 10; _++)
                                      this.maxaudioptsList[_] = this.last10anduiptsList[_];
                                  if (this.lastAudioTs > 0 && this.lastAudioTs == a) {
                                      var m = a + (0 | this.aacTimeLen);
                                      this.audioIncreaseTSMap.set(o, m),
                                      a = m
                                  }
                                  if (Number(localStorage._printAudioTs) && l.a.debug("%cFlvParser audio ts", "color:red", a, a - this.lastAudioTs),
                                  this.lastAudioTs = a,
                                  this.hasAudioTag = !0,
                                  !this.validAacSample(a))
                                      return;
                                  var v = s - 2
                                    , y = {
                                      type: "aac",
                                      unit: t.subarray(e, e + v),
                                      dts: 90 * a,
                                      pts: 90 * a,
                                      ts: a
                                  };
                                  if (this.droppingSample && this.droppingSample(y))
                                      return;
                                  this.printFirstAudioTs || (this.printFirstAudioTs = !0,
                                  l.a.log("FlvParser.parseAudio", a)),
                                  this.pfaTs || (this.pfaTs = !0,
                                  l.a.log("FlvParser.parseAudio11", a)),
                                  this.audioFps.addDts(a),
                                  this.mse.curAudioDts = a,
                                  this.lastParseDts = a,
                                  this.audioFrames++,
                                  this.ctrlBuffer.addSample(y)
                              } else
                                  l.a.warn("FlvParser.parseAudio error aac packet type=" + h)
                          }
                      }, {
                          key: "validAacSample",
                          value: function(t) {
                              var e = this.ctrlBuffer.avBuffer.aBuffer.samples
                                , i = e.length;
                              if (i > 0) {
                                  var s = e[i - 1];
                                  return 1 === i && s.ts > t && s.ts - t > this.validAacTime ? (e.shift(),
                                  !0) : t - s.ts < this.validAacTime
                              }
                              return !0
                          }
                      }, {
                          key: "getAdtsConfig",
                          value: function(t, e, s) {
                              var a = 0
                                , r = null
                                , n = navigator.userAgent.toLowerCase();
                              return -1 !== n.indexOf("firefox") ? e >= 6 ? (t = 5,
                              r = new Array(4),
                              a = e - 3) : (t = 2,
                              r = new Array(2),
                              a = e) : -1 !== n.indexOf("android") ? -1 !== n.indexOf("mqqbrowser") ? (t = 2,
                              r = new Array(2),
                              a = e) : (t = 5,
                              r = new Array(4),
                              a = e) : (t = 5,
                              r = new Array(4),
                              a = e,
                              e >= 6 ? a = e - 3 : 1 === s && (t = 2,
                              r = new Array(2),
                              a = e)),
                              this.audioSampleRate = i.AdtsSampleingRates[e],
                              this.aacTimeLen = 1024e3 / this.audioSampleRate,
                              l.a.log("FlvParser.getAdtsConfig audioSampleRate=" + this.audioSampleRate + " aacTimeLen=" + this.aacTimeLen),
                              r[0] = t << 3,
                              r[0] |= (14 & e) >> 1,
                              r[1] = (1 & e) << 7,
                              r[1] |= s << 3,
                              5 === t && (r[1] |= (14 & a) >> 1,
                              r[2] = (1 & a) << 7,
                              r[2] |= 8,
                              r[3] = 0),
                              l.a.log("FlvParser.getAdtsConfig type=" + t + " index=" + e + " channel=" + s + " exIndex=" + a + " config=" + r),
                              r
                          }
                      }, {
                          key: "parseOBUHeader",
                          value: function(t) {
                              var e = {};
                              return e.obu_forbidden_bit = t >> 7,
                              e.obu_type = (120 & t) >> 3,
                              e.obu_extension_flag = (4 & t) >> 2,
                              e.obu_has_size_field = (2 & t) >> 1,
                              e.obu_reserved_1bit = 1 & t,
                              e
                          }
                      }, {
                          key: "isHevc",
                          value: function() {
                              return 12 == this.codec
                          }
                      }, {
                          key: "isAv01",
                          value: function() {
                              return 13 == this.codec
                          }
                      }, {
                          key: "hevcFindNextStartCode",
                          value: function(t, e) {
                              return 0 === t[e] && 0 === t[e + 1] ? 1 === t[e + 2] ? {
                                  found: !0,
                                  startCodeSize: 3
                              } : 0 === t[e + 2] && 1 === t[e + 3] ? {
                                  found: !0,
                                  startCodeSize: 4
                              } : {
                                  found: !1
                              } : {
                                  found: !1
                              }
                          }
                      }, {
                          key: "isHevcNal",
                          value: function(t, e) {
                              return 0 === t[e] && 0 === t[e + 1] && 0 === t[e + 2] && 1 === t[e + 3]
                          }
                      }, {
                          key: "isH264Sei",
                          value: function(t) {
                              return 6 === t[0]
                          }
                      }, {
                          key: "isH264Aud",
                          value: function(t) {
                              return 9 === t[0]
                          }
                      }, {
                          key: "isH264NALUPPS",
                          value: function(t) {
                              return 40 === t[0]
                          }
                      }, {
                          key: "getCalculateVideoFramePlayDelay",
                          value: function() {
                              return 0
                          }
                      }, {
                          key: "_remux",
                          value: function(t, e) {
                              this.remuxer.remux(e, t, 0, !1)
                          }
                      }, {
                          key: "calcAudioFrameRate",
                          value: function(t) {
                              this.audioFrameRateTs || (this.audioFrameRateTs = t,
                              this.audioFrameCnt = 0),
                              t - this.audioFrameRateTs < 1e3 ? this.audioFrameCnt++ : (Number(localStorage._printAudioFrameRate) && l.a.log("@@@@@@@@ audioFrameRate=" + this.audioFrameCnt),
                              this.audioFrameRateTs = t,
                              this.audioFrameCnt = 0)
                          }
                      }], [{
                          key: "probe",
                          value: function(t) {
                              return !(70 !== t[0] || 76 !== t[1] || 86 !== t[2] || 1 !== t[3])
                          }
                      }]),
                      i
                  }(H);
                  At.EVENTS = {
                      META_DATA: "meta_data",
                      SWITCH_URL_DONE: "switch_url_done"
                  },
                  At.REMUX_TYPE_AUDIO = 0,
                  At.REMUX_TYPE_VIDEO = 1,
                  At.FLV_HEADER_LEN = 9,
                  At.TAG_HEADER_LEN = 11,
                  At.PREV_TAG_SIZE_LEN = 4,
                  At.AUDIO_TYPE = 8,
                  At.VIDEO_TYPE = 9,
                  At.SCRIPT_TYPE = 18,
                  At.SCRIPT_AMF1_HEAD_LEN = 13,
                  At.SCRIPT_AMF2_HEAD_LEN = 5,
                  At.IFRAME = 1,
                  At.NAL_VPS = 32,
                  At.NAL_SPS = 33,
                  At.NAL_PPS = 34,
                  At.H265_SEI_HEAD = [44, 162, 222, 9, 181, 23, 71, 219, 187, 85, 164, 254, 127, 194, 252, 78],
                  At.AdtsSampleingRates = [96e3, 88200, 64e3, 48e3, 44100, 32e3, 24e3, 22050, 16e3, 12e3, 11025, 8e3, 7350];
                  var Ct = At
                    , kt = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.seiList = [],
                          this.player = e,
                          this.lastTs = -1,
                          this.internal = 10,
                          this.timerStart = !1
                      }
                      return Object(a.a)(t, [{
                          key: "add",
                          value: function(t, e) {
                              var i = this.seiList.length;
                              if (this.seiList.length > 0)
                                  for (i = this.seiList.length - 1; i > 0 && !(t > this.seiList[i].timeStamp); i--)
                                      ;
                              this.seiList.splice(i + 1, 0, {
                                  timeStamp: t,
                                  data: e
                              }),
                              this.timerStart || (this.timerStart = !0,
                              setTimeout(this.checkDispatchSei.bind(this), this.internal))
                          }
                      }, {
                          key: "checkDispatchSei",
                          value: function() {
                              if (this.timerStart) {
                                  for (var t = this.player.getCurrentRealTime(), e = 0, i = null; e < this.seiList.length - 2; ) {
                                      if (t >= this.seiList[e].timeStamp && this.seiList[e + 1].timeStamp > t) {
                                          i = this.seiList[e + 1].data,
                                          this.player.onH264Sei(i, this.seiList[e + 1].timeStamp),
                                          this.seiList.splice(0, e + 1);
                                          break
                                      }
                                      e++
                                  }
                                  setTimeout(this.checkDispatchSei.bind(this), this.internal)
                              }
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              this.seiList = [],
                              this.player = null,
                              this.lastTs = -1,
                              this.timerStart = !1
                          }
                      }]),
                      t
                  }()
                    , bt = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.volumeList = [],
                          this.player = e,
                          this.lastTs = -1,
                          this.internal = 100,
                          this.timerStart = !1,
                          this.dispatchMap = new Map
                      }
                      return Object(a.a)(t, [{
                          key: "addMixAudio",
                          value: function(t, e) {
                              if (t.length > 0)
                                  for (var i = t.split(","), s = 0; s < i.length; s++)
                                      this.add(e, i[s])
                          }
                      }, {
                          key: "add",
                          value: function(t, e) {
                              var i = this.volumeList.length;
                              if (this.volumeList.length > 0)
                                  for (i = this.volumeList.length - 1; i > 0 && !(t > this.volumeList[i].timeStamp); i--)
                                      ;
                              this.volumeList.splice(i + 1, 0, {
                                  timeStamp: t,
                                  data: e
                              }),
                              this.timerStart || (this.timerStart = !0,
                              setTimeout(this.checkDispatchVolume.bind(this), this.internal))
                          }
                      }, {
                          key: "checkDispatchVolume",
                          value: function() {
                              var t = this;
                              if (this.timerStart) {
                                  var e = this.player.getCurrentRealTime()
                                    , i = 0;
                                  for (this.dispatchMap.clear(); this.volumeList[i] && this.volumeList[i].timeStamp < e; ) {
                                      var s = this.volumeList[i].data.split("_");
                                      s.length > 1 && this.dispatchMap.set(s[0], s[1]),
                                      i++
                                  }
                                  this.dispatchMap.forEach((function(e, i, s) {
                                      t.player.onScriptVolumeInfo(i, e)
                                  }
                                  )),
                                  this.dispatchMap.clear(),
                                  this.volumeList.splice(0, i),
                                  this.volumeList.length > 0 ? setTimeout(this.checkDispatchVolume.bind(this), this.internal) : this.timerStart = !1
                              }
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              this.volumeList = [],
                              this.player = null,
                              this.lastTs = -1,
                              this.timerStart = !1
                          }
                      }]),
                      t
                  }()
                    , Rt = function() {
                      function t(e, i) {
                          Object(s.a)(this, t),
                          this.mse = e,
                          this.video = i,
                          this.playing = !1,
                          this.seekTime = 0,
                          this.isMuffled = !1,
                          this.cacheVolume = 1,
                          i.addEventListener("pause", e.onVideoPauseBind),
                          i.addEventListener("error", e.onVideoErrorBind),
                          i.addEventListener("play", e.onVideoPlayBind),
                          i.addEventListener("playing", e.onVideoPlayingBind),
                          i.addEventListener("loadeddata", e.onVideoLoadedBind)
                      }
                      return Object(a.a)(t, [{
                          key: "seek",
                          value: function(t) {
                              this.seekTime = t,
                              this.video && (this.video.currentTime = t)
                          }
                      }, {
                          key: "_checkPlay",
                          value: function() {
                              l.a.log("MSEVideo.checkPlay seekTime=".concat(this.seekTime, " playing=").concat(this.playing, " currentTime=").concat(this.video && this.video.currentTime)),
                              this.video && 0 === this.video.currentTime && !this.playing ? (this.seekTime > 0 ? (this.seekTime++,
                              this.video.currentTime = this.seekTime) : this.video.currentTime += 1,
                              this._play()) : k.a.remove(this._checkPlay, this)
                          }
                      }, {
                          key: "play",
                          value: function() {
                              "safari" !== _.a.name || this.mse.isLive ? (this._play(),
                              k.a.add(this._checkPlay, this, 1e3)) : k.a.add(this._checkPlay, this, 1e3)
                          }
                      }, {
                          key: "_play",
                          value: function() {
                              var t = this;
                              if (this.video) {
                                  var e = this.video.play();
                                  e ? e.then((function() {
                                      k.a.remove(t._checkPlay, t),
                                      l.a.log("MSEVideo._play suc currentTime=".concat(t.video && t.video.currentTime)),
                                      t.mse && t.mse.handler.eventEmitter && t.mse.handler.eventEmitter.roomRecordStat && t.mse.handler.eventEmitter.roomRecordStat.roomNoRenderStat.resume(),
                                      o.a.platform === C.a.PLATFORM_TYPE_NAME.wap && !t.playing && t.mse && t.mse.triggerH5PlayVideo(),
                                      t.playing = !0
                                  }
                                  )).catch((function(e) {
                                      t.playing = !1;
                                      var i = e.toString();
                                      l.a.error("MSEVideo.play error: ".concat(i)),
                                      t.mse && (i.indexOf("NotAllowedError") >= 0 || i.indexOf("request was interrupted") >= 0 || t.video.paused) && (t.mse && t.mse.onPauseByBrowser(),
                                      o.a.platform === C.a.PLATFORM_TYPE_NAME.wap && k.a.remove(t._checkPlay, t))
                                  }
                                  )) : this.playing = !1
                              } else
                                  k.a.remove(this._checkPlay, this)
                          }
                      }, {
                          key: "pause",
                          value: function() {
                              this.video.pause()
                          }
                      }, {
                          key: "getBufferLen",
                          value: function() {
                              var t = 0;
                              if (this.video) {
                                  var e = this.video.buffered;
                                  e.length > 0 && (t = 1e3 * (e.end(e.length - 1) - this.video.currentTime) >> 0)
                              }
                              return t
                          }
                      }, {
                          key: "printBuffered",
                          value: function() {
                              for (var t = this.video.buffered, e = [], i = 0; i < t.length; i++)
                                  e.push("[".concat(t.start(i), ", ").concat(t.end(i), "]"));
                              l.a.log("video.buffered", e.join(" "), "video.currentTime=", this.video.currentTime)
                          }
                      }, {
                          key: "getCurrentTime",
                          value: function() {
                              return Math.round(1e3 * this.video.currentTime)
                          }
                      }, {
                          key: "setVolume",
                          value: function(t) {
                              this.isMuffled ? this.video.volume = 0 : this.video.volume = t,
                              this.cacheVolume = t
                          }
                      }, {
                          key: "setMuffledVolume",
                          value: function(t) {
                              this.isMuffled = t,
                              this.isMuffled ? this.video.volume = 0 : this.setVolume(this.cacheVolume)
                          }
                      }, {
                          key: "getVolume",
                          value: function() {
                              return this.video.volume
                          }
                      }, {
                          key: "setMuted",
                          value: function(t) {
                              this.video && (this.video.muted = t,
                              l.a.log("MSEVideo.setMuted ".concat(t, " hasVideo=").concat(!!this.videoSourceBuffer, " hasAudio=").concat(!!this.audioSourceBuffer)))
                          }
                      }, {
                          key: "getMuted",
                          value: function() {
                              return this.video ? this.video.muted : -1
                          }
                      }, {
                          key: "destroy",
                          value: function() {
                              this.video.removeEventListener("error", this.mse.onVideoErrorBind),
                              this.video.removeEventListener("pause", this.mse.onVideoPauseBind),
                              this.video.removeEventListener("play", this.mse.onVideoPlayBind),
                              this.video.removeEventListener("loadeddata", this.mse.onVideoLoadedBind),
                              this.pause(),
                              this.video.removeAttribute("src"),
                              "function" == typeof this.video.load && function() {
                                  try {
                                      this.video.load()
                                  } catch (t) {}
                              }(),
                              this.video = null,
                              this.mse = null
                          }
                      }]),
                      t
                  }()
                    , Lt = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.emptyTs = 0,
                          this.emptyTime = 0,
                          this.emptyCnt = 0,
                          this.aiEmptyTime = 0,
                          this.aiEmptyCnt = 0
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              this.emptyTs = 0,
                              this.emptyTime = 0,
                              this.emptyCnt = 0
                          }
                      }, {
                          key: "getStats",
                          value: function() {
                              var t = {
                                  emptyTime: this.emptyTime,
                                  emptyCnt: this.emptyCnt
                              };
                              return this.emptyTime = 0,
                              this.emptyCnt = 0,
                              t
                          }
                      }, {
                          key: "getAiStats",
                          value: function() {
                              var t = {
                                  aiEmptyTime: this.aiEmptyTime,
                                  aiEmptyCnt: this.aiEmptyCnt
                              };
                              return this.aiEmptyTime = 0,
                              this.aiEmptyCnt = 0,
                              t
                          }
                      }, {
                          key: "checkBuffer",
                          value: function(t, e) {
                              e < 200 && 0 === this.emptyTs ? this.emptyTs = t : e > 500 && this.emptyTs > 0 && (this.emptyTime += t - this.emptyTs,
                              this.aiEmptyTime += t - this.emptyTs,
                              this.emptyTs = 0,
                              this.emptyCnt++,
                              this.aiEmptyCnt++)
                          }
                      }]),
                      t
                  }()
                    , wt = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this._cnt = 0,
                          this._duration = 0,
                          this._pauseTs = 0,
                          this._aiCnt = 0,
                          this._aiDuration = 0
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              this.resetStat(),
                              this.resetAiStat(),
                              this._pauseTs = 0
                          }
                      }, {
                          key: "resetStat",
                          value: function() {
                              this._cnt = 0,
                              this._duration = 0
                          }
                      }, {
                          key: "pause",
                          value: function() {
                              0 === this._pauseTs && (this._pauseTs = c.a.now())
                          }
                      }, {
                          key: "resume",
                          value: function() {
                              this.calc(!0)
                          }
                      }, {
                          key: "calc",
                          value: function(t) {
                              if (this._pauseTs > 0) {
                                  var e = c.a.now()
                                    , i = e - this._pauseTs;
                                  i >= 200 && (this._cnt++,
                                  this._aiCnt++,
                                  this._duration += i,
                                  this._aiDuration += i),
                                  this._pauseTs = t ? 0 : e
                              }
                          }
                      }, {
                          key: "resetAiStat",
                          value: function() {
                              this._aiCnt = 0,
                              this._aiDuration = 0
                          }
                      }, {
                          key: "getAiStat",
                          value: function() {
                              var t = {
                                  aiCnt: this._aiCnt,
                                  aiDuration: this._aiDuration
                              };
                              return this.resetAiStat(),
                              t
                          }
                      }, {
                          key: "record",
                          value: function(t) {
                              this.calc(!1),
                              t.setCore(d.a.CORE.VIDEO_BLOCK_COUNT, this._cnt),
                              t.setCore(d.a.CORE.VIDEO_BLOCK_DURATION, this._duration),
                              this.resetStat()
                          }
                      }]),
                      t
                  }()
                    , Ot = i(21)
                    , Dt = function() {
                      function t(e, i) {
                          Object(s.a)(this, t),
                          this._mse = e,
                          this._callbacks = i,
                          this._paused = !1,
                          this._playedTime = 0,
                          this._pausedTs = 0,
                          this._lastPausedTs = 0
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              this._paused = !1,
                              this._playedTime = 0,
                              this._pausedTs = 0,
                              this._lastPausedTs = 0
                          }
                      }, {
                          key: "check",
                          value: function(t) {
                              var e = this._mse.video.video;
                              !this._mse.isLive && e.currentTime <= 1 || (0 !== this._playedTime && (e.currentTime === this._playedTime ? this._paused ? this._fixedCurrentTime(t, e) : this._setPaused(t, e) : this._paused && this._setResume(t, e)),
                              this._playedTime = e.currentTime)
                          }
                      }, {
                          key: "_setPaused",
                          value: function(t, e) {
                              this._paused = !0,
                              this._pausedTs = t,
                              this._lastPausedTs = t,
                              this._log("_setPaused", e),
                              this._callbacks.pause(t)
                          }
                      }, {
                          key: "_setResume",
                          value: function(t, e) {
                              var i = t - this._pausedTs;
                              this._paused = !1,
                              this._pausedTs = 0,
                              this._lastPausedTs = 0,
                              this._log("_setResume", e),
                              this._callbacks.resume(t, i)
                          }
                      }, {
                          key: "_fixedCurrentTime",
                          value: function(t, e) {
                              t - this._lastPausedTs > 500 && (this._fixedByBuffered(e) || this._fixedByDts(e)) && (this._lastPausedTs = t)
                          }
                      }, {
                          key: "_fixedByBuffered",
                          value: function(t) {
                              if ("flv" === this._mse.videoType) {
                                  var e = t.buffered.length;
                                  if (e > 0) {
                                      var i = t.buffered.start(e - 1)
                                        , s = t.buffered.end(e - 1);
                                      if (i > t.currentTime && s - i > 1)
                                          return this._log("_fixedByBuffered", t),
                                          t.currentTime = i,
                                          !0
                                  }
                              }
                              return !1
                          }
                      }, {
                          key: "_fixedByDts",
                          value: function(t) {
                              return !!(this._mse.getBufferLen() > 2e3 && this._mse.isLive) && (this._log("_fixedByDts", t),
                              t.currentTime += 1,
                              !0)
                          }
                      }, {
                          key: "_log",
                          value: function(t, e, i) {
                              this._mse.video.printBuffered(),
                              l.a.log("MSEPause(".concat(this._mse._num_, ").").concat(t, " readyState=").concat(e.readyState, " currentTime=").concat(e.currentTime, " buf=").concat(this._mse.getBufferLen(), " dts=").concat(this._mse.getCurrentDts(), " ").concat(i || ""))
                          }
                      }, {
                          key: "paused",
                          get: function() {
                              return this._paused
                          }
                      }, {
                          key: "pausedTs",
                          get: function() {
                              return this._pausedTs
                          }
                      }]),
                      t
                  }()
                    , Nt = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.startDts = 0,
                          this.endDts = 0,
                          this.endFrameId = 0
                      }
                      return Object(a.a)(t, [{
                          key: "isDisconnectDts",
                          value: function(t) {
                              return this.endDts > 0 && t - this.endDts > 200
                          }
                      }, {
                          key: "isDisconnectFrame",
                          value: function(t) {
                              return this.endFrameId > 0 && t - this.endFrameId != 1
                          }
                      }, {
                          key: "getContinueBuffer",
                          value: function(t) {
                              return t >= this.startDts && t <= this.endDts ? this.endDts - t : 0
                          }
                      }, {
                          key: "addBuffer",
                          value: function(t, e) {
                              0 === this.startDts && (this.startDts = e),
                              this.endDts = e,
                              this.endFrameId = t
                          }
                      }]),
                      t
                  }()
                    , Ft = 1
                    , Mt = 2
                    , Ut = 3
                    , Bt = 1
                    , Vt = 2
                    , xt = 3
                    , Ht = {
                      NONE: 0,
                      NEXT_TIME: 1,
                      SAMPLE_SIZE: 2,
                      SAMPLE_LAST: 3,
                      SAMPLE_PERCENT: 4,
                      MAX_BITRATE: 5,
                      TARGET_BAD: 6,
                      TARGET_MAX: 7,
                      EVAL_BW: 9,
                      EVAL_FAIL: 10
                  }
                    , Gt = {
                      NONE: 0,
                      NEXT_TIME: 1,
                      BUFFER: 2,
                      TARGET_SVR: 3,
                      TARGET_HOST: 4
                  }
                    , jt = "timer"
                    , Wt = "record"
                    , Yt = "resume"
                    , qt = "push"
                    , Kt = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this._frameId = 0,
                          this._lastFrameId = 0,
                          this._startFrameId = 0
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              this._frameId = 0,
                              this._lastFrameId = 0,
                              this._startFrameId = 0
                          }
                      }, {
                          key: "setStartFrameId",
                          value: function(t) {
                              this._startFrameId = t,
                              this._lastFrameId = this._frameId
                          }
                      }, {
                          key: "getFrameId",
                          value: function(t, e) {
                              return 0 === t ? (this._frameId++,
                              e > 0 && this._frameId++) : (e > 0 && this._lastFrameId++,
                              this._frameId = this._lastFrameId + (t - this._startFrameId + 1)),
                              this._frameId
                          }
                      }]),
                      t
                  }()
                    , zt = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this._mse = null,
                          this._list = [],
                          this._dtsList = [],
                          this._tsList = [],
                          this._currentBuffered = null,
                          this._continueBuffer = -1,
                          this._lastFrameTs = 0,
                          this._startTs = 0,
                          this._started = !1,
                          this._lastRemoveTs = 0,
                          this._deltaStart = Number(o.a.continueBufferDeltaStart) || 6e3,
                          this._deltaEnd = Number(o.a.continueBufferDeltaEnd) || 3e3,
                          this._localFrameId = new Kt,
                          this._printContinueBuffer = 1 == localStorage._printContinueBuffer
                      }
                      return Object(a.a)(t, [{
                          key: "setMse",
                          value: function(t) {
                              this._mse = t
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              l.a.log("VideoBufferedList.stop"),
                              this._startTs = 0,
                              this._list = [],
                              this._dtsList = [],
                              this._continueBuffer = -1,
                              this._currentBuffered = null,
                              this._localFrameId.reset(),
                              k.a.remove(this.onCheckFastTimer, this)
                          }
                      }, {
                          key: "printInfo",
                          value: function(t) {
                              var e = [];
                              this._list.forEach((function(t) {
                                  e.push("[".concat(t.startDts, ", ").concat(t.endDts, "]"))
                              }
                              )),
                              l.a.log("VideoBufferedList.print dts=".concat(t, " buffered=").concat(e.join(" ")))
                          }
                      }, {
                          key: "record",
                          value: function(t) {
                              this._calc(c.a.now(), Wt),
                              t.setCore(d.a.CORE.VIDEO_CONTINUE_BUFFER, this._continueBuffer),
                              this._continueBuffer = -1
                          }
                      }, {
                          key: "start",
                          value: function() {
                              0 === this._startTs && (l.a.log("VideoBufferList.start"),
                              this._startTs = c.a.now(),
                              k.a.add(this.onCheckFastTimer, this, 50))
                          }
                      }, {
                          key: "onCheckFastTimer",
                          value: function(t) {
                              if (0 === this._lastRemoveTs)
                                  this._lastRemoveTs = t;
                              else if (this._lastRemoveTs > 0 && t - this._lastRemoveTs > 5e3) {
                                  this._lastRemoveTs = t;
                                  for (var e = this._mse.getCurrentDts() - 2e4, i = this._dtsList.length - 1; i >= 0; i--)
                                      if (this._dtsList[i] < e) {
                                          this._dtsList = this._dtsList.slice(i),
                                          this._tsList = this._tsList.slice(i);
                                          break
                                      }
                              }
                              var s = t - this._lastFrameTs;
                              this._lastFrameTs > 0 && s > 100 && (this._calc(t, jt),
                              this._lastFrameTs = t)
                          }
                      }, {
                          key: "addSample",
                          value: function(t, e, i, s) {
                              var a = c.a.now();
                              this._tsList.push(a),
                              this._dtsList.push(e),
                              (0 === this._lastFrameTs || i) && this._localFrameId.setStartFrameId(t),
                              this._lastFrameTs = a;
                              var r = this._localFrameId.getFrameId(t, s);
                              this._currentBuffered && !this._currentBuffered.isDisconnectFrame(r) || (this._currentBuffered = new Nt,
                              this._list.push(this._currentBuffered),
                              this._list.length > 10 && e - this._list[0].endDts > 3e5 && this._list.shift()),
                              this._currentBuffered.addBuffer(r, e)
                          }
                      }, {
                          key: "_calc",
                          value: function(t, e) {
                              var i = t - this._deltaStart
                                , s = t - this._deltaEnd;
                              if ((e === Wt || e === Yt) && -1 === this._continueBuffer)
                                  return this._continueBuffer = this._getContinueBuffer(this._mse.getCurrentDts()),
                                  void (this._printContinueBuffer && this.printInfo(this._mse.getCurrentDts() + " continueBuffer=".concat(this._continueBuffer, " from=").concat(e, " ")));
                              if (!(0 === this._startTs || i < this._startTs)) {
                                  for (var a = this._getDtsBound(i, s), r = a.startDts, n = a.endDts, o = Number.MAX_SAFE_INTEGER, h = this._dtsList.length, u = 0; u < h; u++) {
                                      var l = this._dtsList[u];
                                      if (l > n)
                                          break;
                                      if (l >= r && l <= n && (o = Math.min(o, this._getContinueBuffer(l))),
                                      0 === o)
                                          break
                                  }
                                  o === Number.MAX_SAFE_INTEGER && (o = 0),
                                  (-1 === this._continueBuffer || this._continueBuffer > o) && (this._continueBuffer = o,
                                  this._printContinueBuffer && this.printInfo(this._mse.getCurrentDts() + " now=".concat(t, " startDts=").concat(r, " endDts=").concat(n, " continueBuffer=").concat(o, " from=").concat(e)))
                              }
                          }
                      }, {
                          key: "_getDtsBound",
                          value: function(t, e) {
                              for (var i = this._tsList.length, s = Number.MAX_SAFE_INTEGER, a = 0, r = 0; r < i; r++) {
                                  var n = this._tsList[r];
                                  if (n >= t && n <= e) {
                                      var o = this._dtsList[r];
                                      o < s && (s = o),
                                      o > a && (a = o)
                                  } else if (n > e)
                                      break
                              }
                              return {
                                  startDts: s,
                                  endDts: a
                              }
                          }
                      }, {
                          key: "_getContinueBuffer",
                          value: function(t) {
                              for (var e = 0, i = 0; i < this._list.length && 0 === (e = this._list[i].getContinueBuffer(t)); i++)
                                  ;
                              return e
                          }
                      }, {
                          key: "continueBuffer",
                          get: function() {
                              return this._continueBuffer
                          },
                          set: function(t) {
                              this._continueBuffer = t
                          }
                      }]),
                      t
                  }()
                    , Jt = 0
                    , Qt = function() {
                      function t(e, i) {
                          Object(s.a)(this, t);
                          var a = i.videoType
                            , r = void 0 === a ? "flv" : a
                            , n = i.isLive
                            , o = void 0 === n || n
                            , h = i.isPureAudio
                            , u = void 0 !== h && h
                            , c = i.isPureVideo
                            , d = void 0 !== c && c
                            , p = i.h265Proxy
                            , f = void 0 === p ? null : p
                            , _ = i.videoElement
                            , m = void 0 === _ ? null : _;
                          this.handler = e,
                          this.videoType = r,
                          this.isLive = o,
                          this.isPureAudio = u,
                          this.isPureVideo = d,
                          this.pushVideoStartRenderTime = 0,
                          this.h265Proxy = f,
                          this.videoElement = m,
                          this.requestAnimationId = -1,
                          this._num_ = ++Jt,
                          l.a.log("MSEPlayer(".concat(this._num_, ").constructor")),
                          this.buffered = new zt,
                          this.buffered.setMse(this),
                          this.remuxer = new w(this),
                          "ts" === r ? this.parser = new U(this,this.remuxer) : (this.parser = new Ct(this,this.remuxer),
                          this.parser.ctrlBuffer.setBuffered(this.buffered)),
                          this.JITTER_BUFMIN = 1e3,
                          this.JITTER_BUFLEN = 4e3,
                          this.JITTER_BUFMAX = 8e3,
                          this.latencySeek = 0,
                          this.userPaused = !1,
                          this._triggerPlay = !1,
                          this.hasData = !1,
                          this.playing = !1,
                          this.lastPlayTime = 0,
                          this.lastCheckPlayTime = 0,
                          this.maxGop = 0,
                          this.playStartTime = 0,
                          this.delayReset = !1,
                          this.isPlayerError = !1,
                          this.isErrorEvent = !1,
                          this.startPlayBackRate = .9,
                          this.pausedByBrowser = !1,
                          this.metadata = {},
                          this.bufStat = new Lt,
                          this.pauseStat = new wt,
                          this.tryPlayAgainTimout = 0,
                          this.onUpdateErrorBind = this.onUpdateError.bind(this),
                          this.onAudioUpdateEndBind = this.onAudioUpdateEnd.bind(this),
                          this.onVideoUpdateEndBind = this.onVideoUpdateEnd.bind(this),
                          this.onMediaSourceOpenBind = this.onMediaSourceOpen.bind(this),
                          this.onVideoErrorBind = this.onVideoError.bind(this),
                          this.onVideoPauseBind = this.onVideoPause.bind(this),
                          this.onVideoPlayBind = this.onVideoPlay.bind(this),
                          this.onVideoLoadedBind = this.onVideoLoaded.bind(this),
                          this.checkVideoPlayingBind = this.checkVideoPlaying.bind(this),
                          this.onVideoPlayingBind = this.onVideoPlaying.bind(this),
                          this.mediaSource = new MediaSource,
                          this.mediaSource.addEventListener("sourceopen", this.onMediaSourceOpenBind),
                          this.h264SeiInfos = new kt(this),
                          this.scriptVolumeInfos = new bt(this),
                          this.video = this.createVideo(),
                          this.msePause = new Dt(this,{
                              pause: this._msePaused.bind(this),
                              resume: this._mseResume.bind(this)
                          }),
                          this.audioSourceBuffer = null,
                          this.videoSourceBuffer = null,
                          this.audioCodec = null,
                          this.videoCodec = null,
                          this.audioSegments = [],
                          this.videoSegments = [],
                          this.width = 1280,
                          this.height = 720,
                          this.autoJitter = !0,
                          this.autoBitrateJitter = !1,
                          this.playbackrateChangeAccess = !0,
                          this.enableLowLatency = !1,
                          this.sensitivePause = !0,
                          this.waitSwapToPcdn = !1,
                          this.printJitter = !!Number(localStorage._printJitter);
                          var v = navigator.userAgent.toLowerCase();
                          this.isAndroid = -1 !== v.indexOf("Android"),
                          -1 == l.a.getLevel() && window.chrome && (window.chrome.mse = this),
                          this.videoDataAppended = !1,
                          this.avcchangeCheckTimer = 0,
                          this.offsetDts = 0,
                          this.curVideoDts = 0,
                          this.curAudioDts = 0,
                          this.isOnFragParsed = !1,
                          this.onFragParsedTime = 0,
                          this.isH265Play = !1,
                          this.playRateIncrease = 0,
                          this.playRateDecrease = 0,
                          this.startPlayTime = 0,
                          this.isStartBuffer = !0,
                          this.bufferCd = 12e4,
                          this.startCd = 5e3,
                          this.setVideoCurrentTime = 0,
                          this.startMoreBufferTime = 0,
                          this.bufferMoreContinueTime = 6e4,
                          this.maxJumpWaitNow = 0,
                          this.mediaDelay = null,
                          this.seiAnchorDelay = -1,
                          this.discontinuityAudio = !1,
                          this.discontinuityVideo = !1,
                          this.isPlaybackRateNormal = !0,
                          f && f.initRender(this)
                      }
                      return Object(a.a)(t, [{
                          key: "getDelayStat",
                          value: function() {
                              return "ts" !== this.videoType ? this.parser.sei.getStat() : null
                          }
                      }, {
                          key: "getDelayInfo",
                          value: function() {
                              return l.a.log("MSEPlayer.getDelayInfo: delay: ", this.mediaDelay),
                              this.mediaDelay
                          }
                      }, {
                          key: "setSeiDelay",
                          value: function(t) {
                              if (this.seiAnchorDelay !== t || !this.mediaDelay) {
                                  var e = this.getBufferLen();
                                  this.seiAnchorDelay = t,
                                  this.mediaDelay = {
                                      total_delay: this.seiAnchorDelay + e,
                                      buffer_delay: e,
                                      status: 0
                                  },
                                  0 === this.seiAnchorDelay && (this.mediaDelay.status = 1)
                              }
                          }
                      }, {
                          key: "getRealBitrate",
                          value: function() {
                              var t = 0;
                              return this.parser.fps && (t = this.parser.fps.getRealBitrate()),
                              t
                          }
                      }, {
                          key: "destroy",
                          value: function() {
                              if (l.a.log("MSEPlayer(".concat(this._num_, ").destroy")),
                              this.buffered.stop(),
                              this.h265Proxy && this.h265Proxy.stop(),
                              this.playing = !1,
                              this.lastPlayTime = 0,
                              this.playStartTime = 0,
                              this.lastCheckPlayTime = 0,
                              this.hasData = !1,
                              this.handler && (this.handler.onVideoStop(this.video.video, !!this.videoSourceBuffer),
                              this.handler = null),
                              this.remuxer.destroy(),
                              this.parser.destroy(),
                              this.audioCodec = null,
                              this.videoCodec = null,
                              this.audioSegments = [],
                              this.videoSegments = [],
                              this.audioSourceBuffer && (this.audioSourceBuffer.removeEventListener("updateend", this.onAudioUpdateEndBind),
                              this.audioSourceBuffer.removeEventListener("error", this.onUpdateErrorBind),
                              this.audioSourceBuffer = null),
                              this.videoSourceBuffer && (this.videoSourceBuffer.removeEventListener("updateend", this.onVideoUpdateEndBind),
                              this.videoSourceBuffer.removeEventListener("error", this.onUpdateErrorBind),
                              this.videoSourceBuffer = null),
                              this.mediaSource) {
                                  this.mediaSource.removeEventListener("sourceopen", this.onMediaSourceOpenBind);
                                  for (var t = this.mediaSource.sourceBuffers; t.length; )
                                      this.mediaSource.removeSourceBuffer(t[0]);
                                  this.mediaSource = this.onMediaSourceOpenBind = null
                              }
                              this.onAudioUpdateEndBind = this.onVideoUpdateEndBind = this.onUpdateErrorBind = null,
                              this.video && (this.video.destroy(),
                              this.video = null),
                              this.videoElement = null,
                              this.pushVideoStartRenderTime = 0,
                              this.playbackrateChangeAccess = !0,
                              -1 !== this.requestAnimationId && (cancelAnimationFrame(this.requestAnimationId),
                              this.requestAnimationId = -1),
                              this.onFragParsedTime = 0,
                              k.a.remove(this.triggerPlayVideo, this)
                          }
                      }, {
                          key: "resetHls",
                          value: function() {
                              this.parser.pushAllData && this.parser.pushAllData(),
                              this.parser.reset && this.parser.reset(),
                              this.remuxer.reset()
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              if (l.a.log("MSEPlayer(".concat(this._num_, ").reset")),
                              this.handler.onVideoStop(this.video.video, !!this.videoSourceBuffer),
                              this.JITTER_BUFMIN = 1e3,
                              this.JITTER_BUFLEN = 4e3,
                              this.JITTER_BUFMAX = 8e3,
                              this.userPaused = !1,
                              this.playing = !1,
                              this.lastPlayTime = 0,
                              this.playStartTime = 0,
                              this.lastCheckPlayTime = 0,
                              this.hasData = !1,
                              this.audioCodec = null,
                              this.videoCodec = null,
                              this.audioSegments = [],
                              this.videoSegments = [],
                              this.discontinuityAudio = !1,
                              this.discontinuityVideo = !1,
                              this.metadata = {},
                              this.msePause.paused && this.handler.onPlayResume(c.a.now()),
                              this.pauseStat.reset(),
                              this.bufStat.reset(),
                              this.msePause.reset(),
                              this.maxGop = 0,
                              this.isPlaybackRateNormal = !0,
                              clearTimeout(this.tryPlayAgainTimout),
                              this.audioSourceBuffer && (this.audioSourceBuffer.removeEventListener("updateend", this.onAudioUpdateEndBind),
                              this.audioSourceBuffer.removeEventListener("error", this.onUpdateErrorBind),
                              this.audioSourceBuffer = null),
                              this.videoSourceBuffer && (this.videoSourceBuffer.removeEventListener("updateend", this.onVideoUpdateEndBind),
                              this.videoSourceBuffer.removeEventListener("error", this.onUpdateErrorBind),
                              this.videoSourceBuffer = null),
                              this.mediaSource) {
                                  this.mediaSource.removeEventListener("sourceopen", this.onMediaSourceOpenBind);
                                  for (var t = this.mediaSource.sourceBuffers; t.length; )
                                      this.mediaSource.removeSourceBuffer(t[0])
                              }
                              this.mediaSource = new MediaSource,
                              this.mediaSource.addEventListener("sourceopen", this.onMediaSourceOpenBind),
                              this.video && (this.video.destroy(),
                              this.video = null),
                              this.video = this.createVideo(),
                              this.playbackrateChangeAccess = !0,
                              this.videoDataAppended = !1,
                              this.onFragParsedTime = 0,
                              this.startPlayTime = 0,
                              this.isStartBuffer = !0,
                              this.setVideoCurrentTime = 0,
                              this.startMoreBufferTime = 0,
                              this.maxJumpWaitNow = 0
                          }
                      }, {
                          key: "resetVideo",
                          value: function() {
                              if (this.audioSourceBuffer && (this.audioSourceBuffer.removeEventListener("updateend", this.onAudioUpdateEndBind),
                              this.audioSourceBuffer.removeEventListener("error", this.onUpdateErrorBind),
                              this.audioSourceBuffer = null),
                              this.videoSourceBuffer && (this.videoSourceBuffer.removeEventListener("updateend", this.onVideoUpdateEndBind),
                              this.videoSourceBuffer.removeEventListener("error", this.onUpdateErrorBind),
                              this.videoSourceBuffer = null),
                              this.mediaSource) {
                                  this.mediaSource.removeEventListener("sourceopen", this.onMediaSourceOpenBind);
                                  for (var t = this.mediaSource.sourceBuffers; t.length; )
                                      this.mediaSource.removeSourceBuffer(t[0])
                              }
                              this.mediaSource = new MediaSource,
                              this.mediaSource.addEventListener("sourceopen", this.onMediaSourceOpenBind),
                              this.video && (this.video.destroy(),
                              this.video = null),
                              this.video = this.createVideo(),
                              this.videoCodec = null,
                              this.audioCodec = null,
                              this.lastPlayTime = 0
                          }
                      }, {
                          key: "createVideo",
                          value: function() {
                              this._triggerPlay = !1;
                              var t = this.videoElement ? this.videoElement : document.createElement("video");
                              return t.src = URL.createObjectURL(this.mediaSource),
                              new Rt(this,t)
                          }
                      }, {
                          key: "insertDiscontinuity",
                          value: function() {
                              this.discontinuityAudio = !0,
                              this.discontinuityVideo = !0
                          }
                      }, {
                          key: "setPushGop",
                          value: function(t) {
                              this.parser.setPushGop(t)
                          }
                      }, {
                          key: "setDeleteH264Aud",
                          value: function(t) {
                              this.parser.setDeleteH264Aud(t)
                          }
                      }, {
                          key: "setNeedEmptyAudioFrame",
                          value: function(t) {
                              this.parser.setNeedEmptyAudioFrame(t)
                          }
                      }, {
                          key: "getPlayStat",
                          value: function() {
                              return this.parser.getPlayStat()
                          }
                      }, {
                          key: "getPlayVideo",
                          value: function() {
                              return this.video ? this.video.video : null
                          }
                      }, {
                          key: "getFrameReadyed",
                          value: function() {
                              return this.parser && this.parser.getFrameReadyed ? this.parser.getFrameReadyed() : 0
                          }
                      }, {
                          key: "getFramePlayDelays",
                          value: function() {
                              return this.parser.getCalculateVideoFramePlayDelay ? this.parser.getCalculateVideoFramePlayDelay() : 0
                          }
                      }, {
                          key: "getBufferLen",
                          value: function() {
                              return this.video ? this.video.getBufferLen() : 0
                          }
                      }, {
                          key: "getFrameBufferLen",
                          value: function() {
                              return this.parser.getFrameBufferLen ? this.parser.getFrameBufferLen() : 0
                          }
                      }, {
                          key: "getContinueBuffer",
                          value: function() {
                              return this.buffered.continueBuffer
                          }
                      }, {
                          key: "setSensitivePause",
                          value: function(t) {
                              this.sensitivePause = t
                          }
                      }, {
                          key: "getParserBufLen",
                          value: function() {
                              return this.parser.getParserBufLen()
                          }
                      }, {
                          key: "getCurrentDts",
                          value: function() {
                              return void 0 === this.remuxer.getInitDts() ? 0 : this.video.getCurrentTime() + this.remuxer.getInitDts()
                          }
                      }, {
                          key: "getCurrentSeiOffsetDts",
                          value: function() {
                              return this.offsetDts || 0
                          }
                      }, {
                          key: "getCurrentTime",
                          value: function() {
                              return this.video ? this.video.getCurrentTime() : 0
                          }
                      }, {
                          key: "getCurrentRealTime",
                          value: function() {
                              return this.video ? this.getCurrentDts() : 0
                          }
                      }, {
                          key: "appendFlv",
                          value: function(t) {
                              this.addPlayEvent(),
                              this.parser.parseFlv(t)
                          }
                      }, {
                          key: "addPlayEvent",
                          value: function() {
                              this.hasData || (this.hasData = !0,
                              this.videoElement && (this.videoElement.addEventListener("loadeddata", this.onVideoLoadedBind),
                              this.requestAnimationId = requestAnimationFrame(this.checkVideoPlayingBind)))
                          }
                      }, {
                          key: "appendTs",
                          value: function(t) {
                              this.addPlayEvent(),
                              this.parser.parseTs(t)
                          }
                      }, {
                          key: "saveH264SeiData",
                          value: function(t, e) {
                              this.h264SeiInfos.add(t, e)
                          }
                      }, {
                          key: "setPlaybackrateAccess",
                          value: function(t) {
                              this.playbackrateChangeAccess = t
                          }
                      }, {
                          key: "checkBuffer",
                          value: function() {
                              if (!this.video.video.paused) {
                                  var t = c.a.now()
                                    , e = this.video.video.buffered
                                    , i = e.length
                                    , s = this.getBufferLen();
                                  if (this.bufStat.checkBuffer(t, s),
                                  0 === this.video.video.currentTime && 0 !== this.lastPlayTime)
                                      return l.a.warn("MSEPlayer.checkBuffer onPlayerError(true) lastPlayTime=" + this.lastPlayTime + " bufLen=" + s),
                                      this._onPlayerError(!0),
                                      this._onErrorEvent(9),
                                      void (this.lastPlayTime = 0);
                                  if (this.lastPlayTime = this.video.video.currentTime,
                                  t > this.playStartTime + 3e3 && s > 4e3 && 0 == this.video.currentTime && (i > 0 && e.start(0) <= 4 && (l.a.log("MSEPlayer.checkBuffer buffer full but can not play"),
                                  this.video.currentTime = Math.round(e.start(0) + 1)),
                                  this.video.play()),
                                  0 !== this.playStartTime && t > this.playStartTime + 5e3 && (s > 5e3 || 0 === s))
                                      if (0 == this.video.video.currentTime && s > 2e3)
                                          l.a.log("MSEPlayer(".concat(this._num_, ") ####### currentTime=0 ++ bufLen=").concat(s, " paused=").concat(this.video.video.paused)),
                                          this.video.play();
                                      else if (this.playStartTime = 0,
                                      0 === this.video.video.currentTime && !this.isAndroid)
                                          return l.a.warn("MSEPlayer(".concat(this._num_, ").checkBuffer onPlayerError(true) playTime=") + this.video.video.currentTime + " bufLen=" + s),
                                          this._onErrorEvent(6),
                                          void this._onPlayerError(!0);
                                  null == this.videoElement && i && this.video.video.currentTime - e.start(0) > 20 && (this.audioSourceBuffer && !this.audioSourceBuffer.updating && this.audioSourceBuffer.remove(0, this.video.video.currentTime - 10),
                                  this.videoSourceBuffer && !this.videoSourceBuffer.updating && this.videoSourceBuffer.remove(0, this.video.video.currentTime - 10))
                              }
                          }
                      }, {
                          key: "_onPlayerError",
                          value: function(t) {
                              !this.isPlayerError && this.handler && (this.isPlayerError = !0,
                              this.handler.onPlayerError(t))
                          }
                      }, {
                          key: "_onErrorEvent",
                          value: function(t) {
                              this.isErrorEvent || (this.isErrorEvent = !0,
                              this.handler && this.handler.onErrorEvent && this.handler.onErrorEvent({
                                  type: t
                              }))
                          }
                      }, {
                          key: "onParseError",
                          value: function(t) {
                              this._onErrorEvent(t)
                          }
                      }, {
                          key: "onAvcCfgChange",
                          value: function() {
                              return l.a.log("MSEPlayer(".concat(this._num_, ").onAvcCfgChange")),
                              this.getBufferLen() < 500 ? (l.a.log("MSEPlayer(".concat(this._num_, ").onAvcCfgChange reset player")),
                              this.remuxer.reset(),
                              this.parser.setPaused(!1),
                              !1) : (this.delayReset = !0,
                              !0)
                          }
                      }, {
                          key: "onRestart",
                          value: function() {
                              l.a.log("MSEPlayer(".concat(this._num_, ").onRestart")),
                              this.reset()
                          }
                      }, {
                          key: "onVideoParseInvalid",
                          value: function() {
                              this.handler && this.handler.onVideoParseInvalid && this.handler.onVideoParseInvalid()
                          }
                      }, {
                          key: "onGop",
                          value: function(t) {
                              this.handler.onGop && this.handler.onGop(t),
                              t > this.maxGop && (this.maxGop = t,
                              l.a.log("MSEPlayer(".concat(this._num_, ").onGop update maxGop=") + this.maxGop))
                          }
                      }, {
                          key: "getMaxGop",
                          value: function() {
                              return this.maxGop
                          }
                      }, {
                          key: "setVolume",
                          value: function(t) {
                              this.video.setVolume(t)
                          }
                      }, {
                          key: "setEnableLowLatency",
                          value: function(t) {
                              this.enableLowLatency = t
                          }
                      }, {
                          key: "getVolume",
                          value: function() {
                              return this.video ? this.video.getVolume() : -1
                          }
                      }, {
                          key: "setMuted",
                          value: function(t) {
                              this.video && (this.video.setMuted(t),
                              l.a.log("MSEPlayer.setMuted ".concat(t, " hasVideo=").concat(!!this.videoSourceBuffer, " hasAudio=").concat(!!this.audioSourceBuffer)))
                          }
                      }, {
                          key: "getMuted",
                          value: function() {
                              return this.video ? this.video.getMuted() : -1
                          }
                      }, {
                          key: "setResolution",
                          value: function(t, e) {
                              l.a.log("MSEPlayer(".concat(this._num_, ").setResolution w/h=") + t + "/" + e),
                              this.width = t,
                              this.height = e
                          }
                      }, {
                          key: "getWidth",
                          value: function() {
                              return this.width
                          }
                      }, {
                          key: "getHeight",
                          value: function() {
                              return this.height
                          }
                      }, {
                          key: "setExceptionStat",
                          value: function(t, e) {
                              this.handler && this.handler.exceptionStat && this.handler.exceptionStat.setStat(t, e)
                          }
                      }, {
                          key: "turnToH264",
                          value: function() {
                              this.h265Proxy && this.h265Proxy.stop(),
                              this.handler && this.handler.turnToH264()
                          }
                      }, {
                          key: "on265StartCodeError",
                          value: function() {
                              this.h265Proxy && this.h265Proxy.on265StartCodeError(Ot.a.START_CODE_ERROR)
                          }
                      }, {
                          key: "h265Retry",
                          value: function() {
                              this.h265Proxy && this.h265Proxy.stop(),
                              this.handler.h265Retry()
                          }
                      }, {
                          key: "onInitSegment",
                          value: function(t) {
                              t.audioCodec && (this.audioCodec = t.audioCodec),
                              t.videoCodec && (this.videoCodec = t.videoCodec),
                              this.isMediaSourceOpen && this.initSourceBuffer(),
                              t.audioMoov && this.audioSegments.push(t.audioMoov),
                              t.videoMoov && this.videoSegments.push(t.videoMoov),
                              this.playStartTime = 0
                          }
                      }, {
                          key: "onFragParsing",
                          value: function(t) {
                              "audio" === t.type ? this.audioSegments.push(t.data) : "video" === t.type && this.videoSegments.push(t.data)
                          }
                      }, {
                          key: "onFragParsed",
                          value: function() {
                              this.audioSourceBuffer && this.appendBuffer("audio"),
                              this.videoSourceBuffer && this.appendBuffer("video"),
                              null == this.videoElement && this.isLive && (this.isOnFragParsed || (this.onFragParsedTime = c.a.now(),
                              l.a.log("MSEPlayer.onFragParsed", this.onFragParsedTime),
                              this.isOnFragParsed = !0),
                              this.triggerPlay())
                          }
                      }, {
                          key: "checkVideoPlaying",
                          value: function() {
                              0 == this.pushVideoStartRenderTime && this.video && this.video.video && this.video.video.videoWidth > 0 && this.video.video.videoHeight > 0 ? this.pushVideoStartRenderTime = c.a.now() : this.requestAnimationId = requestAnimationFrame(this.checkVideoPlayingBind)
                          }
                      }, {
                          key: "onVideoLoaded",
                          value: function() {
                              l.a.log("MSEPlayer.onVideoLoaded"),
                              this.triggerPlay()
                          }
                      }, {
                          key: "reloadInError",
                          value: function() {
                              this.handler.reloadInError && this.handler.reloadInError()
                          }
                      }, {
                          key: "initSourceBuffer",
                          value: function() {
                              if (this.audioCodec && !this.audioSourceBuffer) {
                                  l.a.log("MSEPlayer(".concat(this._num_, ").initSourceBuffer audio codec=") + this.audioCodec);
                                  try {
                                      this.audioSourceBuffer = this.mediaSource.addSourceBuffer("video/mp4;codecs=".concat(this.audioCodec)),
                                      this.audioSourceBuffer.addEventListener("updateend", this.onAudioUpdateEndBind),
                                      this.audioSourceBuffer.addEventListener("error", this.onUpdateErrorBind)
                                  } catch (t) {
                                      return l.a.warn("MSEPlayer.initSourceBuffer audio err=" + t.message),
                                      t.message && -1 != t.message.indexOf("No additional SourceBuffer objects may be added") && (l.a.log("MSEPlayer.initSourceBuffer resetMediasource in audio"),
                                      this.handler.resetMediasource) ? void this.handler.resetMediasource() : (this._onErrorEvent(4),
                                      void this._onPlayerError(!0))
                                  }
                              } else
                                  this.audioCodec && this.audioSourceBuffer && this.discontinuityAudio && (l.a.log("MSEPlayer(".concat(this._num_, ").initSourceBuffer reset audio codec=") + this.audioCodec),
                                  this.audioSourceBuffer.changeType("video/mp4;codecs=".concat(this.audioCodec)));
                              if (this.videoCodec && !this.videoSourceBuffer) {
                                  l.a.log("MSEPlayer(".concat(this._num_, ").initSourceBuffer video codec=") + this.videoCodec);
                                  try {
                                      this.videoSourceBuffer = this.mediaSource.addSourceBuffer("video/mp4;codecs=".concat(this.videoCodec)),
                                      this.videoSourceBuffer.addEventListener("updateend", this.onVideoUpdateEndBind),
                                      this.videoSourceBuffer.addEventListener("error", this.onUpdateErrorBind)
                                  } catch (t) {
                                      if (t.message && -1 != t.message.indexOf("No additional SourceBuffer objects may be added") && (l.a.log("MSEPlayer.initSourceBuffer resetMediasource in video"),
                                      this.handler.resetMediasource))
                                          return void this.handler.resetMediasource();
                                      l.a.warn("MSEPlayer(".concat(this._num_, ").initSourceBuffer video err=") + t.message),
                                      this._onErrorEvent(5),
                                      this._onPlayerError(!0)
                                  }
                              } else
                                  this.videoCodec && this.videoSourceBuffer && this.discontinuityVideo && (l.a.log("MSEPlayer(".concat(this._num_, ").initSourceBuffer reset video codec=") + this.videoCodec),
                                  this.videoSourceBuffer.changeType("video/mp4;codecs=".concat(this.videoCodec)));
                              this.discontinuityVideo = !1,
                              this.discontinuityAudio = !1
                          }
                      }, {
                          key: "appendBuffer",
                          value: function(t) {
                              if (0 != this.mediaSource.sourceBuffers.length && !this.isPlayerError)
                                  if ("audio" == t) {
                                      if (this.audioSegments.length > 0 && this.audioSourceBuffer && !this.audioSourceBuffer.updating) {
                                          var e = this.audioSegments.shift();
                                          try {
                                              this.audioSourceBuffer.appendBuffer(e),
                                              this.videoDataAppended = !0
                                          } catch (t) {
                                              l.a.warn("MSEPlayer(".concat(this._num_, ").appendBuffer audio err=") + t.message),
                                              this._onErrorEvent(7),
                                              this._onPlayerError(!0)
                                          }
                                      }
                                  } else {
                                      if ("video" != t)
                                          throw new Error("MSEPlayer(".concat(this._num_, ").appendBuffer type error! Valide type is audio or video."));
                                      if (this.videoSegments.length > 0 && this.videoSourceBuffer && !this.videoSourceBuffer.updating) {
                                          var i = this.videoSegments.shift();
                                          try {
                                              this.videoSourceBuffer.appendBuffer(i),
                                              this.videoDataAppended = !0
                                          } catch (t) {
                                              l.a.warn("MSEPlayer(".concat(this._num_, ").appendBuffer video err=") + t.message),
                                              this._onErrorEvent(8),
                                              this._onPlayerError(!0)
                                          }
                                      }
                                  }
                          }
                      }, {
                          key: "recvDataFull",
                          value: function() {
                              this.handler && this.handler.recvDataFull && this.handler.recvDataFull()
                          }
                      }, {
                          key: "getVideoFrames",
                          value: function() {
                              return this.parser && this.parser.getVideoFrames ? this.parser.getVideoFrames() : 0
                          }
                      }, {
                          key: "getAudioFrames",
                          value: function() {
                              return this.parser && this.parser.getAudioFrames ? this.parser.getAudioFrames() : 0
                          }
                      }, {
                          key: "triggerH265Play",
                          value: function(t, e) {
                              this.isH265Play || (l.a.log("MSEPlayer.triggerH265Play"),
                              this.isH265Play = !0,
                              this.h265Proxy && this.h265Proxy.reportDecodeRenderTime(t, e))
                          }
                      }, {
                          key: "triggerPlay",
                          value: function() {
                              if (!this.playing && this.isMediaSourceOpen) {
                                  if (this.playing = !0,
                                  this.playStartTime = c.a.now(),
                                  this.videoElement && !this.videoElement.autoplay || this.video.play(),
                                  o.a.platform === C.a.PLATFORM_TYPE_NAME.wap)
                                      return;
                                  "safari" === _.a.name ? o.a.safariFirstLoad ? (o.a.safariFirstLoad = !1,
                                  this.triggerPlayVideo()) : k.a.once(this.triggerPlayVideo, this, o.a.safariPlayDelay) : this.triggerPlayVideo()
                              }
                          }
                      }, {
                          key: "triggerPlayVideo",
                          value: function() {
                              var t = !!this.videoSourceBuffer
                                , e = "h264";
                              13 == this.parser.codec ? e = "av1" : 12 == this.parser.codec && (e = "h265"),
                              l.a.log("MSEPlayer.onPlayVideo codec: ", e),
                              0 == this.parser.decodeIFRTime && 1 == Number(o.a.isNoVideoReport) && this.handler.eventEmitter && this.handler.eventEmitter.trigger(r.a.P2P_REPORT),
                              this.h265Proxy && this.h265Proxy.isReady ? this.handler.onPlayVideo(this.video.video, this.width, this.height, t, this.h265Proxy.canvas, this.onFragParsedTime, e) : this.handler.onPlayVideo(this.video.video, this.width, this.height, t, null, this.onFragParsedTime, e),
                              this.startPlayTime = c.a.now()
                          }
                      }, {
                          key: "triggerH5PlayVideo",
                          value: function() {
                              if (l.a.log("trigger h5 video play"),
                              this.pausedByBrowser)
                                  this.pausedByBrowser = !1;
                              else {
                                  this.startPlayTime = c.a.now();
                                  var t = !!this.videoSourceBuffer;
                                  this.handler.onPlayVideo(this.video.video, this.width, this.height, t, null, this.onFragParsedTime)
                              }
                          }
                      }, {
                          key: "onH264Sei",
                          value: function(t, e) {
                              this.handler.onSendSeiData(t, e, this.video.video.currentTime)
                          }
                      }, {
                          key: "onScriptVolumeInfo",
                          value: function(t, e) {
                              this.handler.onSendScriptVolumeInfo(t, e)
                          }
                      }, {
                          key: "onMediaSourceOpen",
                          value: function() {
                              this.mediaSource.removeEventListener("sourceopen", this.onMediaSourceOpenBind),
                              (this.audioSegments.length > 0 || this.videoSegments.length > 0) && (this.initSourceBuffer(),
                              this.appendBuffer("audio"),
                              this.appendBuffer("video"),
                              l.a.log("MSEPlayer.onMediaSourceOpen"),
                              0 == this.onFragParsedTime && (this.onFragParsedTime = c.a.now()),
                              null == this.videoElement && this.triggerPlay())
                          }
                      }, {
                          key: "onAudioUpdateEnd",
                          value: function() {
                              this.appendBuffer("audio"),
                              this.checkAppendOver()
                          }
                      }, {
                          key: "onVideoUpdateEnd",
                          value: function() {
                              this.appendBuffer("video"),
                              this.checkAppendOver()
                          }
                      }, {
                          key: "checkAppendOver",
                          value: function() {
                              0 === this.videoSegments.length && 0 === this.audioSegments.length && (this.videoSourceBuffer && this.videoSourceBuffer.updating || this.audioSourceBuffer && this.audioSourceBuffer.updating || this.handler && this.handler.onSBUpdateEnd && this.handler.onSBUpdateEnd())
                          }
                      }, {
                          key: "onUpdateError",
                          value: function(t) {
                              l.a.warn("MSEPlayer.onUpdateError", t)
                          }
                      }, {
                          key: "onVideoPause",
                          value: function(t) {
                              this.userPaused = !0
                          }
                      }, {
                          key: "onPauseByBrowser",
                          value: function() {
                              this.handler && (this.handler.onPauseByBrowser && this.handler.onPauseByBrowser(),
                              this.handler.updateStatus && this.handler.updateStatus(r.b.BROWSER_PAUSE),
                              this.pausedByBrowser = !0,
                              this.handler.eventEmitter && this.handler.eventEmitter.trigger(r.a.BROWSER_PAUSE, {
                                  video: this.video.video
                              }))
                          }
                      }, {
                          key: "onVideoPlaying",
                          value: function() {
                              if (this.handler && this.handler.updateStatus) {
                                  if (this.video.video && this.video.video.paused)
                                      return void l.a.log("video is playing, video.paused=", this.video.video.paused);
                                  l.a.log("video is playing", this.isPureAudio);
                                  var t = this.isPureAudio ? r.b.AUDIO_PLAYING : r.b.VIDEO_PLAYING;
                                  this.handler.updateStatus(t)
                              }
                          }
                      }, {
                          key: "onVideoPlay",
                          value: function(t) {
                              this.userPaused = !1
                          }
                      }, {
                          key: "onVideoError",
                          value: function(t) {
                              var e = "";
                              if (this.video.video.error) {
                                  var i = this.video.video.error.code;
                                  e = " errCode=" + i + " " + ["Unknow", "用户终止", "网络错误", "解码错误", "格式不支持"][i],
                                  3 != i && 4 != i || (this._onErrorEvent(3 == i ? 1 : 2),
                                  this._onPlayerError(!0),
                                  localStorage.decodeabnormal = "abnormal_" + (new Date).getTime())
                              }
                              l.a.warn("MSEPlayer.onVideoError" + e)
                          }
                      }, {
                          key: "pause",
                          value: function() {
                              l.a.info("MSEPlayer.pause"),
                              this.userPaused = !0,
                              this.video && this.video.pause(),
                              this.handler.eventEmitter && this.handler.eventEmitter.roomRecordStat && this.handler.eventEmitter.roomRecordStat.roomNoRenderStat.pause()
                          }
                      }, {
                          key: "play",
                          value: function() {
                              l.a.info("MSEPlayer.play"),
                              this.userPaused = !1,
                              this.video && this.video.play()
                          }
                      }, {
                          key: "seek",
                          value: function(t) {
                              this.lastPlayTime = t,
                              l.a.info("MSEPlayer.seek seekTime=" + t, "currentTime=" + this.video.video.currentTime),
                              this.video && this.video.seek(t)
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              if (this.playing && this.isMediaSourceOpen) {
                                  this.parser && this.parser.fps && (this.metadata.fps = this.parser.fps.getFps(),
                                  this.metadata.recvVideoFps = this.parser.fps.getRecvFps()),
                                  this.parser && this.parser.audioFps && (this.metadata.audioFps = this.parser.audioFps.getFps(),
                                  this.metadata.recvAudioFps = this.parser.audioFps.getRecvFps());
                                  var i = this.getBufferLen()
                                    , s = Number(localStorage._printBufferLen);
                                  if (-1 == s || s > 0 && s == this._num_) {
                                      var a = Math.max(0, i / 100);
                                      l.a.debug(this._getTag(), "bufLen", "-".repeat(a), i)
                                  }
                                  if (Number(localStorage._printMseLog) && this.audioSegments && this.videoSegments && l.a.debug("MSE aSegments=".concat(this.audioSegments.length, " vSegments=").concat(this.videoSegments.length, " bufLen=").concat(this.getBufferLen())),
                                  !this.video.video.paused && !this.userPaused) {
                                      if (null == this.videoElement && this.isLive && e % 4 == 0 && i > o.a.jitJump[0] && !Number(localStorage._localFlvTest)) {
                                          var r = .001 * (o.a.jitJump[0] - o.a.jitJump[1]);
                                          this.video.video.currentTime += r,
                                          l.a.warn("MSEPlayer.onCheckTimer jumpTs=".concat(r, " bufLen=").concat(this.getBufferLen()))
                                      }
                                      this.checkBuffer(),
                                      this.onJitterTimer();
                                      var n = (this.handler ? this.handler.lastEmptySliceTs : 0) || 0
                                        , h = n > 0 && t - n < 3e3
                                        , u = !!this.videoSourceBuffer;
                                      this.isLive && u && this.msePause.pausedTs > 0 && t - this.msePause.pausedTs > 5e3 && !h && this.sensitivePause && (l.a.warn("MSEPlayer.onCheckTimer paused 5 sec."),
                                      this._onErrorEvent(3),
                                      this._onPlayerError(!0),
                                      this.handler && this.handler.onPause5Sec && this.handler.onPause5Sec())
                                  }
                              } else
                                  this.parser && this.parser.printPlayFrameInfo && this.parser.printPlayFrameInfo()
                          }
                      }, {
                          key: "onCheckFastTimer",
                          value: function(t, e) {
                              if (1 === Number(o.a.isMute) && this.muffledVoice(),
                              this.playing && this.isMediaSourceOpen && !this.video.video.paused && !this.userPaused) {
                                  this.checkEmptyFrames(),
                                  this.checkDelayReset(),
                                  this.msePause.check(t);
                                  var i = (this.handler ? this.handler.lastEmptySliceTs : 0) || 0
                                    , s = i > 0 && t - i < 3e3
                                    , a = !!this.videoSourceBuffer;
                                  if (null == this.videoElement && !this.pause500checked && a && this.msePause.pausedTs > 0 && t - this.msePause.pausedTs > 500 && !s) {
                                      this.pause500checked = !0;
                                      var r = this.bufferedInfo()
                                        , n = r.bufferLen.toFixed(2)
                                        , h = (r.nextStart - r.end).toFixed(2);
                                      if (l.a.info("MSEPlayer(".concat(this._num_, ").onCheckFastTimer paused"), "bufferLen=" + n, "hole=" + h, "nextStart=" + r.nextStart.toFixed(2), "currentTime=" + this.video.video.currentTime),
                                      this.isLive && "ts" != this.videoType) {
                                          this.video.printBuffered();
                                          var u = Number(r.nextStart);
                                          this.video.video && u && h > 0 && h < 3 && u - this.video.video.currentTime > .5 && (this.video.video.currentTime = u,
                                          l.a.log("MSEPlayer(".concat(this._num_, ").onCheckFastTimer try jump currentTime=") + this.video.video.currentTime))
                                      }
                                  }
                              }
                          }
                      }, {
                          key: "checkEmptyFrames",
                          value: function() {
                              this.handler.hasOwnProperty("hasEmptyFrames") && this.parser.hasEmptyFrames && (this.handler.hasEmptyFrames = this.parser.hasEmptyFrames)
                          }
                      }, {
                          key: "checkDelayReset",
                          value: function() {
                              this.delayReset && this.getBufferLen() < 500 && (l.a.log("MSEPlayer(".concat(this._num_, ").checkDelayReset reset player")),
                              this.remuxer.reset(),
                              this.parser.setPaused(!1),
                              this.delayReset = !1)
                          }
                      }, {
                          key: "_msePaused",
                          value: function(t) {
                              this.pauseStat.pause(),
                              this.handler.eventEmitter && this.handler.eventEmitter.roomRecordStat && this.handler.eventEmitter.roomRecordStat.roomNoRenderStat.pause(),
                              this.handler.onPlayPause(t, !!this.videoSourceBuffer)
                          }
                      }, {
                          key: "_mseResume",
                          value: function(t, e) {
                              this.pause500checked = !1,
                              this.pauseStat.resume(),
                              this.handler.eventEmitter && this.handler.eventEmitter.roomRecordStat && this.handler.eventEmitter.roomRecordStat.roomNoRenderStat.resume(),
                              this.handler.onPlayResume(t, !!this.videoSourceBuffer)
                          }
                      }, {
                          key: "bufferedInfo",
                          value: function() {
                              var t, e, i, s, a, r = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : .2, n = [], o = [], h = this.video.video.buffered;
                              for (a = 0; a < h.length; a++)
                                  n.push({
                                      start: h.start(a),
                                      end: h.end(a)
                                  });
                              for (n.sort((function(t, e) {
                                  return t.start - e.start || e.end - t.end
                              }
                              )),
                              a = 0; a < n.length; a++) {
                                  var u = o.length;
                                  if (u) {
                                      var l = o[u - 1].end;
                                      n[a].start - l < r ? n[a].end > l && (o[u - 1].end = n[a].end) : o.push(n[a])
                                  } else
                                      o.push(n[a])
                              }
                              var c = this.video.video.currentTime;
                              for (a = 0,
                              t = 0,
                              e = i = c; a < o.length; a++) {
                                  var d = o[a].start
                                    , p = o[a].end;
                                  if (c + r >= d && c < p)
                                      e = d,
                                      t = (i = p) - c;
                                  else if (c + r < d) {
                                      s = d;
                                      break
                                  }
                              }
                              return s || (s = i),
                              {
                                  bufferLen: t,
                                  start: e,
                                  end: i,
                                  nextStart: s
                              }
                          }
                      }, {
                          key: "printBuffer",
                          value: function(t) {
                              if (this.video.video) {
                                  var e = this.video.video.buffered
                                    , i = "buffered=[" + (1e3 * e.start(0) | 0) + "," + (1e3 * e.end(0) | 0) + "]"
                                    , s = 1e3 * this.video.video.currentTime >> 0
                                    , a = this.getBufferLen();
                                  l.a.log("MSEPlayer(".concat(this._num_, ").printBuffer ").concat(t, " currentTime=").concat(s, " bufLen=").concat(a, " ").concat(i))
                              }
                          }
                      }, {
                          key: "playbackRateSet",
                          value: function(t) {
                              var e = this
                                , i = this.getPlayVideo();
                              if (i) {
                                  var s = function(t) {
                                      if (e.playRateIncrease % 2 == 0) {
                                          var s = t < 1 && t + .02 > 1 ? 1 : t + .02;
                                          s > o.a.playbackrateMax && (s = o.a.playbackrateMax),
                                          e.playRateDecrease = 0,
                                          i.playbackRate = s
                                      }
                                  }
                                    , a = function(t) {
                                      if (e.playRateDecrease % 2 == 0) {
                                          var s = t > 1 && t - .02 < 1 ? 1 : t - .02;
                                          s < o.a.playbackrateMin && (s = o.a.playbackrateMin),
                                          e.playRateIncrease = 0,
                                          i.playbackRate = s
                                      }
                                  }
                                    , r = this.getBufferLen()
                                    , n = i.playbackRate;
                                  t < 0 ? a(n) : t > 0 ? s(n) : 1 !== n && (n < 1 && r < this.JITTER_BUFLEN ? a(n) : n > 1 && r > this.JITTER_BUFLEN ? s(n) : i.playbackRate = 1),
                                  this.playRateDecrease++,
                                  this.playRateIncrease++
                              }
                          }
                      }, {
                          key: "setPlaybackRate",
                          value: function(t) {
                              var e = this.getPlayVideo();
                              e && (e.playbackRate = t)
                          }
                      }, {
                          key: "onJitterTimer",
                          value: function(t, e) {
                              if (this.playing && ("ts" != this.videoType || this.isLive) && this.autoJitter && !this.autoBitrateJitter) {
                                  var i = this.getPlayVideo();
                                  if (i) {
                                      var s = this.getBufferLen();
                                      if (o.a.getEnableJumpBuffer()) {
                                          var a = c.a.now();
                                          if (this.latencySeek > 0 && s > 4e3)
                                              return void (i.currentTime += s - this.latencySeek);
                                          if (this.enableLowLatency && s > Number(o.a.jitLowLatency))
                                              i.currentTime += s - o.a.jitLowLatency;
                                          else {
                                              var r = s - this.JITTER_BUFLEN;
                                              if (a - this.startPlayTime < this.startCd)
                                                  return;
                                              if (s >= (o.a.setVideoCTCfg[2] || 1e4))
                                                  return void this.setJumpBufferCurrentTime(r, s, 0, a);
                                              if (this.isStartBuffer && a - this.startPlayTime > this.startCd)
                                                  r >= o.a.setVideoCTCfg[1] && this.setJumpBufferCurrentTime(r, s, 1, a),
                                                  this.isStartBuffer = !1;
                                              else if (a - this.setVideoCurrentTime >= this.bufferCd || 0 == this.setVideoCurrentTime) {
                                                  if (a - this.startMoreBufferTime >= this.bufferMoreContinueTime && 0 != this.startMoreBufferTime)
                                                      return this.setJumpBufferCurrentTime(r, s, 2, a),
                                                      void (this.startMoreBufferTime = 0);
                                                  r >= o.a.setVideoCTCfg[1] ? 0 == this.startMoreBufferTime && (this.startMoreBufferTime = a) : this.startMoreBufferTime = 0
                                              }
                                          }
                                      } else if (this.latencySeek > 0 && s > 4e3)
                                          i.currentTime += s - this.latencySeek;
                                      else
                                          try {
                                              var n = 0;
                                              s < this.JITTER_BUFMIN ? n = s - this.JITTER_BUFLEN : s > this.JITTER_BUFMAX && (n = s - this.JITTER_BUFMAX),
                                              this.enableLowLatency && s > Number(o.a.jitLowLatency) ? i.playbackRate = 1.1 : this.playbackrateChangeAccess ? (n = Number(localStorage.ab_adjust) || n,
                                              1 != i.playbackRate && this.isPlaybackRateNormal && l.a.log("MSEPlayer.onJitterTimer.playbackRate=", i.playbackRate),
                                              1 != i.playbackRate ? this.isPlaybackRateNormal = !1 : this.isPlaybackRateNormal = !0,
                                              this.playbackRateSet(n)) : i.playbackRate = 1,
                                              -1 === Number(localStorage._print_ab_log) && l.a.log("BUFMIN: %d, BUFMAX: %d, BUFLEN:%d, bufLen: %d, adjust: %d, playbackRate: %f", this.JITTER_BUFMIN, this.JITTER_BUFMAX, this.JITTER_BUFLEN, s, n, i.playbackRate)
                                          } catch (t) {
                                              l.a.error("MSEPlayer.onJitterTimer set playbackRateSet error", t)
                                          }
                                  }
                              }
                          }
                      }, {
                          key: "setJumpBufferCurrentTime",
                          value: function(t, e, i, s) {
                              this.h265Proxy && this.h265Proxy.isReady ? this.h265Proxy.jumpBuffer(t, e, i, s) : this.setVideoCurrentTimeHand(t, e, i, s)
                          }
                      }, {
                          key: "setVideoCurrentTimeHand",
                          value: function(t, e, i, s) {
                              var a = this.getPlayVideo();
                              if (a) {
                                  var r = "";
                                  0 === i ? r = "maxBuffer" : 1 === i ? r = "fiveJump" : 2 === i && (r = "ContinueJudgeJump"),
                                  l.a.log("MSEPlayer.onJitterTimer.jumpBuffer ".concat(r, " video.currentTime before=").concat(a.currentTime, " bufLen=").concat(e, " minusBuffer=").concat(t, " curDts=").concat(this.getCurrentDts())),
                                  a.currentTime += t / 1e3,
                                  this.setVideoCurrentTime = s,
                                  l.a.log("MSEPlayer.onJitterTimer.jumpBuffer ".concat(r, " video.currentTime now=").concat(a.currentTime, " curDts=").concat(this.getCurrentDts(), " bufLen=").concat(this.getBufferLen()))
                              }
                          }
                      }, {
                          key: "setJitter",
                          value: function() {
                              var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 3e3
                                , e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1e3
                                , i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 5e3;
                              this.JITTER_BUFLEN = t,
                              this.JITTER_BUFMIN = e,
                              this.JITTER_BUFMAX = i,
                              l.a.info("".concat(this._getTag(), " MSEPlayer.setJitter bufMin=").concat(e, " bufLen=").concat(t, " bufMax=").concat(i))
                          }
                      }, {
                          key: "_getTag",
                          value: function() {
                              var t = this.handler.constructor.name;
                              return this._num_ + " " + t
                          }
                      }, {
                          key: "muffledVoice",
                          value: function() {
                              var t = this;
                              if (this.handler && this.handler.voiceEliminationData) {
                                  var e = this.handler.voiceEliminationData
                                    , i = !1;
                                  if (e && 0 !== e.length) {
                                      var s = this.getCurrentDts()
                                        , a = 0
                                        , r = 0;
                                      [].slice.call(e).map((function(e, n) {
                                          a = e.begin,
                                          r = e.end,
                                          0 == e.type && (a += t.offsetDts,
                                          r += t.offsetDts),
                                          s >= a && s <= r ? (i = !0,
                                          l.a.log("MSEPlayer.muffledVoice data", JSON.stringify(e))) : s > r && (l.a.log("MSEPlayer.muffledVoice stop muffle audio"),
                                          t.handler.voiceEliminationData.splice(n, 1))
                                      }
                                      )),
                                      i ? this.video.setMuffledVolume(!0) : this.video.setMuffledVolume(!1)
                                  }
                              }
                          }
                      }, {
                          key: "isMediaSourceOpen",
                          get: function() {
                              return this.mediaSource && "open" === this.mediaSource.readyState
                          }
                      }]),
                      t
                  }()
                    , Xt = {
                      isMacChrome72: function() {
                          return "mac" === _.a.platform && "chrome" === _.a.name && 72 === Number(_.a.version.major)
                      },
                      isNeedAud: function() {
                          return _.a.chrome && _.a.version.major >= 73
                      },
                      isBrowserSupport: function() {
                          return _.a.firefox || _.a.opera || _.a.chrome && 53 != _.a.version.major || _.a.safari || _.a.edge || _.a.edg
                      },
                      isP2PCooling: function() {
                          return 1 === Number(o.a.needCooling) && 1 === Number(localStorage.getItem("__p2p_cooling_play"))
                      },
                      isSupportP2P: function() {
                          return this.isBrowserSupport() && !this.isP2PCooling()
                      },
                      isWebrtcSupport: function() {
                          try {
                              var t = navigator.userAgent
                                , e = {
                                  Trident: t.indexOf("Trident") > 0 || t.indexOf("NET CLR") > 0,
                                  Presto: t.indexOf("Presto") > 0,
                                  WebKit: t.indexOf("AppleWebKit") > 0,
                                  Gecko: t.indexOf("Gecko/") > 0,
                                  UC: t.indexOf("UC") > 0 || t.indexOf(" UBrowser") > 0,
                                  BaiDu: t.indexOf("Baidu") > 0 || t.indexOf("BIDUBrowser") > 0,
                                  Maxthon: t.indexOf("Maxthon") > 0,
                                  LBBROWSER: t.indexOf("LBBROWSER") > 0,
                                  SouGou: t.indexOf("MetaSr") > 0 || t.indexOf("Sogou") > 0,
                                  IE: t.indexOf("MSIE") > 0 || t.indexOf("Trident") > 0,
                                  Firefox: t.indexOf("Firefox") > 0,
                                  Opera: t.indexOf("Opera") > 0 || t.indexOf("OPR") > 0,
                                  Safari: t.indexOf("Safari") > 0,
                                  Chrome: t.indexOf("Chrome") > 0 || t.indexOf("CriOS") > 0,
                                  Wechat: t.indexOf("MicroMessenger") > 0,
                                  Windows: t.indexOf("Windows") > 0,
                                  Linux: t.indexOf("Linux") > 0,
                                  Mac: t.indexOf("Macintosh") > 0,
                                  Android: t.indexOf("Android") > 0 || t.indexOf("Adr") > 0,
                                  WP: t.indexOf("IEMobile") > 0,
                                  BlackBerry: t.indexOf("BlackBerry") > 0 || t.indexOf("RIM") > 0 || t.indexOf("BB") > 0,
                                  MeeGo: t.indexOf("MeeGo") > 0,
                                  Symbian: t.indexOf("Symbian") > 0,
                                  iOS: t.indexOf("like Mac OS X") > 0,
                                  iPhone: t.indexOf("iPh") > 0,
                                  iPad: t.indexOf("iPad") > 0,
                                  Mobile: t.indexOf("Mobi") > 0 || t.indexOf("iPh") > 0 || t.indexOf("480") > 0,
                                  Tablet: t.indexOf("Tablet") > 0 || t.indexOf("iPad") > 0 || t.indexOf("Nexus 7") > 0
                              };
                              return e.Chrome && (e.Chrome = !(e.Opera || e.BaiDu || e.Maxthon || e.SouGou || e.UC || e.LBBROWSER)),
                              e.Chrome
                          } catch (t) {
                              return !1
                          }
                      }
                  }
                    , Zt = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.flvPlayer = e,
                          this.eventEmitter = e.eventEmitter,
                          this.jumpToP2PCd = 1e3 * (Math.floor(120 * Math.random()) + 180),
                          this.nextJumpToP2PTs = 0,
                          this.waitPlayEnd = !1,
                          this.lastP2PInfo = null
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              this.waitPlayEnd = !1
                          }
                      }, {
                          key: "initJumpTs",
                          value: function(t) {
                              0 == this.nextJumpToP2PTs && (this.nextJumpToP2PTs = t + this.jumpToP2PCd)
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              if (!this.waitPlayEnd && Xt.isSupportP2P() && !(t < this.nextJumpToP2PTs)) {
                                  var i = this.flvPlayer;
                                  if (this.lastP2PInfo && !o.a.isCloseP2P(this.lastP2PInfo.uid) && this.lastP2PInfo.lineType == i.lineType) {
                                      var s = this.lastP2PInfo.sStreamName;
                                      s && i.url && -1 != i.url.indexOf(s) && (i.getBufferLen() < i.mse.JITTER_BUFLEN || (i.loader && (l.a.warn("BackToP2P.tryPlayP2P"),
                                      i.loader.close()),
                                      this.waitPlayEnd = !0))
                                  }
                              }
                          }
                      }, {
                          key: "onCheckFastTimer",
                          value: function(t, e) {
                              var i = this.flvPlayer.getBufferLen();
                              this.waitPlayEnd && i < 1e3 && (this.waitPlayEnd = !1,
                              this.jumpToP2PCd < 18e5 && (this.jumpToP2PCd += 12e4),
                              this.nextJumpToP2PTs = t + this.jumpToP2PCd,
                              this.flvPlayer.getRecSysRsp({
                                  info: this.flvPlayer.info,
                                  type: "flv",
                                  metadata: this.flvPlayer.mse.metadata,
                                  isBackToP2P: !0
                              }))
                          }
                      }, {
                          key: "recSysRspHandler",
                          value: function(t, e, i) {
                              t && e && e.tRecSysInfo && 0 == e.tRecSysInfo.lAction || (l.a.warn("BackToP2P.onCheckFastTimer jumpToP2PCd=".concat(this.jumpToP2PCd / 6e4, "min")),
                              this.eventEmitter.trigger(r.a.FLV_TRY_TO_P2P),
                              this.lastP2PInfo = null)
                          }
                      }]),
                      t
                  }()
                    , $t = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.flvPlayer = e,
                          this.stat = e.stat,
                          this.tsdb = e.tsdb,
                          this.img = null,
                          this.isPaused = !1,
                          this.isFirstReport = !0
                      }
                      return Object(a.a)(t, [{
                          key: "sendFlow",
                          value: function(t, e, i, s, a, r) {
                              var n = arguments.length > 6 && void 0 !== arguments[6] && arguments[6];
                              this.record(t, e, i, s, a, r, n)
                          }
                      }, {
                          key: "getUserProperty",
                          value: function() {
                              var t = this.tsdb;
                              return o.a[100] ? o.a[101] ? Xt.isBrowserSupport() ? Xt.isP2PCooling() ? C.a.userProperty.P2P_COOLING : 1 == t.turnToFlvTimes && 0 == t.restartTimes ? t.turnToFlvReason == C.a.turnToFlvReason.FULL_CONNECT_TIMEOUT ? C.a.userProperty.FIRST_FULL_CONNECT_TIMEOUT : t.turnToFlvReason == C.a.turnToFlvReason.FULL_NO_DATA ? C.a.userProperty.FIRST_FULL_NO_DATA : t.turnToFlvReason == C.a.turnToFlvReason.FULL_PLAY_FAIL ? C.a.userProperty.FIRST_FULL_PLAY_FAIL : t.turnToFlvReason == C.a.turnToFlvReason.SUB_CONNECT_TIMEOUT ? C.a.userProperty.SUB_CONNECT_TIMEOUT : t.turnToFlvReason == C.a.turnToFlvReason.SUB_NO_DATA ? C.a.userProperty.SUB_NO_DATA : t.turnToFlvReason == C.a.turnToFlvReason.P2P_ARGS_ERROR ? C.a.userProperty.P2P_ARGS_ERROR : t.turnToFlvReason == C.a.turnToFlvReason.P2P_COOLING ? C.a.userProperty.P2P_COOLING : t.turnToFlvReason == C.a.turnToFlvReason.IS_NOT_FIRST_FETCH ? C.a.userProperty.IS_NOT_FIRST_FETCH : t.turnToFlvReason == C.a.turnToFlvReason.VIDEO_BUFFER_EMPTY ? C.a.userProperty.VIDEO_BUFFER_EMPTY : C.a.userProperty.UNKNOW : t.turnToFlvReason == C.a.turnToFlvReason.FULL_CONNECT_TIMEOUT || t.turnToFlvReason == C.a.turnToFlvReason.FULL_NO_DATA || t.turnToFlvReason == C.a.turnToFlvReason.FULL_PLAY_FAIL ? t.restartReason == C.a.restartReason.RANGE_SEQ_MAX ? C.a.userProperty.RESTART_RANGE_MAX : t.restartReason == C.a.restartReason.RANGE_SEQ_LARGE ? C.a.userProperty.RESTART_RANGE_LARGE : t.restartReason == C.a.restartReason.CONNECT ? C.a.userProperty.RESTART_CONNECT : t.restartReason == C.a.restartReason.MULTI_CDN ? C.a.userProperty.RESTART_MUTI_CDN : t.restartReason == C.a.restartReason.PLAYER_NO_DATA ? C.a.userProperty.RESTART_PLAYER_NO_DATA : t.restartReason == C.a.restartReason.PLAYER_ERROR ? C.a.userProperty.RESTART_PLAYER_ERROR : t.restartReason == C.a.restartReason.FLV_TO_P2P ? C.a.userProperty.FLV_TO_P2P : t.restartReason == C.a.restartReason.LOST_SEQ ? C.a.userProperty.LOST_SEQ : C.a.userProperty.UNKNOW : t.turnToFlvReason == C.a.turnToFlvReason.SUB_CONNECT_TIMEOUT ? C.a.userProperty.SUB_CONNECT_TIMEOUT : t.turnToFlvReason == C.a.turnToFlvReason.SUB_NO_DATA ? C.a.userProperty.SUB_NO_DATA : t.turnToFlvReason == C.a.turnToFlvReason.P2P_ARGS_ERROR ? C.a.userProperty.P2P_ARGS_ERROR : t.turnToFlvReason == C.a.turnToFlvReason.P2P_COOLING ? C.a.userProperty.P2P_COOLING : t.turnToFlvReason == C.a.turnToFlvReason.IS_NOT_FIRST_FETCH ? C.a.userProperty.IS_NOT_FIRST_FETCH : t.turnToFlvReason == C.a.turnToFlvReason.VIDEO_BUFFER_EMPTY ? C.a.userProperty.VIDEO_BUFFER_EMPTY : C.a.userProperty.UNKNOW : C.a.userProperty.BROWSER_UN_SUPPORT : C.a.userProperty.CLIENT_CLOSE : C.a.userProperty.SERVER_CLOSE
                          }
                      }, {
                          key: "record",
                          value: function(t, e, i, s, a, r) {
                              var n = arguments.length > 6 && void 0 !== arguments[6] && arguments[6];
                              this.volumeEnergy = r,
                              i && (this.isPaused = !0);
                              var o = this.getUserProperty();
                              this.stat.setCoreDim(d.a.DIM_CORE.USER_PROPERTY, o),
                              this.stat.setCoreDim(d.a.DIM_CORE.SIGNAL_USER_PROPERTY, 0),
                              this.stat.setComDim(d.a.DIM_COM.VIDEO_MIN_BUF, this.flvPlayer.mse.JITTER_BUFLEN);
                              var h = this.flvPlayer.mse.parser.timeStampStat
                                , u = [];
                              h.reset();
                              var l = this.flvPlayer.info;
                              this.stat.setCoreDim(d.a.DIM_CORE.VIDEO_BAD_QUALITY_OLD, i ? 100 : 0),
                              this.stat.setCoreDim(d.a.DIM_CORE.VIDEO_BAD_QUALITY, i || t > 0 ? 100 : 0),
                              this.stat.setCoreDim(d.a.DIM_CORE.VIDEO_BAD_REASON, a),
                              this.stat.setCore(d.a.CORE.BUFFER_LENGTH, this.flvPlayer.getBufferLen() + this.flvPlayer.getFrameBufferLen()),
                              this.stat.setCore(d.a.CORE.PLAY_DELAY, this.flvPlayer.getBufferLen()),
                              this.stat.setCore(d.a.CORE.FRAME_BUFFER_DELAY, this.flvPlayer.getFrameBufferLen()),
                              this.recordSample(),
                              this.recordAuto(),
                              this.flvPlayer.recSysStat.recordHeart(this.stat),
                              this.flvPlayer.mse.buffered.record(this.stat),
                              this.flvPlayer.mse.pauseStat.record(this.stat),
                              this.flvPlayer.autoMonitor.recordHeartType();
                              var c = this.flvPlayer.mse.metadata
                                , p = c.recvVideoFps
                                , _ = c.recvAudioFps;
                              this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.AUDIO_RATE, _),
                              this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.VIDEO_RATE, p);
                              var m = this.flvPlayer.mse.bufStat.getStats()
                                , v = m.emptyTime
                                , y = m.emptyCnt;
                              if (this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.VIDEO_BUFFER_EMPTY_COUNT, y),
                              this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.VIDEO_BUFFER_EMPTY_TIME, v),
                              this.flvPlayer.h265Proxy.rendering) {
                                  var T = this.flvPlayer.h265Proxy.getStats()
                                    , g = T.statProps
                                    , S = T.h265PauseCnt;
                                  for (var P in g)
                                      "toDecode" == P ? this.recordH265Frame(g[P], d.a.DIM_COM.V_TO_DECODE_FRAMES) : "decoded" == P ? this.recordH265Frame(g[P], d.a.DIM_COM.V_DECODE_FRAME) : "render" == P ? this.recordH265Frame(g[P], d.a.DIM_COM.V_PLAY_FRAME) : "rawList" == P ? this.recordH265Frame(g[P], d.a.DIM_COM.V_RECV_FRAME) : "frameList" == P ? this.recordH265Frame(g[P], d.a.DIM_COM.V_TO_PLAY_FRAME) : this.stat.setComp(d.a.DIM_H265_SAM.name, P, g[P].join("|"));
                                  this.stat.setCoreDim(d.a.DIM_CORE.VIDEO_H265_BAD_QUALITY, S > 0 ? 100 : 0)
                              }
                              this.flvPlayer.eventEmitter && this.flvPlayer.eventEmitter.costUs > 0 && this.stat.setComp(d.a.DIM_H265_SAM.name, "costUs", this.flvPlayer.eventEmitter.costUs);
                              var E = this.flvPlayer.loader.speed;
                              this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.SPEED, E);
                              var I = this.flvPlayer.mse.curVideoDts
                                , A = this.flvPlayer.mse.curAudioDts;
                              this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.VIDEO_DTS, I),
                              this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.AUDIO_DTS, A),
                              this.stat.setCompFormat(d.a.DIM_LINK_SAM.name, ":", ","),
                              this.recordC2CDelay(),
                              this.flvPlayer.mse.metadata && this.flvPlayer.mse.metadata.codecname && this.stat.setComDim(d.a.DIM_COM.SPHD_TYPE, this.flvPlayer.mse.metadata.codecname),
                              this.isFirstReport ? this.isFirstReport = !1 : u.push({
                                  sMetricName: f.METRIC.VIDEO_BAD_QUALITY_RATIO,
                                  vField: {
                                      value: this.isPaused ? 100 : 0,
                                      pausecnt: t
                                  },
                                  vDimension: {
                                      p2p: 0,
                                      originalBitrate: 0 === l.originalBitrate ? 1 : 0,
                                      p2pCooling: z.a.p2pCooling ? 1 : 0,
                                      topSid: l.sid,
                                      reason: a,
                                      quality: i || t > 0 ? 100 : 0
                                  },
                                  vExLog: {
                                      cdnip: this.flvPlayer.cdnip
                                  }
                              }),
                              this.stat.setComDim(d.a.DIM_COM.CDNIP, this.flvPlayer.cdnip),
                              this.recordAiData(),
                              this.recordMuteData(),
                              this.stat.fill(u, n),
                              this.tsdb.sendMetrics(u),
                              this.isPaused = !1
                          }
                      }, {
                          key: "recordSample",
                          value: function(t) {
                              this.flvPlayer.sampleController.recordStat(this.stat, t),
                              this.flvPlayer.mse.parser.avSample.recordStat(this.stat)
                          }
                      }, {
                          key: "recordAuto",
                          value: function() {
                              var t = this.flvPlayer.ctrlBitrate;
                              t && (this.stat.setCoreDim(d.a.DIM_CORE.AUTO_U_REASON, t._switchUpReason),
                              this.stat.setCoreDim(d.a.DIM_CORE.AUTO_D_REASON, t._switchDownReason))
                          }
                      }, {
                          key: "recordH265Frame",
                          value: function(t, e) {
                              var i = this;
                              this.stat.setComp(e, "size", t.length),
                              t.map((function(t, s) {
                                  i.stat.setComp(e, "k" + (s + 1), t),
                                  i.stat.setCompFormat(e, ":", ",")
                              }
                              ))
                          }
                      }, {
                          key: "recordAiData",
                          value: function() {
                              var t = this.flvPlayer.getAiStat()
                                , e = t.aiP2PCnt
                                , i = t.aiFlvCnt
                                , s = t.aiP2PTimeoutCnt
                                , a = t.aiFlvTimeoutCnt
                                , r = t.aiP2PErrorCnt
                                , n = t.aiFlvErrorCnt
                                , o = t.aiP2PSwitchCnt
                                , h = t.aiFlvSwitchCnt
                                , u = t.aiP2PNotSwitchCnt
                                , l = t.aiFlvNotSwitchCnt
                                , c = t.aiFlvErrorSwitchCnt
                                , p = t.aiFlvErrorNotSwitchCnt
                                , f = t.aiStartP2PCnt
                                , _ = t.aiStartFlvCnt;
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_P2P_CNT, e),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_FLV_CNT, i),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_P2P_TIMEOUT_CNT, s),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_FLV_TIMEOUT_CNT, a),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_P2P_ERROR_CNT, r),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_FLV_ERROR_CNT, n),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_P2P_SWITCH_CNT, o),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_FLV_SWITCH_CNT, h),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_P2P_NOT_SWITCH_CNT, u),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_FLV_NOT_SWITCH_CNT, l),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_FLV_ERROR_SWITCH_CNT, c),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_FLV_ERROR_NOT_SWITCH_CNT, p),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_START_P2P_CNT, f),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_START_FLV_CNT, _),
                              this.stat.setCompFormat(d.a.AI_CONTROL_DATA.name, ":", ",")
                          }
                      }, {
                          key: "recordMuteData",
                          value: function() {
                              if (this.flvPlayer.eventEmitter && this.flvPlayer.eventEmitter.getMuteStat && this.flvPlayer.eventEmitter.getMuteStat) {
                                  var t = this.flvPlayer.eventEmitter.getMuteStat().muteData
                                    , e = [];
                                  t.map((function(t) {
                                      var i = [];
                                      i.push(t.value),
                                      i.push(t.type),
                                      i.push(t.currentDts),
                                      i.push(t.reqKey),
                                      i.push(t.begin),
                                      i.push(t.end),
                                      e.push(i.join(":"))
                                  }
                                  )),
                                  this.stat.setCoreDim(d.a.DIM_COM.MUTE_DATA, e.join(","))
                              }
                          }
                      }, {
                          key: "recordC2CDelay",
                          value: function() {
                              var t = this.flvPlayer.mse.getDelayStat();
                              if (t) {
                                  for (var e in t.fields)
                                      this.stat.setCore(e, t.fields[e]);
                                  for (var i in t.dims)
                                      this.stat.setCoreDim(i, t.dims[i])
                              }
                          }
                      }]),
                      t
                  }()
                    , te = function() {
                      function t(e, i) {
                          Object(s.a)(this, t),
                          this.hyPlayer = e,
                          this.mse = i,
                          this.tickCnt = 0
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              this.tickCnt = 0
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              this.tickCnt++,
                              4 !== this.tickCnt && this.tickCnt % 10 != 0 || this.trigger()
                          }
                      }, {
                          key: "trigger",
                          value: function() {
                              var t = {};
                              Object.assign(t, this.mse.metadata),
                              this.hyPlayer.trigger(r.c.METADATA, t)
                          }
                      }]),
                      t
                  }()
                    , ee = i(25)
                    , ie = i.n(ee);
                  window.AudioContext = window.AudioContext || window.webkitAudioContext || window.mozAudioContext || window.msAudioContext;
                  var se = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i() {
                          var t;
                          return Object(s.a)(this, i),
                          (t = e.call(this)).audioContext = null,
                          t.playing = !1,
                          t.audio = null,
                          t.analyser = null,
                          t.source = null,
                          t.timer = 0,
                          t
                      }
                      return Object(a.a)(i, [{
                          key: "reset",
                          value: function() {
                              this.playing = !1
                          }
                      }, {
                          key: "createAudioContext",
                          value: function(t) {
                              if (t)
                                  try {
                                      this.audio != t && (this.audio = t,
                                      this.audioContext = new AudioContext,
                                      this.source = this.audioContext.createMediaElementSource(t),
                                      this.analyser = this.audioContext.createAnalyser(),
                                      this.analyser.fftSize = 2048,
                                      this.source.connect(this.analyser),
                                      this.analyser.connect(this.audioContext.destination)),
                                      this.playing = !0,
                                      this.loop(2e3)
                                  } catch (t) {
                                      l.a.log("createAudioContext err:" + t)
                                  }
                          }
                      }, {
                          key: "loop",
                          value: function(t) {
                              if (this.playing && this.analyser && this.analyser.fftSize) {
                                  this.audio && !this.audio.error && this.playing && (clearTimeout(this.timer),
                                  this.timer = setTimeout(this.loop.bind(this), t, t));
                                  var e = this.analyser.fftSize
                                    , s = new Uint8Array(e);
                                  this.analyser.getByteFrequencyData(s),
                                  s.some((function(t) {
                                      return t
                                  }
                                  )) ? this.emit(i.AUDIO_FREQUENCY, {
                                      value: 1
                                  }) : this.emit(i.AUDIO_FREQUENCY, {
                                      value: 0
                                  })
                              }
                          }
                      }]),
                      i
                  }(ee.EventEmitter)
                    , ae = se;
                  function re(t, e, i) {
                      return e in t ? Object.defineProperty(t, e, {
                          value: i,
                          enumerable: !0,
                          configurable: !0,
                          writable: !0
                      }) : t[e] = i,
                      t
                  }
                  se.AUDIO_FREQUENCY = "AUDIO_FREQUENCY";
                  var ne = i(44);
                  function oe(t, e) {
                      return function(t) {
                          if (Array.isArray(t))
                              return t
                      }(t) || function(t, e) {
                          if ("undefined" != typeof Symbol && Symbol.iterator in Object(t)) {
                              var i = []
                                , s = !0
                                , a = !1
                                , r = void 0;
                              try {
                                  for (var n, o = t[Symbol.iterator](); !(s = (n = o.next()).done) && (i.push(n.value),
                                  !e || i.length !== e); s = !0)
                                      ;
                              } catch (t) {
                                  a = !0,
                                  r = t
                              } finally {
                                  try {
                                      s || null == o.return || o.return()
                                  } finally {
                                      if (a)
                                          throw r
                                  }
                              }
                              return i
                          }
                      }(t, e) || Object(ne.a)(t, e) || function() {
                          throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")
                      }()
                  }
                  function he(t, e) {
                      var i = (65535 & t) + (65535 & e);
                      return (t >> 16) + (e >> 16) + (i >> 16) << 16 | 65535 & i
                  }
                  function ue(t, e, i, s, a, r) {
                      return he((n = he(he(e, t), he(s, r))) << (o = a) | n >>> 32 - o, i);
                      var n, o
                  }
                  function le(t, e, i, s, a, r, n) {
                      return ue(e & i | ~e & s, t, e, a, r, n)
                  }
                  function ce(t, e, i, s, a, r, n) {
                      return ue(e & s | i & ~s, t, e, a, r, n)
                  }
                  function de(t, e, i, s, a, r, n) {
                      return ue(e ^ i ^ s, t, e, a, r, n)
                  }
                  function pe(t, e, i, s, a, r, n) {
                      return ue(i ^ (e | ~s), t, e, a, r, n)
                  }
                  function fe(t, e) {
                      var i, s, a, r, n;
                      t[e >> 5] |= 128 << e % 32,
                      t[14 + (e + 64 >>> 9 << 4)] = e;
                      var o = 1732584193
                        , h = -271733879
                        , u = -1732584194
                        , l = 271733878;
                      for (i = 0; i < t.length; i += 16)
                          s = o,
                          a = h,
                          r = u,
                          n = l,
                          o = le(o, h, u, l, t[i], 7, -680876936),
                          l = le(l, o, h, u, t[i + 1], 12, -389564586),
                          u = le(u, l, o, h, t[i + 2], 17, 606105819),
                          h = le(h, u, l, o, t[i + 3], 22, -1044525330),
                          o = le(o, h, u, l, t[i + 4], 7, -176418897),
                          l = le(l, o, h, u, t[i + 5], 12, 1200080426),
                          u = le(u, l, o, h, t[i + 6], 17, -1473231341),
                          h = le(h, u, l, o, t[i + 7], 22, -45705983),
                          o = le(o, h, u, l, t[i + 8], 7, 1770035416),
                          l = le(l, o, h, u, t[i + 9], 12, -1958414417),
                          u = le(u, l, o, h, t[i + 10], 17, -42063),
                          h = le(h, u, l, o, t[i + 11], 22, -1990404162),
                          o = le(o, h, u, l, t[i + 12], 7, 1804603682),
                          l = le(l, o, h, u, t[i + 13], 12, -40341101),
                          u = le(u, l, o, h, t[i + 14], 17, -1502002290),
                          o = ce(o, h = le(h, u, l, o, t[i + 15], 22, 1236535329), u, l, t[i + 1], 5, -165796510),
                          l = ce(l, o, h, u, t[i + 6], 9, -1069501632),
                          u = ce(u, l, o, h, t[i + 11], 14, 643717713),
                          h = ce(h, u, l, o, t[i], 20, -373897302),
                          o = ce(o, h, u, l, t[i + 5], 5, -701558691),
                          l = ce(l, o, h, u, t[i + 10], 9, 38016083),
                          u = ce(u, l, o, h, t[i + 15], 14, -660478335),
                          h = ce(h, u, l, o, t[i + 4], 20, -405537848),
                          o = ce(o, h, u, l, t[i + 9], 5, 568446438),
                          l = ce(l, o, h, u, t[i + 14], 9, -1019803690),
                          u = ce(u, l, o, h, t[i + 3], 14, -187363961),
                          h = ce(h, u, l, o, t[i + 8], 20, 1163531501),
                          o = ce(o, h, u, l, t[i + 13], 5, -1444681467),
                          l = ce(l, o, h, u, t[i + 2], 9, -51403784),
                          u = ce(u, l, o, h, t[i + 7], 14, 1735328473),
                          o = de(o, h = ce(h, u, l, o, t[i + 12], 20, -1926607734), u, l, t[i + 5], 4, -378558),
                          l = de(l, o, h, u, t[i + 8], 11, -2022574463),
                          u = de(u, l, o, h, t[i + 11], 16, 1839030562),
                          h = de(h, u, l, o, t[i + 14], 23, -35309556),
                          o = de(o, h, u, l, t[i + 1], 4, -1530992060),
                          l = de(l, o, h, u, t[i + 4], 11, 1272893353),
                          u = de(u, l, o, h, t[i + 7], 16, -155497632),
                          h = de(h, u, l, o, t[i + 10], 23, -1094730640),
                          o = de(o, h, u, l, t[i + 13], 4, 681279174),
                          l = de(l, o, h, u, t[i], 11, -358537222),
                          u = de(u, l, o, h, t[i + 3], 16, -722521979),
                          h = de(h, u, l, o, t[i + 6], 23, 76029189),
                          o = de(o, h, u, l, t[i + 9], 4, -640364487),
                          l = de(l, o, h, u, t[i + 12], 11, -421815835),
                          u = de(u, l, o, h, t[i + 15], 16, 530742520),
                          o = pe(o, h = de(h, u, l, o, t[i + 2], 23, -995338651), u, l, t[i], 6, -198630844),
                          l = pe(l, o, h, u, t[i + 7], 10, 1126891415),
                          u = pe(u, l, o, h, t[i + 14], 15, -1416354905),
                          h = pe(h, u, l, o, t[i + 5], 21, -57434055),
                          o = pe(o, h, u, l, t[i + 12], 6, 1700485571),
                          l = pe(l, o, h, u, t[i + 3], 10, -1894986606),
                          u = pe(u, l, o, h, t[i + 10], 15, -1051523),
                          h = pe(h, u, l, o, t[i + 1], 21, -2054922799),
                          o = pe(o, h, u, l, t[i + 8], 6, 1873313359),
                          l = pe(l, o, h, u, t[i + 15], 10, -30611744),
                          u = pe(u, l, o, h, t[i + 6], 15, -1560198380),
                          h = pe(h, u, l, o, t[i + 13], 21, 1309151649),
                          o = pe(o, h, u, l, t[i + 4], 6, -145523070),
                          l = pe(l, o, h, u, t[i + 11], 10, -1120210379),
                          u = pe(u, l, o, h, t[i + 2], 15, 718787259),
                          h = pe(h, u, l, o, t[i + 9], 21, -343485551),
                          o = he(o, s),
                          h = he(h, a),
                          u = he(u, r),
                          l = he(l, n);
                      return [o, h, u, l]
                  }
                  function _e(t) {
                      var e, i = "", s = 32 * t.length;
                      for (e = 0; e < s; e += 8)
                          i += String.fromCharCode(t[e >> 5] >>> e % 32 & 255);
                      return i
                  }
                  function me(t) {
                      var e, i = [];
                      for (i[(t.length >> 2) - 1] = void 0,
                      e = 0; e < i.length; e += 1)
                          i[e] = 0;
                      var s = 8 * t.length;
                      for (e = 0; e < s; e += 8)
                          i[e >> 5] |= (255 & t.charCodeAt(e / 8)) << e % 32;
                      return i
                  }
                  function ve(t) {
                      var e, i, s = "";
                      for (i = 0; i < t.length; i += 1)
                          e = t.charCodeAt(i),
                          s += "0123456789abcdef".charAt(e >>> 4 & 15) + "0123456789abcdef".charAt(15 & e);
                      return s
                  }
                  function ye(t) {
                      return unescape(encodeURIComponent(t))
                  }
                  function Te(t) {
                      return function(t) {
                          return _e(fe(me(t), 8 * t.length))
                      }(ye(t))
                  }
                  function ge(t, e) {
                      return function(t, e) {
                          var i, s, a = me(t), r = [], n = [];
                          for (r[15] = n[15] = void 0,
                          a.length > 16 && (a = fe(a, 8 * t.length)),
                          i = 0; i < 16; i += 1)
                              r[i] = 909522486 ^ a[i],
                              n[i] = 1549556828 ^ a[i];
                          return s = fe(r.concat(me(e)), 512 + 8 * e.length),
                          _e(fe(n.concat(s), 640))
                      }(ye(t), ye(e))
                  }
                  var Se = function(t, e, i) {
                      return e ? i ? ge(e, t) : ve(ge(e, t)) : i ? Te(t) : ve(Te(t))
                  }
                    , Pe = Object(v.a)("X2Zt")
                    , Ee = Object(v.a)("Zm0=")
                    , Ie = Object(v.a)("X3dzVGltZQ==")
                    , Ae = Object(v.a)("d3NUaW1l")
                    , Ce = Object(v.a)("X2ludmFsaWRUaW1l")
                    , ke = Object(v.a)("X25leHRSZWZyZXNoVGltZQ==")
                    , be = Object(v.a)("X2N0eXBl")
                    , Re = Object(v.a)("Y3R5cGU=")
                    , Le = Object(v.a)("d3NTZWNyZXQ=")
                    , we = Object(v.a)("X3BhcmFtcw==")
                    , Oe = Object(v.a)("X3NGbHZBbnRpY29kZQ==")
                    , De = Object(v.a)("X3NGbHZVcmw=")
                    , Ne = Object(v.a)("X3NTdHJlYW1OYW1l")
                    , Fe = Object(v.a)("X3JlcQ==")
                    , Me = Object(v.a)("c2VxaWQ=")
                    , Ue = Object(v.a)("X3NlcWlk")
                    , Be = Object(v.a)("X3BjZG4=")
                    , Ve = Object(v.a)("JDA=")
                    , xe = Object(v.a)("JDE=")
                    , He = Object(v.a)("JDI=")
                    , Ge = Object(v.a)("JDM=")
                    , je = Object(v.a)("aW5pdA==")
                    , We = Object(v.a)("aXNJbnZhbGlk")
                    , Ye = Object(v.a)("Z2V0QW50aWNvZGU=")
                    , qe = Object(v.a)("cGFyc2VBbnRpY29kZQ==")
                    , Ke = Object(v.a)("aGFzQW50aWNvZGU=")
                    , ze = Object(v.a)("b25DaGVja1RpbWVy")
                    , Je = Object(v.a)("X29uUmVmcmVzaA==")
                    , Qe = Object(v.a)("X29uUmVmcmVzaEJpbmQ=")
                    , Xe = Object(v.a)("dmFsaWQ=")
                    , Ze = Object(v.a)("Z2V0VG9rZW4=")
                    , $e = Object(v.a)("X2dldFRva2Vu")
                    , ti = Object(v.a)("bGl2ZXVp")
                    , ei = Object(v.a)("Z2V0Q2RuVG9rZW5JbmZvRXg=")
                    , ii = (Object(v.a)("MTAw"),
                  Object(v.a)("dmVyPTE="))
                    , si = Object(v.a)("Jg==")
                    , ai = Object(v.a)("PQ==")
                    , ri = Object(v.a)("UkVGUkVTSA==")
                    , ni = Object(v.a)("cmVmcmVzaA==")
                    , oi = (Object(v.a)("ZGVjb2RlVVJJ"),
                  Object(v.a)("dW5lc2NhcGU="),
                  Object(v.a)("Z2V0U2VxaWQ="))
                    , hi = i(15).default
                    , ui = i(18).default
                    , li = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i() {
                          var t;
                          return Object(s.a)(this, i),
                          (t = e.call(this))[Ie] = "",
                          t[Pe] = "",
                          t[be] = "",
                          t[we] = [],
                          t[Oe] = "",
                          t[De] = "",
                          t[Ne] = "",
                          t[Ue] = "",
                          t[Ce] = Number.MAX_SAFE_INTEGER,
                          t[ke] = Number.MAX_SAFE_INTEGER,
                          t[Qe] = t[Je].bind(Object(g.a)(t)),
                          t
                      }
                      return Object(a.a)(i, [{
                          key: Ke,
                          value: function() {
                              return "" !== this[Oe]
                          }
                      }, {
                          key: je,
                          value: function(t, e, i) {
                              this[De] = t,
                              this[Ne] = e,
                              this[qe](i)
                          }
                      }, {
                          key: qe,
                          value: function(t) {
                              var e = this;
                              this[Pe] = "",
                              this[Ie] = "",
                              this[be] = "",
                              this[we] = [],
                              this[Oe] = t,
                              t.split(si).forEach((function(t) {
                                  var i = oe(t.split(ai), 2)
                                    , s = i[0]
                                    , a = i[1];
                                  if (s === Ee)
                                      a = decodeURI(a),
                                      a = unescape(a),
                                      a = atob(a),
                                      e[Pe] = a;
                                  else if (s === Ae) {
                                      e[Ie] = a;
                                      var r = 1e3 * parseInt(a, 16) + 3e5;
                                      e[Ce] = c.a.now() + (r - Date.now()),
                                      e[ke] = e[Ce] - 3e4
                                  } else
                                      s == Re ? e[be] = a : s !== Le && e[we].push(t)
                              }
                              ))
                          }
                      }, {
                          key: We,
                          value: function(t) {
                              return t > this[Ce]
                          }
                      }, {
                          key: Ye,
                          value: function(t) {
                              if ("" === this[Pe])
                                  return this[Oe];
                              var e = o.a.platform
                                , i = C.a.PLATFORM_TYPE[e] || C.a.PLATFORM_TYPE.web;
                              this[Ue] = z.a.uid + Date.now();
                              var s = Se("".concat(this[Ue], "|").concat(this[be], "|").concat(i))
                                , a = e === C.a.PLATFORM_TYPE_NAME.wap ? z.a.uid : z.a.convertUid
                                , r = this[Pe].replace(Ve, a).replace(xe, this[Ne]).replace(He, s).replace(Ge, this[Ie]);
                              t && (r += Be);
                              var n = "".concat(Le).concat(ai).concat(Se(r)).concat(si).concat(Ae).concat(ai).concat(this[Ie]).concat(si).concat(Me).concat(ai).concat(this[Ue]).concat(si).concat(Re).concat(ai).concat(this[be]).concat(si).concat(ii);
                              return this[we].length > 0 && (n += si + this[we].join(si)),
                              n
                          }
                      }, {
                          key: oi,
                          value: function() {
                              return this[Ue]
                          }
                      }, {
                          key: ze,
                          value: function(t, e) {
                              t >= this[ke] && this[Ze]().then(this[Qe])
                          }
                      }, {
                          key: Je,
                          value: function() {
                              this.trigger(i.Events[ri])
                          }
                      }, {
                          key: Xe,
                          value: function() {
                              var t = this;
                              return new Promise((function(e) {
                                  t[We](c.a.now()) ? t[Ze]().then(e) : e()
                              }
                              ))
                          }
                      }, {
                          key: Ze,
                          value: function() {
                              var t = this;
                              return new Promise((function(e) {
                                  ui.connected ? t[$e](e) : ui.on(ui.TAFLINK_INITED, (function() {
                                      t[$e](e)
                                  }
                                  ))
                              }
                              ))
                          }
                      }, {
                          key: $e,
                          value: function(t) {
                              var e = this;
                              this[Fe] || (this[Fe] = new hi.GetCdnTokenExReq),
                              this[Fe].sFlvUrl = this._sFlvUrl,
                              this[Fe].sStreamName = this._sStreamName,
                              this[Fe].tId = ui.getUserId(),
                              this[Fe].iAppId = z.a.appid,
                              this[ke] = Number.MAX_SAFE_INTEGER,
                              ui.sendWup(ti, ei, this._req, (function(s) {
                                  l.a.log("".concat(i.name, ".").concat(Ze, "="), s.sFlvToken),
                                  e[qe](s.sFlvToken),
                                  t()
                              }
                              ), !0, ui.getRequestId())
                          }
                      }]),
                      i
                  }(H);
                  li.Events = re({}, ri, ni);
                  var ci = li
                    , di = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.player = e,
                          this.recordMap = new Map,
                          this.init(),
                          this.reset()
                      }
                      return Object(a.a)(t, [{
                          key: "init",
                          value: function() {
                              this.keys = Object.values(d.a.DIM_LINK_STA);
                              var t = this.keys.indexOf(d.a.DIM_LINK_STA.name);
                              -1 !== t && this.keys.splice(t, 1)
                          }
                      }, {
                          key: "setStat",
                          value: function(t, e) {
                              this.recordMap.has(t) || (this.recordMap.set(t, 1),
                              this.exceptionStat[t] = e)
                          }
                      }, {
                          key: "getStat",
                          value: function() {
                              var t = this;
                              this.player.getDurationTime && this.player.getDurationTime() > 2 && this.setStat(d.a.DIM_LINK_STA.DATA_ENOUGH, 1);
                              var e = [];
                              return Object.keys(this.exceptionStat).forEach((function(i) {
                                  e.push("".concat(i, ":").concat(t.exceptionStat[i]))
                              }
                              )),
                              e.join(",")
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              var t = this;
                              this.recordMap.clear(),
                              this.exceptionStat = {},
                              this.keys.forEach((function(e) {
                                  t.exceptionStat[e] = 0
                              }
                              ))
                          }
                      }]),
                      t
                  }()
                    , pi = function(t, e, i) {
                      i = i || "";
                      var s = "cdndomain"
                        , a = (e = e || "").match(/\/\/(.+?)\//i);
                      a && a.length > 1 && (s = a[1]),
                      t.setComDim(d.a.DIM_COM.CDNDOMAIN, s),
                      t.setComDim(d.a.DIM_COM.STREAM, i || "stream")
                  }
                    , fi = function() {
                      function t(e) {
                          var i = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1]
                            , a = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 10;
                          Object(s.a)(this, t),
                          this.linkHandler = e,
                          this.ws = null,
                          this.connected = !1,
                          this.isYY = i,
                          this.url = null,
                          this.avgSpeed = new y(a)
                      }
                      return Object(a.a)(t, [{
                          key: "destroy",
                          value: function() {
                              this.linkHandler = null,
                              this.reset(),
                              k.a.remove(this.onCheckTimer, this)
                          }
                      }, {
                          key: "connect",
                          value: function(t) {
                              this.reset(),
                              k.a.add(this.onCheckTimer, this, 1e3),
                              this.url = t,
                              this.ws = new WebSocket(t),
                              this.ws.binaryType = "arraybuffer",
                              this.ws.onopen = this.onopen.bind(this),
                              this.ws.onerror = this.onerror.bind(this),
                              this.ws.onclose = this.onclose.bind(this),
                              this.ws.onmessage = this.onmessage.bind(this)
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              this.ws && (this.connected = !1,
                              this.ws.onopen = null,
                              this.ws.onerror = null,
                              this.ws.onclose = null,
                              this.ws.onmessage = null,
                              this.ws.close(),
                              this.ws = null),
                              this.url = null,
                              this.avgSpeed.reset()
                          }
                      }, {
                          key: "send",
                          value: function(t) {
                              this.ws && this.connected && this.ws.send(t)
                          }
                      }, {
                          key: "onopen",
                          value: function() {
                              this.connected = !0,
                              this.linkHandler && this.linkHandler.onopen()
                          }
                      }, {
                          key: "onerror",
                          value: function(t) {
                              l.a.log("ProtoLink.onerror event=" + t),
                              this.connected = !1,
                              this.ws = null,
                              this.linkHandler && (this.linkHandler.onerror(t),
                              this.linkHandler = null)
                          }
                      }, {
                          key: "onclose",
                          value: function() {
                              this.connected = !1,
                              this.ws = null,
                              this.linkHandler && (this.linkHandler.onclose(),
                              this.linkHandler = null)
                          }
                      }, {
                          key: "onmessage",
                          value: function(t) {
                              this.avgSpeed.addCur(t.data.byteLength),
                              t.data instanceof ArrayBuffer ? this.processArrayBuffer(t.data) : this.processText(t.data)
                          }
                      }, {
                          key: "processText",
                          value: function(t) {
                              l.a.log("ProtoLink.processText data=" + t)
                          }
                      }, {
                          key: "processArrayBuffer",
                          value: function(t) {
                              if (this.isYY)
                                  for (var e = new DataView(t), i = 0, s = 0, a = 0; i + 10 < t.byteLength; ) {
                                      if (i + (s = e.getUint32(i, !0)) > t.byteLength || s < 10)
                                          return void l.a.error("ProtoLink.processArrayBuffer length error pktLen=" + s + " bufferLen=" + t.byteLength);
                                      a = e.getUint32(i + 4, !0);
                                      var r = new DataView(t,i,s);
                                      this.linkHandler && this.linkHandler.onData(a, r),
                                      i += s
                                  }
                              else
                                  this.linkHandler && this.linkHandler.onData(t)
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              this.connected && this.avgSpeed.calculate()
                          }
                      }, {
                          key: "speed",
                          get: function() {
                              return this.avgSpeed.average()
                          }
                      }]),
                      t
                  }()
                    , _i = function() {
                      function t(e) {
                          var i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 10;
                          Object(s.a)(this, t),
                          this.linkHandler = e,
                          this.connected = !1,
                          this.url = null,
                          this.xhr = null,
                          this.avgSpeed = new y(i)
                      }
                      return Object(a.a)(t, null, [{
                          key: "isSupported",
                          value: function() {
                              try {
                                  var t = new XMLHttpRequest;
                                  return t.open("GET", "https://example.com", !0),
                                  t.responseType = "moz-chunked-arraybuffer",
                                  "moz-chunked-arraybuffer" === t.responseType
                              } catch (t) {
                                  return l.a.warn("MozChunkedLoader", t.message),
                                  !1
                              }
                          }
                      }]),
                      Object(a.a)(t, [{
                          key: "destroy",
                          value: function() {
                              this.reset(),
                              this.linkHandler = null,
                              k.a.remove(this.onCheckTimer, this)
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              this.abort(),
                              this.url = null,
                              this.xhr = null,
                              this.connected = !1,
                              this.avgSpeed.reset()
                          }
                      }, {
                          key: "abort",
                          value: function() {
                              this.xhr && (l.a.log("ProtoLinkXhrFF abort"),
                              this.xhr.abort())
                          }
                      }, {
                          key: "connect",
                          value: function(t) {
                              this.reset(),
                              this.url = t;
                              var e = this.xhr = new XMLHttpRequest;
                              e.responseType = "moz-chunked-arraybuffer",
                              e.open("GET", this.url, !0),
                              e.onerror = this.onerror.bind(this),
                              e.onprogress = this.onprogress.bind(this),
                              e.onloadend = this.loadend.bind(this),
                              e.onload = this.onclose.bind(this),
                              e.send(),
                              k.a.add(this.onCheckTimer, this, 1e3)
                          }
                      }, {
                          key: "onprogress",
                          value: function(t) {
                              this.connected || this.onopen();
                              var e = t.target.response;
                              this.linkHandler.onData(e),
                              this.avgSpeed.addCur(e.byteLength)
                          }
                      }, {
                          key: "onreadystatechange",
                          value: function(t) {}
                      }, {
                          key: "onopen",
                          value: function() {
                              this.connected = !0,
                              this.linkHandler && this.linkHandler.onopen()
                          }
                      }, {
                          key: "onerror",
                          value: function(t) {
                              l.a.log("ProtoLinkXhrFF.onerror " + t);
                              var e = t.currentTarget.status;
                              this.connected = !1,
                              this.linkHandler && (this.linkHandler.onerror(t, e),
                              this.linkHandler = null)
                          }
                      }, {
                          key: "loadend",
                          value: function(t) {
                              404 === t.currentTarget.status && this.onerror(t)
                          }
                      }, {
                          key: "onclose",
                          value: function() {
                              l.a.log("ProtoLinkXhrFF.onclose"),
                              this.connected = !1,
                              this.linkHandler && (this.linkHandler.onclose(),
                              this.linkHandler = null)
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              this.connected && this.avgSpeed.calculate()
                          }
                      }, {
                          key: "speed",
                          get: function() {
                              return this.avgSpeed.average()
                          }
                      }]),
                      t
                  }()
                    , mi = function() {
                      function t(e) {
                          var i = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 10;
                          Object(s.a)(this, t),
                          this.linkHandler = e,
                          this.connected = !1,
                          this.url = null,
                          this.requestAbort = !1,
                          this.avgSpeed = new y(i)
                      }
                      return Object(a.a)(t, [{
                          key: "destroy",
                          value: function() {
                              this.abort(),
                              this.linkHandler = null,
                              this.reset(),
                              k.a.remove(this.onCheckTimer, this)
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              this.url = null,
                              this.connected = !1,
                              this.avgSpeed.reset()
                          }
                      }, {
                          key: "pump",
                          value: function(t) {
                              var e = this;
                              t.read().then(function(i) {
                                  if (i.done)
                                      e.onclose();
                                  else if (!e.checkAbort(t)) {
                                      var s = i.value.buffer;
                                      e.avgSpeed.addCur(s.byteLength),
                                      e.linkHandler && e.linkHandler.onData(s),
                                      e.pump(t)
                                  }
                              }
                              .bind(this))
                          }
                      }, {
                          key: "checkAbort",
                          value: function(t) {
                              return !!this.requestAbort && (this.requestAbort = !1,
                              t.cancel(),
                              !0)
                          }
                      }, {
                          key: "connect",
                          value: function(t) {
                              var e = this;
                              k.a.add(this.onCheckTimer, this, 1e3),
                              this.url = t,
                              fetch(t).then((function(t) {
                                  Number(localStorage._printFetchUrl) && l.a.log("FetchUrl", t.url);
                                  var i = t.body.getReader();
                                  e.checkAbort(i) || (e.linkHandler && e.linkHandler.onstatus && e.linkHandler.onstatus(t.status),
                                  t.ok && t.status >= 200 && t.status < 300 ? (e.onheader(t),
                                  e.onopen(),
                                  e.pump.call(e, i)) : (l.a.log("ProtoLinkFetch http code invalid status:" + t.status),
                                  e.onerror(t.statusText, t.status)))
                              }
                              )).catch((function(t) {
                                  l.a.log("ProtoLinkFetch exception"),
                                  e.onerror(t.message)
                              }
                              ))
                          }
                      }, {
                          key: "abort",
                          value: function() {
                              this.requestAbort = !0
                          }
                      }, {
                          key: "onheader",
                          value: function(t) {
                              var e, i = {}, s = [], a = Object(m.a)(t.headers);
                              try {
                                  for (a.s(); !(e = a.n()).done; ) {
                                      var r = oe(e.value, 2)
                                        , n = r[0]
                                        , o = r[1];
                                      i[n] = o,
                                      s.push(n + ":" + o)
                                  }
                              } catch (t) {
                                  a.e(t)
                              } finally {
                                  a.f()
                              }
                              l.a.log("ProtoLinkFetch.onheader", s.join(" | ")),
                              this.linkHandler.onheader && this.linkHandler.onheader(i)
                          }
                      }, {
                          key: "onopen",
                          value: function() {
                              this.connected = !0,
                              this.linkHandler && this.linkHandler.onopen()
                          }
                      }, {
                          key: "onerror",
                          value: function(t, e) {
                              l.a.log("ProtoLinkFetch.onerror " + t),
                              this.connected = !1,
                              this.linkHandler && (this.linkHandler.onerror(t, e),
                              this.linkHandler = null)
                          }
                      }, {
                          key: "onclose",
                          value: function() {
                              this.connected = !1,
                              this.linkHandler && (this.linkHandler.onclose(),
                              this.linkHandler = null)
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              this.connected && this.avgSpeed.calculate()
                          }
                      }, {
                          key: "speed",
                          get: function() {
                              return this.avgSpeed.average()
                          }
                      }]),
                      t
                  }()
                    , vi = function() {
                      function t(e) {
                          var i = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1];
                          Object(s.a)(this, t),
                          this.flvPlayer = e,
                          e.hyPlayer && (this.hyPlayer = e.hyPlayer,
                          this.stat = e.hyPlayer.stat),
                          this._newLink(),
                          this.needRetry = i,
                          this.status = 0,
                          this.url = null,
                          this.started = !1,
                          this.lastGetProxyTime = 0,
                          this.getProxyPeriod = t.DEFAULT_GET_PROXY_PERIOD,
                          this.headers = null
                      }
                      return Object(a.a)(t, [{
                          key: "_newLink",
                          value: function() {
                              _.a.firefox && _i.isSupported() ? this.link = new _i(this) : Xt.isMacChrome72() ? this.link = new fi(this) : this.link = new mi(this)
                          }
                      }, {
                          key: "abort",
                          value: function() {
                              this.link.destroy()
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              this.lastGetProxyTime = 0,
                              this.status = 0,
                              this.url = null,
                              this.started && (l.a.log("FlvLoader.reset"),
                              this.link.destroy(),
                              this._newLink())
                          }
                      }, {
                          key: "connect",
                          value: function(t) {
                              t ? (this.link instanceof fi && (t = t.replace("http", "ws")),
                              this.reset(),
                              this.lastGetProxyTime = c.a.now() - 2e3,
                              l.a.log("FlvLoader.connect url=" + t, this.lastGetProxyTime),
                              this.headers = null,
                              this.url = t,
                              this.link.connect(this.url),
                              this.started = !0) : l.a.warn("FlvLoader.connect url is null")
                          }
                      }, {
                          key: "close",
                          value: function() {
                              l.a.log("FlvLoader.close"),
                              this.reset(),
                              this.started = !1
                          }
                      }, {
                          key: "onstatus",
                          value: function(t) {
                              this.status = t
                          }
                      }, {
                          key: "onheader",
                          value: function(t) {
                              this.headers = t,
                              l.a.log("FlvLoader.onheader", t),
                              this.flvPlayer && this.flvPlayer.onHeader && this.flvPlayer.onHeader(t)
                          }
                      }, {
                          key: "onopen",
                          value: function() {
                              l.a.log("FlvLoader.onopen"),
                              this.getProxyPeriod = t.DEFAULT_GET_PROXY_PERIOD,
                              this.flvPlayer.onConnected()
                          }
                      }, {
                          key: "onclose",
                          value: function() {
                              localStorage.hasOwnProperty("_toPcdn") || (l.a.log("FlvLoader.onclose"),
                              this.flvPlayer.onClosed(),
                              this.lastGetProxyTime = 0,
                              this.needRetry && this.getProxy())
                          }
                      }, {
                          key: "onerror",
                          value: function(t, e) {
                              l.a.log("FlvLoader.onerror", e),
                              this.lastGetProxyTime = 0,
                              this.needRetry && this.getProxy(),
                              this.flvPlayer.onLoadError && this.flvPlayer.onLoadError(t)
                          }
                      }, {
                          key: "onData",
                          value: function(t) {
                              this.flvPlayer.onData(t, 1)
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              if (this.started && (this.onCheckConnect(t),
                              e % 10 == 0)) {
                                  var i = this.link.speed;
                                  i != v.b.UintMax && (i = v.b.formatByteSize(i),
                                  l.a.log("FlvLoader speed ".concat(i, "/s")))
                              }
                          }
                      }, {
                          key: "onCheckConnect",
                          value: function(t) {
                              this.connected || (this.needRetry ? this.getProxy() : t - this.lastGetProxyTime > 15e3 && 0 != this.lastGetProxyTime && this.flvPlayer && this.flvPlayer.onLoadTimeout && (this.flvPlayer.onLoadTimeout(),
                              this.lastGetProxyTime = 0))
                          }
                      }, {
                          key: "getProxy",
                          value: function() {
                              var t = c.a.now();
                              t - this.lastGetProxyTime < this.getProxyPeriod || (l.a.log("FlvLoader.getProxy lastGetProxyTime=" + this.lastGetProxyTime + " now=" + t + " period=" + this.getProxyPeriod),
                              this.reset(),
                              this.lastGetProxyTime = t,
                              this.getProxyPeriod = Math.min(2 * this.getProxyPeriod, 128e3),
                              this.flvPlayer.requestUrl())
                          }
                      }, {
                          key: "speed",
                          get: function() {
                              var t = this.link.speed;
                              return t == v.b.UintMax && (t = 0),
                              t
                          }
                      }, {
                          key: "connected",
                          get: function() {
                              return this.link && this.link.connected
                          }
                      }]),
                      t
                  }();
                  vi.DEFAULT_GET_PROXY_PERIOD = 4e3;
                  var yi = vi
                    , Ti = "loaded"
                    , gi = "error"
                    , Si = "timeout"
                    , Pi = new Map
                    , Ei = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i(t) {
                          var a;
                          return Object(s.a)(this, i),
                          (a = e.call(this))._libName = t,
                          a._script = null,
                          a._loaded = !1,
                          a._onLoadBind = a._onLoad.bind(Object(g.a)(a)),
                          a._onErrorBind = a._onError.bind(Object(g.a)(a)),
                          a
                      }
                      return Object(a.a)(i, [{
                          key: "load",
                          value: function(t) {
                              var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 6e4;
                              if (this._loaded)
                                  this.trigger(Ti);
                              else {
                                  var i = this._script;
                                  i || ((i = document.createElement("script")).async = !0,
                                  i.onload = i.onreadystatechange = this._onLoadBind,
                                  i.onerror = this._onErrorBind,
                                  i.src = t.endsWith("/") ? t + this._libName : t + "/" + this._libName,
                                  document.getElementsByTagName("head")[0].appendChild(i),
                                  this._script = i,
                                  k.a.once(this._onTimeout, this, e))
                              }
                          }
                      }, {
                          key: "_onLoad",
                          value: function() {
                              var t = this._script
                                , e = t.readyState;
                              e && "loaded" !== e && "complete" !== e || (t.onload = t.onreadystatechange = null,
                              this._loaded = !0,
                              k.a.remove(this._onTimeout, this),
                              this.trigger(Ti))
                          }
                      }, {
                          key: "_onTimeout",
                          value: function() {
                              this._clear(),
                              this.trigger(Si)
                          }
                      }, {
                          key: "_onError",
                          value: function() {
                              this._clear(),
                              this.trigger(gi)
                          }
                      }, {
                          key: "_clear",
                          value: function() {
                              var t = this._script;
                              t && (t.onload = t.onreadystatechange = t.onerror = null,
                              t.src = "",
                              t.parentNode && t.parentNode.removeChild(t),
                              this._script = null)
                          }
                      }]),
                      i
                  }(H)
                    , Ii = function(t, e, i) {
                      var s = i.onLoaded
                        , a = void 0 === s ? null : s
                        , r = i.onError
                        , n = void 0 === r ? null : r
                        , o = i.onTimeout
                        , h = void 0 === o ? null : o
                        , u = i.thisObj
                        , l = void 0 === u ? null : u
                        , c = i.timeout
                        , d = void 0 === c ? 6e4 : c
                        , p = Pi.get(e);
                      return p || (p = new Ei(e),
                      Pi.set(e, p)),
                      a && p.on(Ti, a, l),
                      n && p.on(gi, n, l),
                      h && p.on(Si, h, l),
                      p.load(t, d),
                      p
                  }
                    , Ai = function(t, e) {
                      var i = e.onLoaded
                        , s = void 0 === i ? null : i
                        , a = e.onError
                        , r = void 0 === a ? null : a
                        , n = e.onTimeout
                        , o = void 0 === n ? null : n
                        , h = e.thisObj
                        , u = void 0 === h ? null : h
                        , l = Pi.get(t);
                      l && (s && l.off(Ti, s, u),
                      r && l.off(gi, r, u),
                      o && l.off(Si, o, u))
                  }
                    , Ci = {
                      ppio: "ppio",
                      xy: "xy"
                  }
                    , ki = {
                      ppio: "EcdnLive.js",
                      xy: "XYLive.js"
                  }
                    , bi = "LOAD_FAIL"
                    , Ri = "GATHER_SUC"
                    , Li = "GATHER_FAIL"
                    , wi = "DATA"
                    , Oi = "LOAD_STOP"
                    , Di = "LOAD_FINISH"
                    , Ni = "SDK_DESTROYED"
                    , Fi = {}
                    , Mi = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i() {
                          var t;
                          return Object(s.a)(this, i),
                          (t = e.call(this))._pcdnName = "",
                          t._loader = null,
                          t._lastDataTs = 0,
                          t._started = !1,
                          t._speed = new y(10),
                          t._callbacks = {
                              onLoaded: t._onLoadLibSUc,
                              onError: t._onLoadLibErr,
                              thisObj: Object(g.a)(t)
                          },
                          t._binds = {},
                          t._binds[bi] = t._onLoadFail.bind(Object(g.a)(t)),
                          t._binds[Ri] = t._onGatherSuc.bind(Object(g.a)(t)),
                          t._binds[Li] = t._onGatherFail.bind(Object(g.a)(t)),
                          t._binds[wi] = t._onData.bind(Object(g.a)(t)),
                          t._binds[Oi] = t._onLoadStop.bind(Object(g.a)(t)),
                          t._binds[Di] = t._onLoadFinish.bind(Object(g.a)(t)),
                          t._binds[Ni] = t._sdkDestroy.bind(Object(g.a)(t)),
                          t
                      }
                      return Object(a.a)(i, [{
                          key: "setPcdnName",
                          value: function(t) {
                              this._pcdnName = t
                          }
                      }, {
                          key: "isLibReady",
                          value: function() {
                              return Fi[this._pcdnName]
                          }
                      }, {
                          key: "loadLib",
                          value: function(t) {
                              this.isLibReady() ? this.trigger(i.BaseEvents.LIB_READY, {
                                  type: i.BaseEvents.LIB_READY,
                                  isFirst: !1
                              }) : Ii(t, ki[this._pcdnName], this._callbacks)
                          }
                      }, {
                          key: "_onLoadLibSUc",
                          value: function() {
                              Ai(ki[this._pcdnName], this._callbacks),
                              this._hasInterface() ? (Fi[this._pcdnName] = 1,
                              this.trigger(i.BaseEvents.LIB_READY, {
                                  type: i.BaseEvents.LIB_READY,
                                  isFirst: !0
                              })) : this.trigger(i.BaseEvents.LIB_ERR, {
                                  type: i.BaseEvents.LIB_ERR,
                                  msg: "".concat(this._pcdnName, " has no constructor!")
                              })
                          }
                      }, {
                          key: "_hasInterface",
                          value: function() {
                              return this._pcdnName === Ci.ppio ? !!window.EcdnLive : this._pcdnName === Ci.xy && !!window.xyvp && !!window.xyvp.Loader
                          }
                      }, {
                          key: "_createLoader",
                          value: function() {
                              this._pcdnName === Ci.ppio ? this._loader = new window.EcdnLive({
                                  appId: "huya",
                                  debug: !1,
                                  logLevel: ""
                              }) : this._pcdnName === Ci.xy && (this._loader = new window.xyvp.Loader),
                              this._doPcdnEvents(!0)
                          }
                      }, {
                          key: "_destroyLoader",
                          value: function() {
                              this._loader && (this._doPcdnEvents(!1),
                              this._loader.stopLoad(),
                              this._loader.stopPeerGather(),
                              this._loader.destroy(),
                              this._loader = null)
                          }
                      }, {
                          key: "_doPcdnEvents",
                          value: function(t) {
                              if (this._loader)
                                  for (var e in this._binds)
                                      t ? this._loader.on(e, this._binds[e]) : this._loader.off(e, this._binds[e])
                          }
                      }, {
                          key: "_onLoadLibErr",
                          value: function() {
                              this.trigger(i.BaseEvents.LIB_ERR, {
                                  type: i.BaseEvents.LIB_ERR,
                                  msg: "".concat(this._pcdnName, " load_fail")
                              })
                          }
                      }, {
                          key: "_onLoadFail",
                          value: function() {
                              this.trigger(i.LoadEvents.LOAD_FAIL, {
                                  type: i.LoadEvents.LOAD_FAIL
                              })
                          }
                      }, {
                          key: "_onData",
                          value: function(t) {
                              0 === this._lastDataTs && (this.trigger(i.LoadEvents.LOAD_SUC, {
                                  type: i.LoadEvents.LOAD_SUC
                              }),
                              k.a.remove(this.onConnectTimeout, this));
                              var e = "xy" === this._pcdnName ? t : t.data;
                              this._lastDataTs = c.a.now(),
                              this._speed.addCur(e.byteLength),
                              this.trigger(i.LoadEvents.DATA, {
                                  type: i.LoadEvents.DATA,
                                  data: e
                              })
                          }
                      }, {
                          key: "_onGatherSuc",
                          value: function() {
                              this.trigger(i.BaseEvents.GATHER_SUC, {
                                  type: i.BaseEvents.GATHER_SUC
                              })
                          }
                      }, {
                          key: "_onGatherFail",
                          value: function() {
                              this.trigger(i.BaseEvents.GATHER_FAIL, {
                                  type: i.BaseEvents.GATHER_FAIL
                              })
                          }
                      }, {
                          key: "_onLoadStop",
                          value: function() {
                              this.trigger(i.LoadEvents.LOAD_STOP, {
                                  type: i.LoadEvents.LOAD_STOP
                              })
                          }
                      }, {
                          key: "_onLoadFinish",
                          value: function() {
                              this.trigger(i.LoadEvents.LOAD_FINISH, {
                                  type: i.LoadEvents.LOAD_FINISH
                              })
                          }
                      }, {
                          key: "_sdkDestroy",
                          value: function() {
                              this.trigger(i.LoadEvents.SDK_DESTROYED, {
                                  type: i.LoadEvents.SDK_DESTROYED
                              })
                          }
                      }, {
                          key: "getName",
                          value: function() {
                              return this._pcdnName
                          }
                      }, {
                          key: "create",
                          value: function() {
                              this._destroyLoader(),
                              this._createLoader()
                          }
                      }, {
                          key: "startPeerGather",
                          value: function(t) {
                              this._callPcdn("startPeerGather", [t])
                          }
                      }, {
                          key: "stopPeerGather",
                          value: function() {
                              this._callPcdn("stopPeerGather")
                          }
                      }, {
                          key: "refreshUrl",
                          value: function(t) {
                              this._callPcdn("refreshUrl", [t])
                          }
                      }, {
                          key: "startLoad",
                          value: function(t, e) {
                              l.a.log("PcdnLoader.startLoad url=" + t, JSON.stringify(e)),
                              this._started = !0,
                              this._lastDataTs = 0,
                              k.a.once(this.onConnectTimeout, this, 3e3),
                              this._callPcdn("startLoad", [t, e])
                          }
                      }, {
                          key: "onConnectTimeout",
                          value: function() {
                              this.trigger(i.LoadEvents.CONNECT_TIMEOUT, {
                                  type: i.LoadEvents.CONNECT_TIMEOUT
                              })
                          }
                      }, {
                          key: "stopLoad",
                          value: function(t) {
                              this._started && (this._lastDataTs = 0,
                              this._started = !1,
                              this._speed.reset(),
                              k.a.remove(this.onConnectTimeout, this),
                              this._callPcdn("stopLoad", {
                                  reason: t
                              }))
                          }
                      }, {
                          key: "destroy",
                          value: function() {
                              this.clear(),
                              this._lastDataTs = 0,
                              this._started = !1,
                              k.a.remove(this.onConnectTimeout, this),
                              this._doPcdnEvents(!1),
                              this._callPcdn("destroy")
                          }
                      }, {
                          key: "close",
                          value: function() {
                              this.clear(),
                              this._doPcdnEvents(!1),
                              this.stopLoad(),
                              this.stopPeerGather(),
                              this._callPcdn("destroy"),
                              this._loader = null
                          }
                      }, {
                          key: "_callPcdn",
                          value: function(t, e) {
                              this._loader && this._loader[t] ? (l.a.log("PcdnLoader.".concat(t, " ").concat(this._pcdnName, " ").concat(e ? JSON.stringify(e) : "")),
                              this._loader[t].apply(this._loader, e)) : l.a.log("PcdnLoader.".concat(t, " ").concat(this._pcdnName, " hasLoader=").concat(!!this._loader, " hasInterface=").concat(!!this._loader && !!this._loader[t]))
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              this._speed.calculate()
                          }
                      }, {
                          key: "onCheckFastTimer",
                          value: function(t, e) {
                              this._lastDataTs > 0 && t - this._lastDataTs > 500 && (this._lastDataTs = t,
                              this.trigger(i.LoadEvents.DATA_TIMEOUT, {
                                  type: i.LoadEvents.DATA_TIMEOUT
                              }))
                          }
                      }, {
                          key: "speed",
                          get: function() {
                              var t = this._speed.average();
                              return t === v.b.UintMax && (t = 0),
                              t
                          }
                      }, {
                          key: "connected",
                          get: function() {
                              return this._lastDataTs > 0
                          }
                      }], [{
                          key: "hasPcdn",
                          value: function(t) {
                              return !!Ci[t]
                          }
                      }]),
                      i
                  }(H);
                  Mi.BaseEvents = {
                      LIB_READY: "LIB_READY",
                      LIB_ERR: "LIB_ERR",
                      GATHER_SUC: "GATHER_SUC",
                      GATHER_FAIL: "GATHER_FAIL"
                  },
                  Mi.LoadEvents = {
                      CONNECT_TIMEOUT: "CONNECT_TIMEOUT",
                      LOAD_SUC: "LOAD_SUC",
                      DATA: "DATA",
                      DATA_TIMEOUT: "DATA_TIMEOUT",
                      LOAD_FAIL: "LOAD_FAIL",
                      LOAD_STOP: "LOAD_STOP",
                      LOAD_FINISH: "LOAD_FINISH",
                      SDK_DESTROYED: "SDK_DESTROYED"
                  };
                  var Ui = Mi
                    , Bi = function() {
                      function t(e) {
                          var i = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1];
                          Object(s.a)(this, t),
                          this._flvPlayer = e,
                          this._flvLoader = new yi(e,i),
                          this._pcdnLoader = new Ui,
                          this._sPcdnName = "",
                          this._requesting = !1,
                          this._loader = null,
                          this._swapTs = 0,
                          this._gatherSuc = !1,
                          this._failCnt = 0,
                          this.url = "",
                          this._checkSampleBind = this._checkSample.bind(this)
                      }
                      return Object(a.a)(t, [{
                          key: "close",
                          value: function() {
                              l.a.log("LoaderCtrl.close"),
                              this._flvPlayer.anticode.off(ci.Events.REFRESH, this._onAnticodeRefresh, this),
                              this._flvLoader.close(),
                              this._pcdnLoader.close(),
                              this._requesting = !1,
                              this._loader = null,
                              this._failCnt = 0,
                              this._gatherSuc = !1,
                              this._swapTs = 0,
                              this._sPcdnName = ""
                          }
                      }, {
                          key: "checkPcdnMode",
                          value: function() {
                              this._reqPcdn()
                          }
                      }, {
                          key: "connect",
                          value: function(t) {
                              this.close(),
                              this.url = t,
                              this._connect(t),
                              this._reqPcdn()
                          }
                      }, {
                          key: "_connect",
                          value: function(t, e) {
                              t = this._getUrlParams(t, !1),
                              l.a.log("LoaderCtrl._connect", t),
                              this._flvPlayer.anticode.off(ci.Events.REFRESH, this._onAnticodeRefresh, this),
                              this._stopPcdn(e),
                              this._flvLoader.connect(t),
                              this._loader = this._flvLoader,
                              this.url = this._flvLoader.url ? this._flvLoader.url : t
                          }
                      }, {
                          key: "_stopPcdn",
                          value: function(t) {
                              this._doPcdnEventHandler(Ui.LoadEvents, !1),
                              this._pcdnLoader.stopLoad(t)
                          }
                      }, {
                          key: "_reqPcdn",
                          value: function() {
                              var t = this;
                              if (1 != localStorage._closePcdn) {
                                  if (this._flvPlayer.info.isAuto && Number(o.a.closePcdn500) === this._flvPlayer.info.curBitrate)
                                      l.a.log("LoaderCtrl._reqPcdn closePcdn500");
                                  else if (localStorage._pcdnName && (this._flvPlayer.info.usePcdn = 1),
                                  1 !== this._flvPlayer.info.usePcdn && this._flvPlayer.stat.setComDim(d.a.DIM_COM.FLV_PCDN_STATE, 1),
                                  1 === this._flvPlayer.info.usePcdn && !this._requesting && "" === this._sPcdnName) {
                                      this._flvPlayer.stat.setComDim(d.a.DIM_COM.FLV_PCDN_STATE, 2),
                                      this._requesting = !0;
                                      var e = new J.ClientGetPcdnFlvOutsideSdkFullstreamInfoReq;
                                      e.lReqTs = Date.now(),
                                      e.lUid = z.a.uid,
                                      e.sGuid = z.a.sGuid,
                                      e.lAnchorUid = this._flvPlayer.info.presenterUid,
                                      e.iCdnLine = this._flvPlayer.info.lineType,
                                      e.iCliType = J.EM_CLINET_TYPE.E_CLIENT_WEB,
                                      e.lBucketPara = Number(localStorage.randomPcdnPercent) || 0,
                                      e.iBusiType = J.EM_BUSI_TYPE.E_BusiType_Live,
                                      e.vCliSupportPcdns.value = ["ppio", "xy"],
                                      e.sStreamName = this._flvPlayer.info.sStreamName,
                                      l.a.log("LoaderCtrl.reqPcdn req", e),
                                      Q.sendWup("hypcdngw", "onClientGetPcdnFlvOutsideSdkFullstreamInfo", e, (function(e) {
                                          l.a.log("HYPlayer.reqPcdn res", e),
                                          !e || 0 != e.iErrCode && 7 != e.iErrCode || t._rspPcdn(e)
                                      }
                                      ), !0, Q.getRequestId())
                                  }
                              } else
                                  l.a.log("LoaderCtrl._reqPcdn host close")
                          }
                      }, {
                          key: "_rspPcdn",
                          value: function(t) {
                              this._requesting = !1,
                              localStorage._pcdnName && (t.sPcdnName = localStorage._pcdnName),
                              this._sPcdnName !== t.sPcdnName && (this._sPcdnName = t.sPcdnName,
                              this._flvPlayer.stat.setComDim(d.a.DIM_COM.PCDN_ORIGIN, t.sPcdnName),
                              this._flvPlayer.stat.setComDim(d.a.DIM_COM.FLV_PCDN_STATE, 3),
                              this._loadPcdn())
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              this._loader && this._loader.onCheckTimer(t, e),
                              this._checkSwapToPcdn(t)
                          }
                      }, {
                          key: "_checkSwapToPcdn",
                          value: function(t) {
                              return !!(t > this._swapTs && this._gatherSuc && this._loader !== this._pcdnLoader) && (this._flvPlayer.stat.setComDim(d.a.DIM_COM.FLV_PCDN_STATE, 10),
                              this._swapToPcdn(),
                              !0)
                          }
                      }, {
                          key: "onCheckFastTimer",
                          value: function(t, e) {
                              this._loader && this._loader.onCheckFastTimer && this._loader.onCheckFastTimer(t, e)
                          }
                      }, {
                          key: "_loadPcdn",
                          value: function() {
                              Ui.hasPcdn(this._sPcdnName) ? (this._flvPlayer.stat.setComDim(d.a.DIM_COM.FLV_PCDN_STATE, 5),
                              this._doPcdnEventHandler(Ui.BaseEvents, !0),
                              this._pcdnLoader.setPcdnName(this._sPcdnName),
                              this._pcdnLoader.loadLib(this._flvPlayer.info.h5Root)) : this._flvPlayer.stat.setComDim(d.a.DIM_COM.FLV_PCDN_STATE, 4)
                          }
                      }, {
                          key: "_doPcdnEventHandler",
                          value: function(t, e) {
                              for (var i in t) {
                                  var s = t[i];
                                  e ? this._pcdnLoader.on(s, this._onPcdnEventHandler, this) : this._pcdnLoader.off(s, this._onPcdnEventHandler, this)
                              }
                          }
                      }, {
                          key: "_onPcdnEventHandler",
                          value: function(t) {
                              switch (t.type !== Ui.LoadEvents.DATA && l.a.log("LoaderCtrl._onPcdnEventHandler", t.type, t.msg),
                              t.type) {
                              case Ui.BaseEvents.LIB_READY:
                                  t.isFirst && this._reportPcdnLibAct([0], [this._pcdnLoader.getName()]),
                                  this._flvPlayer.stat.setComDim(d.a.DIM_COM.FLV_PCDN_STATE, 7),
                                  this._pcdnLoader.create(),
                                  this._pcdnLoader.startPeerGather(this._getUrl(!0));
                                  break;
                              case Ui.BaseEvents.LIB_ERR:
                                  this._flvPlayer.stat.setComDim(d.a.DIM_COM.FLV_PCDN_STATE, 6),
                                  this._reportPcdnLibAct([100], [this._pcdnLoader.getName()]);
                                  break;
                              case Ui.LoadEvents.CONNECT_TIMEOUT:
                                  this._flvPlayer.stat.setComDim(d.a.DIM_COM.FLV_PCDN_STATE, 11),
                                  this._swapToCdn(t.type);
                                  break;
                              case Ui.LoadEvents.DATA_TIMEOUT:
                                  this._flvPlayer.getBufferLen() < 1500 && (this._flvPlayer.stat.setComDim(d.a.DIM_COM.FLV_PCDN_STATE, 12),
                                  this._swapToCdn(t.type));
                                  break;
                              case Ui.LoadEvents.LOAD_SUC:
                                  this._failCnt = 0,
                                  this._flvLoader.close(),
                                  this._flvPlayer.stat.setComDim(d.a.DIM_COM.FLV_PCDN_STATE, 15),
                                  this._beforeSwap();
                                  break;
                              case Ui.LoadEvents.LOAD_FAIL:
                                  this._flvPlayer.stat.setComDim(d.a.DIM_COM.FLV_PCDN_STATE, 14),
                                  this._swapToCdn(t.type);
                                  break;
                              case Ui.BaseEvents.GATHER_SUC:
                                  this._gatherSuc = !0,
                                  l.a.log("LoaderCtrl gather_suc", this._loader !== this._pcdnLoader),
                                  this._checkSwapToPcdn(c.a.now()) || this._loader === this._pcdnLoader || this._flvPlayer.stat.setComDim(d.a.DIM_COM.FLV_PCDN_STATE, 9);
                                  break;
                              case Ui.BaseEvents.GATHER_FAIL:
                                  this._gatherSuc = !1,
                                  this._flvPlayer.stat.setComDim(d.a.DIM_COM.FLV_PCDN_STATE, 8);
                                  break;
                              case Ui.LoadEvents.DATA:
                                  this._flvPlayer.onData(t.data, 2);
                                  break;
                              case Ui.LoadEvents.LOAD_STOP:
                                  this._flvPlayer.stat.setComDim(d.a.DIM_COM.FLV_PCDN_STATE, 13),
                                  this._swapToCdn(t.type);
                                  break;
                              case Ui.LoadEvents.LOAD_FINISH:
                                  this._flvPlayer.stat.setComDim(d.a.DIM_COM.FLV_PCDN_STATE, 16),
                                  this._swapToCdn(t.type);
                                  break;
                              case Ui.LoadEvents.SDK_DESTROYED:
                                  this._flvPlayer.stat.setComDim(d.a.DIM_COM.FLV_PCDN_STATE, 17),
                                  this._swapToCdn(t.type)
                              }
                          }
                      }, {
                          key: "_reportPcdnLibAct",
                          value: function(t, e) {
                              this._flvPlayer.tsdb.sendMetrics([this._flvPlayer.stat.createAct(d.a.ACT.LOAD_PCDNLIB_ERROR, {
                                  value: t,
                                  str: e
                              })])
                          }
                      }, {
                          key: "_onAnticodeRefresh",
                          value: function() {
                              this._flvPlayer.initInfo(this._flvPlayer.info, !0),
                              this._pcdnLoader.refreshUrl(this._flvPlayer.info.url)
                          }
                      }, {
                          key: "_checkSample",
                          value: function(t) {
                              var e = this._flvPlayer.mse.parser;
                              return e.lastParseDts > 0 && t.ts <= e.lastParseDts || (e.setDroppingSample(null),
                              !1)
                          }
                      }, {
                          key: "_swapToPcdn",
                          value: function() {
                              this._flvPlayer.anticode.on(ci.Events.REFRESH, this._onAnticodeRefresh, this),
                              this._doPcdnEventHandler(Ui.LoadEvents, !0);
                              var t = this._flvPlayer.mse
                                , e = t.parser || {};
                              l.a.log("LoaderCtrl.swapToPcdn vDts=".concat(t.curVideoDts, " aDts=").concat(t.curAudioDts, " lastParseDts=").concat(e.lastParseDts)),
                              this._pcdnLoader.startLoad(this._getUrl(!0), {
                                  startDts: e.lastParseDts
                              }),
                              this._loader = this._pcdnLoader,
                              this._flvPlayer.stat.addCore(d.a.CORE.GET_STREAM_CNT, 1)
                          }
                      }, {
                          key: "_swapToCdn",
                          value: function(t) {
                              var e = this._loader !== this._flvLoader;
                              l.a.log("LoaderCtrl.swapToCdn reason=".concat(t, " swap=").concat(e)),
                              e && (this._flvPlayer.tsdb.sendMetrics([this._flvPlayer.stat.createAct(d.a.ACT.PCDN_TO_CDN, {
                                  str: [t]
                              })]),
                              this._failCnt++,
                              this._swapTs = c.a.now() + 1e4 * Math.min(6, this._failCnt),
                              this._flvPlayer.stat.addCore(d.a.CORE.SWITCH_CDN_CNT, 1),
                              this._beforeSwap(),
                              this._connect(this._getUrl(!1), t))
                          }
                      }, {
                          key: "_getUrl",
                          value: function(t) {
                              return this._flvPlayer.initInfo(this._flvPlayer.info, t),
                              this._getUrlParams(this._flvPlayer.info.url, t)
                          }
                      }, {
                          key: "_getUrlParams",
                          value: function(t, e) {
                              var i = "";
                              e && (i += "pulltype=pcdn&"),
                              i += "&wsiphost=ipdbme&";
                              var s = o.a.platform
                                , a = C.a.PLATFORM_TYPE[s] || C.a.PLATFORM_TYPE.web
                                , r = s === C.a.PLATFORM_TYPE_NAME.wap ? "uid=".concat(z.a.uid, "&uuid=").concat(z.a.uuid) : "u=".concat(z.a.convertUid);
                              i += "".concat(r, "&t=").concat(a, "&sv=").concat(2202140215),
                              -1 === t.indexOf("?") ? t += "?" : t += "&";
                              var n = {
                                  url: t += i
                              };
                              return e && this._flvPlayer.isUseAV1() ? n.url += "&codec=av1" : e && this._flvPlayer.h265Proxy.checkUrl(n),
                              n.url
                          }
                      }, {
                          key: "_beforeSwap",
                          value: function() {
                              var t = this._flvPlayer.mse.parser;
                              t.parseFlvHead = !1,
                              t.flvCacher.reset(),
                              t.printFirstVideoTs = !1,
                              t.printFirstAudioTs = !1,
                              t.pfvTs = !1,
                              t.pfaTs = !1,
                              t.setDroppingSample(this._checkSampleBind)
                          }
                      }, {
                          key: "connected",
                          get: function() {
                              return this._loader && this._loader.connected
                          }
                      }, {
                          key: "speed",
                          get: function() {
                              return this._loader && this._loader.speed
                          }
                      }]),
                      t
                  }()
                    , Vi = 0
                    , xi = 1
                    , Hi = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.samples = new y(e),
                          this.maxSize = e,
                          this.lastTs = 0,
                          this.isOver = !1,
                          this.callback = null
                      }
                      return Object(a.a)(t, [{
                          key: "getResult",
                          value: function() {
                              for (var t = this.samples.getSamples(), e = t.length, i = [], s = 0; s < e; s++)
                                  i.push("".concat(s + 1, ":").concat(t[s]));
                              return i.join(",")
                          }
                      }, {
                          key: "start",
                          value: function(t) {
                              this.isOver = !1,
                              this.callback = t,
                              k.a.add(this.onCheckTime, this, 20)
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              this.callback = null,
                              this.samples.reset(),
                              this.lastTs = 0,
                              k.a.remove(this.onCheckTime, this)
                          }
                      }, {
                          key: "setOver",
                          value: function() {
                              if (!this.isOver) {
                                  this.isOver = !0;
                                  var t = this.getResult();
                                  l.a.log("FastSample.over result=".concat(t)),
                                  this.callback && this.callback(t),
                                  this.stop()
                              }
                          }
                      }, {
                          key: "add",
                          value: function(t) {
                              if (!this.isOver) {
                                  this.samples.addCur(t);
                                  var e = c.a.now();
                                  0 === this.lastTs ? this.lastTs = e : this._checkSample(e)
                              }
                          }
                      }, {
                          key: "onCheckTime",
                          value: function(t) {
                              this._checkSample(t)
                          }
                      }, {
                          key: "_checkSample",
                          value: function(t) {
                              this.lastTs > 0 && t - this.lastTs > 500 && (this.lastTs = t,
                              this.samples.calculate(),
                              this.samples.getSamples().length === this.maxSize && this.setOver())
                          }
                      }]),
                      t
                  }()
                    , Gi = function t(e) {
                      Object(s.a)(this, t),
                      this.iHEVCBitRate = e.iHEVCBitRate,
                      this.iCodecType = e.iCodecType,
                      this.iBitRate = e.iBitRate,
                      this.bitrate = e.bitrate
                  }
                    , ji = 0
                    , Wi = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this._id = ji++,
                          this._callbacks = e,
                          this._timeout = !1,
                          this._destroy = !1,
                          this._timeoutTime = 1e3,
                          this._onRspBind = this._onRsp.bind(this)
                      }
                      return Object(a.a)(t, [{
                          key: "destroy",
                          value: function() {
                              this._destroy = !0,
                              this._callbacks = null,
                              k.a.remove(this._onTimeout, this)
                          }
                      }, {
                          key: "sendP2PFlv",
                          value: function(t) {
                              var e = t.info
                                , i = this._getReq(t);
                              i.mAppendInfo.value = {
                                  streamType: t.type,
                                  expVideoFps: t.metadata && t.metadata.fps || 0,
                                  expAudioFps: t.metadata && t.metadata.audioFps || 0,
                                  codeRate: e.curBitrate,
                                  isOriginal: Number(0 === e.originalBitrate),
                                  line: t.lineType,
                                  codeType: t.isH265 ? "265" : "264",
                                  sStreamName: e.sStreamName,
                                  playType: t.playType,
                                  isServer: 0,
                                  iIsP2PSupport: e.iIsP2PSupport
                              },
                              this._sendReq(i)
                          }
                      }, {
                          key: "sendAuto",
                          value: function(t) {
                              var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 1e3;
                              this._timeoutTime = e;
                              var i = this._getReq(t);
                              i.mAppendInfo.value = t.appendInfo,
                              this._sendReq(i)
                          }
                      }, {
                          key: "_getReq",
                          value: function(t) {
                              var e = new J.RecSysReq;
                              return e.tId.iAppid = z.a.appid,
                              e.tId.lUid = z.a.uid,
                              e.tId.sGuid = z.a.sGuid,
                              e.tId.sUA = "webh5",
                              e.sAnchorUid = t.presenterUid,
                              e.sRoomId = t.roomId,
                              e.iScene = t.scene,
                              e.bDebug = 1,
                              e
                          }
                      }, {
                          key: "_sendReq",
                          value: function(t) {
                              var e = Object.assign({}, t);
                              l.a.log("RecSysProxy(".concat(this._id, ").sendReq"), t, JSON.stringify(e)),
                              Q.sendWup("mediaui", "getMediaRec", t, this._onRspBind, !0, Q.getRequestId(), !0),
                              k.a.once(this._onTimeout, this, this._timeoutTime)
                          }
                      }, {
                          key: "_onRsp",
                          value: function(t) {
                              if (1 != localStorage._testTimeout) {
                                  k.a.remove(this._onTimeout, this);
                                  var e = Object.assign({}, t);
                                  l.a.log("RecSysProxy(".concat(this._id, ").onRsp"), t, JSON.stringify(e)),
                                  this._destroy || this._callbacks && this._callbacks.onRsp(t)
                              } else
                                  l.a.log("RecSysProxy._onRsp _testTimeout=".concat(localStorage._testTimeout))
                          }
                      }, {
                          key: "_onTimeout",
                          value: function() {
                              this._callbacks && this._callbacks.onTimeout && this._callbacks.onTimeout()
                          }
                      }]),
                      t
                  }()
                    , Yi = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.ctrlBitrate = e,
                          this.timeLineTs = 0,
                          this.sampleTs = 0,
                          this.sampleCheckTs = 0,
                          this.sampleDts = 0,
                          this.sampleCheckDts = 0,
                          this.printTs = 0,
                          this.printSampleTs = 0,
                          this.printSampleDts = 0,
                          this.startTs = 0,
                          this.startDts = 0,
                          this.cnt12 = 0
                      }
                      return Object(a.a)(t, [{
                          key: "start",
                          value: function(t, e) {
                              l.a.log("EvalBw.start now=".concat(t, " dts=").concat(e)),
                              this.startTs = this.timeLineTs = this.sampleTs = this.sampleCheckTs = this.printTs = this.printSampleTs = t,
                              this.startDts = this.printSampleDts = this.sampleCheckDts = this.sampleDts = e,
                              this.cnt12 = 0
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              this.reset()
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              l.a.log("EvalBw.reset"),
                              this.startTs = this.timeLineTs = this.sampleTs = this.sampleCheckTs = this.printTs = this.printSampleTs = 0,
                              this.startDts = this.printSampleDts = this.sampleCheckDts = this.sampleDts = 0,
                              this.cnt12 = 0
                          }
                      }, {
                          key: "onCheckFastTimer",
                          value: function(t, e) {
                              if (this.startTs > 0) {
                                  var i = t - this.timeLineTs;
                                  if (i > 300) {
                                      var s = this.sampleTs - this.sampleCheckTs
                                        , a = this.sampleDts - this.sampleCheckDts
                                        , r = a > 0 ? s / a : 2;
                                      l.a.log("EvalBw.onCheckFastTimer eval timeline=".concat(i, " costtime=").concat(s, " duration=").concat(a, " costtime/duration=").concat(r, " dts=").concat(this.sampleDts)),
                                      r > 1.4 && !this._downBwCheck() ? this._evalFail() : r > 1.2 && !this._downBwCheck() ? (this.cnt12++,
                                      this.cnt12 >= 2 && this._evalFail()) : this.cnt12 = 0,
                                      this.timeLineTs = t,
                                      this.sampleCheckTs = t,
                                      this.sampleCheckDts = this.sampleDts
                                  }
                              }
                              if (Number(localStorage._printEval) > 0 && t - this.printTs > Number(localStorage._printEval) && this.sampleDts > 0) {
                                  var n = t - this.printTs
                                    , o = this.sampleTs - this.printSampleTs
                                    , h = this.sampleDts - this.printSampleDts;
                                  l.a.log("EvalBw.onCheckFastTimer print timeline=".concat(n, " duration=").concat(h, " costtime=").concat(o, " costtime/duration=").concat(o / h, " dts=").concat(this.sampleDts)),
                                  this.printTs = t,
                                  this.printSampleTs = this.sampleTs,
                                  this.printSampleDts = this.sampleDts
                              }
                          }
                      }, {
                          key: "_evalFail",
                          value: function() {
                              this.stop(),
                              this.ctrlBitrate.evalFail()
                          }
                      }, {
                          key: "_downBwCheck",
                          value: function() {
                              var t = this.sampleTs - this.startTs
                                , e = this.sampleDts - this.startDts;
                              return l.a.log("EvalBw._downBwCheck costtime=".concat(t, " duration=").concat(e, " costtime/duration=").concat(t / e, " dts=").concat(this.sampleDts)),
                              e > 0 && t / e < 1.2
                          }
                      }, {
                          key: "addSample",
                          value: function(t) {
                              var e = c.a.now();
                              if (0 === this.printSampleDts && (this.printSampleDts = t.ts,
                              this.printTs = this.printSampleTs = e),
                              this.sampleTs = e,
                              this.sampleDts = t.ts,
                              this.startTs > 0 && t.key) {
                                  var i = this._downBwCheck();
                                  this.stop(),
                                  i ? this.ctrlBitrate.evalSuc() : this.ctrlBitrate.evalFail()
                              }
                          }
                      }]),
                      t
                  }()
                    , qi = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.statSwitch = e,
                          this.type = 0,
                          this.startTs = 0,
                          this.nextIFrameTs = 0,
                          this.connectedTs = 0,
                          this.firstVideoPkgTs = 0,
                          this.ptsIFrameTs = 0,
                          this.endTs = 0
                      }
                      return Object(a.a)(t, [{
                          key: "start",
                          value: function(t, e) {
                              this.statSwitch.sendSwitchAuto([t, e || 0]),
                              this.type = t,
                              this.reset(),
                              this.startTs = c.a.now()
                          }
                      }, {
                          key: "nextIFrame",
                          value: function() {
                              this.startTs > 0 && (this.nextIFrameTs = c.a.now())
                          }
                      }, {
                          key: "connected",
                          value: function() {
                              this.startTs > 0 && (this.connectedTs = c.a.now())
                          }
                      }, {
                          key: "firstVideo",
                          value: function() {
                              this.startTs > 0 && (this.firstVideoPkgTs = c.a.now())
                          }
                      }, {
                          key: "ptsIFrame",
                          value: function() {
                              this.startTs > 0 && (this.ptsIFrameTs = c.a.now())
                          }
                      }, {
                          key: "end",
                          value: function(t) {
                              if (this.startTs > 0) {
                                  this.endTs = c.a.now();
                                  var e = [this.endTs - this.startTs, this.nextIFrameTs > 0 ? this.nextIFrameTs - this.startTs : -1, this.connectedTs > 0 && this.nextIFrameTs > 0 ? this.connectedTs - this.nextIFrameTs : -1, this.firstVideoPkgTs > 0 && this.connectedTs > 0 ? this.firstVideoPkgTs - this.connectedTs : -1, this.ptsIFrameTs > 0 && this.firstVideoPkgTs > 0 ? this.ptsIFrameTs - this.firstVideoPkgTs : -1, this.ptsIFrameTs > 0 ? this.endTs - this.ptsIFrameTs : -1];
                                  l.a.log("AutoSeg.end", e.toString()),
                                  this.statSwitch.sendSwitchCost(e, [this.type, t])
                              }
                              this.reset()
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              this.startTs = 0,
                              this.nextIFrameTs = 0,
                              this.connectedTs = 0,
                              this.firstVideoPkgTs = 0,
                              this.ptsIFrameTs = 0,
                              this.endTs = 0
                          }
                      }]),
                      t
                  }()
                    , Ki = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this._size = 0,
                          this._cnt = 0,
                          this._index = 0,
                          this._map = new Map,
                          this._bufCnt = Number(o.a.autoCfg.bufCnt),
                          this._sucPer = Number(o.a.autoCfg.sucPer),
                          this._sucCnt = 0,
                          this._contiCnt = 0
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              this._cnt = 0,
                              this._index = 0,
                              this._map.clear(),
                              this._sucCnt = 0,
                              this._contiCnt = 0
                          }
                      }, {
                          key: "setSwitchTime",
                          value: function(t) {
                              this.reset(),
                              this._size = t / Number(o.a.autoCfg.sampleTime)
                          }
                      }, {
                          key: "addSample",
                          value: function(t) {
                              if (this._cnt++,
                              t ? (this._contiCnt++,
                              this._sucCnt++,
                              this._map.set(this._index, 1)) : (this._contiCnt = 0,
                              this._map.set(this._index, 0)),
                              this._cnt > this._size) {
                                  this._cnt--;
                                  var e = this._index - this._size
                                    , i = this._map.get(e);
                                  this._map.delete(e),
                                  1 === i && this._sucCnt--
                              }
                              return this._index++,
                              this.isFullSize() && this.isLastReach() && this.isPercentReach()
                          }
                      }, {
                          key: "isFullSize",
                          value: function() {
                              return this._cnt >= this._size
                          }
                      }, {
                          key: "isLastReach",
                          value: function() {
                              return this._contiCnt >= this._bufCnt
                          }
                      }, {
                          key: "isPercentReach",
                          value: function() {
                              return this._sucCnt / this._cnt >= this._sucPer
                          }
                      }]),
                      t
                  }()
                    , zi = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this._minTime = Number(o.a.autoCfg.minTime),
                          this._maxTime = Number(o.a.autoCfg.maxTime),
                          this._map = new Map
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              l.a.log("AutoUpGap.reset"),
                              this._map.clear()
                          }
                      }, {
                          key: "getMin",
                          value: function() {
                              return this._minTime
                          }
                      }, {
                          key: "getGap",
                          value: function(t) {
                              return this._map.has(t) || this._map.set(t, this._minTime),
                              this._map.get(t)
                          }
                      }, {
                          key: "addFail",
                          value: function(t, e) {
                              l.a.log("AutoUpGap.addFail bitrate=".concat(t, " isMin=").concat(e));
                              var i = this.getGap(t);
                              if (!e) {
                                  var s = Math.min(2 * i, this._maxTime);
                                  this._map.set(t, s)
                              }
                          }
                      }]),
                      t
                  }()
                    , Ji = new Set
                    , Qi = new Map
                    , Xi = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this._highRate = Number(o.a.autoCfg.highRate),
                          this._badBuf = Number(o.a.autoCfg.badBuf),
                          this._badCnt = Number(o.a.autoCfg.badCnt),
                          this._sList = [],
                          this._sTime = o.a.autoCfg.badS[0],
                          this._sCnt = o.a.autoCfg.badS[1],
                          this._lList = [],
                          this._lTime = o.a.autoCfg.badL[0],
                          this._lCnt = o.a.autoCfg.badL[1]
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              this._sList = [],
                              this._lList = []
                          }
                      }, {
                          key: "getBitrates",
                          value: function() {
                              return Array.from(Ji).join(",")
                          }
                      }, {
                          key: "hasBitrate",
                          value: function(t) {
                              return Ji.has(t)
                          }
                      }, {
                          key: "addBadQuality",
                          value: function(t, e, i, s) {
                              return this._addBadQuality(t, e, i, s, this._sList, this._sTime, this._sCnt) || this._addBadQuality(t, e, i, s, this._lList, this._lTime, this._lCnt)
                          }
                      }, {
                          key: "_addBadQuality",
                          value: function(t, e, i, s, a, r, n) {
                              if (a.push({
                                  now: e,
                                  pauseTime: i,
                                  bufferLen: s
                              }),
                              a.length > n && a.shift(),
                              a.length >= n) {
                                  var o = e - a[0].now;
                                  if (o <= r)
                                      return l.a.log("AutoBadQuality._addBadQuality disTime=".concat(o, " time=").concat(r, " cnt=").concat(n)),
                                      this._checkPerformance(t, a),
                                      !0
                              }
                              return !1
                          }
                      }, {
                          key: "_checkPerformance",
                          value: function(t, e) {
                              var i = this;
                              if (t > this._highRate)
                                  if (e.some((function(t) {
                                      return t.bufferLen < i._badBuf
                                  }
                                  ))) {
                                      Qi.has(t) || Qi.set(t, 0);
                                      var s = Qi.get(t) + 1;
                                      Qi.set(t, s),
                                      s >= this._badCnt && Ji.add(t)
                                  } else
                                      Ji.add(t)
                          }
                      }]),
                      t
                  }()
                    , Zi = {
                      UP_PTS: Math.pow(2, 0),
                      UP_WAIT_IFRAME: Math.pow(2, 1),
                      UP_CONNECT_FAIL: Math.pow(2, 2),
                      UP_CONNECT_SLOW: Math.pow(2, 3),
                      UP_FIRST_FRAME: Math.pow(2, 4),
                      UP_PTS_FRAME: Math.pow(2, 5),
                      BACK_CONNECT_FAIL: Math.pow(2, 6),
                      BACK_PTS: Math.pow(2, 7),
                      EVAL_BEFORE: Math.pow(2, 8),
                      EVAL_AFTER: Math.pow(2, 9),
                      BACK_CONNECT_SLOW: Math.pow(2, 10),
                      BACK_FIRST_FRAME: Math.pow(2, 11),
                      BACK_PTS_FRAME: Math.pow(2, 12),
                      DOWN_NO_IFRAME: Math.pow(2, 13),
                      DOWN_CONNECT_FAIL: Math.pow(2, 14),
                      DOWN_PTS: Math.pow(2, 15),
                      DOWN_CONNECT_SLOW: Math.pow(2, 16),
                      DOWN_FIRST_FRAME: Math.pow(2, 17),
                      DOWN_PTS_FRAME: Math.pow(2, 18),
                      UP_NO_IFRAME: Math.pow(2, 19)
                  }
                    , $i = function() {
                      function t(e, i) {
                          Object(s.a)(this, t),
                          this._ctrlBitrate = e,
                          this._autoMonitor = i,
                          this._buffer = null,
                          this._startTs = 0,
                          this._connectedTs = 0,
                          this._firstFrameTs = 0
                      }
                      return Object(a.a)(t, [{
                          key: "setStart",
                          value: function(t) {
                              this._startTs = c.a.now(),
                              this._connectedTs = 0,
                              this._firstFrameTs = 0,
                              t < o.a.autoBufferScore && this._ctrlBitrate.isSwitchUp() && this._autoMonitor.addBadReason(Zi.UP_WAIT_IFRAME)
                          }
                      }, {
                          key: "setConnected",
                          value: function() {
                              this._connectedTs = c.a.now(),
                              this._connectedTs - this._startTs > o.a.autoConnectScore && (this._ctrlBitrate.isSwitchUp() ? this._autoMonitor.addBadReason(Zi.UP_CONNECT_SLOW) : this._ctrlBitrate.isSwitchDown() ? this._autoMonitor.addBadReason(Zi.DOWN_CONNECT_SLOW) : this._ctrlBitrate.isSwitchBack() && this._autoMonitor.addBadReason(Zi.BACK_CONNECT_SLOW))
                          }
                      }, {
                          key: "setFirstFrame",
                          value: function() {
                              this._firstFrameTs = c.a.now(),
                              this._checkFirstFrame()
                          }
                      }, {
                          key: "setFirstVideoTimeout",
                          value: function() {
                              this._connectedTs > 0 ? this._checkFirstFrame() : this._ctrlBitrate.isSwitchUp() ? this._autoMonitor.addBadReason(Zi.UP_CONNECT_FAIL) : this._ctrlBitrate.isSwitchDown() ? this._autoMonitor.addBadReason(Zi.DOWN_CONNECT_FAIL) : this._ctrlBitrate.isSwitchBack() && this._autoMonitor.addBadReason(Zi.BACK_CONNECT_FAIL)
                          }
                      }, {
                          key: "_checkFirstFrame",
                          value: function() {
                              c.a.now() - this._connectedTs > o.a.autoFirstScore && (this._ctrlBitrate.isSwitchUp() ? this._autoMonitor.addBadReason(Zi.UP_FIRST_FRAME) : this._ctrlBitrate.isSwitchDown() ? this._autoMonitor.addBadReason(Zi.DOWN_FIRST_FRAME) : this._ctrlBitrate.isSwitchBack() && this._autoMonitor.addBadReason(Zi.BACK_FIRST_FRAME))
                          }
                      }, {
                          key: "setPtsFrame",
                          value: function(t) {
                              this._checkPtsFrame(),
                              t > 0 && (this._ctrlBitrate.isSwitchUp() ? this._autoMonitor.addBadReason(Zi.UP_PTS) : this._ctrlBitrate.isSwitchDown() ? this._autoMonitor.addBadReason(Zi.DOWN_PTS) : this._ctrlBitrate.isSwitchBack() && this._autoMonitor.addBadReason(Zi.BACK_PTS))
                          }
                      }, {
                          key: "setPtsFrameTimeout",
                          value: function() {
                              this._checkPtsFrame()
                          }
                      }, {
                          key: "_checkPtsFrame",
                          value: function() {
                              c.a.now() - this._firstFrameTs > o.a.autoPtsScore && (this._ctrlBitrate.isSwitchUp() ? this._autoMonitor.addBadReason(Zi.UP_PTS_FRAME) : this._ctrlBitrate.isSwitchDown() ? this._autoMonitor.addBadReason(Zi.DOWN_PTS_FRAME) : this._ctrlBitrate.isSwitchBack() && this._autoMonitor.addBadReason(Zi.BACK_PTS_FRAME))
                          }
                      }, {
                          key: "setEvalBefore",
                          value: function(t) {
                              t < o.a.autoBufferScore && this._autoMonitor.addBadReason(Zi.EVAL_BEFORE)
                          }
                      }, {
                          key: "setEvalAfter",
                          value: function(t) {
                              t < o.a.autoBufferScore && this._autoMonitor.addBadReason(Zi.EVAL_AFTER)
                          }
                      }, {
                          key: "setNoIFrame",
                          value: function() {
                              this._buffer && this._buffer.isWaitForIFrame() && (this._ctrlBitrate.isSwitchUp() ? this._autoMonitor.addBadReason(Zi.UP_NO_IFRAME) : this._ctrlBitrate.isSwitchDown() && this._autoMonitor.addBadReason(Zi.DOWN_NO_IFRAME))
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              this._startTs = 0,
                              this._connectedTs = 0,
                              this._firstFrameTs = 0
                          }
                      }, {
                          key: "buffer",
                          set: function(t) {
                              this._buffer = t
                          }
                      }]),
                      t
                  }()
                    , ts = {
                      NONE: 0,
                      H264ToH264: 1,
                      H264ToH265: 2,
                      H265ToH264: 3,
                      H265ToH265: 4
                  }
                    , es = 0
                    , is = function() {
                      function t(e, i) {
                          var a = e.player
                            , r = e.statSwitch
                            , n = e.autoMonitor
                            , h = e.recSysStat;
                          Object(s.a)(this, t),
                          this._player = a,
                          this._statSwitch = r,
                          this._autoMonitor = n,
                          this._recSysStat = h,
                          this._callbacks = i,
                          this._seg = new qi(r),
                          this._badStat = new $i(this,n),
                          this._buffer = null,
                          this._curBitrate = 0,
                          this._lastBitrate = 0,
                          this._startBitrate = 0,
                          this._sessionId = 0,
                          this._maxBitrate = 0,
                          this._originalMaxBitrate = 0,
                          this._minBitrate = 0,
                          this._bitrateList = [],
                          this._allBitratebps = "",
                          this._switchSampleTime = Number(o.a.autoCfg.sampleTime),
                          this._switchUpGap = Number(o.a.autoCfg.upGap),
                          this._switchDownGap = Number(o.a.autoCfg.downGap),
                          this._switchBackGap = Number(o.a.autoCfg.backGap),
                          this._nextReqInterval = Number(o.a.recSysExpiredTime),
                          this._firstRecSysTime = Number(o.a.autoCfg.sysTime),
                          this._switchUpPer = Number(o.a.autoCfg.upPer),
                          this._switchDownPer = Number(o.a.autoCfg.downPer),
                          this._switchDownNowPer = Number(o.a.autoCfg.downNowPer),
                          this._switchWaitPer = Number(o.a.autoCfg.waitPer),
                          this._switchDownBitrate = Number(o.a.autoCfg.downBitrate),
                          this._beforeSwitchCb = null,
                          this._mse = null,
                          this._evalBw = new Yi(this),
                          this._switchNextTime = 0,
                          this._switchSampleTs = 0,
                          this._upGap = new zi,
                          this._switchUpSample = new Ki,
                          this._badRate = new Xi,
                          this._switchUpReason = Ht.NONE,
                          this._switchDownReason = Gt.NONE,
                          this._switchType = ts.NONE,
                          this._switchOver = !1,
                          this._evalOver = !1,
                          this._started = !1,
                          this._nextRecSysTs = 0,
                          this._switchState = es,
                          this._recSysProxy = null,
                          this._badQualityCoderatebps = [],
                          this._recSysExpiredTime = 0,
                          this._visibilityState = C.a.VISIBILITY_STATE.VISIBLE,
                          this._onRecSysBind = this._onRecSys.bind(this),
                          this._onRecSysDownTimeoutBind = this._onRecSysDownTimeout.bind(this),
                          this._onRecSysIntervalTimeoutBind = this._onRecSysIntervalTimeout.bind(this),
                          this._onVisibilityChangeBind = this._onVisibilityChange.bind(this),
                          this._switchUpSample.setSwitchTime(this._upGap.getMin()),
                          this.closeAuto = 2 === Number(localStorage.openAuto),
                          this.switchStartTime = 0
                      }
                      return Object(a.a)(t, [{
                          key: "isSwitchUp",
                          value: function() {
                              return 1 === this._switchState
                          }
                      }, {
                          key: "isSwitchDown",
                          value: function() {
                              return 3 === this._switchState
                          }
                      }, {
                          key: "isSwitchBack",
                          value: function() {
                              return 4 === this._switchState
                          }
                      }, {
                          key: "start",
                          value: function(t, e) {
                              var i = this;
                              if (!this._started)
                                  if (t && t.parser && t.parser.ctrlBuffer) {
                                      l.a.log("CtrlBitrate.start", JSON.stringify(e)),
                                      this._mse = t;
                                      var s = t.parser.ctrlBuffer;
                                      s.setEval(this._evalBw),
                                      s.callbacks = this._callbacks,
                                      this._buffer = s,
                                      this._badStat.buffer = s,
                                      this._sessionId = e.sessionId,
                                      this._curBitrate = e.curBitrate,
                                      this._maxBitrate = e.startBitrate,
                                      3 === Number(o.a.isWebAutoAB) && (this._maxBitrate = o.a.maxBitRate),
                                      this._originalMaxBitrate = this._maxBitrate,
                                      this._startBitrate = e.startBitrate,
                                      this._bitrateList = [],
                                      this._minBitrate = Number.MAX_SAFE_INTEGER;
                                      var a = [];
                                      e.bitrateList.forEach((function(t) {
                                          i._bitrateList.push(new Gi(t)),
                                          a.push(1e3 * t.bitrate),
                                          i._minBitrate = Math.min(i._minBitrate, t.bitrate)
                                      }
                                      )),
                                      this._allBitratebps = a.join(","),
                                      this._bitrateList.sort((function(t, e) {
                                          return t.bitrate > e.bitrate ? -1 : 1
                                      }
                                      )),
                                      this._start()
                                  } else
                                      l.a.warn("CtrlBitrate.start waring mse")
                          }
                      }, {
                          key: "_start",
                          value: function() {
                              l.a.log("CtrlBitrate._start started=".concat(this._started, " bitrates=").concat(this._bitrateList.length, " mse=").concat(!!this._mse)),
                              this._mse && this._bitrateList.length > 0 && !this._started && (this._started = !0,
                              this._player.eventEmitter.on(r.c.VISIBILITY_CHANGE, this._onVisibilityChangeBind),
                              this._switchNextTime = c.a.now() + 5e3,
                              k.a.add(this._onCheckFastTimer, this, 100),
                              k.a.once(this._firstReqAuto, this, 1e3 + 10 * Math.floor(Math.random() * this._firstRecSysTime / 10)),
                              this._onVisibilityChange())
                          }
                      }, {
                          key: "_onVisibilityChange",
                          value: function() {
                              l.a.log("CtrlBitrate._onVisibilityChange old=".concat(this._visibilityState, " new=").concat(document.visibilityState)),
                              this._visibilityState !== C.a.VISIBILITY_STATE.VISIBLE && document.visibilityState === C.a.VISIBILITY_STATE.VISIBLE && (this._switchSampleTs = 0,
                              this._switchUpSample.reset()),
                              this._visibilityState = document.visibilityState
                          }
                      }, {
                          key: "_firstReqAuto",
                          value: function() {
                              l.a.log("CtrlBitrate._firstReqAuto"),
                              this._reqAutoRecSys(1, this._onRecSysIntervalTimeoutBind)
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              l.a.log("CtrlBitrate.stop"),
                              this._mse = null,
                              this._buffer = null,
                              this._started = !1,
                              this._switchState = es,
                              this._switchType = ts.NONE,
                              this._switchUpReason = Ht.NONE,
                              this._switchDownReason = Gt.NONE,
                              this._badQualityCoderatebps = [],
                              this._recSysExpiredTime = 0,
                              this._switchNextTime = 0,
                              this._switchTarget = null,
                              this._curBitrate = 0,
                              this._lastBitrate = 0,
                              this._nextRecSysTs = 0,
                              this._bitrateList = [],
                              this._evalBw.stop(),
                              this._switchUpSample.reset(),
                              this._upGap.reset(),
                              this._badRate.reset(),
                              this._destroyRecSys(),
                              this._player.eventEmitter.off(r.c.VISIBILITY_CHANGE, this._onVisibilityChangeBind),
                              k.a.remove(this._onCheckFastTimer, this),
                              k.a.remove(this._firstReqAuto, this),
                              this.switchStartTime = 0
                          }
                      }, {
                          key: "pause",
                          value: function() {
                              this._buffer.pause()
                          }
                      }, {
                          key: "_sendSwitchStat",
                          value: function(t) {
                              var e = this._buffer.switchTs.getMetric()
                                , i = e.values
                                , s = e.strs;
                              this._buffer.switchTs.resetPtsSample(),
                              i[3] = this._seg.type,
                              s[2] = t,
                              this._statSwitch.sendSwitchPts(i, s),
                              this._seg.end(t)
                          }
                      }, {
                          key: "switchBitrate",
                          value: function(t) {
                              this._curBitrate !== t && (0 !== this._curBitrate && l.a.log("CtrlBitrate.switchBitrate from=".concat(this._curBitrate, " to=").concat(t, " buffer=").concat(this._mse.getBufferLen())),
                              this._switchOver = !1,
                              this._lastBitrate = this._curBitrate,
                              this._curBitrate = t,
                              this._buffer.switchBitrate(3 === this._switchState, this._lastBitrate, this._curBitrate))
                          }
                      }, {
                          key: "switchBack",
                          value: function(t) {
                              if (this.switchStartTime = 0,
                              this._switchState !== es && this._lastBitrate < this._curBitrate) {
                                  this._upGap.addFail(this._lastBitrate, this._curBitrate === this._minBitrate),
                                  this._evalBw.stop(),
                                  this._sendSwitchStat(t === xt ? 1 : 2),
                                  this._seg.start(Ut, t),
                                  this._switchState = 4,
                                  l.a.log("CtrlBitrate.switchBack from=".concat(this._curBitrate, " lastBitrate=").concat(this._lastBitrate, " reason=").concat(t, " buffer=").concat(this._mse.getBufferLen()));
                                  for (var e = this._bitrateList.length, i = 0; i < e; i++) {
                                      var s = this._bitrateList[i];
                                      if (s.bitrate === this._lastBitrate) {
                                          var a = this._getDownInfo(i + 1, e);
                                          a && a.bitrate >= this._switchDownBitrate && (s = a),
                                          l.a.log("CtrlBitrate.switchBack to=".concat(s.bitrate)),
                                          this._beforeSwitchCb && this._beforeSwitchCb(s),
                                          this._buffer.switchBack();
                                          break
                                      }
                                  }
                              }
                          }
                      }, {
                          key: "startEval",
                          value: function(t) {
                              if (1 === this._switchState) {
                                  var e = this._mse.getBufferLen();
                                  l.a.log("CtrlBitrate.switchDone start eval buffer=".concat(e)),
                                  this._badStat.setEvalBefore(e),
                                  this._switchState = 6,
                                  this._switchUpReason = Ht.EVAL_BW,
                                  this._evalOver = !1,
                                  this._evalBw.start(c.a.now(), t)
                              }
                          }
                      }, {
                          key: "evalSuc",
                          value: function() {
                              var t = this._mse.getBufferLen();
                              l.a.log("CtrlBirate.evalSuc buffer=".concat(t)),
                              this._badStat.setEvalAfter(t);
                              var e = c.a.now();
                              this._switchNextTime > e ? this._switchNextTime += this._switchUpGap : this._switchNextTime = e + this._switchUpGap,
                              this._evalOver = !0,
                              this._resetProperties(),
                              this._sendSwitchStat(1),
                              this._setPlaybackrate(!1),
                              this._switchUpSample.setSwitchTime(this._upGap.getGap(this._curBitrate))
                          }
                      }, {
                          key: "evalFail",
                          value: function() {
                              var t = this._mse.getBufferLen();
                              l.a.log("CtrlBirate.evalFail buffer=".concat(t)),
                              this._badStat.setEvalAfter(t),
                              this._switchUpReason = Ht.EVAL_FAIL,
                              this._evalOver = !0,
                              this.switchBack(xt)
                          }
                      }, {
                          key: "_resetProperties",
                          value: function() {
                              this._evalOver && this._switchOver && (this._switchState = es,
                              this._switchType = ts.NONE,
                              this._switchUpReason = Ht.NONE,
                              this._switchDownReason = Gt.NONE)
                          }
                      }, {
                          key: "switchDone",
                          value: function(t) {
                              this._switchOver = !0;
                              var e = this._mse.getBufferLen();
                              l.a.log("CtrlBitrate.switchDone buffer=".concat(e, " switchType=").concat(this._switchType, " switchNextGap=").concat(t));
                              var i = c.a.now();
                              if (this._switchNextTime = i + t,
                              6 === this._switchState && (this.switchStartTime = i),
                              3 === this._switchState || 4 === this._switchState) {
                                  this._evalBw.reset(),
                                  this._sendSwitchStat(1),
                                  3 === this._switchState ? (this._switchUpReason = Ht.NONE,
                                  this._switchDownReason = Gt.NONE,
                                  this._switchNextTime += this._switchDownGap,
                                  this._switchState = es,
                                  this._switchType = ts.NONE,
                                  this._setPlaybackrate(!1)) : (this._switchState = 5,
                                  this._switchNextTime += this._switchBackGap);
                                  var s = this._upGap.getGap(this._curBitrate);
                                  l.a.log("CtrlBitrate.switchDone switchTime=".concat(s)),
                                  this._switchUpSample.setSwitchTime(s)
                              } else
                                  this._resetProperties();
                              this._buffer.play()
                          }
                      }, {
                          key: "_setPlaybackrate",
                          value: function(t) {
                              var e = this._mse.getBufferLen()
                                , i = Number(o.a.autoCfg.slow);
                              i = e > 3e3 ? .95 : e > 2e3 ? .9 : .85,
                              this._mse.setPlaybackRate(t ? i : 1),
                              this._mse.autoBitrateJitter = t
                          }
                      }, {
                          key: "_switchUp",
                          value: function() {
                              if (this._curBitrate < this.maxBitrate) {
                                  if (this._switchState === es) {
                                      for (var t = null, e = this._bitrateList.length - 1; e >= 0; e--) {
                                          var i = this._bitrateList[e];
                                          if (i.bitrate > this._curBitrate && !this._badRate.hasBitrate(i.bitrate) && i.bitrate <= this.maxBitrate && !this._isBadBitrate(i.bitrate)) {
                                              t = i;
                                              break
                                          }
                                      }
                                      t ? (l.a.log("CtrlBitrate._switchUp suc"),
                                      this._setPlaybackrate(!0),
                                      this._seg.start(Ft),
                                      this._switchState = 1,
                                      this._beforeSwitchCb && this._beforeSwitchCb(t),
                                      this._autoMonitor.start(Ft, this.switchType)) : this._bitrateList[0].bitrate > this.maxBitrate ? this._switchUpReason = Ht.TARGET_MAX : this._switchUpReason = Ht.TARGET_BAD
                                  }
                              } else
                                  this._switchUpReason = Ht.MAX_BITRATE
                          }
                      }, {
                          key: "addBadQuality",
                          value: function(t, e, i) {
                              t = t || c.a.now(),
                              l.a.log("CtrlBitrate.addBadQuality started=".concat(this._started, " switchState=").concat(this._switchState)),
                              this._started && this._switchState === es && this._badRate.addBadQuality(this._curBitrate, t, e, i) && (this._badRate.reset(),
                              l.a.log("CtrlBitrate pause down!"),
                              this._switchDownBefore())
                          }
                      }, {
                          key: "_switchDownBefore",
                          value: function() {
                              var t = this._bitrateList[this._bitrateList.length - 1].bitrate;
                              this._curBitrate > t && (this._switchState = 2,
                              2 === Number(o.a.isWebAutoAB) || 3 === Number(o.a.isWebAutoAB) ? this._switchDown() : this._reqAutoRecSys(2, this._onRecSysDownTimeoutBind))
                          }
                      }, {
                          key: "_switchDown",
                          value: function() {
                              var t = c.a.now();
                              o.a.autoCfg && 0 != this.switchStartTime && t - this.switchStartTime < o.a.autoCfg.noRederTime && this._upGap.addFail(this._lastBitrate, this._curBitrate === this._minBitrate),
                              this.switchStartTime = 0;
                              for (var e = this.badQualityCoderatebps, i = this._bitrateList.length, s = null, a = 0; a < i; a++) {
                                  var r = this._bitrateList[a];
                                  if (r.bitrate < this._curBitrate && !this._isBadBitrate(r.bitrate)) {
                                      if (r.bitrate === this._minBitrate || r.bitrate <= this._switchDownBitrate)
                                          s = r;
                                      else {
                                          var n = this._getDownInfo(a + 1, i);
                                          s = !n || n.bitrate < this._switchDownBitrate ? r : n
                                      }
                                      break
                                  }
                              }
                              if (s)
                                  l.a.log("CtrlBitrate._switchDown suc"),
                                  this._setPlaybackrate(!0),
                                  this._seg.start(Mt),
                                  this._switchState = 3,
                                  this._beforeSwitchCb && this._beforeSwitchCb(s),
                                  this._autoMonitor.start(Mt, this.switchType);
                              else {
                                  l.a.log("CtrlBitrate._switchDown fail bad_host=".concat(this._badRate.getBitrates(), " bad_svr=").concat(e.join(",")));
                                  var h = this._bitrateList[i - 1];
                                  -1 !== e.indexOf(1e3 * h.bitrate) ? this._switchDownReason = Gt.TARGET_SVR : this._badRate.hasBitrate(h.bitrate) && (this._switchDownReason = Gt.TARGET_HOST)
                              }
                          }
                      }, {
                          key: "_isBadBitrate",
                          value: function(t) {
                              return -1 !== this.badQualityCoderatebps.indexOf(1e3 * t) || this._badRate.hasBitrate(t)
                          }
                      }, {
                          key: "_getDownInfo",
                          value: function(t, e) {
                              return null
                          }
                      }, {
                          key: "_onRecSysDownTimeout",
                          value: function() {
                              l.a.log("CtrlBitrate._onRecSysTimeout"),
                              this._nextRecSysTs = c.a.now() + this.nextReqInterval,
                              this._destroyRecSys(),
                              this._switchDown()
                          }
                      }, {
                          key: "_onCheckFastTimer",
                          value: function(t, e) {
                              if (this._evalBw.onCheckFastTimer(t, e),
                              5 === this._switchState)
                                  this._fillBuf();
                              else if (this._visibilityState === C.a.VISIBILITY_STATE.VISIBLE && this._switchState === es && t > this._switchNextTime && !this._buffer.isPaused() && !this.closeAuto) {
                                  if (0 === this._switchSampleTs)
                                      this._switchSampleTs = t;
                                  else if (t - this._switchSampleTs >= this._switchSampleTime) {
                                      this._switchSampleTs = t;
                                      var i = this._mse.getBufferLen()
                                        , s = this._player.getWaitBufferLen()
                                        , a = this._player.getWaitFrameTime(t);
                                      this._needSwitchDown(t, i, s, a) ? (l.a.log("CtrlBitrate buffer down! buffer=".concat(i, " waitBuffer=").concat(s, " waitFrameTime=").concat(a)),
                                      this._switchDownBefore()) : (this._switchDownReason = Gt.BUFFER,
                                      this._switchUpSample.addSample(i >= this._mse.JITTER_BUFLEN * this._switchUpPer) ? this._switchUp() : this._switchUpSample.isFullSize() ? this._switchUpSample.isLastReach() ? this._switchUpSample.isPercentReach() || (this._switchUpReason = Ht.SAMPLE_PERCENT) : this._switchUpReason = Ht.SAMPLE_LAST : this._switchUpReason = Ht.SAMPLE_SIZE)
                                  }
                              } else
                                  t < this._switchNextTime && (this._switchUpReason = Ht.NEXT_TIME,
                                  this._switchDownReason = Gt.NEXT_TIME);
                              this._nextRecSysTs > 0 && t >= this._nextRecSysTs && this._reqAutoRecSys(0, this._onRecSysIntervalTimeoutBind)
                          }
                      }, {
                          key: "_needSwitchDown",
                          value: function(t, e, i, s) {
                              return e + i < this._mse.JITTER_BUFLEN * this._switchDownPer
                          }
                      }, {
                          key: "_fillBuf",
                          value: function() {
                              var t = this._mse.getBufferLen();
                              t >= this._mse.JITTER_BUFLEN * this._switchUpPer && (l.a.log("CtrlBitrate.fillBuf suc bufferLen=".concat(t)),
                              this._switchState = es,
                              this._switchType = ts.NONE,
                              this._setPlaybackrate(!1))
                          }
                      }, {
                          key: "_reqAutoRecSys",
                          value: function(t, e) {
                              if (2 !== Number(o.a.isWebAutoAB) && 3 !== Number(o.a.isWebAutoAB)) {
                                  this._nextRecSysTs = Number.MAX_SAFE_INTEGER,
                                  this._destroyRecSys();
                                  var i = this._player.info
                                    , s = new Wi({
                                      onRsp: this._onRecSysBind,
                                      onTimeout: e
                                  });
                                  s.sendAuto({
                                      presenterUid: i.presenterUid,
                                      roomId: i.roomId,
                                      scene: 1,
                                      appendInfo: {
                                          platform: "webh5&".concat(2202140215),
                                          p2p: this._player.playerType,
                                          h265: this._player.h265Proxy && this._player.h265Proxy.isReady ? 1 : 0,
                                          line: i.lineType,
                                          coderatebps: 1e3 * i.curBitrate,
                                          gameid: i.gameId,
                                          all_coderatebps: this._allBitratebps,
                                          req_type: t,
                                          start_coderatebps: 1e3 * this._startBitrate,
                                          session_id: this._sessionId
                                      }
                                  }, 1e3),
                                  this._recSysProxy = s
                              }
                          }
                      }, {
                          key: "_onRecSysIntervalTimeout",
                          value: function() {
                              this._nextRecSysTs = c.a.now() + this.nextReqInterval,
                              this._destroyRecSys()
                          }
                      }, {
                          key: "_onRecSys",
                          value: function(t) {
                              var e = !1
                                , i = c.a.now();
                              if (t) {
                                  if (this._recSysStat.addItem(1, t.tRecSysInfo.sDispatchId, i + o.a.recSysExpiredTime),
                                  Number(localStorage._testAction) > 0 && (l.a.log("CtrlBitrate._onRecSys _testAction=".concat(localStorage._testAction)),
                                  t.tRecSysInfo.lAction = Number(localStorage._testAction)),
                                  0 === t.tRecSysInfo.lAction)
                                      e = !0;
                                  else if (t.tRecSysInfo.lAction >= 100 && t.tRecSysInfo.lAction < 200) {
                                      if ("" !== t.tRecSysInfo.sActValue) {
                                          var s = JSON.parse(v.b.unescapeHTML(t.tRecSysInfo.sActValue));
                                          l.a.log("CtrlBitrate._onRecSys", JSON.stringify(s)),
                                          this._maxBitrate = Number(s.auto_max_coderatebps) / 1e3 || this._maxBitrate,
                                          this._nextReqInterval = 1e3 * Number(s.next_req_interval) || this._nextReqInterval,
                                          this._badQualityCoderatebps = s.bad_quality_coderatebps || [],
                                          this._recSysExpiredTime = c.a.now();
                                          var a = Number(s.force_auto_count)
                                            , n = Number(s.force_auto_effective_time);
                                          a > 0 && n > 0 && this._player.trigger(r.c.AUTO_FORCE_RSP, {
                                              force_auto_count: a,
                                              force_auto_effective_time: n
                                          })
                                      }
                                      e = !0
                                  }
                              } else
                                  e = !0;
                              Number(localStorage._testBadQuality) > 0 && (l.a.log("CtrlBitrate._onRecSys _testBadQuality=".concat(localStorage._testBadQuality)),
                              this._badQualityCoderatebps = [1e3 * Number(localStorage._testBadQuality)]),
                              Number(localStorage._testMaxBitrate) > 0 && (l.a.log("CtrlBitrate._onRecSys _testMaxBitrate=".concat(localStorage._testMaxBitrate)),
                              this._maxBitrate = Number(localStorage._testMaxBitrate)),
                              2 === this._switchState && (this._switchState = es,
                              e ? this._switchDown() : this._switchNextTime = this._nextRecSysTs),
                              this._nextRecSysTs = i + this.nextReqInterval - 1e4
                          }
                      }, {
                          key: "_destroyRecSys",
                          value: function() {
                              this._recSysProxy && this._recSysProxy.destroy(),
                              this._recSysProxy = null
                          }
                      }, {
                          key: "_recSysExpired",
                          value: function() {
                              var t = c.a.now() - this._recSysExpiredTime;
                              return 0 != this._recSysExpiredTime && t > o.a.recSysExpiredTime
                          }
                      }, {
                          key: "switchType",
                          get: function() {
                              return this._switchType
                          },
                          set: function(t) {
                              this._switchType = t
                          }
                      }, {
                          key: "beforeSwitchCb",
                          set: function(t) {
                              this._beforeSwitchCb = t
                          }
                      }, {
                          key: "lastBitrate",
                          get: function() {
                              return this._lastBitrate
                          }
                      }, {
                          key: "curBitrate",
                          get: function() {
                              return this._curBitrate
                          }
                      }, {
                          key: "maxBitrate",
                          get: function() {
                              return this._recSysExpired() && (this._maxBitrate = this._originalMaxBitrate),
                              this._maxBitrate
                          }
                      }, {
                          key: "nextReqInterval",
                          get: function() {
                              return this._recSysExpired() && (this._nextReqInterval = Number(o.a.recSysExpiredTime)),
                              this._nextReqInterval
                          }
                      }, {
                          key: "badQualityCoderatebps",
                          get: function() {
                              return this._recSysExpired() && (this._badQualityCoderatebps = []),
                              this._badQualityCoderatebps
                          }
                      }]),
                      t
                  }();
                  is.SwitchType = ts;
                  var ss = is
                    , as = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.mse = null,
                          this.dtsGap = 0,
                          this.lastBufferLen = 0,
                          this.pauseCnt = 0,
                          this.callbacks = null
                      }
                      return Object(a.a)(t, [{
                          key: "stop",
                          value: function() {
                              this.mse = null,
                              this.dtsGap = 0,
                              this.callbacks = null,
                              k.a.remove(this._onTimer, this)
                          }
                      }, {
                          key: "start",
                          value: function(t, e, i) {
                              l.a.log("SwitchDoneBefore.start bufferLen=".concat(t.getBufferLen(), " dtsGap=").concat(e)),
                              this.mse = t,
                              this.dtsGap = e,
                              this.lastBufferLen = 0,
                              this.pauseCnt = 0,
                              this.callbacks = i,
                              k.a.add(this._onTimer, this, 100),
                              this._onTimer(0)
                          }
                      }, {
                          key: "_onTimer",
                          value: function(t) {
                              if (this.mse) {
                                  var e = 200;
                                  Number(localStorage._localBuffer) > 0 && (e = Number(localStorage._localBuffer));
                                  var i = this.mse.getBufferLen();
                                  i <= e || this.dtsGap + i <= 0 || this.pauseCnt > 2 ? (l.a.log("SwitchDoneBefore.done bufferLen=".concat(i, " dtsGap=").concat(this.dtsGap, " pauseCnt=").concat(this.pauseCnt)),
                                  k.a.remove(this._onTimer, this),
                                  this.callbacks && this.callbacks.done()) : i === this.lastBufferLen && this.pauseCnt++,
                                  this.lastBufferLen = i
                              } else
                                  this.stop()
                          }
                      }]),
                      t
                  }()
                    , rs = "heart"
                    , ns = 0
                    , os = function() {
                      function t(e, i) {
                          Object(s.a)(this, t),
                          this._id = ns++,
                          this.eventEmitter = e,
                          this.stat = i.stat,
                          this.tsdb = i.tsdb,
                          this.statSwitch = i.statSwitch,
                          this.sampleController = i.sampleController,
                          this.h265Proxy = i.h265Proxy,
                          this.autoMonitor = i.autoMonitor,
                          this.recSysStat = i.recSysStat,
                          this.info = null,
                          this.isH265Playing = !1,
                          this.playerType = -1,
                          this.started = !1,
                          this.heart20Ts = 0,
                          this.pauseCnt = 0,
                          this.pauseTime = 0,
                          this.pauseCnt5 = 0,
                          this.pauseTime5 = 0,
                          this.pauseCnt60Sec = 0,
                          this.pauseStartTs = 0,
                          this.pauseCheckLock = !1,
                          this.videoStatus = r.b.VIDEO_STOP,
                          this.isSwitchPause = !1,
                          this._useAV1 = !1,
                          this.isAV1MediaSupported = this.checkAV1MediaSupported(),
                          this.resetAiProps(),
                          this.videoBadList = [],
                          this.fastSample = new Hi(20),
                          this.onFastSampleOverBind = this.onFastSampleOver.bind(this),
                          this._switch265FailBind = this._switch265Fail.bind(this),
                          this.ctrlBitrate = new ss({
                              player: this,
                              statSwitch: this.statSwitch,
                              autoMonitor: this.autoMonitor,
                              recSysStat: this.recSysStat
                          },{
                              start: this._switchStart.bind(this),
                              first: this._switchFirstSample.bind(this),
                              done: this._switchDone.bind(this),
                              autoReport: this.autoReport.bind(this)
                          }),
                          this.ctrlBitrate.beforeSwitchCb = this._beforeSwitch.bind(this),
                          this.switchDoneBefore = new as
                      }
                      return Object(a.a)(t, [{
                          key: "_beforeSwitch",
                          value: function(t) {
                              this.switchDoneBefore.stop();
                              var e = this.info;
                              e._delayRemove = !1,
                              e.iBitRate = t.iBitRate,
                              e.curBitrate = t.bitrate,
                              e.originalBitrate = 0 === t.iBitRate,
                              e.iCodecType = t.iCodecType,
                              e.iHEVCBitRate = t.iHEVCBitRate;
                              var i = this.h265Proxy.renderInited;
                              this.h265Proxy.initSupport(e);
                              var s = this.h265Proxy.isSupported;
                              !i && s ? (this.ctrlBitrate.switchType = ss.SwitchType.H264ToH265,
                              this.h265Proxy.loadDecoder(e.h5Root, {
                                  ready: this._onH265DecoderReady.bind(this),
                                  error: this._switch265FailBind,
                                  timeout: this._switch265FailBind
                              })) : (i || s ? i && s ? this.ctrlBitrate.switchType = ss.SwitchType.H265ToH265 : i && !s && (this.ctrlBitrate.switchType = ss.SwitchType.H265ToH264,
                              e._delayRemove = !0) : this.ctrlBitrate.switchType = ss.SwitchType.H264ToH264,
                              this.switchLevel(e))
                          }
                      }, {
                          key: "_onH265DecoderReady",
                          value: function() {
                              l.a.log("IPlayer._onH265DecoderReady"),
                              this.info._delayRemove = !0,
                              this.switchLevel(this.info)
                          }
                      }, {
                          key: "_switch265Fail",
                          value: function() {
                              this.ctrlBitrate.switchType = ss.SwitchType.H264ToH264,
                              this.switchLevel(this.info)
                          }
                      }, {
                          key: "setAutoInfo",
                          value: function(t) {
                              this.ctrlBitrate.setAutoInfo(t)
                          }
                      }, {
                          key: "switchLevel",
                          value: function(t) {
                              o.a.initByBitrate(t.curBitrate),
                              this.isUserPaused() ? this.start(t) : this.started && (this.info = t,
                              this.statSwitch.check(t, !0),
                              this.ctrlBitrate.switchBitrate(t.curBitrate),
                              this._triggerAutoChanged())
                          }
                      }, {
                          key: "_switchStart",
                          value: function(t, e) {
                              var i = this.getBufferLen();
                              this.ctrlBitrate._badStat.setStart(i),
                              this.ctrlBitrate._seg.nextIFrame(),
                              l.a.log("IPlayer(".concat(this._id, ")._switchStart bufferLen=").concat(i, " dts=").concat(t, " pts=").concat(e)),
                              k.a.once(this._switchFirstVideoTimeout, this, 1e3),
                              this.isSwitchPause = !1,
                              k.a.once(this._checkSwitchPause, this, 5e3)
                          }
                      }, {
                          key: "onConnected",
                          value: function() {
                              l.a.log("IPlayer(".concat(this._id, ").onConnected")),
                              this.ctrlBitrate._badStat.setConnected(),
                              this.ctrlBitrate._seg.connected()
                          }
                      }, {
                          key: "_switchFirstSample",
                          value: function() {
                              l.a.log("IPlayer(".concat(this._id, ")._switchFirstSample")),
                              this.ctrlBitrate._badStat.setFirstFrame(),
                              this.ctrlBitrate._seg.firstVideo(),
                              k.a.remove(this._switchFirstVideoTimeout, this),
                              k.a.once(this._switchPtsIFrameTimeout, this, 1e3)
                          }
                      }, {
                          key: "_switchFirstVideoTimeout",
                          value: function() {
                              l.a.log("IPlayer(".concat(this._id, ")._switchFirstVideoTimeout")),
                              this.ctrlBitrate._badStat.setFirstVideoTimeout(),
                              this.switchDoneBefore.stop(),
                              this.ctrlBitrate.switchBack(Bt)
                          }
                      }, {
                          key: "_switchPtsIFrameTimeout",
                          value: function() {
                              l.a.log("IPlayer(".concat(this._id, ")._switchPtsIFrameTimeout")),
                              this.ctrlBitrate._badStat.setPtsFrameTimeout(),
                              this.switchDoneBefore.stop(),
                              this.ctrlBitrate.switchBack(Vt)
                          }
                      }, {
                          key: "_switchDone",
                          value: function(t, e, i) {
                              this.ctrlBitrate._badStat.setPtsFrame(i),
                              this.ctrlBitrate._seg.ptsIFrame(),
                              k.a.remove(this._switchPtsIFrameTimeout, this),
                              this.ctrlBitrate.startEval(e),
                              this.ctrlBitrate.switchType === ss.SwitchType.H264ToH265 || this.ctrlBitrate.switchType === ss.SwitchType.H265ToH264 ? (this.ctrlBitrate.pause(),
                              this.switchDoneBefore.start(this.getMse(), t, {
                                  done: this._onSwitchDoneBefore.bind(this)
                              })) : this._switchDoneReal(0)
                          }
                      }, {
                          key: "_onSwitchDoneBefore",
                          value: function() {
                              var t = this.getMse();
                              l.a.log("IPlayer(".concat(this._id, ")._onSwitchDoneBefore mse=").concat(!!t, " switchType=").concat(this.ctrlBitrate.switchType)),
                              t && (t.resetVideo(),
                              t.playing = !1,
                              t.parser.remuxer.reset(),
                              this.ctrlBitrate.switchType === ss.SwitchType.H265ToH264 ? this.h265Proxy.stop() : this.ctrlBitrate.switchType === ss.SwitchType.H264ToH265 && this.h265Proxy.initRender(t)),
                              this._switchDoneReal(3e3)
                          }
                      }, {
                          key: "_switchDoneReal",
                          value: function(t) {
                              l.a.log("IPlayer(".concat(this._id, ")._switchDoneReal")),
                              this.ctrlBitrate.switchDone(t)
                          }
                      }, {
                          key: "_triggerAutoChanged",
                          value: function() {
                              this.eventEmitter.trigger(r.a.AUTO_BITRATE_CHANGED, {
                                  lastBitrate: this.ctrlBitrate.lastBitrate,
                                  curBitrate: this.ctrlBitrate.curBitrate
                              })
                          }
                      }, {
                          key: "isUserPaused",
                          value: function() {
                              return !1
                          }
                      }, {
                          key: "onPlayVideo",
                          value: function(t, e, i, s, a, r, n) {
                              this.info && this.info.isAuto && 0 === Number(o.a.autoCfg.close) && (this.ctrlBitrate.start(this.getMse(), {
                                  sessionId: this.info._sessionId,
                                  startBitrate: this.info._startBitrate,
                                  bitrateList: this.info.bitrateList,
                                  curBitrate: this.info.curBitrate
                              }),
                              this._triggerAutoChanged()),
                              this.stat.setComDim(d.a.DIM_COM.DPI, e + "*" + i),
                              this.h265Proxy.needPreload && this.h265Proxy.loadDecoder(this.info.h5Root, null)
                          }
                      }, {
                          key: "_startContinueBuffer",
                          value: function() {
                              var t = this.getMse();
                              t && t.buffered.start()
                          }
                      }, {
                          key: "onPlayPause",
                          value: function(t, e) {
                              this.pauseStartTs = t,
                              this.pauseCheckLock = !1,
                              this.isSwitchPause = !0,
                              this.autoMonitor.setPause(t, this.getBufferLen()),
                              e && this.updateStatus(r.b.VIDEO_CACHING)
                          }
                      }, {
                          key: "onPlayResume",
                          value: function(t, e) {
                              this._checkPaused(t, "resume"),
                              e && this.updateStatus(r.b.VIDEO_PLAYING)
                          }
                      }, {
                          key: "_checkPaused",
                          value: function(t, e) {
                              if (this.pauseStartTs > 0) {
                                  var i = t - this.pauseStartTs;
                                  if (i >= 200) {
                                      l.a.warn("IPlayer(".concat(this._id, ")._checkPaused type=").concat(e, " pauseTime=").concat(i));
                                      var s = this.getMse()
                                        , a = 0;
                                      s && (s.buffered._calc(t, Yt),
                                      a = s.getContinueBuffer()),
                                      this.autoMonitor.addBadQuality(t, i, e, a),
                                      this.pauseCnt++,
                                      this.pauseTime += i,
                                      this.pauseCnt5++,
                                      this.pauseTime5 += i,
                                      this.ctrlBitrate.addBadQuality(t, i, this.getBufferLen()),
                                      this.pauseCnt60Sec++
                                  } else
                                      this.autoMonitor.resetPausedTs();
                                  this.pauseStartTs = e === rs ? t : 0
                              }
                          }
                      }, {
                          key: "updateStatus",
                          value: function(t) {
                              this.videoStatus !== t && (this.videoStatus = t,
                              this.eventEmitter.trigger(r.a.PLAY_STATUS, {
                                  status: t
                              }))
                          }
                      }, {
                          key: "onErrorEvent",
                          value: function(t) {
                              3 === t.type && this.ctrlBitrate._badStat.setNoIFrame()
                          }
                      }, {
                          key: "getMse",
                          value: function() {
                              return null
                          }
                      }, {
                          key: "getBufferLen",
                          value: function() {
                              return 0
                          }
                      }, {
                          key: "getWaitBufferLen",
                          value: function() {
                              return 0
                          }
                      }, {
                          key: "getWaitFrameTime",
                          value: function(t) {
                              return 0
                          }
                      }, {
                          key: "triggerVideoBadQuality",
                          value: function() {
                              this.eventEmitter.trigger(r.a.VIDEO_BAD_QUALITY)
                          }
                      }, {
                          key: "trigger",
                          value: function(t, e) {
                              this.eventEmitter.trigger(t, e)
                          }
                      }, {
                          key: "onFastSampleOver",
                          value: function(t) {
                              var e = [this.stat.createAct(d.a.ACT.FAST_SAMPLE, {
                                  str: [t]
                              })];
                              this.tsdb.sendMetrics(e)
                          }
                      }, {
                          key: "startFastSample",
                          value: function() {
                              this.fastSample.start(this.onFastSampleOverBind)
                          }
                      }, {
                          key: "addBytes",
                          value: function(t) {
                              this.sampleController.addTotalSample(t),
                              this.fastSample.add(t)
                          }
                      }, {
                          key: "init",
                          value: function(t) {}
                      }, {
                          key: "start",
                          value: function(t) {
                              this.stop(),
                              k.a.add(this.getVideoBadQuality, this, 2e4),
                              k.a.add(this.pauseTimer60Sec, this, 6e4),
                              this.sampleController.start()
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              this.isH265Playing = !1,
                              this.heart20Ts = 0,
                              this.videoBadList = [],
                              this.pauseCnt60Sec = 0,
                              this.isSwitchPause = !1,
                              this.fastSample.stop(),
                              this.sampleController.stop(),
                              this.ctrlBitrate.stop(),
                              this.switchDoneBefore.stop(),
                              k.a.remove(this._switchFirstVideoTimeout, this),
                              k.a.remove(this._switchPtsIFrameTimeout, this),
                              k.a.remove(this.timeoutRecSysRsp, this),
                              k.a.remove(this.getVideoBadQuality, this),
                              k.a.remove(this.getVideoLoad, this),
                              k.a.remove(this.pauseTimer60Sec, this)
                          }
                      }, {
                          key: "getVideoBadQuality",
                          value: function() {
                              if (0 !== Number(o.a.isAiP2PToFlv) && this.mse) {
                                  var t = this.mse.pauseStat.getAiStat()
                                    , e = t.aiDuration
                                    , i = t.aiCnt;
                                  if (this.videoBadList.length < 3 && (e >= o.a.aiP2PFlvConfig[0] || i >= o.a.aiP2PFlvConfig[1] ? this.videoBadList.push(1) : this.videoBadList.push(0)),
                                  this.videoBadList.length >= 3) {
                                      var s = 0;
                                      this.videoBadList.map((function(t) {
                                          1 == t && s++
                                      }
                                      ));
                                      var a = c.a.now();
                                      if (s >= 2) {
                                          if (this.playerType === xi) {
                                              var r = this.eventEmitter.getVideoP2PBuffertEmptyTime;
                                              0 != r && a - r <= o.a.aiBufferEmptyRequestInterval ? l.a.log("IPlayer(".concat(this._id, ").getVideoBadQuality.getVideoP2PBuffertEmptyTime"), a - r) : (this.getRecSysRsp({
                                                  info: this.info,
                                                  type: "p2p",
                                                  metadata: this.player ? this.player.msePlayer.metadata : null,
                                                  reason: C.a.turnToFlvReason.VIDEO_BUFFER_EMPTY
                                              }),
                                              this.eventEmitter.getVideoP2PBuffertEmptyTime = a)
                                          } else if (this.playerType === Vi) {
                                              var n = this.eventEmitter.getVideoFlvBuffertEmptyTime;
                                              if (0 != n && a - n <= o.a.aiBufferEmptyRequestInterval)
                                                  return void l.a.log("IPlayer(".concat(this._id, ").getVideoBadQuality.getVideoFlvBuffertEmptyTime"), a - n);
                                              this.eventEmitter && this.eventEmitter.lastP2PInfo && (this.getRecSysRsp({
                                                  info: this.info,
                                                  type: "flv",
                                                  metadata: this.mse.metadata
                                              }),
                                              this.eventEmitter.getVideoFlvBuffertEmptyTime = a)
                                          }
                                          this.videoBadList = []
                                      } else
                                          this.videoBadList.shift()
                                  }
                              }
                          }
                      }, {
                          key: "startP2PUrl",
                          value: function(t) {}
                      }, {
                          key: "stopStream",
                          value: function(t) {}
                      }, {
                          key: "checkPcdnMode",
                          value: function(t, e) {
                              if (this.info) {
                                  this.info.usePcdn = this._getUsePcdn(t),
                                  localStorage.usePcdn && (this.info.usePcdn = 1),
                                  this.p2pMgr && this.p2pMgr.stream && (this.p2pMgr.stream.usePcdn = this._checkUsePcdn()),
                                  this.stat.setComDim(d.a.DIM_COM.FORCE_SUB_TYPE, this.info.usePcdn);
                                  var i = this._getPcdnName(e);
                                  "" != i && null != i && this.stat.setComDim(d.a.DIM_COM.PCDN_ORIGIN, i)
                              }
                          }
                      }, {
                          key: "_checkUsePcdn",
                          value: function() {
                              return this.info.isAuto && Number(o.a.closePcdn500) === this.info.curBitrate ? 0 : this.info.usePcdn
                          }
                      }, {
                          key: "checkAV1MediaSupported",
                          value: function() {
                              return MediaSource.isTypeSupported('video/mp4; codecs="av01.0.08M.08"')
                          }
                      }, {
                          key: "setUseAV1",
                          value: function(t) {
                              this._useAV1 = t
                          }
                      }, {
                          key: "isUseAV1",
                          value: function(t) {
                              this._useAV1 = o.a.useAV1;
                              var e = !0;
                              return this.eventEmitter.noLoadAv1Count && (e = this.eventEmitter.noLoadAv1Count < 3),
                              this.isAV1MediaSupported && this._useAV1 && e && v.b.getAv1Random(t, o.a.av1PercentConfig) && 1 == Number(o.a.abUseAv1)
                          }
                      }, {
                          key: "_getUsePcdn",
                          value: function(t) {
                              return 0
                          }
                      }, {
                          key: "_getPcdnName",
                          value: function() {
                              return ""
                          }
                      }, {
                          key: "setEnableLowLatency",
                          value: function(t) {}
                      }, {
                          key: "setPlaybackrateAccess",
                          value: function(t) {}
                      }, {
                          key: "setVolume",
                          value: function(t) {}
                      }, {
                          key: "getCurrentTime",
                          value: function() {
                              return 0
                          }
                      }, {
                          key: "getFrameData",
                          value: function() {
                              return null
                          }
                      }, {
                          key: "resetAiProps",
                          value: function() {
                              this.aiP2PCnt = 0,
                              this.aiFlvCnt = 0,
                              this.aiP2PTimeoutCnt = 0,
                              this.aiFlvTimeoutCnt = 0,
                              this.aiP2PErrorCnt = 0,
                              this.aiFlvErrorCnt = 0,
                              this.aiP2PSwitchCnt = 0,
                              this.aiFlvSwitchCnt = 0,
                              this.aiP2PNotSwitchCnt = 0,
                              this.aiFlvNotSwitchCnt = 0,
                              this.aiFlvErrorNotSwitchCnt = 0,
                              this.aiFlvErrorSwitchCnt = 0
                          }
                      }, {
                          key: "recordAiP2PFlv",
                          value: function(t) {
                              "p2p" == t ? this.aiP2PCnt++ : "flv" == t && this.aiFlvCnt++
                          }
                      }, {
                          key: "initAiReq",
                          value: function(t, e, i, s, a, r) {
                              var n = new J.RecSysReq;
                              n.tId.iAppid = z.a.appid,
                              n.tId.lUid = z.a.uid,
                              n.tId.sGuid = z.a.sGuid,
                              n.tId.sUA = "webh5",
                              n.sAnchorUid = t.presenterUid,
                              n.sRoomId = z.a.roomId,
                              n.iScene = 6,
                              n.bDebug = 1,
                              n.mAppendInfo.value = {
                                  streamType: e,
                                  expVideoFps: i && null != i.fps ? i.fps : 0,
                                  expAudioFps: i && null != i.audioFps ? i.audioFps : 0,
                                  codeRate: t.curBitrate,
                                  isOriginal: 0 == t.originalBitrate ? 1 : 0,
                                  line: r,
                                  codeType: this.isH265 ? "265" : "264",
                                  sStreamName: t.sStreamName,
                                  playType: s,
                                  isServer: 0,
                                  iIsP2PSupport: t.iIsP2PSupport
                              };
                              var o = Object.assign({}, n);
                              return l.a.log("IPlayer(".concat(this._id, ").getRecSysRsp.req"), n, JSON.stringify(o)),
                              n
                          }
                      }, {
                          key: "getRecSysRsp",
                          value: function(t, e) {
                              var i = this
                                , s = t.info
                                , a = t.type
                                , r = (t.reason,
                              t.metadata)
                                , n = t.isNotAi
                                , h = c.a.now();
                              if (0 === Number(o.a.isAiP2PToFlv) || n)
                                  return this.recordAiP2PFlv(a),
                                  void this.recSysRspHandler(!1, null, t);
                              var u = this.eventEmitter.getAIRequestTime;
                              if (0 != u && h - u <= o.a.aiRequestInterval)
                                  l.a.log("IPlayer(".concat(this._id, ").getRecSysRsp.getAIRequestTime"), h - u);
                              else {
                                  this.eventEmitter.getAIRequestTime = h,
                                  this.recordAiP2PFlv(a),
                                  k.a.remove(this.timeoutRecSysRsp),
                                  this.isTimeout = !0,
                                  this.isResTimeout = !1;
                                  var d = this.initAiReq(s, a, r, 0, "264", s.lineType);
                                  Q.sendWup("mediaui", "getMediaRec", d, (function(e) {
                                      if (!i.eventEmitter.isBusiStop) {
                                          var s = Object.assign({}, e);
                                          if (l.a.log("IPlayer(".concat(i._id, ").getRecSysRsp res"), e, JSON.stringify(s)),
                                          i.isTimeout = !1,
                                          !i.isResTimeout)
                                              if (0 === e.iStatus)
                                                  e && e.tRecSysInfo && 1 == e.tRecSysInfo.lAction ? "p2p" == a ? i.aiP2PSwitchCnt++ : "flv" == a && (i.aiFlvSwitchCnt++,
                                                  t.isFlvError && i.aiFlvErrorSwitchCnt++) : "p2p" == a ? i.aiP2PNotSwitchCnt++ : "flv" == a && (i.aiFlvNotSwitchCnt++,
                                                  t.isFlvError && i.aiFlvErrorNotSwitchCnt++),
                                                  i.recSysRspHandler(!0, e, t);
                                              else {
                                                  if (t.isNotFirstFetch)
                                                      return;
                                                  "p2p" == a ? i.aiP2PErrorCnt++ : "flv" == a && (i.aiFlvErrorCnt++,
                                                  t.isFlvError && i.aiFlvErrorSwitchCnt++),
                                                  i.recSysRspHandler(!1, null, t)
                                              }
                                      }
                                  }
                                  ), !0, Q.getRequestId(), !0),
                                  this.aiP2PFlvProps = t,
                                  k.a.once(this.timeoutRecSysRsp, this, 5e3)
                              }
                          }
                      }, {
                          key: "getAiStat",
                          value: function() {
                              var t = {};
                              this.eventEmitter && this.eventEmitter.getAiStartStat && (t = this.eventEmitter.getAiStartStat()),
                              this.aiP2PSwitchCnt += t.aiStartFlvCnt;
                              var e = {
                                  aiP2PCnt: this.aiP2PCnt,
                                  aiFlvCnt: this.aiFlvCnt,
                                  aiP2PTimeoutCnt: this.aiP2PTimeoutCnt,
                                  aiFlvTimeoutCnt: this.aiFlvTimeoutCnt,
                                  aiP2PErrorCnt: this.aiP2PErrorCnt,
                                  aiFlvErrorCnt: this.aiFlvErrorCnt,
                                  aiP2PSwitchCnt: this.aiP2PSwitchCnt,
                                  aiFlvSwitchCnt: this.aiFlvSwitchCnt,
                                  aiP2PNotSwitchCnt: this.aiP2PNotSwitchCnt,
                                  aiFlvNotSwitchCnt: this.aiFlvNotSwitchCnt,
                                  aiStartP2PCnt: t.aiStartP2PCnt || 0,
                                  aiStartFlvCnt: t.aiStartFlvCnt || 0,
                                  aiFlvErrorSwitchCnt: this.aiFlvErrorSwitchCnt,
                                  aiFlvErrorNotSwitchCnt: this.aiFlvErrorNotSwitchCnt
                              };
                              return this.resetAiProps(),
                              e
                          }
                      }, {
                          key: "timeoutRecSysRsp",
                          value: function() {
                              if (this.isTimeout) {
                                  var t = this.aiP2PFlvProps
                                    , e = t.type;
                                  if (t.isNotFirstFetch)
                                      return;
                                  "p2p" == e ? this.aiP2PTimeoutCnt++ : "flv" == e && (this.aiFlvTimeoutCnt++,
                                  t.isFlvError && this.aiFlvErrorSwitchCnt++),
                                  this.recSysRspHandler(!1, null, t),
                                  this.isResTimeout = !0
                              }
                          }
                      }, {
                          key: "onPause5Sec",
                          value: function() {
                              this.eventEmitter && (l.a.log("IPlayer(".concat(this._id, ").onPause5Sec")),
                              this.eventEmitter.trigger(r.a.PAUSE_5SEC_ERROR))
                          }
                      }, {
                          key: "pauseTimer60Sec",
                          value: function(t, e) {
                              this.pauseCnt60Sec >= o.a.autoReportCfg[1] && 1 === Number(o.a.autoReportCfg[2]) && this.autoReport(0),
                              this.pauseCnt60Sec = 0
                          }
                      }, {
                          key: "_checkSwitchPause",
                          value: function() {
                              this.isSwitchPause && 1 === Number(o.a.autoReportCfg[2]) && this.autoReport(1),
                              this.isSwitchPause = !1
                          }
                      }, {
                          key: "autoReport",
                          value: function(t) {
                              this.playerType != xi && this.playerType != Vi || !this.info.isAuto || 1 === Number(o.a.autoReportCfg[0]) && (l.a.log("IPlayer autoReport type=".concat(t)),
                              this.eventEmitter && this.eventEmitter.trigger(r.a.P2P_REPORT))
                          }
                      }, {
                          key: "hasPicture",
                          get: function() {
                              return !1
                          }
                      }, {
                          key: "isPlaying",
                          get: function() {
                              return !1
                          }
                      }]),
                      t
                  }()
                    , hs = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i(t, a) {
                          var n, o = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : null;
                          Object(s.a)(this, i),
                          n = e.call(this, t, a),
                          l.a.log("FlvPlayer(".concat(n._id, ").constructor"));
                          var h = a.isPureAudio
                            , u = a.isPureVideo;
                          return n.startTs = 0,
                          n.startTime = 0,
                          n.lineType = 0,
                          n.loader = new Bi(Object(g.a)(n),!0),
                          n.recvTime = 0,
                          n.firstPkgTime = 0,
                          n.connectTime = 0,
                          n.loadFlvStatus = 0,
                          n.isPureAudio = h,
                          n.isPureVideo = u,
                          n.videoElement = o,
                          n.flvLoadTimeSended = !1,
                          n.enableLowLatency = !1,
                          n.anticode = new ci,
                          n.mse = n.createMse(),
                          n.pauseStartTs = 0,
                          n.metadataTick = new te(t,n.mse),
                          n.pauseReason = 0,
                          n.loadTime = 0,
                          n.connectTime = 0,
                          n.recvDataTime = 0,
                          n.loadStartTs = 0,
                          n.cdnip = "",
                          n.sendPauseTimeout = 0,
                          n.videoStatus = r.b.VIDEO_STOP,
                          void 0 !== $t && (n.qaStat = new $t(Object(g.a)(n))),
                          n.playedStat = null,
                          n.flowSize = 0,
                          n.flvDataSize = 0,
                          n.backToP2P = new Zt(Object(g.a)(n)),
                          n.volumeCount = 0,
                          n.sendMetricTimer = 0,
                          n.sendMetricTimes = 0,
                          n.businessStartCost = 0,
                          n.startTimeStamp = 0,
                          n.noNeedSendVideoLoadTime = !1,
                          n.exceptionStat = new di(Object(g.a)(n)),
                          n.startUrlBind = n.startUrl.bind(Object(g.a)(n)),
                          n.playerType = Vi,
                          n
                      }
                      return Object(a.a)(i, [{
                          key: "createMse",
                          value: function() {
                              var t = new Qt(this,{
                                  videoType: "flv",
                                  isPureAudio: this.isPureAudio,
                                  isPureVideo: this.isPureVideo,
                                  h265Proxy: this.h265Proxy,
                                  videoElement: this.videoElement
                              });
                              return t.setPushGop(o.a.pushGop),
                              t
                          }
                      }, {
                          key: "getFrameData",
                          value: function() {
                              return {
                                  pts: this.mse.getCurrentRealTime()
                              }
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              this.started && (l.a.log("FlvPlayer(".concat(this._id, ").reset")),
                              k.a.remove(this.onCheckTimer, this),
                              k.a.remove(this.onCheckFastTimer, this),
                              this.exceptionStat.reset(),
                              this.loader.close(),
                              this.mse && (this.mse.destroy(),
                              this.mse = null),
                              this.mse = this.createMse(),
                              this.pauseStartTs = 0,
                              this.qaStat.isFirstReport = !0,
                              this.metadataTick.reset(),
                              this.metadataTick.mse = this.mse,
                              this.startTs = 0,
                              this.recvTime = 0,
                              this.startTime = 0,
                              this.enableLowLatency = !1,
                              this.pauseCheckLock = !1,
                              this.loadTime = 0,
                              this.connectTime = 0,
                              this.recvDataTime = 0,
                              this.flowSize = 0,
                              this.flvDataSize = 0,
                              this.recvDataEnough = !1,
                              this.recvFlvData = !1,
                              this.cdnip = "",
                              this.appStartPlayTime = 0,
                              this.backToP2P.reset(),
                              this.stat.reset(),
                              this.stopMetricTimer(),
                              this.audiouitil && (this.audiouitil.reset(),
                              this.audiouitil = null),
                              this.videoStatus = r.b.VIDEO_STOP)
                          }
                      }, {
                          key: "getCostTimes",
                          value: function() {
                              return [this.connectTime > 0 ? this.connectTime - this.startTs : 0, this.recvDataTime > 0 ? this.recvDataTime - this.connectTime : 0, this.mse.pushVideoStartRenderTime > 0 ? this.mse.pushVideoStartRenderTime - this.startTs : 0]
                          }
                      }, {
                          key: "getRecvInfo",
                          value: function() {
                              return [this.connectTime > 0 ? this.connectTime - this.startTs : 0, this.recvDataTime > 0 ? this.recvDataTime - this.connectTime : 0, this.mse.pushVideoStartRenderTime > 0 ? this.mse.pushVideoStartRenderTime - this.startTs : 0, this.mse.getVideoFrames(), this.mse.getAudioFrames(), this.flowSize]
                          }
                      }, {
                          key: "checkPcdnMode",
                          value: function(t) {
                              E(Object(S.a)(i.prototype), "checkPcdnMode", this).call(this, t),
                              this.loader.checkPcdnMode()
                          }
                      }, {
                          key: "_getUsePcdn",
                          value: function(t) {
                              return 1 === Number(t[J.EM_PCDN_MODE.E_PcdnMode_FlvOutsideSdkFullstream]) ? 1 : 0
                          }
                      }, {
                          key: "_getPcdnName",
                          value: function(t) {
                              var e = "";
                              return t && (e = t[J.EM_PCDN_MODE.E_PcdnMode_FlvOutsideSdkFullstream]),
                              e
                          }
                      }, {
                          key: "start",
                          value: function(t) {
                              this.firstPkgTime = 0,
                              E(Object(S.a)(i.prototype), "start", this).call(this),
                              this.reset(),
                              this.checkParams(t, this.startUrlBind)
                          }
                      }, {
                          key: "checkParams",
                          value: function(t, e) {
                              l.a.log("FlvPlayer(".concat(this._id, ").checkParams"), JSON.stringify(t)),
                              this.started = !0,
                              this.info = t,
                              t.sFlvUrl && t.sStreamName ? (t.sFlvUrl = t.sFlvUrl.replace("http://", "https://"),
                              this.initDomain(t),
                              t.sFlvAntiCode ? (this.anticode.init(t.sFlvUrl, t.sStreamName, t.sFlvAntiCode),
                              this.anticode.valid().then((function() {
                                  e(t)
                              }
                              ))) : e(t)) : t.url ? e(t) : l.a.error("FlvPlayer(".concat(this._id, ").start has no params(sFlvUrl,sStreamName,url)"))
                          }
                      }, {
                          key: "startUrl",
                          value: function(t) {
                              if (this.started) {
                                  this.initInfo(t),
                                  this.appStartPlayTime = t.appStartPlayTime ? t.appStartPlayTime : 0;
                                  var e = c.a.now();
                                  if (this.businessStartCost = 0,
                                  this.UIStartCost = 0,
                                  this.loadStartTs = 0,
                                  this.startTimeStamp = Number(t.startTimeStamp) || 0,
                                  t.noNeedSendVideoLoadTime ? this.noNeedSendVideoLoadTime = !0 : (this.businessStartCost = Math.floor(t.startTimeStamp > 1 ? (new Date).getTime() - t.startTimeStamp : 0),
                                  this.noNeedSendVideoLoadTime = !1),
                                  t.uistartTs && t.uistartTs > 0 && (this.UIStartCost = Math.floor((new Date).getTime() - t.uistartTs)),
                                  this.startTs = e,
                                  l.a.log("FlvPlayer(".concat(this._id, ").startNow"), Date.now(), e),
                                  this.startTime = e,
                                  this.backToP2P.initJumpTs(e),
                                  this.loadFlvStatus = 0,
                                  this.mse.setPushGop(o.a.pushGop),
                                  Xt.isNeedAud() ? this.mse.setDeleteH264Aud(-1 === o.a.deleteH264Aud.indexOf(t.presenterUid) ? 0 : 1) : this.mse.setDeleteH264Aud(0),
                                  t.latencyLevel) {
                                      var i = o.a.latency[t.latencyLevel];
                                      i || (i = [3e3, 2e3, 4e3, 2e3]),
                                      this.mse.latencySeek = i[3],
                                      this.mse.setJitter(i[0], i[1], i[2])
                                  } else
                                      this.enableLowLatency ? o.a.setLowLatency(this.mse) : o.a.setJitterCfg(this.mse, t.presenterUid, t.curBitrate);
                                  var s = this.h265Proxy.isReady
                                    , a = this.isUseAV1(t);
                                  this.stat.setComDim(d.a.DIM_COM.ORIGINAL_BITRATE, 0 === t.originalBitrate ? 1 : 0),
                                  this.stat.setComDim(d.a.DIM_COM.P2P, d.a.LIVE_TYPE.FLV),
                                  this.stat.setComDim(d.a.DIM_COM.STREAM_TYPE, 1),
                                  this.stat.setComDim(d.a.DIM_COM.H265, s ? 1 : 0),
                                  this.stat.setComDim(d.a.DIM_COM.V_DECODEC, a ? 2 : s ? 1 : 0),
                                  a ? (t.url += "&codec=av1",
                                  -1 == t.url.indexOf("ratio") && (t.url += "&ratio=0")) : s && (this.h265Proxy.checkUrl(t),
                                  this.eventEmitter.tsdbUtil.sendMetrics([this.stat.createAct(d.a.ACT.H265_STATUS, {
                                      value: [0],
                                      str: [0]
                                  })])),
                                  this.statSwitch.check(t, !1),
                                  delete t.pullStreamFrom,
                                  this.startFastSample(),
                                  this._startContinueBuffer(),
                                  this.loader.connect(t.url, null == this.videoElement),
                                  this.stat.setComDim(d.a.DIM_COM.STREAM_URL, this.loader.url),
                                  pi(this.stat, this.info.url, this.info.sStreamName),
                                  k.a.add(this.onCheckTimer, this, 1e3),
                                  k.a.add(this.onCheckFastTimer, this, 100),
                                  null != this.videoElement && this.startMetricTimer(2e4)
                              }
                          }
                      }, {
                          key: "_switchStart",
                          value: function(t, e) {
                              E(Object(S.a)(i.prototype), "_switchStart", this).call(this, t, e),
                              this.initInfo(this.info),
                              -1 !== this.info.url.indexOf("?") ? this.info.url += "&startPts=".concat(e) : this.info.url += "?startPts=".concat(e),
                              this.h265Proxy.checkUrl(this.info),
                              this.mse.parser.reset(),
                              this.loader.close(),
                              1 == localStorage._testBack ? localStorage._testBack = 0 : (this.startTs = c.a.now(),
                              this.loader.connect(this.info.url)),
                              this.updateFlvConfig()
                          }
                      }, {
                          key: "initInfo",
                          value: function(t, e) {
                              this.info = t,
                              t.sFlvUrl && t.sStreamName && (t.url = "".concat(t.sFlvUrl, "/").concat(t.sStreamName, ".flv"));
                              var i = [];
                              this.anticode.hasAnticode() && i.push(this.anticode.getAnticode(e)),
                              -1 !== o.a.useChangeRate.indexOf(Number(t.presenterUid)) ? i.push("ratio=".concat(t.curBitrate)) : t.iBitRate > 0 ? i.push("ratio=".concat(t.iBitRate)) : localStorage._ratio && i.push("&ratio=".concat(localStorage._ratio)),
                              -1 === t.url.indexOf("va.huya.com") && -1 === t.url.indexOf("cdnweb.huya.com") && -1 === t.url.indexOf("va-cmcc.huya.com") || i.push("&https=1"),
                              i.length > 0 && (t.url += (-1 !== t.url.indexOf("?") ? "&" : "?") + "".concat(i.join("&"))),
                              this.url = t.url,
                              this.lineType = t.lineType
                          }
                      }, {
                          key: "recSysRspHandler",
                          value: function(t, e, i) {
                              i && i.isBackToP2P ? this.backToP2P.recSysRspHandler(t, e, i) : !t || e && e.tRecSysInfo && 1 == e.tRecSysInfo.lAction ? (l.a.warn("FlvPlayer(".concat(this._id, ").recSysRspHandler FLV_TRY_TO_P2P")),
                              this.eventEmitter.trigger(r.a.FLV_TRY_TO_P2P)) : (l.a.warn("FlvPlayer(".concat(this._id, ").recSysRspHandler jumpToP2PCd=").concat(this.jumpToP2PCd / 6e4, "min fail")),
                              this.eventEmitter.trigger(r.a.H5_PLAYER_ERROR))
                          }
                      }, {
                          key: "setVideoPlayTimeSended",
                          value: function() {
                              this.flvLoadTimeSended = !0
                          }
                      }, {
                          key: "getPlayVideo",
                          value: function() {
                              return this.mse.getPlayVideo()
                          }
                      }, {
                          key: "setJitter",
                          value: function(t, e, i) {
                              this.mse && this.mse.setJitter(t, e, i)
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              this.started && (l.a.log("FlvPlayer(".concat(this._id, ").stopFlv")),
                              this._reportFlvFlow(),
                              this.reset(),
                              this.started = !1),
                              this.audiouitil && (this.audiouitil.reset(),
                              this.audiouitil = null),
                              this.recvDataEnough = !1,
                              this.recvFlvData = !1,
                              E(Object(S.a)(i.prototype), "stop", this).call(this)
                          }
                      }, {
                          key: "recvDataFull",
                          value: function() {
                              this.recvDataTime = c.a.now(),
                              this.eventEmitter.trigger(r.a.RECV_VIDEO_FRAME),
                              l.a.log("FlvPlayer(".concat(this._id, ").recvDataFull"))
                          }
                      }, {
                          key: "initDomain",
                          value: function(t) {
                              if (!t.inited) {
                                  t.inited = !0;
                                  var e = t.domainList;
                                  if (e && e.length) {
                                      var i = t.sFlvUrl.match(/\/\/(.+?)\//i);
                                      t._domain = i ? i[1] : "",
                                      l.a.log("FlvPlayer(".concat(this._id, ").initDomain:\n\t") + e.join("\n\t"));
                                      var s = e.shift();
                                      this.cdnip = s,
                                      this.stat.setComDim(d.a.DIM_COM.CDNIP, s),
                                      t.sFlvUrl = t.sFlvUrl.replace(/\/\/(.+?)\//, "//" + s + "/" + t._domain + "/")
                                  }
                              }
                          }
                      }, {
                          key: "retryVideo",
                          value: function() {
                              this.eventEmitter.trigger(r.a.REPLAY_VIDEO)
                          }
                      }, {
                          key: "setEnableLowLatency",
                          value: function(t) {
                              this.enableLowLatency = t,
                              t && o.a.setLowLatency(this.mse)
                          }
                      }, {
                          key: "updateFlvConfig",
                          value: function() {
                              this.enableLowLatency ? o.a.setLowLatency(this.mse) : o.a.setJitterCfg(this.mse, this.info.presenterUid, this.info.curBitrate),
                              this.mse && (this.mse.setNeedEmptyAudioFrame(o.a.flvEmptyAudioFrame > 0),
                              l.a.log("FlvPlayer(".concat(this._id, ").updateFlvConfig flvEmptyAudioFrame=") + this.getConfig("flvEmptyAudioFrame")))
                          }
                      }, {
                          key: "requestUrl",
                          value: function() {
                              var t = this.info
                                , e = t.domainList;
                              if (e && t._domain) {
                                  var i = new RegExp("//(.*?)" + t._domain + "/")
                                    , s = e.shift();
                                  return s ? (this.cdnip = s,
                                  this.stat.setExtDim(d.a.DIM_EXT.CDN_IP, s),
                                  l.a.warn("FlvPlayer(".concat(this._id, ").requestUrl change domain to ").concat(s)),
                                  t.sFlvUrl = t.sFlvUrl.replace(i, "//" + s + "/" + t._domain + "/")) : (this.cdnip = "",
                                  this.stat.delDim(d.a.DIM_EXT.CDN_IP),
                                  l.a.warn("FlvPlayer(".concat(this._id, ").requestUrl change domain to ").concat(t._domain)),
                                  t.sFlvUrl = t.sFlvUrl.replace(i, "//" + t._domain + "/"),
                                  delete t.domainList),
                                  this._reportFlvFlow(),
                                  void this.startUrl(t)
                              }
                              this.eventEmitter.trigger(r.a.FLV_URL_UNAVAILABLE)
                          }
                      }, {
                          key: "setConfig",
                          value: function(t, e) {
                              o.a.setConfig(t, e)
                          }
                      }, {
                          key: "getConfig",
                          value: function(t) {
                              return o.a[t]
                          }
                      }, {
                          key: "setVolume",
                          value: function(t) {
                              this.mse.setVolume(t)
                          }
                      }, {
                          key: "setMuted",
                          value: function(t) {
                              this.mse.setMuted(t)
                          }
                      }, {
                          key: "getMuted",
                          value: function() {
                              return this.mse.getMuted()
                          }
                      }, {
                          key: "getBufferLen",
                          value: function() {
                              return this.mse && this.mse.getBufferLen ? this.mse.getBufferLen() : 0
                          }
                      }, {
                          key: "getFrameBufferLen",
                          value: function() {
                              return this.mse && this.mse.getFrameBufferLen ? this.mse.getFrameBufferLen() : 0
                          }
                      }, {
                          key: "getCurrentTime",
                          value: function() {
                              return this.mse.getCurrentRealTime()
                          }
                      }, {
                          key: "getCurrentDts",
                          value: function() {
                              return this.mse.getCurrentDts()
                          }
                      }, {
                          key: "getCurrentSeiOffsetDts",
                          value: function() {
                              return this.mse.getCurrentSeiOffsetDts()
                          }
                      }, {
                          key: "getDurationTime",
                          value: function() {
                              var t = (this.mse.video || {}).video
                                , e = 0;
                              return t && (e = Math.floor(t.duration || 0)),
                              e
                          }
                      }, {
                          key: "getVolumeEnergy",
                          value: function() {
                              var t = this.volumeCount > 5 ? 1 : 0;
                              return this.volumeCount = 0,
                              t
                          }
                      }, {
                          key: "getAnticodeHandler",
                          value: function() {
                              return this.anticode
                          }
                      }, {
                          key: "play",
                          value: function() {
                              this.mse.play()
                          }
                      }, {
                          key: "pause",
                          value: function() {
                              this.loader.close(),
                              this.mse && this.mse.pause(),
                              k.a.remove(this.onCheckTimer, this),
                              k.a.remove(this.onCheckFastTimer, this),
                              this.stopMetricTimer()
                          }
                      }, {
                          key: "setPlaybackrateAccess",
                          value: function(t) {
                              this.mse && this.mse.setPlaybackrateAccess(t)
                          }
                      }, {
                          key: "setAutoJitter",
                          value: function(t) {
                              this.mse.autoJitter = t
                          }
                      }, {
                          key: "setLoadFlvStatus",
                          value: function(t) {
                              t > this.loadFlvStatus && (this.loadFlvStatus = t)
                          }
                      }, {
                          key: "sendLoadVideoErrorStatus",
                          value: function() {
                              this.eventEmitter.tsdbUtil.sendMetrics([this.stat.createAct(f.METRIC.VIDEO_VIDEO_LOAD_ERROR, {
                                  value: [this.loadFlvStatus]
                              })])
                          }
                      }, {
                          key: "turnToH264",
                          value: function() {
                              this.stop(),
                              this.eventEmitter.trigger(r.a.TURN_TO_H264)
                          }
                      }, {
                          key: "h265Retry",
                          value: function() {
                              this.stop(),
                              this.eventEmitter.trigger(r.a.H265_VIDEO_RETRY)
                          }
                      }, {
                          key: "onHeader",
                          value: function(t) {
                              t.hasOwnProperty("cdncip") && this.stat.setComDim(d.a.DIM_COM.CDN_CIP, t.cdncip),
                              t.hasOwnProperty("cdnsip") && this.stat.setComDim(d.a.DIM_COM.CDN_SIP, t.cdnsip),
                              t.hasOwnProperty("alt-svc") && this.stat.setComDim(d.a.DIM_COM.ALT_SVC, t["alt-svc"]),
                              t.hasOwnProperty("x-hy-quic") && this.stat.setComDim(d.a.DIM_COM.QUIC, t["x-hy-quic"])
                          }
                      }, {
                          key: "onConnected",
                          value: function() {
                              E(Object(S.a)(i.prototype), "onConnected", this).call(this),
                              this.connectTime = c.a.now(),
                              l.a.log("%c[TIME] FlvPlayer(".concat(this._id, ").onConnected connectTime=") + (this.connectTime - this.startTs), "color:#A23400;background:#FFF5C2"),
                              this.setLoadFlvStatus(C.a.LoadVideoTimeoutReason.FLV_CONNECTED),
                              this.exceptionStat.setStat(d.a.DIM_LINK_STA.CONNECT_SUC, 1)
                          }
                      }, {
                          key: "onClosed",
                          value: function() {
                              this.eventEmitter.trigger(r.a.VIDEO_LINK_CLOSE, {
                                  video: this.mse.getPlayVideo()
                              })
                          }
                      }, {
                          key: "onError",
                          value: function() {
                              this.eventEmitter.trigger(r.a.ANCHOR_STOP, {
                                  video: this.mse.getPlayVideo()
                              })
                          }
                      }, {
                          key: "onData",
                          value: function(t, e) {
                              0 == this.firstPkgTime && (this.firstPkgTime = c.a.now()),
                              this.exceptionStat.setStat(d.a.DIM_LINK_STA.HAS_DATA, 1);
                              var i = new Uint8Array(t);
                              this.flowSize += i.byteLength,
                              this.addBytes(i.byteLength),
                              this.recvDataEnough || (this.flvDataSize += i.byteLength,
                              this.flvDataSize > 1e6 && (this.setLoadFlvStatus(C.a.LoadVideoTimeoutReason.FLV_DATA_INVALID),
                              this.recvDataEnough = !0)),
                              1 === e ? this.stat.addCore(d.a.CORE.CDN_TOTAL_BW, i.byteLength) : this.stat.addCore(d.a.CORE.PCDN_TOTAL_BW, i.byteLength),
                              this.mse.appendFlv(i);
                              var s = c.a.now();
                              0 == this.recvTime && (l.a.log("%c[TIME] FlvPlayer(".concat(this._id, ").onData firstPkgTime=") + (s - this.connectTime), "color:#A23400;background:#FFF5C2"),
                              this.setLoadFlvStatus(C.a.LoadVideoTimeoutReason.FLV_RECV_DATA)),
                              this.recvTime = s
                          }
                      }, {
                          key: "getMse",
                          value: function() {
                              return this.mse
                          }
                      }, {
                          key: "onPlayVideo",
                          value: function(t, e, s, a, n, o, h) {
                              E(Object(S.a)(i.prototype), "onPlayVideo", this).call(this, t, e, s, a, n, o, h),
                              this.stat.setComDim(d.a.DIM_COM.DPI, e + "*" + s);
                              var u = c.a.now();
                              l.a.log("FlvPlayer(".concat(this._id, ").onStartVideo loadeddata=").concat(u)),
                              this.loadTime = u - this.startTs,
                              this.newLoadTime = u - this.eventEmitter.startTs,
                              this.waitRemuxTime = 0,
                              this.mse && this.mse.parser && 0 != this.mse.parser.waitRemuxTime && (this.waitRemuxTime = this.mse.parser.waitRemuxTime);
                              var p = this.connectTime - this.startTs
                                , f = this.recvDataTime - this.startTs
                                , _ = this.mse.pushVideoStartRenderTime - this.startTs
                                , m = this.UIStartCost > 0 ? this.loadTime + this.UIStartCost : 0
                                , v = 0;
                              this.startTimeStamp > 1 ? v = this.loadTime + this.businessStartCost : 1 === this.startTimeStamp && (v = this.loadTime);
                              var y = this.firstPkgTime - this.startTs
                                , T = 0;
                              0 != this.mse.parser.decodeIFRTime && (T = this.mse.parser.decodeIFRTime - this.startTs),
                              l.a.log("%cFlvPlayer(".concat(this._id, ").onPlayVideo loadTime=") + this.loadTime + "  businessStartCost=" + this.businessStartCost + "  UIStartCost=" + this.UIStartCost, "color:#A23400;background:#FFF5C2"),
                              l.a.log("%cFlvPlayer(".concat(this._id, ").onPlayVideo newLoadTime=") + this.newLoadTime, "color:#A23400;background:#FFF5C2"),
                              this.tsdb.sendFlvTime(this.newLoadTime, p, f, _, null != this.videoElement, v, m, this.waitRemuxTime, y, T);
                              var g = {
                                  video: t,
                                  width: e,
                                  height: s,
                                  loadTime: this.loadTime,
                                  connectTime: p,
                                  recvDataTime: f,
                                  pushVideoTime: _,
                                  canvas: n,
                                  videoCodec: h,
                                  delayRemove: this.info._delayRemove
                              };
                              this.info._delayRemove = !1,
                              this.eventEmitter.trigger(r.a.VIDEO_PLAY, g),
                              this.updateStatus(r.b.VIDEO_PLAYING),
                              this.setLoadFlvStatus(C.a.LoadVideoTimeoutReason.FLV_STARTPLAY),
                              this.eventEmitter.onPlayVideo && this.eventEmitter.onPlayVideo(t)
                          }
                      }, {
                          key: "onAudioFrequency",
                          value: function(t) {
                              t.value && this.volumeCount++
                          }
                      }, {
                          key: "onVideoStop",
                          value: function(t, e) {
                              l.a.log("FlvPlayer(".concat(this._id, ").onVideoStop hasVideo=") + e),
                              e && this.updateStatus(r.b.VIDEO_STOP),
                              this.eventEmitter.trigger(r.a.VIDEO_STOP, {
                                  video: t,
                                  hasVideo: e
                              })
                          }
                      }, {
                          key: "onSendSeiData",
                          value: function(t, e, i) {
                              this.eventEmitter.trigger(r.a.H264_SEI_PLAY, {
                                  data: t,
                                  ts: e,
                                  now: (new Date).getTime(),
                                  vt: i
                              })
                          }
                      }, {
                          key: "onSendScriptVolumeInfo",
                          value: function(t, e) {
                              Number(localStorage._printAudioIntensity) && l.a.log("FlvPlayer(".concat(this._id, ").onSendScriptVolumeInfo uid:") + t + "  intensity:" + e),
                              this.eventEmitter.trigger(r.a.UPDATE_INTERSITY, {
                                  uid: t,
                                  intensity: e
                              })
                          }
                      }, {
                          key: "onLoadError",
                          value: function(t) {
                              this.eventEmitter.trigger(r.a.FLV_URL_UNAVAILABLE, {
                                  msg: t
                              }),
                              this.setLoadFlvStatus(C.a.LoadVideoTimeoutReason.FLV_CONNECT_ERROR)
                          }
                      }, {
                          key: "onVideoParseInvalid",
                          value: function() {
                              this.setLoadFlvStatus(C.a.LoadVideoTimeoutReason.FLV_DATA_INVALID)
                          }
                      }, {
                          key: "onLoadTimeout",
                          value: function() {
                              this.eventEmitter.trigger(r.a.FLV_URL_LOAD_TIMEOUT)
                          }
                      }, {
                          key: "onPlayerError",
                          value: function(t) {}
                      }, {
                          key: "onErrorEvent",
                          value: function(t) {
                              E(Object(S.a)(i.prototype), "onErrorEvent", this).call(this, t),
                              this.eventEmitter && this.eventEmitter.lastP2PInfo ? this.getRecSysRsp({
                                  info: this.info,
                                  type: "flv",
                                  metadata: this.mse.metadata,
                                  isFlvError: !0
                              }) : this.eventEmitter.trigger(r.a.H5_PLAYER_ERROR, {
                                  code: t.type,
                                  msg: "播放错误"
                              })
                          }
                      }, {
                          key: "onPlayPause",
                          value: function(t, e) {
                              this.startSendPauseTimer(),
                              E(Object(S.a)(i.prototype), "onPlayPause", this).call(this, t, e)
                          }
                      }, {
                          key: "onPlayResume",
                          value: function(t, e) {
                              this.stopSendPauseTimer(),
                              E(Object(S.a)(i.prototype), "onPlayResume", this).call(this, t, e)
                          }
                      }, {
                          key: "sendPauseEvent",
                          value: function() {
                              this.eventEmitter.trigger(r.a.PLAY_CARTON)
                          }
                      }, {
                          key: "startMetricTimer",
                          value: function(t) {
                              clearTimeout(this.sendMetricTimer),
                              this.sendMetricTimer = setTimeout(this.heartBeat20sMetric.bind(this), t)
                          }
                      }, {
                          key: "stopMetricTimer",
                          value: function() {
                              this.sendMetricTimes = 0,
                              clearTimeout(this.sendMetricTimer)
                          }
                      }, {
                          key: "setAudioUtil",
                          value: function(t) {
                              this.audiouitil = t,
                              this.audiouitil.removeAllListeners([ae.AUDIO_FREQUENCY]),
                              this.audiouitil.createAudioContext(this.mse.video),
                              this.audiouitil.on(ae.AUDIO_FREQUENCY, this.onAudioFrequency.bind(this))
                          }
                      }, {
                          key: "startSendPauseTimer",
                          value: function() {
                              this.stopSendPauseTimer(),
                              this.sendPauseTimeout = setTimeout(this.sendPauseEvent.bind(this), 200)
                          }
                      }, {
                          key: "stopSendPauseTimer",
                          value: function() {
                              clearTimeout(this.sendPauseTimeout)
                          }
                      }, {
                          key: "heartBeat20sMetric",
                          value: function() {
                              var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 2e4
                                , e = c.a.now();
                              if (l.a.log("FlvPlayer(".concat(this._id, ").heartBeat20sMetric ")),
                              this.sendMetricTimes++,
                              this._checkPaused(e, rs),
                              this.qaStat) {
                                  0 == this.pauseTime && (this.pauseReason = 0);
                                  var i = this.pauseStartTs > 0;
                                  this.qaStat.record(this.pauseCnt, this.pauseTime, i, this.flowSize, this.pauseReason, this.getVolumeEnergy())
                              }
                              this.pauseStartTs > 0 && this.autoMonitor.setPause(this.pauseStartTs, this.getBufferLen()),
                              this.pauseCnt = 0,
                              this.pauseTime = 0,
                              this.pauseReason = 0,
                              this.flowSize = 0,
                              this.sendMetricTimes % 15 == 0 && (this.tsdb.sendMetrics([{
                                  sMetricName: f.METRIC.VIDEO_VIDEO_BAD_QUALITY_5M_RATIO,
                                  vField: {
                                      value: this.pauseCnt5 > 0 ? 100 : 0
                                  }
                              }]),
                              this.pauseCnt5 = 0,
                              this.pauseTime5 = 0),
                              t > 0 && this.startMetricTimer(t)
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              if (this.started) {
                                  if (this.connected && this.recvTime > 0 && t - this.recvTime > 8e3) {
                                      var i = this.getBufferLen();
                                      return l.a.warn("FlvPlayer(".concat(this._id, ").onCheckTimer no data received ") + (t - this.recvTime) + " buffLen=" + i),
                                      void this.eventEmitter.trigger(r.a.NO_DATA_RECEIVED)
                                  }
                                  if (this.anticode.onCheckTimer(t, e),
                                  this.loader.onCheckTimer(t, e),
                                  this.mse && this.mse.onCheckTimer(t, e),
                                  this.metadataTick.onCheckTimer(t, e),
                                  this.connected) {
                                      null == this.videoElement && (0 === this.heart20Ts ? this.heart20Ts = t : t - this.heart20Ts >= 2e4 && (this.heartBeat20sMetric(0),
                                      this.heart20Ts = t));
                                      try {
                                          this.eventEmitter.trigger(r.a.PLAY_DOWNLINK_INFO, {
                                              buffer: this.getBufferLen() / 1e3,
                                              downLinkSpeed: 0 | this.loader.speed,
                                              videoBufferEnd: this.mse.video.video.buffered.end(this.mse.video.video.buffered.length - 1)
                                          })
                                      } catch (t) {
                                          l.a.log("FlvPlayer(".concat(this._id, ").onCheckTimer cannot get down link info"))
                                      }
                                      this.backToP2P.onCheckTimer(t, e),
                                      this.eventEmitter.trigger(r.a.PLAY_FRAME_BUFFER, {
                                          frameStorage: this.mse.getFrameReadyed(),
                                          jitterBuffer: this.mse.getBufferLen(),
                                          playdelay: this.mse.getFramePlayDelays()
                                      })
                                  }
                              }
                          }
                      }, {
                          key: "onCheckFastTimer",
                          value: function(t, e) {
                              this.started && (this.mse.onCheckFastTimer(t, e),
                              this.backToP2P.onCheckFastTimer(t, e),
                              this.loader.onCheckFastTimer(t, e),
                              !this.pauseCheckLock && this.pauseStartTs > 0 && t - this.pauseStartTs > 200 && (this.pauseCheckLock = !0,
                              this.pauseCheck(t)))
                          }
                      }, {
                          key: "_reportFlvFlow",
                          value: function() {
                              this.qaStat && (this._checkPaused(c.a.now(), "stop"),
                              this.qaStat.sendFlow(this.pauseCnt, this.pauseTime, this.pauseStartTs, this.flowSize, this.pauseReason, this.getVolumeEnergy(), !0),
                              this.pauseCnt = 0,
                              this.pauseTime = 0,
                              this.pauseReason = 0,
                              this.flowSize = 0)
                          }
                      }, {
                          key: "pauseCheck",
                          value: function(t) {
                              if (this.started) {
                                  var e = 0
                                    , i = this.info.curBitrate / 8 - 10
                                    , s = this.loader.speed / 1024 | 0;
                                  e = s > 0 && s < i ? C.a.pauseReason.FLV_NET_SLOW : C.a.pauseReason.FLV_NO_BUFF,
                                  this.recvTime > 0 && t - this.recvTime > 2e3 && (e = C.a.pauseReason.FLV_NO_DATA);
                                  var a = this.getBufferLen();
                                  a > 1e3 && (e = C.a.pauseReason.FLV_UNKNOW_PAUSE),
                                  e > this.pauseReason && (this.pauseReason = e),
                                  l.a.warn("FlvPlayer(".concat(this._id, ").pauseCheck curReason=").concat(e, " reportReason=").concat(this.pauseReason, " buffLen=").concat(a))
                              }
                          }
                      }, {
                          key: "connected",
                          get: function() {
                              return this.loader.connected
                          }
                      }, {
                          key: "isPlaying",
                          get: function() {
                              return this.videoStatus !== r.b.VIDEO_STOP
                          }
                      }, {
                          key: "hasPicture",
                          get: function() {
                              var t = this.isPlaying && 0 !== this.mse.getCurrentTime();
                              return this.h265Proxy.rendering && (t = t && this.isH265Playing),
                              t
                          }
                      }]),
                      i
                  }(os)
                    , us = i(15);
                  function ls(t, e) {
                      for (var i = 0; i < t.length; i++) {
                          var s = t[i];
                          s.length < e && (s += " ".repeat(e - s.length),
                          t[i] = s)
                      }
                      return t.join("\n")
                  }
                  var cs = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.version = 1019,
                          this.BASE_SUBS = 10,
                          this.presenterUid = 0,
                          this.uid = 0,
                          this.uuid = 0,
                          this.convertUid = 0,
                          this.appId = 66,
                          this.appid = 66;
                          var e = Number(localStorage.appid);
                          e && (this.appid = e,
                          l.a.warn("--- test appid " + e + " ---", this)),
                          this.sid = 0,
                          this.subSid = 0,
                          this.lineType = -1,
                          this.bitrate = 0,
                          this.curBitrate = 0,
                          this.originalBitrate = 0,
                          this.userAbility = null,
                          this.isStartFromUrl = !1,
                          this.streamId = null,
                          this.streamSeqSN = 0,
                          this.quickAccessBeginIndex = 0,
                          this.quickAccessEndIndex = 0,
                          this.exip = 0,
                          this.sslUrl = "",
                          this.myIp = "",
                          this.quickTime = 0,
                          this.urlTokenTime = 0,
                          this.urlToken = "",
                          this.wsTime = "",
                          this.videoNtp = new K,
                          this.stampcSvr = 0,
                          this.stampcNow = 0,
                          this.wanIp = "",
                          this.wanPort = 0,
                          this.cdnpConnected = 0,
                          this.proxyIp = "",
                          this.cdnpIp = 0,
                          this.stunPorts = [],
                          this.enableFeatures = 0,
                          this.cdnpip = 0,
                          this.firstLogin = !0,
                          this.loaderMgr = null,
                          this.p2pMgr = null,
                          this.globalSpeedCalc = new y(20),
                          this.initTafTime = 0,
                          this.reqVpTime = 0,
                          this.getVPTime = 0,
                          this.startTime = 0,
                          this.connectVideoTime = 0,
                          this.firstVideoPkgTime = 0,
                          this.firstIFrameTime1 = 0,
                          this.firstIFrameTime2 = 0,
                          this.firstRenderTime = 0,
                          this.recvDataTime = 0,
                          this.onPlayTime = 0,
                          this.loadedDataTs = 0,
                          this.hyPlayerLoadTs = 0,
                          this.firstP2POnDataTime = 0,
                          this.firstP2PIframeTime = 0
                      }
                      return Object(a.a)(t, [{
                          key: "initUid",
                          value: function(t) {
                              this.uuid = t,
                              this.convertUid = v.b.rotUid(this.uid, this.presenterUid),
                              l.a.log("Global.initUid uid=".concat(this.uid, " uuid=").concat(this.uuid, " convertUid=").concat(this.convertUid))
                          }
                      }, {
                          key: "getServTime",
                          value: function(t) {
                              if (0 == this.stampcSvr)
                                  return 0;
                              var e = t || c.a.now();
                              return this.stampcSvr + (e - this.stampcNow)
                          }
                      }, {
                          key: "initUseTime",
                          value: function(t) {
                              l.a.log("initUseTime", t),
                              this.startTime = t,
                              this.getLivingInfoTime = 0,
                              this.connectVideoTime = 0,
                              this.firstVideoPkgTime = 0,
                              this.firstAudioPkgTime = 0,
                              this.firstIFrameTime1 = 0,
                              this.firstIFrameTime2 = 0,
                              this.firstRenderTime = 0,
                              this.recvDataTime = 0,
                              this.onPlayTime = 0,
                              this.loadedDataTs = 0,
                              this.hyPlayerLoadTs = 0,
                              this.firstP2POnDataTime = 0,
                              this.firstP2PIframeTime = 0
                          }
                      }, {
                          key: "printUseTime",
                          value: function() {
                              var t = ["\n%c" + ".".repeat(28), " getLivingInfoTime    = " + Math.max(0, this.getLivingInfoTime - this.startTime), " connectVideoTime     = " + (this.connectVideoTime - this.startTime)];
                              this.firstVideoPkgTime > 0 ? t.push(" firstVideoPkgTime    = " + (this.firstVideoPkgTime - this.connectVideoTime), " firstIFrameTime1     = " + (this.firstIFrameTime1 - this.connectVideoTime), " firstIFrameTime2     = " + (this.firstIFrameTime2 - this.firstIFrameTime1), " firstRenderTime      = " + (this.firstRenderTime - this.firstIFrameTime2)) : t.push(" firstAudioPkgTime    = " + (this.firstAudioPkgTime - this.connectVideoTime), " firstRenderTime      = " + (this.firstRenderTime - this.firstAudioPkgTime)),
                              t.push(" onPlayTime           = " + (this.onPlayTime - this.firstRenderTime), " totalTime            = " + (this.onPlayTime - this.startTime), ".".repeat(28));
                              var e = ls(t, 28);
                              l.a.log(e, "color:#007500;background:#FFF5C2")
                          }
                      }, {
                          key: "printVpTime",
                          value: function() {
                              if (!this.printVpTime.done) {
                                  this.printVpTime.done = !0;
                                  var t = ls(["\n%c" + ".".repeat(28), " initTafTime      = " + (this.initTafTime - 0), " getVPTime        = " + (this.getVPTime - this.reqVpTime), " connectVpTime    = " + (this.connectVpTime - this.getVPTime), " loginTime        = " + (this.loginTime - this.connectVpTime), " totalTime        = " + (this.loginTime - this.reqVpTime), ".".repeat(28)], 28);
                                  l.a.log(t, "color:#007500;background:#FFF5C2")
                              }
                          }
                      }]),
                      t
                  }()
                    , ds = i(36)
                    , ps = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.loaderHandler = e,
                          this._destroy = !1,
                          this.reset()
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              this.u8arr = new Uint8Array(0)
                          }
                      }, {
                          key: "destroy",
                          value: function() {
                              l.a.log("SliceHandler.destroy"),
                              this.u8arr = null,
                              this._destroy = !0,
                              this.loaderHandler = null
                          }
                      }, {
                          key: "onData",
                          value: function(t) {
                              var e = this.u8arr
                                , i = new Uint8Array(t);
                              0 === e.length ? this.u8arr = i : (this.u8arr = new Uint8Array(e.length + i.length),
                              this.u8arr.set(e, 0),
                              this.u8arr.set(i, e.length));
                              var s = this.onProto(this.u8arr);
                              s > 0 && !this._destroy && (this.u8arr = this.u8arr.slice(s))
                          }
                      }, {
                          key: "onProto",
                          value: function(t) {
                              for (var e, i, s, a, r, n = new DataView(t.buffer), o = 0, h = 0; o + 10 < t.byteLength && !this._destroy; ) {
                                  if ((h = n.getUint16(o + 8, !0)) < 10)
                                      return this.loaderHandler.onProtoError(h),
                                      o;
                                  if (o + h > t.byteLength)
                                      return o;
                                  s = n.getUint32(o, !0),
                                  a = 4294967296 * n.getUint32(o + 4, !0) + s,
                                  r = n.getUint32(o + 14, !0),
                                  i = t.slice(o + 10, o + h),
                                  (e = new ds.default).seq = a,
                                  e.uri = r,
                                  e.payload = i,
                                  this.loaderHandler && this.loaderHandler.onSlice(j.a.PP2pSliceData, e),
                                  o += h
                              }
                              return o
                          }
                      }]),
                      t
                  }()
                    , fs = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.loaderMgr = e,
                          this.p2pPlayer = e.p2pPlayer,
                          this.tsdbUtil = e.p2pPlayer.tsdb,
                          this.stat = e.p2pPlayer.stat,
                          this.type = t.TYPE_FULL,
                          this.sliceHandler = new ps(this),
                          this.url = null,
                          this.lineType = -1,
                          this.started = !1,
                          this.status = 0,
                          this.connecting = !1,
                          this.connectTotalTs = 0,
                          this.flowRetryTimes = 0,
                          this.lastSeq = 0,
                          this.connectTs = 0,
                          this.connectedTs = 0,
                          this.firstPkgTs = 0,
                          this.reportUrl = null,
                          this.sliceTs = 0,
                          this.sliceStamp = 0,
                          this.tcpStamp = 0,
                          this.logMark = "FullStream",
                          this.logMarkCss = "color:#01814A;background:#FFF5C2;font-weight:bold;",
                          this.ConnectTotalTime = Number(o.a.connectTotalTime),
                          this.ConnectTimeout = Number(o.a.connectTimeout),
                          this.FlowTimeout = Number(o.a.flowTimeout),
                          this.FlowRetryTimes = Number(o.a.flowRetryTimes),
                          this.RenderTimeout = Number(o.a.renderTimeout),
                          this.NoDataTimeout = Number(o.a.noDataTimeout)
                      }
                      return Object(a.a)(t, [{
                          key: "onSlice",
                          value: function(t, e) {
                              var i = e.seq;
                              0 === this.lastSeq && l.a.log("VideoLoader.onFirstSeq", this.getLoaderInfo(), "seq", i),
                              this.lastSeq > 0 && Math.abs(i - this.lastSeq) > 1 && l.a.warn("VideoLoader seq discontinuous, lastSeq=" + this.lastSeq + " curSeq=" + i + " jump=" + (i - this.lastSeq)),
                              this.lastSeq = i,
                              e.from = this.type,
                              this.p2pPlayer.sliceProtoHandler.onSlice(e)
                          }
                      }, {
                          key: "onProtoError",
                          value: function(t) {
                              l.a.error("SliceHandler.onProto length error pktLen=" + t + ", smaller than 10 bytes.", this.getLoaderInfo())
                          }
                      }, {
                          key: "getLoaderInfo",
                          value: function() {
                              var t = "bufLen=" + this.p2pPlayer.bufferLen;
                              return "type=".concat(this.type, " line=").concat(this.lineType, " ").concat(t)
                          }
                      }, {
                          key: "resetReport",
                          value: function() {
                              this.sliceStamp = 0,
                              this.tcpStamp = 0
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              this.sliceHandler && (this.sliceHandler.destroy(),
                              this.sliceHandler = null),
                              this.sliceHandler = new ps(this),
                              this.status = 0,
                              this.lastSeq = 0,
                              this.connecting = !1,
                              this.connectTs = 0,
                              this.connectedTs = 0,
                              this.firstPkgTs = 0,
                              this.sliceTs = 0,
                              this.resetReport(),
                              k.a.remove(this.onCheckTimer, this),
                              k.a.remove(this.onConnectTimeout, this),
                              k.a.remove(this.onFirstDataTimeout, this),
                              k.a.remove(this.onRenderTimeout, this),
                              this.link && this.link.destroy(),
                              this.url && this.url.startsWith("http") ? _.a.firefox && _i.isSupported() ? this.link = new _i(this) : this.link = new mi(this) : this.link = new fi(this,!1)
                          }
                      }, {
                          key: "connect",
                          value: function(t, e) {
                              this.url = t,
                              this.lineType = e,
                              this.reset();
                              var i = c.a.now();
                              this.connectTs = i,
                              this.tcpStamp = i;
                              var s = t
                                , a = this.p2pPlayer.G;
                              if (!a.isStartFromUrl) {
                                  var r = o.a.platform
                                    , n = C.a.PLATFORM_TYPE[r] || C.a.PLATFORM_TYPE.web
                                    , h = r === C.a.PLATFORM_TYPE_NAME.wap ? "&uid=".concat(a.uid, "&uuid=").concat(a.uuid) : "&u=".concat(a.convertUid);
                                  s += "&timeStamp=" + c.a.getDateTimeStr().replace(" ", "_"),
                                  s += "".concat(h, "&t=").concat(n, "&sv=").concat(2202140215),
                                  a.myIp && (s += "&myIp=" + a.myIp)
                              }
                              l.a.log("%c".concat(this.logMark), this.logMarkCss, "".concat(s, " ").concat(this.getLoaderInfo())),
                              this.connecting = !0,
                              this.link.connect(s),
                              this.stat.setComDim(d.a.DIM_COM.STREAM_URL, s),
                              this.started = !0,
                              k.a.add(this.onCheckTimer, this, 1e3),
                              k.a.once(this.onConnectTimeout, this, this.ConnectTimeout)
                          }
                      }, {
                          key: "reconnect",
                          value: function() {
                              if (null != this.url && -1 !== this.lineType) {
                                  var t = this.loaderMgr.antiCode;
                                  t && -1 === this.url.indexOf(t) && (this.url = this.url.replace(/(wsSecret=.+?&wsTime=.+?)(\&|$)/, t + "$2"));
                                  var e = this.p2pPlayer.info;
                                  if (e) {
                                      var i = new RegExp("//(.*?)" + e._domain + "/")
                                        , s = this.p2pPlayer.changeDomain();
                                      this.url = s ? this.url.replace(i, "//" + s + "/" + e._domain + "/") : this.url.replace(i, "//" + e._domain + "/")
                                  }
                                  l.a.log("VideoLoader.reconnect"),
                                  this.close(),
                                  this.connect(this.url, this.lineType)
                              } else
                                  l.a.error("VideoLoader.reconnect url=".concat(this.url, " line=").concat(this.lineType))
                          }
                      }, {
                          key: "close",
                          value: function() {
                              this.reset(),
                              this.started = !1
                          }
                      }, {
                          key: "onopen",
                          value: function() {
                              var t = c.a.now();
                              this.connectedTs = t;
                              var e = this.connectedTs - this.connectTs;
                              l.a.log("VideoLoader.onopen ".concat(this.getLoaderInfo(), " cost time=").concat(e));
                              var i = this.p2pPlayer.G;
                              0 === i.connectVideoTime && (i.connectVideoTime = t,
                              l.a.log("%c[TIME] connectVideoTime=" + (i.connectVideoTime - i.startTime) + " totalTime=" + (t - i.startTime), "color:#A23400;background:#FFF5C2")),
                              this.connecting = !1,
                              this._reportTcp(),
                              this.p2pPlayer.exceptionStat.setStat(d.a.DIM_LINK_STA.CONNECT_SUC, 1),
                              k.a.remove(this.onConnectTimeout, this),
                              k.a.once(this.onFirstDataTimeout, this, this.FlowTimeout),
                              this.loaderMgr.onConnected()
                          }
                      }, {
                          key: "_onclose",
                          value: function() {
                              this.connecting = !1,
                              this.resetReport(),
                              this.sliceTs > 0 ? this.getProxy("onclose") : this.connectedTs > 0 ? this.onFirstDataTimeout() : k.a.once(this.onConnectTimeout, this, 1e3),
                              this.p2pPlayer.exceptionStat.setStat(d.a.DIM_LINK_STA.CONNECT_SUC, 0)
                          }
                      }, {
                          key: "onclose",
                          value: function() {
                              l.a.log("VideoLoader.onclose ".concat(this.getLoaderInfo())),
                              this._onclose()
                          }
                      }, {
                          key: "onerror",
                          value: function(t, e) {
                              l.a.log("VideoLoader.onerror ".concat(this.getLoaderInfo())),
                              404 !== e && 403 !== e || (this.tsdbUtil.httpError = !0,
                              this.tsdbUtil.sendMetrics([this.stat.createAct(d.a.ACT.HTTP_CODE_ + e, {
                                  value: [this.type]
                              })])),
                              this._onclose()
                          }
                      }, {
                          key: "onstatus",
                          value: function(t) {
                              this.status = t
                          }
                      }, {
                          key: "onConnectTimeout",
                          value: function() {
                              this.connectedTs > 0 || (this._reportStat(1),
                              this.connectTotalTs += c.a.now() - this.connectTs,
                              l.a.warn("VideoLoader.onConnectTimeout connectTotalTs=".concat(this.connectTotalTs, "/").concat(this.ConnectTotalTime, " ").concat(this.getLoaderInfo())),
                              this.connectTotalTs < this.ConnectTotalTime ? this.reconnect() : this.p2pPlayer.turnToFlv(C.a.turnToFlvReason.FULL_CONNECT_TIMEOUT),
                              this.p2pPlayer.loaderErrorTimes++)
                          }
                      }, {
                          key: "onFirstDataTimeout",
                          value: function() {
                              if (!(this.sliceTs > 0)) {
                                  var t = c.a.now();
                                  l.a.warn("VideoLoader.onFirstDataTimeout", t - this.connectedTs),
                                  this.p2pPlayer.isEverSuccessPlayed && this.flowRetryTimes++ < this.FlowRetryTimes ? this.reconnect() : this.p2pPlayer.turnToFlv(C.a.turnToFlvReason.FULL_NO_DATA),
                                  this.p2pPlayer.loaderErrorTimes++
                              }
                          }
                      }, {
                          key: "onRenderTimeout",
                          value: function() {
                              this.sliceTs > 0 && this.p2pPlayer.onRenderTimeout()
                          }
                      }, {
                          key: "_reportStat",
                          value: function(t) {
                              this.stat.addComp(d.a.P2P_TCP_TYPE.name, d.a.K + this.type, 1),
                              this.stat.addComp(d.a.P2P_TCP_STATE.name, d.a.K + t, 1)
                          }
                      }, {
                          key: "_reportNoSlice",
                          value: function(t) {
                              if (0 !== this.sliceStamp && t - this.sliceStamp > 2500 && this.url) {
                                  this.p2pPlayer.exceptionStat.setStat(d.a.DIM_LINK_STA.NO_SLICE_DATA, 1);
                                  var e = this.p2pPlayer.G;
                                  this.tsdbUtil.sendMetrics([this.stat.createAct(d.a.ACT.TCP_NO_SLICE, {
                                      value: [this.type],
                                      str: [e.wanIp]
                                  })]),
                                  this.sliceStamp = 0
                              }
                          }
                      }, {
                          key: "_reportNoHeader",
                          value: function() {
                              this.url && this.reportUrl !== this.url && (this.reportUrl = this.url)
                          }
                      }, {
                          key: "_reportTcp",
                          value: function() {
                              var t = this.p2pPlayer.G
                                , e = c.a.now() - this.tcpStamp;
                              this.tcpStamp > 0 && e > 1e3 && this.url && e < 1e4 && this.tsdbUtil.sendMetrics([this.stat.createAct(d.a.ACT.TCP_OPEN_TIME, {
                                  value: [this.type, e],
                                  str: [t.wanIp]
                              })]),
                              this.tcpStamp = 0
                          }
                      }, {
                          key: "onData",
                          value: function(t) {
                              if (1 != localStorage._testNodata) {
                                  this.p2pPlayer.G.globalSpeedCalc.addCur(t.byteLength),
                                  this.p2pPlayer.addBytes(t.byteLength);
                                  var e = c.a.now();
                                  if (this.sliceTs = e,
                                  this.sliceStamp = e,
                                  0 === this.firstPkgTs) {
                                      this.firstPkgTs = e;
                                      var i = this.firstPkgTs - this.connectedTs
                                        , s = v.b.formatByteSize(t.byteLength);
                                      l.a.log("VideoLoader.onData ".concat(this.getLoaderInfo(), " firstPkgTs=").concat(i, " size=").concat(s)),
                                      k.a.remove(this.onFirstDataTimeout, this),
                                      k.a.once(this.onRenderTimeout, this, this.RenderTimeout),
                                      this.connectTotalTs = 0,
                                      this.flowRetryTimes = 0
                                  }
                                  this.link instanceof fi ? this.sliceHandler.onProto(new Uint8Array(t)) : this.sliceHandler.onData(t),
                                  this.p2pPlayer.exceptionStat.setStat(d.a.DIM_LINK_STA.HAS_DATA, 1)
                              }
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              this.started && (this._reportNoSlice(t),
                              this.sliceTs > 0 && t - this.sliceTs >= this.NoDataTimeout && this.getProxy("noDataTime=" + (t - this.sliceTs)))
                          }
                      }, {
                          key: "getProxy",
                          value: function(t) {
                              l.a.log("VideoLoader.getProxy ".concat(t, " ").concat(this.getLoaderInfo())),
                              this._reportNoHeader(),
                              this.reset(),
                              this.p2pPlayer.loaderErrorTimes++,
                              this.p2pPlayer.onRestart(C.a.restartReason.CONNECT)
                          }
                      }, {
                          key: "connected",
                          get: function() {
                              return this.link && this.link.connected
                          }
                      }, {
                          key: "speed",
                          get: function() {
                              var t = this.link.speed;
                              return t == v.b.UintMax && (t = 0),
                              t
                          }
                      }]),
                      t
                  }();
                  fs.TYPE_FULL = 1,
                  fs.TYPE_SUB = 2,
                  fs.TYPE_RANGE = 3,
                  fs.TYPE_PATCH = 4;
                  var _s = fs
                    , ms = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.p2pPlayer = e,
                          this.resetProperty(),
                          this.fullLoader = new _s(this)
                      }
                      return Object(a.a)(t, [{
                          key: "init",
                          value: function(t, e) {
                              this.p2pUrl = t,
                              this.antiCode = e;
                              var i = this.p2pPlayer.G;
                              if (!i.isStartFromUrl) {
                                  "/" === this.p2pUrl.substr(-1) && (this.p2pUrl = this.p2pUrl.substr(0, this.p2pUrl.length - 1)),
                                  this.p2pUrl = this.p2pUrl.replace(/^(http|ws)s?\:/i, ""),
                                  this.streamName = i.streamId.text() + "_" + z.a.appid;
                                  var s = !0;
                                  if (-1 === self.location.protocol.indexOf("https")) {
                                      var a = o.a.p2pWssLines;
                                      "string" == typeof a && (s = "all" == (a = a.toLowerCase()) || -1 != a.split(",").indexOf(i.lineType.toString()))
                                  } else
                                      s = !0;
                                  void 0 === localStorage._testSSL ? this.openWss = s : this.openWss = Number(localStorage._testSSL) > 0
                              }
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              l.a.log("LoaderMgr.stop"),
                              this.stopFullStream(),
                              this.resetProperty()
                          }
                      }, {
                          key: "resetProperty",
                          value: function() {
                              this.p2pUrl = null,
                              this.antiCode = "",
                              this.streamName = "",
                              this.openWss = !0
                          }
                      }, {
                          key: "getUrl",
                          value: function(t) {
                              var e = t === _s.TYPE_RANGE || t === _s.TYPE_FULL && !Xt.isMacChrome72() ? "http" : "ws";
                              this.openWss && (e += "s");
                              var i = ""
                                , s = this.p2pPlayer.G;
                              return this.p2pUrl.match(/al\.p2p\.huya\.com/) && t != _s.TYPE_RANGE && t != _s.TYPE_FULL && (i = "/websocket"),
                              this.url = "".concat(e, ":").concat(this.p2pUrl).concat(i, "/").concat(this.streamName, ".slice?").concat(this.antiCode, "&ex1=").concat(s.exip, "&baseIndex="),
                              this.url
                          }
                      }, {
                          key: "loadFullStream",
                          value: function(t, e, i) {
                              var s = this.p2pPlayer.G;
                              isNaN(t) && (l.a.error("LoaderMgr.loadSubStream baseIndex isNaN [" + t + "] change to 0."),
                              t = 0);
                              var a = this.getUrl(_s.TYPE_FULL) + t;
                              i ? a += "&startPts=".concat(i) : 0 === t && s.quickTime > 0 && (a += "&quickTime=".concat(s.quickTime)),
                              this.url = a,
                              this.fullLoader.connect(a, s.lineType)
                          }
                      }, {
                          key: "stopFullStream",
                          value: function() {
                              this.fullLoader.close()
                          }
                      }, {
                          key: "onConnected",
                          value: function() {
                              this.p2pPlayer.onConnected()
                          }
                      }]),
                      t
                  }()
                    , vs = function() {
                      function t() {
                          Object(s.a)(this, t)
                      }
                      return Object(a.a)(t, null, [{
                          key: "getFlvHeader",
                          value: function() {
                              var t = new Uint8Array(13)
                                , e = 0;
                              return t[e++] = 70,
                              t[e++] = 76,
                              t[e++] = 86,
                              t[e++] = 1,
                              t[e++] = 5,
                              t[e++] = 0,
                              t[e++] = 0,
                              t[e++] = 0,
                              t[e++] = 9,
                              t[e++] = 0,
                              t[e++] = 0,
                              t[e++] = 0,
                              t[e++] = 0,
                              t
                          }
                      }, {
                          key: "packAudioFlvTag",
                          value: function(t, e) {
                              var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : -1
                                , s = e.length + 2
                                , a = new Uint8Array(11 + s + 4)
                                , r = 0;
                              return a[r++] = 8,
                              a[r++] = s >> 16 & 255,
                              a[r++] = s >> 8 & 255,
                              a[r++] = 255 & s,
                              a[r++] = t >> 16 & 255,
                              a[r++] = t >> 8 & 255,
                              a[r++] = 255 & t,
                              a[r++] = t >> 24 & 255,
                              a[r++] = 0,
                              a[r++] = 0,
                              a[r++] = 0,
                              -1 != i && (a[r++] = 175,
                              a[r++] = i),
                              a.set(e, r),
                              r += e.length,
                              s += 11,
                              a[r++] = s >> 24 & 255,
                              a[r++] = s >> 16 & 255,
                              a[r++] = s >> 8 & 255,
                              a[r++] = 255 & s,
                              a
                          }
                      }, {
                          key: "packAvcFlvTag",
                          value: function(t, e, i) {
                              var s = e.length + 5
                                , a = new Uint8Array(11 + s + 4)
                                , r = 0;
                              a[r++] = 9,
                              a[r++] = s >> 16 & 255,
                              a[r++] = s >> 8 & 255,
                              a[r++] = 255 & s,
                              a[r++] = t >> 16 & 255,
                              a[r++] = t >> 8 & 255,
                              a[r++] = 255 & t,
                              a[r++] = t >> 24 & 255,
                              a[r++] = 0,
                              a[r++] = 0,
                              a[r++] = 0,
                              a[r++] = i || 23,
                              a[r++] = 0,
                              a[r++] = 0,
                              a[r++] = 0,
                              a[r++] = 0,
                              a.set(e, r),
                              r += e.length;
                              var n = 11 + s;
                              return a[r++] = n >> 24 & 255,
                              a[r++] = n >> 16 & 255,
                              a[r++] = n >> 8 & 255,
                              a[r++] = 255 & n,
                              a
                          }
                      }, {
                          key: "adtsToConfig",
                          value: function(t) {
                              var e = new Uint8Array(2)
                                , i = 1 + ((192 & t[2]) >> 6)
                                , s = (60 & t[2]) >> 2
                                , a = (1 & t[2]) << 2 | (192 & t[3]) >> 6;
                              return e[0] = i << 3 | (14 & s) >> 1,
                              e[1] = (1 & s) << 7 | a << 3,
                              e
                          }
                      }, {
                          key: "setFrameTimestamp",
                          value: function(t, e) {
                              e[4] = t >> 16 & 255,
                              e[5] = t >> 8 & 255,
                              e[6] = 255 & t,
                              e[7] = t >> 24 & 255
                          }
                      }, {
                          key: "getAvc",
                          value: function(t) {
                              var e = t.streamData[0];
                              return e += t.streamData[1] << 8,
                              e += t.streamData[2] << 16,
                              e += t.streamData[3] << 24 >>> 0,
                              t.streamData.slice(4, 4 + e)
                          }
                      }, {
                          key: "trimIFrame",
                          value: function(t, e) {
                              t.streamData = t.streamData.slice(4 + e)
                          }
                      }]),
                      t
                  }()
                    , ys = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.key = null,
                          this.frameType = -1,
                          this.pktNum = null,
                          this.size = 0,
                          this.packets = [],
                          this.streamData = null,
                          this.firstPktSeq = null,
                          this.lastPktSeq = null,
                          this.dts = v.b.UintMax,
                          this.recvTs = null,
                          this.createTs = 0,
                          this._autoDrop = !1,
                          this.urgentResendTimes = 0
                      }
                      return Object(a.a)(t, [{
                          key: "append",
                          value: function(t) {
                              if (0 === this.packets.length)
                                  this.createTs = c.a.now(),
                                  this.key = t.frameId,
                                  this.frameType = 3 & t.seqNum,
                                  this.pktNum = t.frameNum,
                                  this.packets.push(t),
                                  this.size += t.streamData.length;
                              else {
                                  if (1 == localStorage._autoDrop && (localStorage._autoDrop = 0,
                                  this._autoDrop = !0),
                                  this._autoDrop)
                                      return !1;
                                  if (this.isFull)
                                      return !0;
                                  for (var e = !0, i = this.packets.length - 1; i >= 0; i--) {
                                      if (this.packets[i].seqNum === t.seqNum)
                                          return !0;
                                      if (this.packets[i].seqNum < t.seqNum) {
                                          this.packets.splice(i + 1, 0, t),
                                          this.size += t.streamData.length,
                                          e = !1;
                                          break
                                      }
                                  }
                                  e && (this.packets.splice(0, 0, t),
                                  this.size += t.streamData.length)
                              }
                              if (this.isFull) {
                                  this.streamData = new Uint8Array(this.size);
                                  for (var s = 0, a = this.packets.length, r = 0; r < a; r++)
                                      try {
                                          this.streamData.set(this.packets[r].streamData, s),
                                          s += this.packets[r].streamData.length
                                      } catch (t) {
                                          return l.a.error("VideoFrame.append error, name:" + t.name + " msg:" + t.message),
                                          !1
                                      }
                                  if (s !== this.size)
                                      return l.a.error("VideoFrame.Append size error, infact:" + s + " expected:" + this.size + " key:" + this.key + " firstSeq:" + this.firstPktSeq + " lastSeq:" + (this.firstPktSeq + 2 * this.pktNum) + " num:" + this.pktNum + " len:" + this.packets.length),
                                      this.reset(),
                                      !1;
                                  if (this.firstPktSeq = this.packets[0].seq,
                                  this.lastPktSeq = this.packets[a - 1].seq,
                                  this.dts = this.getFrameTime(),
                                  this.recvTs = c.a.now(),
                                  Number(localStorage._printVideoFrame)) {
                                      var n = this.dts - l.a.lastDts
                                        , o = n > 100 ? "background:#FF9797" : ""
                                        , h = n > 100 ? "-_-" : "";
                                      l.a.debug("%cVideo frameType=" + this.frameType + " seq=" + t.seq + " frameId=" + this.key + " dts=" + this.dts + " %c^dts=" + n, "color:#F00", o, h),
                                      l.a.lastDts = this.dts
                                  }
                              }
                              return !0
                          }
                      }, {
                          key: "getMaxSeq",
                          value: function() {
                              return this.packets[this.packets.length - 1].seq
                          }
                      }, {
                          key: "getFrameTime",
                          value: function() {
                              if (this.dts !== v.b.UintMax)
                                  return this.dts;
                              if (!this.isFull)
                                  return v.b.UintMax;
                              var t = 0;
                              this.isKeyFrame && (t = this.streamData[0],
                              t += this.streamData[1] << 8,
                              t += this.streamData[2] << 16,
                              t += this.streamData[3] << 24 >>> 0,
                              t += 4);
                              var e = (255 & this.streamData[t + 7]) << 24 >>> 0
                                , i = (255 & this.streamData[t + 4]) << 16
                                , s = (255 & this.streamData[t + 5]) << 8
                                , a = 255 & this.streamData[t + 6];
                              return this.dts = e + i + s + a,
                              this.dts
                          }
                      }, {
                          key: "getLostSeqs",
                          value: function() {
                              var t = []
                                , e = this.packets.length;
                              if (e < this.pktNum) {
                                  for (var i = this.packets[0].seq, s = this.packets[e - 1].seq, a = i, r = 1; r < e; r++)
                                      for (var n = this.packets[r].seq; a < n; )
                                          t.push(a),
                                          a++;
                                  for (var o = this.pktNum - e; o-- > 0; )
                                      t.unshift(--i),
                                      t.push(++s)
                              }
                              return t
                          }
                      }, {
                          key: "getSeqs",
                          value: function() {
                              var t = [];
                              return this.packets.forEach((function(e) {
                                  t.push(e.seq)
                              }
                              )),
                              t
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              this.key = null,
                              this.frameType = -1,
                              this.pktNum = null,
                              this.size = 0,
                              this.packets = [],
                              this.firstPktSeq = null,
                              this.lastPktSeq = null,
                              this.dts = v.b.UintMax,
                              this.recvTs = null
                          }
                      }, {
                          key: "isFull",
                          get: function() {
                              return this.packets.length === this.pktNum
                          }
                      }, {
                          key: "isEmpty",
                          get: function() {
                              return 0 === this.packets.length
                          }
                      }, {
                          key: "isKeyFrame",
                          get: function() {
                              return 0 === this.frameType
                          }
                      }, {
                          key: "isPFrame",
                          get: function() {
                              return 1 === this.frameType
                          }
                      }, {
                          key: "isBFrame",
                          get: function() {
                              return 2 === this.frameType
                          }
                      }]),
                      t
                  }()
                    , Ts = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.size = 0,
                          this.head = null,
                          this.freeChainSize = 0,
                          this.freeChain = null,
                          this.travelNode = null
                      }
                      return Object(a.a)(t, [{
                          key: "resetTravel",
                          value: function() {
                              this.travelNode = this.head
                          }
                      }, {
                          key: "travel",
                          value: function() {
                              if (null === this.travelNode && (this.travelNode = this.head,
                              null === this.travelNode))
                                  return null;
                              var t = this.travelNode.data;
                              return this.travelNode = this.travelNode.next,
                              this.travelNode === this.head || null === this.travelNode ? null : t
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              this.resetTravel();
                              var t = null
                                , e = null;
                              for (t = this.head; null != t; )
                                  e = t,
                                  t = t.next,
                                  e.data = null,
                                  e.prev = null,
                                  e.next = null,
                                  t === this.head && (t = null);
                              for (this.head = null,
                              t = this.freeChain; null != t; )
                                  e = t,
                                  t = t.next,
                                  e.data = null,
                                  e.prev = null,
                                  e.next = null;
                              this.freeChain = null,
                              this.size = 0,
                              this.freeChainSize = 0
                          }
                      }, {
                          key: "put",
                          value: function(t) {
                              var e = this.getFree(t);
                              if (this.size++,
                              null === this.head)
                                  e.prev = e,
                                  e.next = e,
                                  this.head = e;
                              else if (e.data.key < this.head.data.key)
                                  e.prev = this.head.prev,
                                  e.next = this.head,
                                  e.prev.next = e,
                                  e.next.prev = e,
                                  this.head = e;
                              else {
                                  for (var i = this.head.prev; e.data.key < i.data.key; )
                                      i = i.prev;
                                  if (e.data.key === i.data.key)
                                      return this.size--,
                                      this.putFree(e),
                                      !1;
                                  e.prev = i,
                                  e.next = i.next,
                                  e.prev.next = e,
                                  e.next.prev = e
                              }
                              return !0
                          }
                      }, {
                          key: "put2",
                          value: function(t) {
                              var e = this.getFree(t);
                              if (this.size++,
                              null === this.head)
                                  e.prev = e,
                                  e.next = e,
                                  this.head = e;
                              else if (e.data.key < this.head.data.key)
                                  e.prev = this.head.prev,
                                  e.next = this.head,
                                  e.prev.next = e,
                                  e.next.prev = e,
                                  this.head = e;
                              else {
                                  for (var i = this.head; e.data.key > i.data.key && (i = i.next) !== this.head; )
                                      ;
                                  if (e.data.key === i.data.key)
                                      return this.size--,
                                      this.putFree(e),
                                      !1;
                                  e.prev = i.prev,
                                  e.next = i,
                                  i.prev.next = e,
                                  i.prev = e
                              }
                              return !0
                          }
                      }, {
                          key: "get",
                          value: function() {
                              if (null === this.head)
                                  return null;
                              var t = this.head
                                , e = t.data;
                              return this.size--,
                              0 === this.size ? this.head = null : (t.prev.next = t.next,
                              t.next.prev = t.prev,
                              this.head = this.head.next),
                              this.putFree(t),
                              e
                          }
                      }, {
                          key: "peek",
                          value: function() {
                              return null === this.head ? null : this.head.data
                          }
                      }, {
                          key: "peekLast",
                          value: function() {
                              return null === this.head ? null : this.head.prev.data
                          }
                      }, {
                          key: "getOrNewNode",
                          value: function(t) {
                              var e = null;
                              if (null === this.head)
                                  this.size++,
                                  (e = this.getFree(null)).prev = e,
                                  e.next = e,
                                  this.head = e;
                              else if (t < this.head.data.key)
                                  this.size++,
                                  (e = this.getFree(null)).prev = this.head.prev,
                                  e.next = this.head,
                                  e.prev.next = e,
                                  e.next.prev = e,
                                  this.head = e;
                              else {
                                  for (var i = this.head.prev; t < i.data.key; )
                                      i = i.prev;
                                  i.data.key === t ? e = i : (this.size++,
                                  (e = this.getFree(null)).prev = i,
                                  e.next = i.next,
                                  e.prev.next = e,
                                  e.next.prev = e)
                              }
                              return e
                          }
                      }, {
                          key: "putFree",
                          value: function(t) {
                              t.data = null,
                              t.next = this.freeChain,
                              t.prev = null,
                              this.freeChain = t,
                              this.freeChainSize++
                          }
                      }, {
                          key: "getFree",
                          value: function(t) {
                              if (null === this.freeChain)
                                  return new gs(t);
                              var e = this.freeChain;
                              return e.data = t,
                              this.freeChain = e.next,
                              this.freeChainSize--,
                              e
                          }
                      }, {
                          key: "getLast",
                          value: function() {
                              if (null == this.head)
                                  return null;
                              var t = this.head.prev
                                , e = t.data;
                              return this.size--,
                              0 === this.size ? this.head = null : (t.prev.next = t.next,
                              t.next.prev = t.prev),
                              this.putFree(t),
                              e
                          }
                      }]),
                      t
                  }()
                    , gs = function t(e) {
                      Object(s.a)(this, t),
                      this.next = null,
                      this.prev = null,
                      this.data = e
                  }
                    , Ss = Ts
                    , Ps = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.videoPlayer = e,
                          this.firstFrameDts = 0,
                          this.isCanPlay = !1,
                          this.lastPlaySeq = 0,
                          this.lastPlayDts = 0,
                          this.lastPlayFrameId = 0,
                          this.chain = new Ss
                      }
                      return Object(a.a)(t, [{
                          key: "getSize",
                          value: function() {
                              return this.chain.size
                          }
                      }, {
                          key: "getWaitFrames",
                          value: function() {
                              return this.chain.size <= 0 ? 0 : this.chain.peekLast().key - this.lastPlayFrameId
                          }
                      }, {
                          key: "getReason",
                          value: function() {
                              var t = this.chain.peek();
                              return t && this.lastPlayFrameId > 0 ? t.isFull ? t.key - this.lastPlayFrameId > 1 ? 1 : 2 : 3 : 0
                          }
                      }, {
                          key: "getFrameGap",
                          value: function() {
                              var t = this.chain.peek();
                              return t && this.lastPlayFrameId > 0 ? t.key - this.lastPlayFrameId : 0
                          }
                      }, {
                          key: "checkPlay",
                          value: function(t, e) {
                              0 === this.firstFrameDts && (this.firstFrameDts = t,
                              this.lastPlayDts = t - 1),
                              this.isCanPlay || (this.isCanPlay = t - this.firstFrameDts >= e)
                          }
                      }, {
                          key: "trimBeforeDts",
                          value: function(t) {
                              for (var e = this.chain.peek(); e && e.dts < t; )
                                  this.chain.get(),
                                  e = this.chain.peek();
                              return e && l.a.log("Recver.trimBeforeDts " + (e instanceof ys ? "video" : "audio") + ", firstFrame=" + e.key + " firstDts=" + e.dts),
                              e
                          }
                      }, {
                          key: "getFrame",
                          value: function(t) {
                              var e = this.chain.peek();
                              return e && e.isFull && (0 === this.lastPlayFrameId || (1 === o.a.useNewPloy ? e.key - this.lastPlayFrameId == 1 || t - this.lastPushTs > 800 && this.videoPlayer.getBufferLen() < 500 : e.key - this.lastPlayFrameId == 1 || this.videoPlayer.getBufferLen() < 1e3)) ? (this.lastPlayFrameId > 0 && e.key - this.lastPlayFrameId > 1 && l.a.warn("Recver.getFrame isAudio=".concat(e.isAudio, " frameId disconnect, lastId=").concat(this.lastPlayFrameId, " curId=").concat(e.key, " gap=").concat(e.key - this.lastPlayFrameId)),
                              this.lastPlayFrameId = e.key,
                              this.lastPlayDts = e.dts,
                              this.lastPushTs = t,
                              this.chain.get(),
                              e) : null
                          }
                      }, {
                          key: "getMaxSeq",
                          value: function(t) {
                              for (var e = this.chain.head, i = 0; e; ) {
                                  var s = e.data;
                                  if (!(t - s.createTs > 1100))
                                      break;
                                  if (i = s.getMaxSeq(),
                                  e.next === this.chain.head)
                                      break;
                                  e = e.next
                              }
                              return i
                          }
                      }, {
                          key: "hasNextFrame",
                          value: function(t) {
                              var e = this.chain.peek();
                              return !(!e || !e.isFull) && (0 === this.lastPlayFrameId || e.key - this.lastPlayFrameId == 1 || e.isTimeout(t))
                          }
                      }, {
                          key: "getNeedRangeSeqs",
                          value: function(t, e, i) {}
                      }, {
                          key: "reset",
                          value: function() {
                              this.lastPlayFrameId = 0,
                              this.lastPlayDts = 0,
                              this.chain.reset(),
                              this.isCanPlay = !1,
                              this.firstFrameDts = 0,
                              this.lastPushTs = 0
                          }
                      }]),
                      t
                  }()
                    , Es = -1
                    , Is = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i(t) {
                          var a;
                          return Object(s.a)(this, i),
                          (a = e.call(this, t)).codecname = "",
                          a.avcConfig = null,
                          a.lastRecvTs = 0,
                          a.lateSeqs = 0,
                          a.dropFrames = 0,
                          a.playedFrames = 0,
                          a.dtsJumpPauseTimes = 0,
                          a.skipFramePauseTimes = 0,
                          a.forceSkipFrameNums = 0,
                          a.waitNextIFrame = !1,
                          a
                      }
                      return Object(a.a)(i, [{
                          key: "recvData",
                          value: function(t) {
                              if (t.frameId <= this.lastPlayFrameId)
                                  return this.lateSeqs++,
                                  3;
                              this.lastRecvTs = c.a.now(),
                              t.config.has(12) && (this.codecname = t.config.get(12));
                              var e = this.chain.getOrNewNode(t.frameId);
                              if (!e)
                                  return 4;
                              var i = e.data;
                              i || (i = new ys,
                              e.data = i),
                              i.append(t);
                              var s = c.a.now()
                                , a = this.videoPlayer.p2pPlayer.G;
                              0 === a.firstVideoPkgTime && (a.firstVideoPkgTime = s,
                              l.a.log("%c[TIME] firstVideoPkgTime=" + (s - a.connectVideoTime) + " totalTime=" + (s - a.startTime) + " seq=" + t.seq + " frameType=" + i.frameType, "color:#A23400;background:#FFF5C2", " frameId=" + i.key)),
                              0 === a.firstIFrameTime1 && 0 === i.frameType && (a.firstIFrameTime1 = s,
                              l.a.log("%c[TIME] firstIFrameTime1=" + (s - a.connectVideoTime) + " totalTime=" + (s - a.startTime) + " seq=" + t.seq + " sliceNum=" + i.pktNum, "color:#A23400;background:#FFF5C2", " frameId=" + i.key));
                              var r = i.isFull;
                              return this.videoPlayer.firstTsStatus < 2 && r && i.isKeyFrame && (this.videoPlayer.setFirstDTs(2, i.dts),
                              a.firstIFrameTime2 = s,
                              l.a.log("%c[TIME] firstIFrameTime2=" + (s - a.firstIFrameTime1) + " totalTime=" + (s - a.startTime) + " seq=" + t.seq + " sliceNum=" + i.pktNum, "color:#A23400;background:#FFF5C2", " frameId=" + i.key)),
                              r ? (this.checkPlay(i.dts, 230),
                              2) : 0
                          }
                      }, {
                          key: "needUrgendResend",
                          value: function(t) {
                              var e = this.chain.peek();
                              return e && t - e.createTs > o.a.urgentResendTime
                          }
                      }, {
                          key: "getWaitFrameTime",
                          value: function(t) {
                              var e = this.chain.peek();
                              return e ? t - e.createTs : 0
                          }
                      }, {
                          key: "checkDropFrames",
                          value: function(t) {
                              var e = this.chain.peek();
                              if (!(e && t - e.createTs < o.a.forceSkipFrameTime)) {
                                  var i = this.lastPlayFrameId
                                    , s = 0
                                    , a = this.chain.get();
                                  l.a.log("VideoRecver.checkDropFrames", a);
                                  var r = this.chain.peek()
                                    , n = "VideoRecver.checkDropFrames"
                                    , h = [];
                                  for (a && (s++,
                                  h.push(a.key),
                                  n += " resendTimes:" + a.urgentResendTimes + " frameId:" + a.key + " pktNum:" + a.pktNum + " hasNum:" + a.packets.length + " seqs:" + (a.pktNum > 0 ? "".concat(a.packets[0], "-").concat(a.packets[a.pktNum - 1]) : "")); r; ) {
                                      if (r.isKeyFrame) {
                                          this.setNextIFrame(r);
                                          break
                                      }
                                      this.waitNextIFrame = !0,
                                      h.push(r.key),
                                      this.chain.get(),
                                      r = this.chain.peek(),
                                      s++
                                  }
                                  s > 0 && (this.forceSkipFrameNums += s,
                                  n += " dropNum:" + s + " cache:" + this.chain.size + " lastPlayFrameID:" + i,
                                  l.a.log(n, h))
                              }
                          }
                      }, {
                          key: "checkNextIframe",
                          value: function() {
                              if (this.waitNextIFrame)
                                  for (var t = this.chain.peek(); t; ) {
                                      if (t.isKeyFrame) {
                                          this.setNextIFrame(t);
                                          break
                                      }
                                      this.lastPlayFrameId = t.key,
                                      t.isFull && (this.lastPlayDts = t.dts,
                                      this.lastPlaySeq = t.firstPktSeq),
                                      this.chain.get(),
                                      t = this.chain.peek()
                                  }
                          }
                      }, {
                          key: "setNextIFrame",
                          value: function(t) {
                              l.a.log("VideoRecver.setNextIFrame", this.lastPlayFrameId, this.lastPlayDts, t.key, t.dts),
                              this.lastPlayFrameId = t.key - 1,
                              t.isFull && (this.lastPlayDts = t.dts,
                              this.lastPlaySeq = t.firstPktSeq),
                              this.waitNextIFrame = !1
                          }
                      }, {
                          key: "getNeedRangeSeqs",
                          value: function(t, e) {
                              var i = this;
                              if (this.lastPlayFrameId > 0 && this.chain.size > 0)
                                  for (var s = this.chain.head; ; ) {
                                      var a = s.data;
                                      if (a.isFull && a.dts >= t)
                                          break;
                                      if (a.isFull || 0 !== a.urgentResendTimes || (a.urgentResendTimes = 1,
                                      a.getLostSeqs().forEach((function(t) {
                                          i.videoPlayer.hasSeq(t) || e.add(t)
                                      }
                                      ))),
                                      e.size > 640)
                                          break;
                                      if ((s = s.next) === this.chain.head)
                                          break
                                  }
                          }
                      }, {
                          key: "getFrame",
                          value: function(t) {
                              var e = E(Object(S.a)(i.prototype), "getFrame", this).call(this, t);
                              return e && (this.lastPlaySeq = e.firstPktSeq),
                              e
                          }
                      }, {
                          key: "printInfo",
                          value: function(t) {
                              var e = this.chain.head
                                , i = 0
                                , s = 0
                                , a = 0
                                , r = 0;
                              e && (i = e.data.key,
                              s = e.data.getMaxSeq());
                              for (var n = 0, o = 0, h = 0; e; ) {
                                  var u = e.data;
                                  if (n++,
                                  o += u.pktNum,
                                  h += u.size,
                                  e.next === this.chain.head) {
                                      a = u.key,
                                      r = u.getMaxSeq();
                                      break
                                  }
                                  e = e.next
                              }
                              l.a.log("VideoInfo ".concat(t, " frameCnt=").concat(n, " pktCnt=").concat(o, " hasCnt=").concat(h, " firstId=").concat(i, " firstSeq=").concat(s, " endId=").concat(a, " endSeq=").concat(r))
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              E(Object(S.a)(i.prototype), "reset", this).call(this),
                              this.waitNextIFrame = !1,
                              this.codecname = "",
                              this.avcConfig = null,
                              this.lastRecvTs = 0
                          }
                      }]),
                      i
                  }(Ps)
                    , As = {
                      MUSIC_MID: 1,
                      MUSIC_MID_TIME_LEN: 2048e3 / 44100,
                      MUSIC_MID_128: 35,
                      MUSIC_MID_128_TIME_LEN: 1024e3 / 44100,
                      MUSIC_MID_160: 36,
                      MUSIC_MID_160_TIME_LEN: 1024e3 / 44100,
                      MUSIC_MID_192: 37,
                      MUSIC_MID_192_TIME_LEN: 1024e3 / 44100,
                      MUSIC_MID_48K_MONO: 100,
                      MUSIC_MID_48K_STEREO: 101,
                      MUSIC_MID_48K_TIME_LEN: 1024e3 / 48e3,
                      VOICE_HIGHER: 2,
                      VOICE_HIGHER_TIME_LEN: 20,
                      VOICE_HIGHER_FRAME_LEN: 882,
                      VOICE_HIGHER_QUALITY1: 22,
                      VOICE_HIGHER_QUALITY1_TIME_LEN: 20,
                      VOICE_HIGHER_QUALITY1_FRAME_LEN: 882,
                      getAudioTimeLen: function(t) {
                          switch (t) {
                          case this.MUSIC_MID:
                              return this.MUSIC_MID_TIME_LEN;
                          case this.MUSIC_MID_128:
                              return this.MUSIC_MID_128_TIME_LEN;
                          case this.MUSIC_MID_160:
                              return this.MUSIC_MID_160_TIME_LEN;
                          case this.MUSIC_MID_192:
                              return this.MUSIC_MID_192_TIME_LEN;
                          case this.MUSIC_MID_48K_MONO:
                          case this.MUSIC_MID_48K_STEREO:
                              return this.MUSIC_MID_48K_TIME_LEN;
                          case this.VOICE_HIGHER:
                              return this.VOICE_HIGHER_TIME_LEN;
                          default:
                              return this.MUSIC_MID_TIME_LEN
                          }
                      }
                  }
                    , Cs = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.seq = 0,
                          this.key = 0,
                          this.codec = 0,
                          this.isEmpty = !1,
                          this.createTime = 0,
                          this.isAudio = !0,
                          this.dts = 0,
                          this.streamData = null,
                          this.aacConfig = null,
                          this.recvTs = 0,
                          this.urgentResendTimes = 0
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              this.seq = 0,
                              this.key = 0,
                              this.codec = 0,
                              this.isEmpty = !1,
                              this.dts = 0,
                              this.streamData = null,
                              this.aacConfig = null,
                              this.recvTs = 0
                          }
                      }, {
                          key: "isTimeout",
                          value: function(t) {
                              return this.createTime > 0 && t - this.createTime > o.a.frameTimeout
                          }
                      }, {
                          key: "getMaxSeq",
                          value: function() {
                              return this.seq
                          }
                      }, {
                          key: "isFull",
                          get: function() {
                              return !0
                          }
                      }]),
                      t
                  }()
                    , ks = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i(t) {
                          var a;
                          return Object(s.a)(this, i),
                          (a = e.call(this, t)).isAudioFrameTimeLenInited = !1,
                          a.audioFrameTimeLen = As.MUSIC_MID_TIME_LEN,
                          a.isAacCfgChange = !1,
                          a.offset = 0,
                          a.lastRecvFrameDts = 0,
                          a.lastResendSeq = 0,
                          a.lastResendFrameId = 0,
                          a.aacConfig = null,
                          a
                      }
                      return Object(a.a)(i, [{
                          key: "reset",
                          value: function() {
                              E(Object(S.a)(i.prototype), "reset", this).call(this),
                              this.isAudioFrameTimeLenInited = !1,
                              this.audioFrameTimeLen = As.MUSIC_MID_TIME_LEN,
                              this.lastRecvFrameDts = 0,
                              this.lastPlaySeq = 0,
                              this.aacConfig = null,
                              this.lastResendSeq = 0,
                              this.lastResendFrameId = 0
                          }
                      }, {
                          key: "recvData",
                          value: function(t) {
                              if (t.seq <= this.lastPlaySeq)
                                  return 3;
                              var e = c.a.now()
                                , i = this.videoPlayer.p2pPlayer.G;
                              return 0 === i.firstAudioPkgTime && (i.firstAudioPkgTime = e,
                              l.a.log("%c[TIME] firstAudioPkgTime=" + (e - i.connectVideoTime) + " totalTime=" + (e - i.startTime), "color:#A23400;background:#FFF5C2")),
                              this.isAudioFrameTimeLenInited || (this.isAudioFrameTimeLenInited = !0,
                              this.audioFrameTimeLen = As.getAudioTimeLen(t.codecType),
                              l.a.log("AudioRecver.recvData codecType=" + t.codecType + " aacTimeLen=" + this.audioFrameTimeLen)),
                              this.offset = 0,
                              this.isAacCfgChange = !1,
                              this.readAacConfig(t),
                              this.readAacTag(t),
                              0
                          }
                      }, {
                          key: "readAacConfig",
                          value: function(t) {
                              var e = t.streamData
                                , i = (e[1] << 16) + (e[2] << 8) + e[3];
                              this.offset = 11 + i + 4;
                              var s = e.slice(0, this.offset);
                              null === this.aacConfig ? (this.aacConfig = s,
                              this.videoPlayer.initAacConfig(s),
                              l.a.log("AudioRecver.decodeAacConfig aacConfig=" + s.slice(-8, -4).toString())) : this.aacConfig.toString() !== s.toString() && (l.a.warn("AudioRecver.decodeAacConfig aacConfig change, " + this.aacConfig.slice(-8, -4).toString() + " -> " + s.slice(-8, -4).toString()),
                              this.isAacCfgChange = !0,
                              this.aacConfig = s)
                          }
                      }, {
                          key: "readAacTag",
                          value: function(t) {
                              for (var e, i, s, a, r = t.streamData, n = 1 === Number(localStorage._printAudioFrame), o = this.videoPlayer.isFirstAudio(), h = new DataView(r.buffer), u = r.length, d = this.offset; d < u; )
                                  if (e = h.getUint32(d, !0),
                                  i = h.getUint32(d + 4, !0),
                                  s = r.slice(d + 8, d + e),
                                  d += e,
                                  a = ((255 & s[7]) << 24 >>> 0) + ((255 & s[4]) << 16) + ((255 & s[5]) << 8) + (255 & s[6]),
                                  !(i < this.lastPlayFrameId)) {
                                      var p = new Cs;
                                      if (p.seq = t.seq,
                                      p.key = i,
                                      p.codec = t.codecType,
                                      p.dts = a,
                                      p.streamData = s,
                                      p.createTime = c.a.now(),
                                      this.isAacCfgChange && (p.aacConfig = this.aacConfig),
                                      this.chain.put(p),
                                      o && (o = !1,
                                      this.videoPlayer.setFirstDTs(0, a)),
                                      this.checkPlay(a, 500),
                                      n) {
                                          var f = a - this.lastRecvFrameDts
                                            , _ = f > 100 ? "background:#FF9797" : ""
                                            , m = f > 100 ? "-.-" : "";
                                          l.a.debug("%cAudio seq=" + t.seq + " frameId=" + i + " dts=" + a + " %c^dts=" + f, "color:#090", _, m)
                                      }
                                      this.lastRecvFrameDts = p.dts
                                  }
                          }
                      }, {
                          key: "getFrame",
                          value: function(t) {
                              var e = E(Object(S.a)(i.prototype), "getFrame", this).call(this, t);
                              return e && (this.lastPlaySeq = e.seq),
                              e
                          }
                      }, {
                          key: "getNeedRangeSeqs",
                          value: function(t, e, i) {
                              if (this.lastPlayFrameId > 0 && this.chain.size > 0) {
                                  for (var s = Math.max(this.lastResendFrameId, this.lastPlayFrameId), a = this.chain.head; ; ) {
                                      var r = a.data;
                                      if (r.key - 1 > s && (this.getLostSeqs(r, e, i),
                                      s = r.key),
                                      e.size >= 640)
                                          break;
                                      if ((a = a.next) === this.chain.head)
                                          break
                                  }
                                  this.lastResendFrameId = s
                              }
                          }
                      }, {
                          key: "getLostSeqs",
                          value: function(t, e, i) {
                              for (var s = Math.max(this.lastResendSeq, this.lastPlaySeq), a = t.seq, r = s; r < a && (r > this.lastResendSeq && (i(r) || e.add(r),
                              this.lastResendSeq = r),
                              !(e.size >= 640)); r++)
                                  ;
                          }
                      }]),
                      i
                  }(Ps)
                    , bs = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.p2pPlayer = e,
                          this.sliceSpeed = (e.info.curBitrate || 500) / 1e3 * 125,
                          this.firstDts = 0,
                          this.firstTsStatus = Es,
                          this.fastOver = !1,
                          this.startDts = 0,
                          this.startTs = 0,
                          this.startSeq = 0,
                          this.recvSeqs = 0,
                          this.lastRecvSeqs = 0,
                          this.pushFrames = 0,
                          this.lastPushFrames = 0,
                          this.lastPushFrameTs = 0,
                          this.lastResendSeq = 0,
                          this.lastPlayVideoSeq = 0,
                          this.videoRecver = new Is(this),
                          this.audioRecver = new ks(this),
                          this.flvHeader = vs.getFlvHeader(),
                          this.msePlayer = this.createMse(),
                          this.metadataTick = new te(e.eventEmitter,this.msePlayer),
                          this.pushVideoFrameBind = this.pushVideoFrame.bind(this),
                          this.pushAudioFrameBind = this.pushAudioFrame.bind(this),
                          this.hasSeqBind = this.hasSeq.bind(this)
                      }
                      return Object(a.a)(t, [{
                          key: "dispose",
                          value: function() {
                              this.msePlayer && (this.msePlayer.destroy(),
                              this.msePlayer = null),
                              this.startDts = 0,
                              this.startTs = 0,
                              this.lastResendSeq = 0,
                              this.videoRecver.reset(),
                              this.audioRecver.reset(),
                              k.a.remove(this.onPushFrameTimer, this)
                          }
                      }, {
                          key: "createMse",
                          value: function() {
                              var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0
                                , e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
                                , i = new Qt(this.p2pPlayer,{
                                  h265Proxy: this.p2pPlayer.h265Proxy
                              });
                              return i.appendFlv(this.flvHeader),
                              i.setPushGop(o.a.pushGop),
                              0 !== t && 0 !== e && i.setResolution(t, e),
                              i
                          }
                      }, {
                          key: "resetMse",
                          value: function() {
                              var t = 0
                                , e = 0;
                              this.msePlayer && (t = this.msePlayer.getWidth(),
                              e = this.msePlayer.getHeight(),
                              this.msePlayer.destroy(),
                              this.msePlayer = null),
                              this.startDts = 0,
                              this.startTs = 0,
                              this.lastResendSeq = 0,
                              this.msePlayer = this.createMse(t, e),
                              this.audioRecver.aacConfig = null,
                              this.videoRecver.avcConfig = null,
                              k.a.remove(this.onPushFrameTimer, this),
                              this.metadataTick.reset(),
                              this.metadataTick.mse = this.msePlayer
                          }
                      }, {
                          key: "onVideoStreamData",
                          value: function(t) {
                              this.recvSeqs++,
                              this.lastRecvSeq = t.seq,
                              2 === this.videoRecver.recvData(t) && this.pushFastFrame()
                          }
                      }, {
                          key: "onAudioStreamData",
                          value: function(t) {
                              this.lastRecvSeq = t.seq,
                              0 === this.audioRecver.recvData(t) && this.pushFastFrame()
                          }
                      }, {
                          key: "onPushFrameTimer",
                          value: function(t, e) {
                              e % 5 == 0 && (this.lastRecvSeqs > 0 && 1 === Number(localStorage._printRecvFrame) && l.a.log("RecvSeqs", this.recvSeqs - this.lastRecvSeqs, "PushFrames", this.pushFrames - this.lastPushFrames, "HasFrames", this.videoRecver.chain.size, "buffer", this.msePlayer ? this.msePlayer.getBufferLen() : 0, "lastPlayDts", this.videoRecver.lastPlayDts, "lastPlayFrameId", this.videoRecver.lastPlayFrameId),
                              this.lastRecvSeqs = this.recvSeqs,
                              this.lastPushFrames = this.pushFrames),
                              this.videoRecver.checkNextIframe(),
                              this.pushFrame(this.startDts + (t - this.startTs), t),
                              this.msePlayer.buffered._calc(t, qt),
                              this.p2pPlayer.p2pMgr.setLastPushedFrame(this.videoRecver.lastPlayDts, this.videoRecver.lastPlayFrameId, this.getBufferLen()),
                              this.checkRangeSeqs(t)
                          }
                      }, {
                          key: "onUpdateLastPlayedFrameId",
                          value: function(t, e) {
                              this.setLastPlayVideoSeq(e)
                          }
                      }, {
                          key: "hasSeq",
                          value: function(t) {
                              return this.p2pPlayer.p2pMgr.hasSeq(t)
                          }
                      }, {
                          key: "setLastPlayVideoSeq",
                          value: function(t) {
                              this.lastPlayVideoSeq = t,
                              this.p2pPlayer.p2pMgr.setLastPlaySeq(t)
                          }
                      }, {
                          key: "checkRangeSeqs",
                          value: function(t) {
                              var e = this.startDts + (t - this.startTs)
                                , i = e - this.videoRecver.lastPlayDts;
                              if (i > 6e3 && this.getBufferLen() < 600 && this.videoRecver.checkDropFrames(t),
                              this.msePlayer.getBufferLen() < 2e3 && this.p2pPlayer.p2pMgr.hasPub() && this.videoRecver.needUrgendResend(t) && 2 != o.a.resendMode) {
                                  var s = new Set;
                                  if (this.videoRecver.getNeedRangeSeqs(e, s, this.hasSeqBind),
                                  this.audioRecver.getNeedRangeSeqs(e, s, this.hasSeqBind),
                                  s.size < 640)
                                      for (var a = Math.max(this.lastResendSeq, this.videoRecver.lastPlaySeq), r = this.videoRecver.lastPlaySeq + Math.ceil(this.sliceSpeed * i / 1e3 * .6), n = a; n < r && (n > this.lastResendSeq && (this.hasSeq(n) || s.add(n),
                                      this.lastResendSeq = n),
                                      !(s.size >= 640)); n++)
                                          ;
                                  var h = Array.from(s);
                                  h.length > 0 && (1 === Number(localStorage._printRange) && l.a.log("VideoPlayer.checkRangeSeqs time=".concat(i, " bufferLen=").concat(this.msePlayer.getBufferLen(), " seqCnt=").concat(h.length, " firstSeq=").concat(h[0], " endSeq=").concat(h[h.length - 1], " size=").concat(this.videoRecver.chain.size, " lastRecvSeq=").concat(this.lastRecvSeq, " lastPlayDts=").concat(this.videoRecver.lastPlayDts, " lastPlayFrameId=").concat(this.videoRecver.lastPlayFrameId)),
                                  this.p2pPlayer.p2pMgr.urgentResend(h))
                              }
                          }
                      }, {
                          key: "pausedTooLong",
                          value: function() {}
                      }, {
                          key: "pushFastFrame",
                          value: function() {
                              this.fastOver || 0 === this.firstTsStatus && !this.audioRecver.isCanPlay || 2 === this.firstTsStatus && !this.videoRecver.isCanPlay || this.pushFrame(this.firstDts + 36e5, 0)
                          }
                      }, {
                          key: "pushFrame",
                          value: function(t, e) {
                              for (; ; )
                                  if (this.audioRecver.hasNextFrame(e) && this.audioRecver.lastPlayDts < this.videoRecver.lastPlayDts) {
                                      if (!this.checkPushFrame(e, this.audioRecver, this.pushAudioFrameBind))
                                          break
                                  } else if (!this.checkPushFrame(e, this.videoRecver, this.pushVideoFrameBind))
                                      break
                          }
                      }, {
                          key: "getDtsGap",
                          value: function() {
                              return this.videoRecver.lastPlayDts - this.audioRecver.lastPlayDts
                          }
                      }, {
                          key: "getReasons",
                          value: function(t) {
                              var e = this.getReason(this.audioRecver)
                                , i = this.getReason(this.videoRecver);
                              return 2 === i && this.audioRecver.hasNextFrame(t) && this.audioRecver.lastPlayDts < this.videoRecver.lastPlayDts && this.msePlayer.getBufferLen() > 1e3 && (i = 4),
                              2 === e && this.audioRecver.lastPlayDts > this.videoRecver.lastPlayDts && (e = 3),
                              {
                                  audioReason: e,
                                  videoReason: i
                              }
                          }
                      }, {
                          key: "getReason",
                          value: function(t) {
                              var e = t.chain.peek();
                              return e && t.lastPlayFrameId > 0 ? e.isFull ? e.key - t.lastPlayFrameId > 1 ? 1 : 2 : 3 : 0
                          }
                      }, {
                          key: "checkPushFrame",
                          value: function(t, e, i) {
                              var s = e.getFrame(t);
                              return !!s && (i(s, t),
                              !0)
                          }
                      }, {
                          key: "pushVideoFrame",
                          value: function(t, e) {
                              if (t) {
                                  if (this.pushFrames++,
                                  this.lastPushFrameTs = e,
                                  t.isKeyFrame) {
                                      var i = vs.getAvc(t);
                                      if (!this.videoRecver.avcConfig || this.videoRecver.avcConfig.toString() !== i.toString()) {
                                          var s = i.length + 4 + 11
                                            , a = 31 & t.streamData[s];
                                          this.videoRecver.avcConfig = i;
                                          var r = vs.packAvcFlvTag(t.dts, i, a);
                                          this.msePlayer && this.msePlayer.appendFlv(r)
                                      }
                                      vs.trimIFrame(t, i.length)
                                  }
                                  this.videoRecver.avcConfig && (this.msePlayer && (this.msePlayer.parser.ctrlBuffer.setCurFrameId(t.key),
                                  this.msePlayer.appendFlv(t.streamData)),
                                  t.streamData = null,
                                  this.onUpdateLastPlayedFrameId(t.id, t.lastPktSeq - 1)),
                                  t.played = !0
                              }
                          }
                      }, {
                          key: "pushAudioFrame",
                          value: function(t, e) {
                              t && (t.dts < this.firstDts - this.audioRecver.audioFrameTimeLen || (t.aacConfig && (l.a.log("VideoPlayer.playAudio aacConfig change"),
                              this.msePlayer && this.msePlayer.appendFlv(t.aacConfig),
                              t.aacConfig = null),
                              this.msePlayer && this.msePlayer.appendFlv(t.streamData),
                              t.streamData = null))
                          }
                      }, {
                          key: "initAacConfig",
                          value: function(t) {
                              this.msePlayer && this.msePlayer.appendFlv(t)
                          }
                      }, {
                          key: "setFirstDTs",
                          value: function(t, e) {
                              var i = this.firstTsStatus;
                              i >= t || (l.a.log("VideoPlayer.setFirstTs status=" + i + "->" + t + " firstTs=" + e + " jitBufLen=" + o.a.jitBufLen),
                              this.firstDts = e,
                              this.lastPlayDts = e + 200,
                              this.firstTsStatus = t,
                              0 === i && 2 === t && (l.a.info("VideoPlayer.setFirstDTs resetMse"),
                              this.resetMse()),
                              2 === t ? (this.videoRecver.trimBeforeDts(this.firstDts),
                              this.audioRecver.trimBeforeDts(this.firstDts),
                              this.msePlayer && this.audioRecver.aacConfig && this.msePlayer.appendFlv(this.audioRecver.aacConfig)) : 0 === t && this.audioRecver.trimBeforeDts(this.firstDts))
                          }
                      }, {
                          key: "isFirstAudio",
                          value: function() {
                              return this.firstTsStatus <= 0
                          }
                      }, {
                          key: "onCheckFastTimer",
                          value: function(t, e) {
                              this.msePlayer && e % 10 == 0 && this.msePlayer.onCheckFastTimer(t, e)
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              this.msePlayer && this.msePlayer.onCheckTimer(t, e),
                              this.metadataTick.onCheckTimer(t, e)
                          }
                      }, {
                          key: "setFastOver",
                          value: function() {
                              l.a.log("VideoPlayer.setFastOver firstDts", this.firstDts, "videoDts", this.videoRecver.firstFrameDts, this.videoRecver.lastPlayDts, "autioDts", this.audioRecver.firstFrameDts, this.audioRecver.lastPlayDts),
                              this.fastOver = !0,
                              0 === this.videoRecver.lastPlayFrameId || 0 === this.audioRecver.lastPlayFrameId ? l.a.warn("VideoPlayer.setFastOver video||audio lastPlayFrameId=0") : (this.startDts = this.videoRecver.lastPlayDts,
                              this.startTs = c.a.now(),
                              this.startSeq = this.videoRecver.lastPlaySeq,
                              k.a.add(this.onPushFrameTimer, this, 200))
                          }
                      }, {
                          key: "getCurrentTime",
                          value: function() {
                              return this.msePlayer ? this.msePlayer.getCurrentTime() : 0
                          }
                      }, {
                          key: "getCurrentDts",
                          value: function() {
                              return this.msePlayer ? this.msePlayer.getCurrentDts() : 0
                          }
                      }, {
                          key: "getCurrentSeiOffsetDts",
                          value: function() {
                              return this.msePlayer ? this.msePlayer.getCurrentSeiOffsetDts() : 0
                          }
                      }, {
                          key: "getCurrentRealTime",
                          value: function() {
                              return this.msePlayer.getCurrentRealTime()
                          }
                      }, {
                          key: "getBufferLen",
                          value: function() {
                              return this.msePlayer ? this.msePlayer.getBufferLen() : 0
                          }
                      }, {
                          key: "getFrameBufferLen",
                          value: function() {
                              return this.msePlayer ? this.msePlayer.getFrameBufferLen() : 0
                          }
                      }, {
                          key: "getWaitBufferLen",
                          value: function() {
                              var t = this.videoRecver.getWaitFrames();
                              return t > 0 && this.msePlayer.metadata && this.msePlayer.metadata.fps > 0 ? t / this.msePlayer.metadata.fps * 1e3 : 0
                          }
                      }, {
                          key: "getWaitFrameTime",
                          value: function(t) {
                              return this.videoRecver.getWaitFrameTime(t)
                          }
                      }, {
                          key: "setQuickVideoLen",
                          value: function(t) {}
                      }, {
                          key: "setPlaybackrateAccess",
                          value: function(t) {
                              this.msePlayer && this.msePlayer.setPlaybackrateAccess(t)
                          }
                      }, {
                          key: "getStat",
                          value: function() {
                              var t = {
                                  lateSeqs: this.videoRecver.lateSeqs,
                                  dropFrames: this.videoRecver.dropFrames,
                                  playedFrames: this.videoRecver.playedFrames,
                                  dtsJumpPauseTimes: this.videoRecver.dtsJumpPauseTimes,
                                  skipFramePauseTimes: this.videoRecver.skipFramePauseTimes,
                                  forceSkipFrameNums: this.videoRecver.forceSkipFrameNums,
                                  playDelayAvg: 0,
                                  hasFrames: this.videoRecver.chain.size,
                                  emptyFrames: this.msePlayer.parser.emptyFrames || 0
                              };
                              return this.videoRecver.lateSeqs = 0,
                              this.videoRecver.dropFrames = 0,
                              this.videoRecver.playedFrames = 0,
                              this.videoRecver.dtsJumpPauseTimes = 0,
                              this.videoRecver.skipFramePauseTimes = 0,
                              this.videoRecver.forceSkipFrameNums = 0,
                              this.msePlayer.parser.emptyFrames = 0,
                              t
                          }
                      }, {
                          key: "switchStart",
                          value: function() {
                              l.a.log("VideoPlayer.switchStart lastPlayFrameId(video=".concat(this.videoRecver.lastPlayFrameId, " audio=").concat(this.audioRecver.lastPlayFrameId, ") lastPlayDts=(video=").concat(this.videoRecver.lastPlayDts, " audio=").concat(this.audioRecver.lastPlayDts, ")")),
                              this.msePlayer.parser.reset(),
                              this.videoRecver.reset(),
                              this.audioRecver.reset(),
                              this.msePlayer.appendFlv(this.flvHeader)
                          }
                      }]),
                      t
                  }()
                    , Rs = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.p2pPlayer = e,
                          this.tsdbUtil = e.tsdb,
                          this.stat = e.stat,
                          this.data = {
                              act: "webhuyah5qa",
                              uid: 0,
                              sid: 0,
                              subsid: 0,
                              linetype: -1,
                              sendcnt: 0,
                              paucount: 0,
                              paulength: 0,
                              bflength: 0,
                              vr: 0,
                              httphead: "",
                              rel: "jsscene",
                              ref: location.href,
                              isp2p: 1
                          },
                          this.img = null,
                          this.isPaused = !1,
                          this.hasEmptyFrames = !1,
                          this.isFirstReport = !0
                      }
                      return Object(a.a)(t, [{
                          key: "send",
                          value: function() {}
                      }, {
                          key: "record",
                          value: function(t, e, i, s, a) {
                              var r = arguments.length > 5 && void 0 !== arguments[5] && arguments[5];
                              i && (this.isPaused = !0),
                              this.sendNewMetrics(t, e, i, s, a, r)
                          }
                      }, {
                          key: "sendFlow",
                          value: function(t, e, i, s, a) {
                              var r = arguments.length > 5 && void 0 !== arguments[5] && arguments[5]
                                , n = this.p2pPlayer.p2pMgr;
                              n && n.fast_bw > 0 && this.stat.addCore(d.a.CORE.CDN_TOTAL_BW, n.fast_bw),
                              this.record(t, e, i, s, a, r)
                          }
                      }, {
                          key: "sendNewMetrics",
                          value: function(t, e, i, s, a) {
                              var r = arguments.length > 5 && void 0 !== arguments[5] && arguments[5]
                                , o = this.p2pPlayer.G
                                , h = this.p2pPlayer.p2pStat.getMetrics();
                              if (this.stat.setCoreDim(d.a.DIM_CORE.USER_PROPERTY, C.a.userProperty.P2P),
                              this.stat.setCoreDim(d.a.DIM_CORE.VIDEO_BAD_QUALITY_OLD, i ? 100 : 0),
                              this.stat.setCoreDim(d.a.DIM_CORE.VIDEO_BAD_QUALITY, i || t > 0 ? 100 : 0),
                              this.stat.setCoreDim(d.a.DIM_CORE.VIDEO_BAD_REASON, s),
                              this.stat.setCoreDim(d.a.DIM_CORE.SIGNAL_USER_PROPERTY, 0),
                              this.stat.setComDim(d.a.DIM_COM.VIDEO_MIN_BUF, this.p2pPlayer.mse.JITTER_BUFLEN),
                              this.p2pPlayer.player && (this.p2pPlayer.player.msePlayer.pauseStat.record(this.stat),
                              this.p2pPlayer.player.msePlayer.buffered.record(this.stat)),
                              this.p2pPlayer.recSysStat.recordHeart(this.stat),
                              this.p2pPlayer.autoMonitor.recordHeartType(),
                              this.recordC2CDelay(),
                              this.recordAuto(),
                              this.isFirstReport ? this.isFirstReport = !1 : h.push({
                                  sMetricName: f.METRIC.VIDEO_BAD_QUALITY_RATIO,
                                  vField: {
                                      value: this.isPaused ? 100 : 0,
                                      pausecnt: t,
                                      forceskipframe: a
                                  },
                                  vDimension: {
                                      success: this.tsdbUtil.hasP2P,
                                      originalBitrate: 0 === this.p2pPlayer.info.originalBitrate ? 1 : 0,
                                      p2pCooling: z.a.p2pCooling ? 1 : 0,
                                      topSid: o.sid,
                                      reason: s,
                                      quality: i || t > 0 ? 100 : 0
                                  },
                                  vExLog: {
                                      cdnip: this.p2pPlayer.getCdnip()
                                  }
                              }),
                              this.isPaused = !1,
                              this.hasEmptyFrames = !1,
                              this.p2pPlayer.p2pMgr.stream) {
                                  var u = this.p2pPlayer.p2pMgr.stream
                                    , l = u.stat;
                                  if (l.record && l.record(),
                                  l.subStreamStat) {
                                      var p = l.subStreamStat.substream_type
                                        , _ = l.subStreamStat.substream_state;
                                      if (p && _ && p.length === _.length) {
                                          for (var m = p.length, v = "", y = 0; y < m; y++)
                                              y > 0 && (v += ","),
                                              v += p[y] + ":" + _[y];
                                          this.stat.setCoreDim(d.a.DIM_COM.SUB_PCDN_STATE, v)
                                      }
                                  }
                                  for (var T in l.bw) {
                                      var g = l.bw[T];
                                      g > 0 && this.stat.addCore(T, g)
                                  }
                                  for (var S in l.pcdn_data) {
                                      var P = l.pcdn_data[S];
                                      P > 0 && this.stat.setCore(S, P)
                                  }
                                  for (var E in l.pcdn_rsp) {
                                      var I = l.pcdn_rsp[E];
                                      switch (n(I)) {
                                      case "string":
                                          "" !== I && this.stat.setCoreDim(E, I);
                                          break;
                                      case "object":
                                          var A = this._getPcdnRspValue(I);
                                          "" !== A && this.stat.setCoreDim(E, A)
                                      }
                                  }
                                  if (l.sub_change_state) {
                                      var k = this.getSubChangeState(l.sub_change_state);
                                      k.length > 0 && this.stat.setCoreDim(d.a.DIM_COM.SUB_CHANGE_STATE, k)
                                  }
                                  for (var b in l.core)
                                      b === d.a.DIM_COM.STREAM_URL && pi(this.stat, l.core[b], this.p2pPlayer.info.sStreamName),
                                      this.stat.setComDim(b, l.core[b]);
                                  for (var R in l.pcdn_data_state)
                                      this.stat.setComDim(R, l.pcdn_data_state[R]);
                                  this.recordSample(!1),
                                  this.stat.setCore(d.a.CORE.BUFFER_LENGTH, this.p2pPlayer.bufferLen + this.p2pPlayer.frameBufferLen),
                                  this.stat.setCore(d.a.CORE.HAS_PUNCH_NODES, u.getPunchedCnt()),
                                  this.stat.setCore(d.a.CORE.FORWARD_REJECT_CNT, l.forward_reject_cnt),
                                  this.setComp(l, d.a.UPDOWN_INFO.name),
                                  this.setComp(l, d.a.SUB_INFO.name),
                                  this.setComp(l, d.a.PUNCH_INFO.name),
                                  this.setComp(l, d.a.PUNCH_BACK_RET.name),
                                  this.setComp(l, d.a.RESEND_INFO.name),
                                  this.setComp(l, d.a.SUB_RETURN.sub_name),
                                  this.setComp(l, d.a.SUB_RETURN.switch_name),
                                  this.setComp(l, d.a.SUB_RETURN.last_name),
                                  this.setComp(l, d.a.FORCESUB_REASON.name),
                                  this.setComp(l, d.a.NONODE_RETURN.name),
                                  this.setComp(l, d.a.P2P_TCP_TYPE.name),
                                  this.setComp(l, d.a.P2P_TCP_STATE.name),
                                  this.setComp(l, d.a.PCDN_BW_DATA.name);
                                  var L = this.p2pPlayer.player
                                    , w = L.msePlayer.metadata
                                    , O = w.recvVideoFps
                                    , D = w.recvAudioFps;
                                  this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.AUDIO_RATE, D),
                                  this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.VIDEO_RATE, O);
                                  var N = L.msePlayer.bufStat.getStats()
                                    , F = N.emptyTime
                                    , M = N.emptyCnt;
                                  if (this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.VIDEO_BUFFER_EMPTY_COUNT, M),
                                  this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.VIDEO_BUFFER_EMPTY_TIME, F),
                                  this.p2pPlayer.h265Proxy.rendering) {
                                      var U = this.p2pPlayer.h265Proxy.getStats()
                                        , B = U.statProps
                                        , V = U.h265PauseCnt;
                                      for (var x in B)
                                          "toDecode" == x ? this.recordH265Frame(B[x], d.a.DIM_COM.V_TO_DECODE_FRAMES) : "decoded" == x ? this.recordH265Frame(B[x], d.a.DIM_COM.V_DECODE_FRAME) : "render" == x ? this.recordH265Frame(B[x], d.a.DIM_COM.V_PLAY_FRAME) : "rawList" == x ? this.recordH265Frame(B[x], d.a.DIM_COM.V_RECV_FRAME) : "frameList" == x ? this.recordH265Frame(B[x], d.a.DIM_COM.V_TO_PLAY_FRAME) : this.stat.setComp(d.a.DIM_H265_SAM.name, x, B[x].join("|"));
                                      this.stat.setCoreDim(d.a.DIM_CORE.VIDEO_H265_BAD_QUALITY, V > 0 ? 100 : 0)
                                  }
                                  this.p2pPlayer.eventEmitter && this.p2pPlayer.eventEmitter.costUs > 0 && this.stat.setComp(d.a.DIM_H265_SAM.name, "costUs", this.p2pPlayer.eventEmitter.costUs),
                                  this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.VIDEO_WAIT_PUSH, L.videoRecver.chain.size),
                                  this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.VIDEO_DROP_FRAMES, a),
                                  this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.VIDEO_AUDIO_GAP, L.getDtsGap()),
                                  this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.AUDIO_WAIT_GAP, L.audioRecver.getFrameGap()),
                                  this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.VIDEO_WAIT_GAP, L.videoRecver.getFrameGap()),
                                  this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.AUDIO_WAIT_PUSH, L.audioRecver.getSize()),
                                  this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.VIDEO_WAIT_PUSH, L.videoRecver.getSize());
                                  var H = L.getReasons(c.a.now());
                                  this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.AUDIO_WAIT_REASON, H.audioReason),
                                  this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.VIDEO_WAIT_REASON, H.videoReason);
                                  var G = this.p2pPlayer.p2pMgr.stream.stat.updown_info || {}
                                    , j = G.downlink_bw || 0;
                                  this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.SPEED, j);
                                  var W = this.p2pPlayer.player.msePlayer.curVideoDts
                                    , Y = this.p2pPlayer.player.msePlayer.curAudioDts;
                                  this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.VIDEO_DTS, W),
                                  this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.AUDIO_DTS, Y),
                                  l.reset()
                              }
                              this.p2pPlayer.player.msePlayer.metadata && this.p2pPlayer.player.msePlayer.metadata.codecname && this.stat.setComDim(d.a.DIM_COM.SPHD_TYPE, this.p2pPlayer.player.msePlayer.metadata.codecname),
                              this.stat.setCompFormat(d.a.DIM_LINK_SAM.name, ":", ","),
                              this.stat.setComDim(d.a.DIM_COM.CDNIP, this.p2pPlayer.getCdnip()),
                              this.recordAiData(),
                              this.recordMuteData(),
                              this.stat.fill(h, r),
                              this.tsdbUtil.sendMetrics(h)
                          }
                      }, {
                          key: "_getPcdnRspValue",
                          value: function(t) {
                              var e = [];
                              for (var i in t)
                                  e.push("".concat(i, ":").concat(t[i]));
                              return e.join(",")
                          }
                      }, {
                          key: "recordSample",
                          value: function(t) {
                              this.p2pPlayer.sampleController.recordStat(this.stat, t),
                              this.p2pPlayer.player.msePlayer.parser.avSample.recordStat(this.stat)
                          }
                      }, {
                          key: "recordAiData",
                          value: function() {
                              var t = this.p2pPlayer.getAiStat()
                                , e = t.aiP2PCnt
                                , i = t.aiFlvCnt
                                , s = t.aiP2PTimeoutCnt
                                , a = t.aiFlvTimeoutCnt
                                , r = t.aiP2PErrorCnt
                                , n = t.aiFlvErrorCnt
                                , o = t.aiP2PSwitchCnt
                                , h = t.aiFlvSwitchCnt
                                , u = t.aiP2PNotSwitchCnt
                                , l = t.aiFlvNotSwitchCnt
                                , c = t.aiFlvErrorSwitchCnt
                                , p = t.aiFlvErrorNotSwitchCnt
                                , f = t.aiStartP2PCnt
                                , _ = t.aiStartFlvCnt;
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_P2P_CNT, e),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_FLV_CNT, i),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_P2P_TIMEOUT_CNT, s),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_FLV_TIMEOUT_CNT, a),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_P2P_ERROR_CNT, r),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_FLV_ERROR_CNT, n),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_P2P_SWITCH_CNT, o),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_FLV_SWITCH_CNT, h),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_P2P_NOT_SWITCH_CNT, u),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_FLV_NOT_SWITCH_CNT, l),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_FLV_ERROR_SWITCH_CNT, c),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_FLV_ERROR_NOT_SWITCH_CNT, p),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_START_P2P_CNT, f),
                              this.stat.setComp(d.a.AI_CONTROL_DATA.name, d.a.AI_CONTROL_DATA.AI_START_FLV_CNT, _),
                              this.stat.setCompFormat(d.a.AI_CONTROL_DATA.name, ":", ",")
                          }
                      }, {
                          key: "recordMuteData",
                          value: function() {
                              if (this.p2pPlayer.eventEmitter.getMuteStat) {
                                  var t = this.p2pPlayer.eventEmitter.getMuteStat().muteData
                                    , e = [];
                                  t.map((function(t) {
                                      var i = [];
                                      i.push(t.value),
                                      i.push(t.type),
                                      i.push(t.currentDts),
                                      i.push(t.reqKey),
                                      i.push(t.begin),
                                      i.push(t.end),
                                      e.push(i.join(":"))
                                  }
                                  )),
                                  this.stat.setCoreDim(d.a.DIM_COM.MUTE_DATA, e.join(","))
                              }
                          }
                      }, {
                          key: "recordC2CDelay",
                          value: function() {
                              var t = this.p2pPlayer.player.msePlayer.getDelayStat();
                              if (t) {
                                  for (var e in t.fields)
                                      this.stat.setCore(e, t.fields[e]);
                                  for (var i in t.dims)
                                      this.stat.setCoreDim(i, t.dims[i])
                              }
                          }
                      }, {
                          key: "recordAuto",
                          value: function() {
                              var t = this.p2pPlayer.ctrlBitrate;
                              t && (this.stat.setCoreDim(d.a.DIM_CORE.AUTO_U_REASON, t._switchUpReason),
                              this.stat.setCoreDim(d.a.DIM_CORE.AUTO_D_REASON, t._switchDownReason))
                          }
                      }, {
                          key: "recordH265Frame",
                          value: function(t, e) {
                              var i = this;
                              this.stat.setComp(e, "size", t.length),
                              t.map((function(t, s) {
                                  i.stat.setComp(e, "k" + (s + 1), t),
                                  i.stat.setCompFormat(e, ":", ",")
                              }
                              ))
                          }
                      }, {
                          key: "getSubChangeState",
                          value: function(t) {
                              var e = [];
                              for (var i in t) {
                                  var s = t[i]
                                    , a = [];
                                  for (var r in s)
                                      a.push("".concat(r, ":").concat(s[r]));
                                  e.push(i + ";" + a.join("|"))
                              }
                              return e.join(",")
                          }
                      }, {
                          key: "setComp",
                          value: function(t, e) {
                              var i = t[e];
                              for (var s in i) {
                                  var a = i[s];
                                  "number" == typeof a ? a > 0 && this.stat.setComp(e, s, a) : this.stat.setComp(e, s, a)
                              }
                          }
                      }]),
                      t
                  }()
                    , Ls = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.p2pPlayer = e,
                          this.tsdbUtil = e.tsdb,
                          this.stat = e.stat,
                          this.p2pState = -1,
                          this.hasFlow = !1,
                          this.metric = new Map,
                          this.total = new Map,
                          this.metric20 = new Map,
                          this.subNodes = new Map,
                          this.playBufLength = 0,
                          this.record = {
                              resendTimes: 0,
                              resendTimeoutCnt: 0,
                              resendErrorTimes: 0,
                              resendSliceCnt: 0,
                              resendRespondCnt: 0,
                              resendLateCnt: 0,
                              resendMissCnt: 0,
                              repeatResendCnt: 0,
                              repeatResendSucc: 0,
                              repeatResendFail: 0,
                              dropFrames: 0,
                              playedFrames: 0,
                              dtsJumpPauseTimes: 0,
                              skipFramePauseTimes: 0,
                              fullFrameRatio: 0
                          }
                      }
                      return Object(a.a)(t, [{
                          key: "addSubNodes",
                          value: function(t) {
                              this.subNodes.set(t, 0)
                          }
                      }, {
                          key: "add",
                          value: function(t, e) {
                              this.hasFlow = !0,
                              this.addValue(this.metric, t, e),
                              this.addValue(this.total, t, e),
                              this.addValue(this.metric20, t, e)
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              this.hasFlow = !1,
                              this.total.clear(),
                              this.metric.clear(),
                              this.subNodes.clear()
                          }
                      }, {
                          key: "reportFlow",
                          value: function() {
                              if (this.hasFlow) {
                                  this.hasFlow = !1;
                                  var t = [];
                                  this.fillFlow(t),
                                  this.metric.clear(),
                                  this.stat.setCoreDim(d.a.DIM_CORE.USER_PROPERTY, C.a.userProperty.P2P),
                                  this.stat.fill(t, !0),
                                  this.tsdbUtil.sendMetrics(t)
                              }
                          }
                      }, {
                          key: "getMetrics",
                          value: function() {
                              var t = [];
                              return this.fillLogin(t),
                              Number(localStorage._noP2p) || (this.fillPunch(t),
                              this.fillPlayRatio(t),
                              this.fillFlow(t),
                              this.fillDetails(t),
                              this.stat.setCore(d.a.CORE.HAS_PUNCH_NODES, 0)),
                              this.metric.clear(),
                              t
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              e % 20 == 0 && this.p2pPlayer.p2pMgr.stream && this.p2pPlayer.p2pMgr.stream.printInfo()
                          }
                      }, {
                          key: "getOldMetrics",
                          value: function() {
                              return []
                          }
                      }, {
                          key: "fillPlayRatio",
                          value: function(t) {}
                      }, {
                          key: "fillLogin",
                          value: function(t) {}
                      }, {
                          key: "fillPunch",
                          value: function(t) {}
                      }, {
                          key: "fillDetails",
                          value: function(t) {}
                      }, {
                          key: "fillFlow",
                          value: function(t) {}
                      }, {
                          key: "addValue",
                          value: function(t, e, i) {
                              var s = 0;
                              t.has(e) && (s = t.get(e)),
                              t.set(e, s + i)
                          }
                      }, {
                          key: "recordPlayBuf",
                          value: function() {
                              this.playBufLength = this.getMetricValue(t.keys.SERVER_TOTAL_STREAM_FLOW)
                          }
                      }, {
                          key: "printLoadFail",
                          value: function(e) {
                              if (Number(localStorage._printP2PInfo)) {
                                  var i = this.getMetricValue(t.keys.SERVER_TOTAL_STREAM_FLOW);
                                  e ? l.a.warn("出视频失败，当前收到数据，bufferLength", i) : l.a.warn("出视频成功，当前收到数据，bufferLength", i, "出视频时BufferLength", this.playBufLength)
                              }
                          }
                      }, {
                          key: "getValueFromMap",
                          value: function(t, e) {
                              return t.has(e) ? t.get(e) : 0
                          }
                      }, {
                          key: "getMetricValue",
                          value: function(t) {
                              return this.metric.has(t) ? this.metric.get(t) : 0
                          }
                      }]),
                      t
                  }()
                    , ws = 5e3;
                  function Os() {
                      return ws++
                  }
                  Ls.keys = {
                      P2P_TOTAL_STREAM_FLOW: 1,
                      P2P_VALID_STREAM_FLOW: 2,
                      SERVER_TOTAL_STREAM_FLOW: 3,
                      SERVER_VALID_STREAM_FLOW: 4,
                      RESEND_SEQ_NUM: 7,
                      REAL_UPLINK_STREAM_SUM: 8,
                      SUBSCRIBE_TIMEOUT_TIMES: 10,
                      SUBSCRIBE_FAILED_TIMES: 11,
                      SUBSCRIBE_SUCCESS_TIMES: 12,
                      SUBSCRIBE_TOTAL_TIMES: 14,
                      INVALID_PACKET_NUM: 13,
                      TOTAL_PEER_NODES: 22,
                      ACTIVE_PUNCH_NODES: 23,
                      PASSIVE_PUNCH_NODES: 24,
                      TRY_PUNCH_NUM: 29,
                      PUNCH_FAIL_NUM: 30,
                      PUNCH_SUC_NUM: 31,
                      FORWARD_REJECT_NUM: 32,
                      GET_NODES_VALID: Os(),
                      GET_NODES_TOTAL: Os(),
                      SUB_NODES: Os(),
                      CDN_SLICE_SEND_COUNT: 85,
                      CDN_SLICE_RECV_COUNT: 86,
                      PUNCH_FAIL_HAS_ICE: 500,
                      PUNCH_FAIL_NO_ICE: 501,
                      RANGE_TOTAL_STREAM_FLOW: 502,
                      RANGE_VALID_STREAM_FLOW: 503,
                      SLICE_REPEAT_CDN: 504,
                      SLICE_REPEAT_P2P: 505,
                      PATCH_FLOW: Os(),
                      SUB_TIMEOUT_TIMES: Os(),
                      SUB_SUC_TIMES: Os(),
                      SUB_FAIL_TIMES: Os(),
                      SUB_TOTAL_TIMES: Os(),
                      SUB_TRY_TIMES: Os(),
                      SUB_KICK_TIMES: Os(),
                      COMPETE_TIMEOUT_TIMES: Os(),
                      COMPETE_SUC_TIMES: Os(),
                      COMPETE_FAIL_TIMES: Os(),
                      COMPETE_TOTAL_TIMES: Os(),
                      DIF_PEER_NUM: Os(),
                      FORCE_NO_PEER: Os(),
                      FORCE_SUB_END: Os(),
                      FORCE_SUB_TIMEOUT: Os(),
                      FORCE_SUB_FAIL: Os(),
                      FORCE_DEPTH_LARGE: Os(),
                      FORCE_SUB_FAIL_SWITCH: Os(),
                      FLOW_COMPETE: Os(),
                      FLOW_FORCE: Os(),
                      FLOW_FIXED: Os(),
                      FLOW_SINGLLING: Os(),
                      FLOW_DEFAULT: Os(),
                      FLOW_FAST: Os(),
                      FLOW_SINGLLING_DOWN: Os(),
                      FORCE_TIMES: Os(),
                      REMOVE_SUB_TIMES: Os(),
                      SUB_RES_TOTAL: Os(),
                      SUB_FAIL_SUC: Os(),
                      SUB_FAIL_STREAM_LIMIT: Os(),
                      SUB_FAIL_SLICE_LATE: Os(),
                      SUB_FAIL_SLICE_FAST: Os(),
                      SUB_FAIL_SLICE_LARGE: Os(),
                      SUB_FAIL_EMPTY_PEER_INFO: Os(),
                      SUB_FAIL_STREAM_LATE: Os(),
                      SUB_FAIL_SUBSCRIBE_UPLINK_NOT_ENOUGHE: Os(),
                      SUB_FAIL_SUBSCRIBE_CYCLE: Os(),
                      SUB_FAIL_OTHER: Os(),
                      SUB_FAIL_KICK_OUT: Os(),
                      SUB_FAIL_SELF_WORST: Os(),
                      SWITCH_LAST_PUB: Os(),
                      SWITCH_STREAM_LIMIT: Os(),
                      SWITCH_SLICE_LARGE: Os(),
                      SWITCH_SLICE_LATE: Os(),
                      SWITCH_SLICE_FAST: Os(),
                      SWITCH_EMPTY_PEER_INFO: Os(),
                      SWITCH_STREAM_LATE: Os(),
                      SWITCH_SUBSCRIBE_UPLINK_NOT_ENOUGH: Os(),
                      SWITCH_SUBSCRIBE_CYCLE: Os(),
                      SWITCH_KICK_OUT: Os(),
                      SWITCH_SELF_WORST: Os(),
                      SWITCH_SUC: Os(),
                      SWITCH_OTHER: Os(),
                      LAST_STREAM_LIMIT: Os(),
                      LAST_SLICE_LARGE: Os(),
                      LAST_SLICE_LATE: Os(),
                      LAST_SLICE_FAST: Os(),
                      LAST_STREAM_LATE: Os(),
                      LAST_UPLINK: Os(),
                      LAST_CYCLE: Os(),
                      LAST_KICK: Os(),
                      LAST_SELF_WORST: Os(),
                      LAST_SUC: Os(),
                      LAST_OTHER: Os(),
                      DEFAULT_REASON: Os(),
                      LEAVE_PING_DIF: Os(),
                      LEAVE_RESET: Os(),
                      PUNCH_BACK_TIMES: Os(),
                      PUNCH_BACK_SUC: Os(),
                      PUNCH_BACK_TRY: Os(),
                      PUNCH_BACK_RET_SUC: Os(),
                      PUNCH_BACK_RET_DIF_STREAM: Os(),
                      PUNCH_BACK_RET_CLOSING: Os(),
                      PUNCH_BACK_RET_COOLING: Os(),
                      PUNCH_BACK_RET_REQUEST: Os(),
                      PUNCH_BACK_REJECT: Os(),
                      RESEND_FETCH_ERROR: Os(),
                      VALID_RET_PRESENTER: Os(),
                      VALID_RET_UPLINK: Os(),
                      VALID_RET_PULL: Os(),
                      VALID_RET_SUBED: Os(),
                      VALID_RET_COOLING: Os(),
                      VALID_RET_DELAY: Os(),
                      VALID_RET_RTT: Os(),
                      VALID_RET_BW: Os(),
                      VALID_RET_LATE: Os(),
                      VALID_RET_FAST: Os(),
                      VALID_RET_NONE: Os(),
                      CLIENT_TYPE: 160,
                      RATE: 120
                  };
                  var Ds = Ls
                    , Ns = {}
                    , Fs = Ns;
                  Ns.INT8 = function() {
                      this._clone = function() {
                          return 0
                      }
                      ,
                      this._write = function(t, e, i) {
                          return t.writeInt8(e, i)
                      }
                      ,
                      this._read = function(t, e, i) {
                          return t.readInt8(e, !0, i)
                      }
                      ,
                      this._className = function() {
                          return Ns.CHAR
                      }
                  }
                  ,
                  Ns.INT16 = function() {
                      this._clone = function() {
                          return 0
                      }
                      ,
                      this._write = function(t, e, i) {
                          return t.writeInt16(e, i)
                      }
                      ,
                      this._read = function(t, e, i) {
                          return t.readInt16(e, !0, i)
                      }
                      ,
                      this._className = function() {
                          return Ns.SHORT
                      }
                  }
                  ,
                  Ns.INT32 = function() {
                      this._clone = function() {
                          return 0
                      }
                      ,
                      this._write = function(t, e, i) {
                          return t.writeInt32(e, i)
                      }
                      ,
                      this._read = function(t, e, i) {
                          return t.readInt32(e, !0, i)
                      }
                      ,
                      this._className = function() {
                          return Ns.INT32
                      }
                  }
                  ,
                  Ns.INT64 = function() {
                      this._clone = function() {
                          return 0
                      }
                      ,
                      this._write = function(t, e, i) {
                          return t.writeInt64(e, i)
                      }
                      ,
                      this._read = function(t, e, i) {
                          return t.readInt64(e, !0, i)
                      }
                      ,
                      this._className = function() {
                          return Ns.INT64
                      }
                  }
                  ,
                  Ns.UINT8 = function() {
                      this._clone = function() {
                          return 0
                      }
                      ,
                      this._write = function(t, e, i) {
                          return t.writeInt16(e, i)
                      }
                      ,
                      this._read = function(t, e, i) {
                          return t.readInt16(e, !0, i)
                      }
                      ,
                      this._className = function() {
                          return Ns.SHORT
                      }
                  }
                  ,
                  Ns.UInt16 = function() {
                      this._clone = function() {
                          return 0
                      }
                      ,
                      this._write = function(t, e, i) {
                          return t.writeInt32(e, i)
                      }
                      ,
                      this._read = function(t, e, i) {
                          return t.readInt32(e, !0, i)
                      }
                      ,
                      this._className = function() {
                          return Ns.INT32
                      }
                  }
                  ,
                  Ns.UInt32 = function() {
                      this._clone = function() {
                          return 0
                      }
                      ,
                      this._write = function(t, e, i) {
                          return t.writeInt64(e, i)
                      }
                      ,
                      this._read = function(t, e, i) {
                          return t.readInt64(e, !0, i)
                      }
                      ,
                      this._className = function() {
                          return Ns.INT64
                      }
                  }
                  ,
                  Ns.Float = function() {
                      this._clone = function() {
                          return 0
                      }
                      ,
                      this._write = function(t, e, i) {
                          return t.writeFloat(e, i)
                      }
                      ,
                      this._read = function(t, e, i) {
                          return t.readFloat(e, !0, i)
                      }
                      ,
                      this._className = function() {
                          return Ns.FLOAT
                      }
                  }
                  ,
                  Ns.Double = function() {
                      this._clone = function() {
                          return 0
                      }
                      ,
                      this._write = function(t, e, i) {
                          return t.writeDouble(e, i)
                      }
                      ,
                      this._read = function(t, e, i) {
                          return t.readDouble(e, !0, i)
                      }
                      ,
                      this._className = function() {
                          return Ns.DOUBLE
                      }
                  }
                  ,
                  Ns.STRING = function() {
                      this._clone = function() {
                          return 0
                      }
                      ,
                      this._write = function(t, e, i) {
                          return t.writeString(e, i)
                      }
                      ,
                      this._read = function(t, e, i) {
                          return t.readString(e, !0, i)
                      }
                      ,
                      this._className = function() {
                          return Ns.STRING
                      }
                  }
                  ,
                  Ns.BOOLEAN = function() {
                      this._clone = function() {
                          return !1
                      }
                      ,
                      this._write = function(t, e, i) {
                          return t.writeBoolean(e, i)
                      }
                      ,
                      this._read = function(t, e, i) {
                          return t.readBoolean(e, !0, i)
                      }
                      ,
                      this._className = function() {
                          return Ns.BOOLEAN
                      }
                  }
                  ,
                  Ns.ENUM = function() {
                      this._clone = function() {
                          return 0
                      }
                      ,
                      this._write = function(t, e, i) {
                          return t.writeInt32(e, i)
                      }
                      ,
                      this._read = function(t, e, i) {
                          return t.readInt32(e, !0, i)
                      }
                  }
                  ,
                  Ns.Vector = function(t) {
                      this.proto = t,
                      this.value = new Array
                  }
                  ,
                  Ns.Vector.prototype._clone = function() {
                      return new Ns.Vector(this.proto)
                  }
                  ,
                  Ns.Vector.prototype._write = function(t, e, i) {
                      return t.writeVector(e, i)
                  }
                  ,
                  Ns.Vector.prototype._read = function(t, e, i) {
                      return t.readVector(e, !0, i)
                  }
                  ,
                  Ns.Vector.prototype._className = function() {
                      return Ns.TypeHelp.VECTOR.replace("$t", this.proto._className())
                  }
                  ,
                  Ns.Map = function(t, e) {
                      this.kproto = t,
                      this.vproto = e,
                      this.value = new Object
                  }
                  ,
                  Ns.Map.prototype._clone = function() {
                      return new Ns.Map(this.kproto,this.vproto)
                  }
                  ,
                  Ns.Map.prototype._write = function(t, e, i) {
                      return t.writeMap(e, i)
                  }
                  ,
                  Ns.Map.prototype._read = function(t, e, i) {
                      return t.readMap(e, !0, i)
                  }
                  ,
                  Ns.Map.prototype.put = function(t, e) {
                      this.value[t] = e
                  }
                  ,
                  Ns.Map.prototype.get = function(t) {
                      return this.value[t]
                  }
                  ,
                  Ns.Map.prototype.getKeys = function() {
                      var t = [];
                      for (var e in this.value)
                          "" != e && t.push(e);
                      return t
                  }
                  ,
                  Ns.Map.prototype.hasKey = function(t) {
                      return this.value.hasOwnProperty(t)
                  }
                  ,
                  Ns.Map.prototype.remove = function(t) {
                      delete this.value[t]
                  }
                  ,
                  Ns.Map.prototype.clear = function() {
                      this.value = new Object
                  }
                  ,
                  Ns.Map.prototype.size = function() {
                      var t = 0;
                      for (var e in this.value)
                          t++;
                      return t
                  }
                  ,
                  Ns.Vector.prototype._className = function() {
                      return Ns.TypeHelp.Map.replace("$k", this.kproto._className()).replace("$v", this.vproto._className())
                  }
                  ,
                  Ns.DataHelp = {
                      EN_INT8: 0,
                      EN_INT16: 1,
                      EN_INT32: 2,
                      EN_INT64: 3,
                      EN_FLOAT: 4,
                      EN_DOUBLE: 5,
                      EN_STRING1: 6,
                      EN_STRING4: 7,
                      EN_MAP: 8,
                      EN_LIST: 9,
                      EN_STRUCTBEGIN: 10,
                      EN_STRUCTEND: 11,
                      EN_ZERO: 12,
                      EN_SIMPLELIST: 13
                  },
                  Ns.TypeHelp = {
                      BOOLEAN: "bool",
                      CHAR: "char",
                      SHORT: "short",
                      INT32: "int32",
                      INT64: "int64",
                      FLOAT: "float",
                      DOUBLE: "double",
                      STRING: "string",
                      VECTOR: "list<$t>",
                      MAP: "map<$k, $v>"
                  },
                  Ns.BinBuffer = function(t) {
                      this.buf = null,
                      this.vew = null,
                      this.len = 0,
                      this.position = 0,
                      null != t && null != t && (t instanceof ArrayBuffer ? (this.buf = t,
                      this.vew = new DataView(this.buf),
                      this.len = this.vew.byteLength,
                      this.position = 0) : (this.buf = t.buf,
                      this.vew = new DataView(this.buf),
                      this.len = t.length,
                      this.position = t.position)),
                      this.__defineGetter__("length", (function() {
                          return this.len
                      }
                      )),
                      this.__defineGetter__("buffer", (function() {
                          return this.buf
                      }
                      ))
                  }
                  ,
                  Ns.BinBuffer.prototype._write = function(t, e, i) {
                      return t.writeBytes(e, i)
                  }
                  ,
                  Ns.BinBuffer.prototype._read = function(t, e, i) {
                      return t.readBytes(e, !0, i)
                  }
                  ,
                  Ns.BinBuffer.prototype._clone = function() {
                      return new Ns.BinBuffer
                  }
                  ,
                  Ns.BinBuffer.prototype.allocate = function(t) {
                      if (t = this.position + t,
                      !(null != this.buf && this.buf.length > t)) {
                          var e = new ArrayBuffer(Math.max(256, 2 * t));
                          null != this.buf && (new Uint8Array(e).set(new Uint8Array(this.buf)),
                          this.buf = void 0),
                          this.buf = e,
                          this.vew = void 0,
                          this.vew = new DataView(this.buf)
                      }
                  }
                  ,
                  Ns.BinBuffer.prototype.getBuffer = function() {
                      var t = new ArrayBuffer(this.len);
                      return new Uint8Array(t).set(new Uint8Array(this.buf,0,this.len)),
                      t
                  }
                  ,
                  Ns.BinBuffer.prototype.memset = function(t, e, i) {
                      this.allocate(i),
                      new Uint8Array(this.buf).set(new Uint8Array(t,e,i), this.position)
                  }
                  ,
                  Ns.BinBuffer.prototype.writeInt8 = function(t) {
                      this.allocate(1),
                      this.vew.setInt8(this.position, t),
                      this.position += 1,
                      this.len = this.position
                  }
                  ,
                  Ns.BinBuffer.prototype.writeUInt8 = function(t) {
                      this.allocate(1),
                      this.vew.setUint8(this.position++, t),
                      this.len = this.position
                  }
                  ,
                  Ns.BinBuffer.prototype.writeInt16 = function(t) {
                      this.allocate(2),
                      this.vew.setInt16(this.position, t),
                      this.position += 2,
                      this.len = this.position
                  }
                  ,
                  Ns.BinBuffer.prototype.writeUInt16 = function(t) {
                      this.allocate(2),
                      this.vew.setUint16(this.position, t),
                      this.position += 2,
                      this.len = this.position
                  }
                  ,
                  Ns.BinBuffer.prototype.writeInt32 = function(t) {
                      this.allocate(4),
                      this.vew.setInt32(this.position, t),
                      this.position += 4,
                      this.len = this.position
                  }
                  ,
                  Ns.BinBuffer.prototype.writeUInt32 = function(t) {
                      this.allocate(4),
                      this.vew.setUint32(this.position, t),
                      this.position += 4,
                      this.len = this.position
                  }
                  ,
                  Ns.BinBuffer.prototype.writeInt64 = function(t) {
                      this.allocate(8),
                      this.vew.setUint32(this.position, parseInt(t / 4294967296)),
                      this.vew.setUint32(this.position + 4, t % 4294967296),
                      this.position += 8,
                      this.len = this.position
                  }
                  ,
                  Ns.BinBuffer.prototype.writeFloat = function(t) {
                      this.allocate(4),
                      this.vew.setFloat32(this.position, t),
                      this.position += 4,
                      this.len = this.position
                  }
                  ,
                  Ns.BinBuffer.prototype.writeDouble = function(t) {
                      this.allocate(8),
                      this.vew.setFloat64(this.position, t),
                      this.position += 8,
                      this.len = this.position
                  }
                  ,
                  Ns.BinBuffer.prototype.writeString = function(t) {
                      for (var e = [], i = 0; i < t.length; i++)
                          e.push(255 & t.charCodeAt(i));
                      this.allocate(e.length),
                      new Uint8Array(this.buf).set(new Uint8Array(e), this.position),
                      this.position += e.length,
                      this.len = this.position
                  }
                  ,
                  Ns.BinBuffer.prototype.writeBytes = function(t) {
                      0 != t.length && null != t.buf && (this.allocate(t.length),
                      new Uint8Array(this.buf).set(new Uint8Array(t.buf,0,t.length), this.position),
                      this.position += t.length,
                      this.len = this.position)
                  }
                  ,
                  Ns.BinBuffer.prototype.readInt8 = function() {
                      return this.vew.getInt8(this.position++)
                  }
                  ,
                  Ns.BinBuffer.prototype.readInt16 = function() {
                      return this.position += 2,
                      this.vew.getInt16(this.position - 2)
                  }
                  ,
                  Ns.BinBuffer.prototype.readInt32 = function() {
                      return this.position += 4,
                      this.vew.getInt32(this.position - 4)
                  }
                  ,
                  Ns.BinBuffer.prototype.readUInt8 = function() {
                      return this.position += 1,
                      this.vew.getUint8(this.position - 1)
                  }
                  ,
                  Ns.BinBuffer.prototype.readUInt16 = function() {
                      return this.position += 2,
                      this.vew.getUint16(this.position - 2)
                  }
                  ,
                  Ns.BinBuffer.prototype.readUInt32 = function() {
                      return this.position += 4,
                      this.vew.getUint32(this.position - 4)
                  }
                  ,
                  Ns.BinBuffer.prototype.readInt64 = function() {
                      var t = this.vew.getUint32(this.position)
                        , e = this.vew.getUint32(this.position + 4);
                      return this.position += 8,
                      4294967296 * t + e
                  }
                  ,
                  Ns.BinBuffer.prototype.readFloat = function() {
                      var t = this.vew.getFloat32(this.position);
                      return this.position += 4,
                      t
                  }
                  ,
                  Ns.BinBuffer.prototype.readDouble = function() {
                      var t = this.vew.getFloat64(this.position);
                      return this.position += 8,
                      t
                  }
                  ,
                  Ns.BinBuffer.prototype.readString = function(t) {
                      for (var e = [], i = 0; i < t; i++)
                          e.push(String.fromCharCode(this.vew.getUint8(this.position++)));
                      var s = e.join("");
                      try {
                          s = decodeURIComponent(escape(s))
                      } catch (t) {}
                      return s
                  }
                  ,
                  Ns.BinBuffer.prototype.readBytes = function(t) {
                      var e = new Ns.BinBuffer;
                      return e.allocate(t),
                      e.memset(this.buf, this.position, t),
                      e.position = 0,
                      e.len = t,
                      this.position = this.position + t,
                      e
                  }
                  ,
                  Ns.JceOutputStream = function() {
                      this.buf = new Ns.BinBuffer,
                      this.getBinBuffer = function() {
                          return this.buf
                      }
                      ,
                      this.getBuffer = function() {
                          return this.buf.getBuffer()
                      }
                  }
                  ,
                  Ns.JceOutputStream.prototype.clear = function() {
                      return this.buf = new Ns.BinBuffer,
                      this
                  }
                  ,
                  Ns.JceOutputStream.prototype.writeTo = function(t, e) {
                      t < 15 ? this.buf.writeUInt8(t << 4 & 240 | e) : this.buf.writeUInt16((240 | e) << 8 | t)
                  }
                  ,
                  Ns.JceOutputStream.prototype.writeBoolean = function(t, e) {
                      this.writeInt8(t, 1 == e ? 1 : 0)
                  }
                  ,
                  Ns.JceOutputStream.prototype.writeInt8 = function(t, e) {
                      0 == e ? this.writeTo(t, Ns.DataHelp.EN_ZERO) : (this.writeTo(t, Ns.DataHelp.EN_INT8),
                      this.buf.writeInt8(e))
                  }
                  ,
                  Ns.JceOutputStream.prototype.writeInt16 = function(t, e) {
                      e >= -128 && e <= 127 ? this.writeInt8(t, e) : (this.writeTo(t, Ns.DataHelp.EN_INT16),
                      this.buf.writeInt16(e))
                  }
                  ,
                  Ns.JceOutputStream.prototype.writeInt32 = function(t, e) {
                      e >= -32768 && e <= 32767 ? this.writeInt16(t, e) : (this.writeTo(t, Ns.DataHelp.EN_INT32),
                      this.buf.writeInt32(e))
                  }
                  ,
                  Ns.JceOutputStream.prototype.writeInt64 = function(t, e) {
                      e >= -2147483648 && e <= 2147483647 ? this.writeInt32(t, e) : (this.writeTo(t, Ns.DataHelp.EN_INT64),
                      this.buf.writeInt64(e))
                  }
                  ,
                  Ns.JceOutputStream.prototype.writeUInt8 = function(t, e) {
                      this.writeInt16(t, e)
                  }
                  ,
                  Ns.JceOutputStream.prototype.writeUInt16 = function(t, e) {
                      this.writeInt32(t, e)
                  }
                  ,
                  Ns.JceOutputStream.prototype.writeUInt32 = function(t, e) {
                      this.writeInt64(t, e)
                  }
                  ,
                  Ns.JceOutputStream.prototype.writeFloat = function(t, e) {
                      0 == e ? this.writeTo(t, Ns.DataHelp.EN_ZERO) : (this.writeTo(t, Ns.DataHelp.EN_FLOAT),
                      this.buf.writeFloat(e))
                  }
                  ,
                  Ns.JceOutputStream.prototype.writeDouble = function(t, e) {
                      0 == e ? this.writeTo(t, Ns.DataHelp.EN_ZERO) : (this.writeTo(t, Ns.DataHelp.EN_DOUBLE),
                      this.buf.writeDouble(e))
                  }
                  ,
                  Ns.JceOutputStream.prototype.writeStruct = function(t, e) {
                      if (null == e.writeTo)
                          throw Error("not defined writeTo Function");
                      this.writeTo(t, Ns.DataHelp.EN_STRUCTBEGIN),
                      e.writeTo(this),
                      this.writeTo(0, Ns.DataHelp.EN_STRUCTEND)
                  }
                  ,
                  Ns.JceOutputStream.prototype.writeString = function(t, e) {
                      var i = e;
                      try {
                          i = unescape(encodeURIComponent(i))
                      } catch (t) {}
                      i.length > 255 ? (this.writeTo(t, Ns.DataHelp.EN_STRING4),
                      this.buf.writeUInt32(i.length)) : (this.writeTo(t, Ns.DataHelp.EN_STRING1),
                      this.buf.writeUInt8(i.length)),
                      this.buf.writeString(i)
                  }
                  ,
                  Ns.JceOutputStream.prototype.writeBytes = function(t, e) {
                      this.writeTo(t, Ns.DataHelp.EN_SIMPLELIST),
                      this.writeTo(0, Ns.DataHelp.EN_INT8),
                      this.writeInt32(0, e.length),
                      this.buf.writeBytes(e)
                  }
                  ,
                  Ns.JceOutputStream.prototype.writeVector = function(t, e) {
                      this.writeTo(t, Ns.DataHelp.EN_LIST),
                      this.writeInt32(0, e.value.length);
                      for (var i = 0; i < e.value.length; i++)
                          e.proto._write(this, 0, e.value[i])
                  }
                  ,
                  Ns.JceOutputStream.prototype.writeMap = function(t, e) {
                      for (var i in this.writeTo(t, Ns.DataHelp.EN_MAP),
                      this.writeInt32(0, e.size()),
                      e.value)
                          e.kproto._write(this, 0, i),
                          e.vproto._write(this, 1, e.value[i])
                  }
                  ,
                  Ns.JceInputStream = function(t) {
                      this.buf = new Ns.BinBuffer(t)
                  }
                  ,
                  Ns.JceInputStream.prototype.setBuffer = function(t) {
                      return this.buf = new Ns.BinBuffer(t),
                      this
                  }
                  ,
                  Ns.JceInputStream.prototype.readFrom = function() {
                      var t = this.buf.readUInt8()
                        , e = (240 & t) >> 4
                        , i = 15 & t;
                      return e >= 15 && (e = this.buf.readUInt8()),
                      {
                          tag: e,
                          type: i
                      }
                  }
                  ,
                  Ns.JceInputStream.prototype.peekFrom = function() {
                      var t = this.buf.position
                        , e = this.readFrom();
                      return this.buf.position = t,
                      {
                          tag: e.tag,
                          type: e.type,
                          size: e.tag >= 15 ? 2 : 1
                      }
                  }
                  ,
                  Ns.JceInputStream.prototype.skipField = function(t) {
                      switch (t) {
                      case Ns.DataHelp.EN_INT8:
                          this.buf.position += 1;
                          break;
                      case Ns.DataHelp.EN_INT16:
                          this.buf.position += 2;
                          break;
                      case Ns.DataHelp.EN_INT32:
                          this.buf.position += 4;
                          break;
                      case Ns.DataHelp.EN_INT64:
                          this.buf.position += 8;
                          break;
                      case Ns.DataHelp.EN_STRING1:
                          var e = this.buf.readUInt8();
                          this.buf.position += e;
                          break;
                      case Ns.DataHelp.EN_STRING4:
                          var i = this.buf.readInt32();
                          this.buf.position += i;
                          break;
                      case Ns.DataHelp.EN_STRUCTBEGIN:
                          this.skipToStructEnd();
                          break;
                      case Ns.DataHelp.EN_STRUCTEND:
                      case Ns.DataHelp.EN_ZERO:
                          break;
                      case Ns.DataHelp.EN_MAP:
                          for (var s = this.readInt32(0, !0), a = 0; a < 2 * s; ++a) {
                              var r = this.readFrom();
                              this.skipField(r.type)
                          }
                          break;
                      case Ns.DataHelp.EN_SIMPLELIST:
                          if ((r = this.readFrom()).type != Ns.DataHelp.EN_INT8)
                              throw Error("skipField with invalid type, type value: " + t + "," + r.type);
                          e = this.readInt32(0, !0),
                          this.buf.position += e;
                          break;
                      case Ns.DataHelp.EN_LIST:
                          for (s = this.readInt32(0, !0),
                          a = 0; a < s; ++a)
                              r = this.readFrom(),
                              this.skipField(r.type);
                          break;
                      default:
                          throw new Error("skipField with invalid type, type value: " + t)
                      }
                  }
                  ,
                  Ns.JceInputStream.prototype.skipToStructEnd = function() {
                      for (; ; ) {
                          var t = this.readFrom();
                          if (this.skipField(t.type),
                          t.type == Ns.DataHelp.EN_STRUCTEND)
                              return
                      }
                  }
                  ,
                  Ns.JceInputStream.prototype.skipToTag = function(t, e) {
                      for (; this.buf.position < this.buf.length; ) {
                          var i = this.peekFrom();
                          if (t <= i.tag || i.type == Ns.DataHelp.EN_STRUCTEND)
                              return i.type != Ns.DataHelp.EN_STRUCTEND && t == i.tag;
                          this.buf.position += i.size,
                          this.skipField(i.type)
                      }
                      if (e)
                          throw Error("require field not exist, tag:" + t);
                      return !1
                  }
                  ,
                  Ns.JceInputStream.prototype.readBoolean = function(t, e, i) {
                      return 1 == this.readInt8(t, e, i)
                  }
                  ,
                  Ns.JceInputStream.prototype.readInt8 = function(t, e, i) {
                      if (0 == this.skipToTag(t, e))
                          return i;
                      var s = this.readFrom();
                      switch (s.type) {
                      case Ns.DataHelp.EN_ZERO:
                          return 0;
                      case Ns.DataHelp.EN_INT8:
                          return this.buf.readInt8()
                      }
                      throw Error("read int8 type mismatch, tag:" + t + ", get type:" + s.type)
                  }
                  ,
                  Ns.JceInputStream.prototype.readInt16 = function(t, e, i) {
                      if (0 == this.skipToTag(t, e))
                          return i;
                      var s = this.readFrom();
                      switch (s.type) {
                      case Ns.DataHelp.EN_ZERO:
                          return 0;
                      case Ns.DataHelp.EN_INT8:
                          return this.buf.readInt8();
                      case Ns.DataHelp.EN_INT16:
                          return this.buf.readInt16()
                      }
                      throw Error("read int8 type mismatch, tag:" + t + ", get type:" + s.type)
                  }
                  ,
                  Ns.JceInputStream.prototype.readInt32 = function(t, e, i) {
                      if (0 == this.skipToTag(t, e))
                          return i;
                      var s = this.readFrom();
                      switch (s.type) {
                      case Ns.DataHelp.EN_ZERO:
                          return 0;
                      case Ns.DataHelp.EN_INT8:
                          return this.buf.readInt8();
                      case Ns.DataHelp.EN_INT16:
                          return this.buf.readInt16();
                      case Ns.DataHelp.EN_INT32:
                          return this.buf.readInt32()
                      }
                      throw Error("read int8 type mismatch, tag:" + t + ", get type:" + s.type)
                  }
                  ,
                  Ns.JceInputStream.prototype.readInt64 = function(t, e, i) {
                      if (0 == this.skipToTag(t, e))
                          return i;
                      switch (this.readFrom().type) {
                      case Ns.DataHelp.EN_ZERO:
                          return 0;
                      case Ns.DataHelp.EN_INT8:
                          return this.buf.readInt8();
                      case Ns.DataHelp.EN_INT16:
                          return this.buf.readInt16();
                      case Ns.DataHelp.EN_INT32:
                          return this.buf.readInt32();
                      case Ns.DataHelp.EN_INT64:
                          return this.buf.readInt64()
                      }
                      throw Error("read int64 type mismatch, tag:" + t + ", get type:" + h.type)
                  }
                  ,
                  Ns.JceInputStream.prototype.readFloat = function(t, e, i) {
                      if (0 == this.skipToTag(t, e))
                          return i;
                      switch (this.readFrom().type) {
                      case Ns.DataHelp.EN_ZERO:
                          return 0;
                      case Ns.DataHelp.EN_FLOAT:
                          return this.buf.readFloat()
                      }
                      throw Error("read float type mismatch, tag:" + t + ", get type:" + h.type)
                  }
                  ,
                  Ns.JceInputStream.prototype.readDouble = function(t, e, i) {
                      if (0 == this.skipToTag(t, e))
                          return i;
                      switch (this.readFrom().type) {
                      case Ns.DataHelp.EN_ZERO:
                          return 0;
                      case Ns.DataHelp.EN_DOUBLE:
                          return this.buf.readDouble()
                      }
                      throw Error("read double type mismatch, tag:" + t + ", get type:" + h.type)
                  }
                  ,
                  Ns.JceInputStream.prototype.readUInt8 = function(t, e, i) {
                      return this.readInt16(t, e, i)
                  }
                  ,
                  Ns.JceInputStream.prototype.readUInt16 = function(t, e, i) {
                      return this.readInt32(t, e, i)
                  }
                  ,
                  Ns.JceInputStream.prototype.readUInt32 = function(t, e, i) {
                      return this.readInt64(t, e, i)
                  }
                  ,
                  Ns.JceInputStream.prototype.readStruct = function(t, e, i) {
                      if (0 == this.skipToTag(t, e))
                          return i;
                      var s = this.readFrom();
                      if (s.type != Ns.DataHelp.EN_STRUCTBEGIN)
                          throw Error("read struct type mismatch, tag: " + t + ", get type:" + s.type);
                      return i.readFrom(this),
                      this.skipToStructEnd(),
                      i
                  }
                  ,
                  Ns.JceInputStream.prototype.readString = function(t, e, i) {
                      if (0 == this.skipToTag(t, e))
                          return i;
                      var s = this.readFrom();
                      if (s.type == Ns.DataHelp.EN_STRING1)
                          return this.buf.readString(this.buf.readUInt8());
                      if (s.type == Ns.DataHelp.EN_STRING4)
                          return this.buf.readString(this.buf.readUInt32());
                      throw Error("read 'string' type mismatch, tag: " + t + ", get type: " + s.type + ".")
                  }
                  ,
                  Ns.JceInputStream.prototype.readString2 = function(t, e, i) {
                      if (0 == this.skipToTag(t, e))
                          return i;
                      var s = this.readFrom();
                      if (s.type == Ns.DataHelp.EN_STRING1)
                          return this.buf.readBytes(this.buf.readUInt8());
                      if (s.type == Ns.DataHelp.EN_STRING4)
                          return this.buf.readBytes(this.buf.readUInt32());
                      throw Error("read 'string' type mismatch, tag: " + t + ", get type: " + s.type + ".")
                  }
                  ,
                  Ns.JceInputStream.prototype.readBytes = function(t, e, i) {
                      if (0 == this.skipToTag(t, e))
                          return i;
                      var s = this.readFrom();
                      if (s.type == Ns.DataHelp.EN_SIMPLELIST) {
                          var a = this.readFrom();
                          if (a.type != Ns.DataHelp.EN_INT8)
                              throw Error("type mismatch, tag:" + t + ",type:" + s.type + "," + a.type);
                          if ((r = this.readInt32(0, !0)) < 0)
                              throw Error("invalid size, tag:" + t + ",type:" + s.type + "," + a.type);
                          return this.buf.readBytes(r)
                      }
                      if (s.type == Ns.DataHelp.EN_LIST) {
                          var r = this.readInt32(0, !0);
                          return this.buf.readBytes(r)
                      }
                      throw Error("type mismatch, tag:" + t + ",type:" + s.type)
                  }
                  ,
                  Ns.JceInputStream.prototype.readVector = function(t, e, i) {
                      if (0 == this.skipToTag(t, e))
                          return i;
                      var s = this.readFrom();
                      if (s.type != Ns.DataHelp.EN_LIST)
                          throw Error("read 'vector' type mismatch, tag: " + t + ", get type: " + s.type);
                      var a = this.readInt32(0, !0);
                      if (a < 0)
                          throw Error("invalid size, tag: " + t + ", type: " + s.type + ", size: " + a);
                      for (var r = 0; r < a; ++r)
                          i.value.push(i.proto._read(this, 0, i.proto._clone()));
                      return i
                  }
                  ,
                  Ns.JceInputStream.prototype.readMap = function(t, e, i) {
                      if (0 == this.skipToTag(t, e))
                          return i;
                      var s = this.readFrom();
                      if (s.type != Ns.DataHelp.EN_MAP)
                          throw Error("read 'map' type mismatch, tag: " + t + ", get type: " + s.type);
                      var a = this.readInt32(0, !0);
                      if (a < 0)
                          throw Error("invalid map, tag: " + t + ", size: " + a);
                      for (var r = 0; r < a; r++) {
                          var n = i.kproto._read(this, 0, i.kproto._clone())
                            , o = i.vproto._read(this, 1, i.vproto._clone());
                          i.put(n, o)
                      }
                      return i
                  }
                  ,
                  Ns.Wup = function() {
                      this.iVersion = 3,
                      this.cPacketType = 0,
                      this.iMessageType = 0,
                      this.iRequestId = 0,
                      this.sServantName = "",
                      this.sFuncName = "",
                      this.sBuffer = new Ns.BinBuffer,
                      this.iTimeout = 0,
                      this.context = new Ns.Map(new Ns.STRING,new Ns.STRING),
                      this.status = new Ns.Map(new Ns.STRING,new Ns.STRING),
                      this.data = new Ns.Map(new Ns.STRING,new Ns.Map(new Ns.STRING,new Ns.BinBuffer)),
                      this.newdata = new Ns.Map(new Ns.STRING,new Ns.BinBuffer),
                      this.iStream = new Ns.JceInputStream,
                      this.oStream = new Ns.JceOutputStream
                  }
                  ,
                  Ns.Wup.prototype.hasKey = function(t) {
                      return this.newdata.hasKey(t)
                  }
                  ,
                  Ns.Wup.prototype.setVersion = function(t) {
                      this.iVersion = t
                  }
                  ,
                  Ns.Wup.prototype.getVersion = function(t) {
                      return this.iVersion
                  }
                  ,
                  Ns.Wup.prototype.setServant = function(t) {
                      this.sServantName = t
                  }
                  ,
                  Ns.Wup.prototype.setFunc = function(t) {
                      this.sFuncName = t
                  }
                  ,
                  Ns.Wup.prototype.setRequestId = function(t) {
                      this.iRequestId = t || ++this.iRequestId
                  }
                  ,
                  Ns.Wup.prototype.getRequestId = function() {
                      return this.iRequestId
                  }
                  ,
                  Ns.Wup.prototype.setTimeOut = function(t) {
                      this.iTimeout = t
                  }
                  ,
                  Ns.Wup.prototype.getTimeOut = function() {
                      return this.iTimeout
                  }
                  ,
                  Ns.Wup.prototype.writeTo = function() {
                      var t = this.oStream.clear();
                      return t.writeInt16(1, this.iVersion),
                      t.writeInt8(2, this.cPacketType),
                      t.writeInt32(3, this.iMessageType),
                      t.writeInt32(4, this.iRequestId),
                      t.writeString(5, this.sServantName),
                      t.writeString(6, this.sFuncName),
                      t.writeBytes(7, this.sBuffer),
                      t.writeInt32(8, this.iTimeout),
                      t.writeMap(9, this.context),
                      t.writeMap(10, this.status),
                      new Ns.BinBuffer(t.getBuffer())
                  }
                  ,
                  Ns.Wup.prototype.encode = function() {
                      var t = this.oStream.clear();
                      3 == this.iVersion ? t.writeMap(0, this.newdata) : t.writeMap(0, this.data),
                      this.sBuffer = t.getBinBuffer();
                      var e = this.writeTo()
                        , i = new Ns.BinBuffer;
                      return i.writeInt32(4 + e.len),
                      i.writeBytes(e),
                      i
                  }
                  ,
                  Ns.Wup.prototype.writeBoolean = function(t, e) {
                      var i = this.oStream.clear();
                      if (i.writeBoolean(0, e),
                      3 == this.iVersion)
                          this.newdata.put(t, new Ns.BinBuffer(i.getBuffer()));
                      else {
                          var s = this.data.get(t)
                            , a = TAF.TypeHelp.BOOLEAN;
                          null == s && (s = new Ns.Map(Ns.STRING,Ns.STRING)),
                          s.put(a, new Ns.BinBuffer(i.getBuffer())),
                          this.data.put(t, s)
                      }
                  }
                  ,
                  Ns.Wup.prototype.writeInt8 = function(t, e) {
                      var i = this.oStream.clear();
                      if (i.writeInt8(0, e),
                      3 == this.iVersion)
                          this.newdata.put(t, new Ns.BinBuffer(i.getBuffer()));
                      else {
                          var s = this.data.get(t)
                            , a = TAF.TypeHelp.CHAR;
                          null == s && (s = new Ns.Map(Ns.STRING,Ns.STRING)),
                          s.put(a, new Ns.BinBuffer(i.getBuffer())),
                          this.data.put(t, s)
                      }
                  }
                  ,
                  Ns.Wup.prototype.writeInt16 = function(t, e) {
                      var i = this.oStream.clear();
                      if (i.writeInt16(0, e),
                      3 == this.iVersion)
                          this.newdata.put(t, new Ns.BinBuffer(i.getBuffer()));
                      else {
                          var s = this.data.get(t)
                            , a = TAF.TypeHelp.SHORT;
                          null == s && (s = new Ns.Map(Ns.STRING,Ns.STRING)),
                          s.put(a, new Uint8Array(i.getBuffer())),
                          this.data.put(t, s)
                      }
                  }
                  ,
                  Ns.Wup.prototype.writeInt32 = function(t, e) {
                      var i = this.oStream.clear();
                      if (i.writeInt32(0, e),
                      3 == this.iVersion)
                          this.newdata.put(t, new Ns.BinBuffer(i.getBuffer()));
                      else {
                          var s = this.data.get(t)
                            , a = TAF.TypeHelp.INT32;
                          null == s && (s = new Ns.Map(Ns.STRING,Ns.STRING)),
                          s.put(a, new Uint8Array(i.getBuffer())),
                          this.data.put(t, s)
                      }
                  }
                  ,
                  Ns.Wup.prototype.writeInt64 = function(t, e) {
                      var i = this.oStream.clear();
                      if (i.writeInt64(0, e),
                      3 == this.iVersion)
                          this.newdata.put(t, new Ns.BinBuffer(i.getBuffer()));
                      else {
                          var s = this.data.get(t)
                            , a = TAF.TypeHelp.INT64;
                          null == s && (s = new Ns.Map(Ns.STRING,Ns.STRING)),
                          s.put(a, new Uint8Array(i.getBuffer())),
                          this.data.put(t, s)
                      }
                  }
                  ,
                  Ns.Wup.prototype.writeFloat = function(t, e) {
                      var i = this.oStream.clear();
                      if (i.writeFloat(0, e),
                      3 == this.iVersion)
                          this.newdata.put(t, new Ns.BinBuffer(i.getBuffer()));
                      else {
                          var s = this.data.get(t)
                            , a = TAF.TypeHelp.FLOAT;
                          null == s && (s = new Ns.Map(Ns.STRING,Ns.STRING)),
                          s.put(a, new Uint8Array(i.getBuffer())),
                          this.data.put(t, s)
                      }
                  }
                  ,
                  Ns.Wup.prototype.writeDouble = function(t, e) {
                      var i = this.oStream.clear();
                      if (i.writeDouble(0, e),
                      3 == this.iVersion)
                          this.newdata.put(t, new Ns.BinBuffer(i.getBuffer()));
                      else {
                          var s = this.data.get(t)
                            , a = TAF.TypeHelp.DOUBLE;
                          null == s && (s = new Ns.Map(Ns.STRING,Ns.STRING)),
                          s.put(a, new Uint8Array(i.getBuffer())),
                          this.data.put(t, s)
                      }
                  }
                  ,
                  Ns.Wup.prototype.writeString = function(t, e) {
                      var i = this.oStream.clear();
                      if (i.writeString(0, e),
                      3 == this.iVersion)
                          this.newdata.put(t, new Ns.BinBuffer(i.getBuffer()));
                      else {
                          var s = this.data.get(t)
                            , a = Ns.TypeHelp.STRING;
                          null == s && (s = new Ns.Map(Ns.STRING,Ns.STRING)),
                          s.put(a, new Uint8Array(i.getBuffer())),
                          this.data.put(t, s)
                      }
                  }
                  ,
                  Ns.Wup.prototype.writeVector = function(t, e) {
                      var i = this.oStream.clear();
                      if (i.writeVector(0, e),
                      3 == this.iVersion)
                          this.newdata.put(t, new Ns.BinBuffer(i.getBinBuffer()));
                      else {
                          var s = this.data.get(t)
                            , a = e._className();
                          null == s && (s = new Ns.Map(Ns.STRING,Ns.STRING)),
                          s.put(a, new Uint8Array(i.getBuffer())),
                          this.data.put(t, s)
                      }
                  }
                  ,
                  Ns.Wup.prototype.writeStruct = function(t, e) {
                      var i = this.oStream.clear();
                      if (i.writeStruct(0, e),
                      3 == this.iVersion)
                          this.newdata.put(t, new Ns.BinBuffer(i.getBuffer()));
                      else {
                          var s = this.data.get(t);
                          null == s && (s = new Ns.Map(Ns.STRING,Ns.STRING)),
                          s.put(" ", new Uint8Array(i.getBuffer())),
                          this.data.put(t, s)
                      }
                  }
                  ,
                  Ns.Wup.prototype.writeBytes = function(t, e) {
                      var i = this.oStream.clear();
                      if (i.writeBytes(0, e),
                      3 == this.iVersion)
                          this.newdata.put(t, new Ns.BinBuffer(i.getBuffer()));
                      else {
                          var s = this.data.get(t);
                          null == s && (s = new Ns.Map(Ns.STRING,Ns.STRING)),
                          s.put("vec", new Uint8Array(i.getBuffer())),
                          this.data.put(t, s)
                      }
                  }
                  ,
                  Ns.Wup.prototype.writeMap = function(t, e) {
                      var i = this.oStream.clear();
                      if (i.writeMap(0, e),
                      3 == this.iVersion)
                          this.newdata.put(t, new Ns.BinBuffer(i.getBuffer()));
                      else {
                          var s = this.data.get(t)
                            , a = Ns.Util.getClassType(e);
                          null == s && (s = new Ns.Map(Ns.STRING,Ns.STRING)),
                          s.put(a, new Uint8Array(i.getBuffer())),
                          this.data.put(t, s)
                      }
                  }
                  ,
                  Ns.Wup.prototype.readFrom = function(t) {
                      this.iVersion = t.readInt16(1, !0),
                      this.cPacketType = t.readInt8(2, !0),
                      this.iMessageType = t.readInt32(3, !0),
                      this.iRequestId = t.readInt32(4, !0),
                      this.sServantName = t.readString(5, !0),
                      this.sFuncName = t.readString(6, !0),
                      localStorage.__wup && console.info("%c@@@ " + this.sServantName + "." + this.sFuncName, "color:white;background:black;", this),
                      this.sBuffer = t.readBytes(7, !0),
                      this.iTimeout = t.readInt32(8, !0),
                      this.context = t.readMap(9, !0, this.context),
                      this.status = t.readMap(10, !0, this.status)
                  }
                  ,
                  Ns.Wup.prototype.decode = function(t) {
                      var e = this.iStream.setBuffer(t);
                      if (e.buf.vew.getInt32(e.buf.position) < 4)
                          throw Error("packet length too short");
                      e.buf.position += 4,
                      this.readFrom(e),
                      e = this.iStream.setBuffer(this.sBuffer.getBuffer()),
                      3 == this.iVersion ? (this.newdata.clear(),
                      e.readMap(0, !0, this.newdata)) : (this.data.clear(),
                      e.readMap(0, !0, this.data))
                  }
                  ,
                  Ns.Wup.prototype.readBoolean = function(t) {
                      var e, i;
                      if (3 == this.iVersion) {
                          if (null == (e = this.newdata.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          i = this.iStream.setBuffer(e.buffer).readBoolean(0, !0, i)
                      } else {
                          if (null == (e = this.data.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          var s = Ns.TypeHelp.BOOLEAN
                            , a = e.get(s);
                          if (null == a)
                              throw Error("UniAttribute not found type:" + s);
                          i = this.iStream.setBuffer(a).readBoolean(0, !0, i)
                      }
                      return i
                  }
                  ,
                  Ns.Wup.prototype.readInt8 = function(t) {
                      var e, i;
                      if (3 == this.iVersion) {
                          if (null == (e = this.newdata.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          i = this.iStream.setBuffer(e.buffer).readInt8(0, !0, i)
                      } else {
                          if (null == (e = this.data.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          var s = Ns.TypeHelp.CHAR
                            , a = e.get(s);
                          if (null == a)
                              throw Error("UniAttribute not found type:" + s);
                          i = this.iStream.setBuffer(a).readInt8(0, !0, i)
                      }
                      return i
                  }
                  ,
                  Ns.Wup.prototype.readInt16 = function(t) {
                      var e, i;
                      if (3 == this.iVersion) {
                          if (null == (e = this.newdata.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          i = (r = this.iStream.setBuffer(e.buffer)).readInt16(0, !0, i)
                      } else {
                          if (null == (e = this.data.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          var s = Ns.TypeHelp.SHORT
                            , a = e.get(s)
                            , r = this.iStream.setBuffer(a);
                          if (null == a)
                              throw Error("UniAttribute not found type:" + s);
                          i = r.readInt16(0, !0, i)
                      }
                      return i
                  }
                  ,
                  Ns.Wup.prototype.readInt32 = function(t) {
                      var e, i;
                      if (3 == this.iVersion) {
                          if (null == (e = this.newdata.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          i = this.iStream.setBuffer(e.buffer).readInt32(0, !0, i)
                      } else {
                          if (null == (e = this.data.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          var s = Ns.TypeHelp.INT32
                            , a = e.get(s);
                          if (null == a)
                              throw Error("UniAttribute not found type:" + s);
                          i = this.iStream.setBuffer(a).readInt32(0, !0, i)
                      }
                      return i
                  }
                  ,
                  Ns.Wup.prototype.readInt64 = function(t) {
                      var e, i;
                      if (3 == this.iVersion) {
                          if (null == (e = this.newdata.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          i = this.iStream.setBuffer(e.buffer).readInt64(0, !0, i)
                      } else {
                          if (null == (e = this.data.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          var s = Ns.TypeHelp.INT64
                            , a = e.get(s);
                          if (null == a)
                              throw Error("UniAttribute not found type:" + s);
                          i = this.iStream.setBuffer(a).readInt64(0, !0, i)
                      }
                      return i
                  }
                  ,
                  Ns.Wup.prototype.readFloat = function(t) {
                      var e, i;
                      if (3 == this.iVersion) {
                          if (null == (e = this.newdata.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          i = this.iStream.setBuffer(e.buffer).readFloat(0, !0, i)
                      } else {
                          if (null == (e = this.data.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          var s = Ns.TypeHelp.FLOAT
                            , a = e.get(s);
                          if (null == a)
                              throw Error("UniAttribute not found type:" + s);
                          i = this.iStream.setBuffer(a).readFloat(0, !0, i)
                      }
                      return i
                  }
                  ,
                  Ns.Wup.prototype.readDouble = function(t) {
                      var e;
                      if (3 == this.iVersion) {
                          if (null == (e = this.newdata.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          var i = this.iStream.setBuffer(e.buffer);
                          def = i.readDouble(0, !0, def)
                      } else {
                          if (null == (e = this.data.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          var s = Ns.TypeHelp.DOUBLE
                            , a = e.get(s);
                          if (null == a)
                              throw Error("UniAttribute not found type:" + s);
                          i = this.iStream.setBuffer(a),
                          def = i.readDouble(0, !0, def)
                      }
                      return def
                  }
                  ,
                  Ns.Wup.prototype.readVector = function(t, e, i) {
                      var s;
                      if (3 == this.iVersion) {
                          if (null == (s = this.newdata.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          e = this.iStream.setBuffer(s.buffer).readVector(0, !0, e)
                      } else {
                          if (null == (s = this.data.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          var a = s.get(i);
                          if (null == a)
                              throw Error("UniAttribute not found type:" + i);
                          e = this.iStream.setBuffer(a).readVector(0, !0, e)
                      }
                      return e
                  }
                  ,
                  Ns.Wup.prototype.readStruct = function(t, e, i) {
                      var s;
                      if (3 == this.iVersion) {
                          if (null == (s = this.newdata.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          e = this.iStream.setBuffer(s.buffer).readStruct(0, !0, e)
                      } else {
                          if (null == (s = this.data.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          var a = s.get(i);
                          if (null == a)
                              throw Error("UniAttribute not found type:" + i);
                          e = this.iStream.setBuffer(a).readStruct(0, !0, e)
                      }
                      return e
                  }
                  ,
                  Ns.Wup.prototype.readMap = function(t, e, i) {
                      var s;
                      if (3 == this.iVersion) {
                          if (null == (s = this.newdata.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          e = this.iStream.setBuffer(s.buffer).readMap(0, !0, e)
                      } else {
                          if (null == (s = this.data.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          var a = s.get(i);
                          if (null == a)
                              throw Error("UniAttribute not found type:" + i);
                          e = this.iStream.setBuffer(a).readMap(0, !0, e)
                      }
                      return e
                  }
                  ,
                  Ns.Wup.prototype.readBytes = function(t, e, i) {
                      var s;
                      if (3 == this.iVersion) {
                          if (null == (s = this.newdata.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          e = this.iStream.setBuffer(s.buffer).readBytes(0, !0, e)
                      } else {
                          if (null == (s = this.data.get(t)))
                              throw Error("UniAttribute not found key:" + t);
                          var a = s.get(i);
                          if (null == a)
                              throw Error("UniAttribute not found type:" + i);
                          e = this.iStream.setBuffer(a).readBytes(0, !0, e)
                      }
                      return e
                  }
                  ,
                  Ns.Util = Ns.Util || {},
                  Ns.Util.jcestream = function(t, e) {
                      if (null != t && null != t)
                          if (t instanceof ArrayBuffer) {
                              e = e || 16;
                              for (var i = new Uint8Array(t), s = "", a = 0; a < i.length; a++)
                                  0 != a && a % e == 0 ? s += "\n" : 0 != a && (s += " "),
                                  s += (i[a] > 15 ? "" : "0") + i[a].toString(16);
                              console.log(s.toUpperCase())
                          } else
                              console.log("Taf.Util.jcestream::value is not ArrayBuffer");
                      else
                          console.log("Taf.Util.jcestream::value is null or undefined")
                  }
                  ,
                  Ns.Util.str2ab = function(t) {
                      var e, i = t.length, s = new Array(i);
                      for (e = 0; e < i; ++e)
                          s[e] = t.charCodeAt(e);
                      return new Uint8Array(s).buffer
                  }
                  ,
                  Ns.Util.ajax = function(t, e, i, s) {
                      var a = new XMLHttpRequest;
                      a.overrideMimeType("text/plain; charset=x-user-defined"),
                      a.addEventListener("readystatechange", (function t() {
                          4 === a.readyState && (200 === a.status || 304 === a.status ? i(Ns.Util.str2ab(a.response)) : s(a.status),
                          a.removeEventListener("readystatechange", t),
                          a = void 0)
                      }
                      )),
                      a.open("post", t),
                      a.send(e)
                  }
                  ;
                  var Ms = new (function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i() {
                          var t;
                          return Object(s.a)(this, i),
                          (t = e.call(this)).libName = "p2plib.js",
                          t.loaded = !1,
                          t.p2pLib = null,
                          t.ON_LOAD = "on_load",
                          t.callbacks = {
                              onLoaded: t.onLoaded,
                              onError: t.onLoadedError,
                              thisObj: Object(g.a)(t)
                          },
                          t
                      }
                      return Object(a.a)(i, [{
                          key: "isSupport",
                          value: function() {
                              return window.RTCPeerConnection || window.webkitRTCPeerConnection || window.mozRTCPeerConnection || window.PeerConnection || window.webkitPeerConnection || window.mozPeerConnection
                          }
                      }, {
                          key: "hasLib",
                          value: function() {
                              return null !== window.P2PLib
                          }
                      }, {
                          key: "loadLib",
                          value: function(t, e) {
                              this.hyPlyer = e,
                              t ? this.loaded ? this.trigger(this.ON_LOAD) : Ii(t, this.libName, this.callbacks) : l.a.warn("P2PLibProxy.loadLib root none")
                          }
                      }, {
                          key: "onLoaded",
                          value: function() {
                              Ai(this.libName, this.callbacks),
                              window.P2PLib ? (this.loaded = !0,
                              this.p2pLib = new P2PLib({
                                  userInfo: z.a,
                                  roomInfo: null,
                                  config: o.a,
                                  TafLink: u.default,
                                  Timer: k.a,
                                  TimeUtil: c.a,
                                  logger: l.a,
                                  HUYA: us.default,
                                  Taf: Fs
                              }),
                              this.trigger(this.ON_LOAD),
                              this.hyPlyer.reportLoadP2PLib(!1)) : this.loadP2PLibError()
                          }
                      }, {
                          key: "onLoadedError",
                          value: function() {
                              this.loadP2PLibError()
                          }
                      }, {
                          key: "loadP2PLibError",
                          value: function() {
                              this.hyPlyer.reportLoadP2PLib(!0)
                          }
                      }, {
                          key: "playStream",
                          value: function(t) {
                              return this.p2pLib ? this.p2pLib.playStream(t) : null
                          }
                      }, {
                          key: "removeStream",
                          value: function(t) {
                              t && this.p2pLib.removeStream(t)
                          }
                      }, {
                          key: "clearPunch",
                          value: function() {
                              this.p2pLib && this.p2pLib.clearPunch()
                          }
                      }, {
                          key: "clearVideo",
                          value: function() {
                              this.p2pLib && this.p2pLib.clearVideo()
                          }
                      }, {
                          key: "inflate",
                          value: function(t, e) {
                              if (this.p2pLib)
                                  return this.p2pLib.inflate(t, e)
                          }
                      }]),
                      i
                  }(H))
                    , Us = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.p2pPlayer = e
                      }
                      return Object(a.a)(t, [{
                          key: "addBytes",
                          value: function(t) {
                              this.p2pPlayer.addBytes(t)
                          }
                      }, {
                          key: "onNoVideo",
                          value: function() {
                              this.p2pPlayer.hyPlayer.trigger(r.a.NO_VIDEO)
                          }
                      }, {
                          key: "onRestart",
                          value: function(t) {
                              this.p2pPlayer.onRestart(t)
                          }
                      }, {
                          key: "turnToFlv",
                          value: function(t) {
                              this.p2pPlayer.turnToFlv(t)
                          }
                      }, {
                          key: "setPcdnName",
                          value: function(t) {
                              this.p2pPlayer.setPcdnName(t)
                          }
                      }, {
                          key: "onSliceData",
                          value: function(t) {
                              this.p2pPlayer.onSliceData(t)
                          }
                      }, {
                          key: "onGetToken",
                          value: function(t) {
                              this.p2pPlayer.info.sFlvAntiCode = t,
                              this.p2pPlayer.loaderMgr.antiCode = t
                          }
                      }, {
                          key: "autoReport",
                          value: function() {
                              this.p2pPlayer.hyPlayer.trigger(r.a.P2P_REPORT)
                          }
                      }, {
                          key: "getBufferLen",
                          value: function() {
                              return this.p2pPlayer.bufferLen
                          }
                      }]),
                      t
                  }()
                    , Bs = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.p2pPlayer = e,
                          this.handler = new Us(e),
                          this.stream = null,
                          this.started = !1,
                          this.fast_bw = 0,
                          this.lastPlaySeq = 0,
                          this.fastNum = 0
                      }
                      return Object(a.a)(t, [{
                          key: "onFastSliceData",
                          value: function(t) {
                              this.stream ? (this.fast_bw > 0 && (this.stream.stat.bw.cdn_total_bw += this.fast_bw,
                              this.stream.stat.bw.fast_bw += this.fast_bw,
                              this.fast_bw = 0),
                              this.stream.onFastSliceData(t),
                              this.fastNum < 100 && (this.fastNum++,
                              100 === this.fastNum && this.checkStart())) : this.fast_bw += t.parent.payload.length + 10
                          }
                      }, {
                          key: "hasSeq",
                          value: function(t) {
                              return !(!this.stream || !this.stream.hasSeq) && this.stream.hasSeq(t)
                          }
                      }, {
                          key: "hasPub",
                          value: function() {
                              return !this.stream || !this.stream.hasPub || this.stream.hasPub
                          }
                      }, {
                          key: "urgentResend",
                          value: function(t) {
                              this.stream && this.stream.urgentResend(t)
                          }
                      }, {
                          key: "setLastPushedFrame",
                          value: function(t, e, i, s, a) {
                              this.stream && this.stream.setLastPushedFrame(t, e, i, s, a)
                          }
                      }, {
                          key: "setLastPlaySeq",
                          value: function(t) {
                              this.lastPlaySeq = t,
                              this.stream && this.stream.setLastPlaySeq(t)
                          }
                      }, {
                          key: "loadLib",
                          value: function() {
                              1 != localStorage._closeSub && (l.a.log("P2pMgr.loadLib"),
                              Ms.on(Ms.ON_LOAD, this.onLoadLib, this),
                              Ms.loadLib(this.p2pPlayer.info.h5Root, this.p2pPlayer.hyPlayer))
                          }
                      }, {
                          key: "onLoadLib",
                          value: function() {
                              l.a.log("P2pMgr.onLoadLib"),
                              Ms.off(Ms.ON_LOAD, this.onLoadLib, this),
                              this.stream || (this.stream = Ms.playStream(this.p2pPlayer.info),
                              this.stream && (this.stream.setLastPlaySeq(this.lastPlaySeq),
                              this.stream.streamHandler = this.handler,
                              this.stream.tsdbUtil = this.p2pPlayer.tsdb,
                              this.stream.tsdbStat = this.p2pPlayer.stat,
                              null != this.p2pPlayer.info.usePcdn && (this.stream.usePcdn = this.p2pPlayer._checkUsePcdn())))
                          }
                      }, {
                          key: "checkStart",
                          value: function() {
                              this.stream && this.started && this.fastNum >= 100 && (this.p2pPlayer.onStartP2P(),
                              this.stream.start(),
                              this.stream.startSubStream())
                          }
                      }, {
                          key: "start",
                          value: function() {
                              this.started = !0,
                              this.checkStart()
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              l.a.log("P2PMgr.stop"),
                              this.started = !1,
                              this.fast_bw = 0,
                              this.lastPlaySeq = 0,
                              this.fastNum = 0,
                              this.stopStream()
                          }
                      }, {
                          key: "stopStream",
                          value: function() {
                              this.stream && (Ms.removeStream(this.stream),
                              this.stream.streamHandler = null,
                              this.stream = null)
                          }
                      }, {
                          key: "onRestart",
                          value: function() {
                              this.fast_bw = 0,
                              this.fastNum = 0,
                              this.started = !1,
                              this.stream && this.stream.onRestart()
                          }
                      }, {
                          key: "destroy",
                          value: function() {
                              this.stop()
                          }
                      }, {
                          key: "switchStart",
                          value: function() {
                              this.stop()
                          }
                      }]),
                      t
                  }()
                    , Vs = i(24)
                    , xs = function() {
                      function t(e, i, a) {
                          Object(s.a)(this, t),
                          this.eventEmiter = e,
                          this.stat = i,
                          this.tsdb = a,
                          this.lastTickTime = 0,
                          this.catonCheckStart = !0,
                          this.lastCheckerTimeStamp = 0,
                          this.visibilityChanged = !1,
                          this.lostVisibility = !1,
                          this.hidden = "",
                          this.visibilityChange = "",
                          this.addVisibilityChange()
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              this.lastTickTime = 0,
                              this.onRemoveWakeTimeoutChecker()
                          }
                      }, {
                          key: "addVisibilityChange",
                          value: function() {
                              void 0 !== document.hidden ? (this.hidden = "hidden",
                              this.visibilityChange = "visibilitychange") : void 0 !== document.msHidden ? (this.hidden = "msHidden",
                              this.visibilityChange = "msvisibilitychange") : void 0 !== document.webkitHidden && (this.hidden = "webkitHidden",
                              this.visibilityChange = "webkitvisibilitychange"),
                              document.addEventListener(this.visibilityChange, this.handleVisibilityChange.bind(this), !1)
                          }
                      }, {
                          key: "handleVisibilityChange",
                          value: function() {
                              document[this.hidden] ? this.lostVisibility = !0 : this.lostVisibility = !1,
                              this.visibilityChange = !0
                          }
                      }, {
                          key: "onCheckFastTimer",
                          value: function(t, e) {
                              if (0 != this.lastCheckerTimeStamp && this.catonCheckStart) {
                                  var i = t - this.lastCheckerTimeStamp;
                                  this.onWakeTimeoutTimeout(i)
                              }
                              this.lastCheckerTimeStamp = t
                          }
                      }, {
                          key: "startWakeTimeoutChecker",
                          value: function() {
                              this.catonCheckStart = !0
                          }
                      }, {
                          key: "onWakeTimeoutTimeout",
                          value: function(t) {
                              if (this.lostVisibility || this.visibilityChange)
                                  this.visibilityChange = !1;
                              else if (!(t < 3e3 || t > 15e3)) {
                                  z.a.p2pCooling = !0,
                                  localStorage.setItem("p2p_cooling_date", (new Date).getTime());
                                  var e = [this.stat.createAct(d.a.ACT.P2P_COOLING, {
                                      str: [_.a.name, _.a.version.major]
                                  })];
                                  this.tsdb.sendMetrics(e),
                                  l.a.log("WakeChecker onWakeTimeoutTimeout large than 3000 cost = " + t),
                                  100 * Math.random() > 99 && this.eventEmiter.trigger(Event.P2P_REPORT)
                              }
                          }
                      }, {
                          key: "onWakeTimeoutError",
                          value: function(t) {
                              this.onRemoveWakeTimeoutChecker(),
                              l.a.log("MAIN: ", "ERROR", t),
                              l.a.log("filename:" + t.filename + "-message:" + t.message + "-lineno:" + t.lineno)
                          }
                      }, {
                          key: "onRemoveWakeTimeoutChecker",
                          value: function() {
                              this.catonCheckStart = !1,
                              this.lastCheckerTimeStamp = 0
                          }
                      }]),
                      t
                  }()
                    , Hs = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.p2pPlayer = e,
                          window.addEventListener("beforeunload", this.onBeforeUnload.bind(this))
                      }
                      return Object(a.a)(t, [{
                          key: "onBeforeUnload",
                          value: function(t) {
                              this.p2pPlayer.stop(1)
                          }
                      }]),
                      t
                  }()
                    , Gs = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.sP2pUrl = "",
                          this.domainList = [],
                          this.cdnip = "",
                          this.domain = "",
                          this.cdnDomain = ""
                      }
                      return Object(a.a)(t, [{
                          key: "initDomain",
                          value: function(t, e) {
                              this.sP2pUrl = t,
                              this.domainList = e;
                              var i = this.sP2pUrl.match(/\/\/(.+?)\//i);
                              if (this.cdnDomain = i ? i[1] : "",
                              this.domainList && this.domainList.length) {
                                  l.a.log("P2PPlayer.initDomain:\n\t" + this.domainList.join("\n\t")),
                                  this.domain = this.cdnDomain;
                                  var s = this.domainList.shift();
                                  s !== this.domain && (this.cdnip = s,
                                  this.sP2pUrl = this.sP2pUrl.replace(/\/\/(.+?)\//, "//" + s + "/" + this.domain + "/"))
                              }
                              return this.sP2pUrl
                          }
                      }, {
                          key: "changeDomain",
                          value: function() {
                              if (this.domainList && "" !== this.domain) {
                                  var t = this.domainList.shift();
                                  if (t === this.domain)
                                      return this.changeDomain();
                                  var e = new RegExp("//(.*?)" + this.domain + "/");
                                  return t ? (this.cdnip = t,
                                  l.a.warn("P2PPlayer change domain to ".concat(t)),
                                  this.sP2pUrl = this.sP2pUrl.replace(e, "//" + t + "/" + this.domain + "/")) : (l.a.warn("P2PPlayer change domain to ".concat(this.domain)),
                                  this.cdnip = "",
                                  this.sP2pUrl = this.sP2pUrl.replace(e, "//" + this.domain + "/"),
                                  this.domainList = null),
                                  t
                              }
                              return null
                          }
                      }]),
                      t
                  }()
                    , js = function(t) {
                      Object(I.a)(r, t);
                      var e = Object(A.a)(r);
                      function r() {
                          return Object(s.a)(this, r),
                          e.call(this)
                      }
                      return Object(a.a)(r, [{
                          key: "onSlice",
                          value: function(t) {
                              var e = new DataView(t.payload.buffer)
                                , i = this.unmarshall(t.uri, e);
                              i.seq = t.seq,
                              this.trigger(j.a.PP2pSliceData, {
                                  parent: t,
                                  child: i
                              })
                          }
                      }, {
                          key: "getClass",
                          value: function(t) {
                              return i(47)("./" + t).default
                          }
                      }]),
                      r
                  }(q)
                    , Ws = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.streamName = e,
                          this.lastTokenTime = 0,
                          this.antiCode = "",
                          this.getTokenInterval = 24e4,
                          this.onGetTokenCb = null
                      }
                      return Object(a.a)(t, [{
                          key: "start",
                          value: function() {
                              this.lastTokenTime = c.a.now(),
                              k.a.add(this.onCheckTimer, this, 1e4)
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              k.a.remove(this.onCheckTimer, this)
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              this.lastTokenTime > 0 && t - this.lastTokenTime >= this.getTokenInterval && this.getToken(t)
                          }
                      }, {
                          key: "getToken",
                          value: function(t) {
                              this.lastTokenTime = t;
                              var e = new us.default.GetCdnTokenExReq;
                              e.sStreamName = this.streamName,
                              u.default.sendWup("liveui", "getCdnTokenInfoEx", e, this.onGetToken.bind(this), !0, u.default.getRequestId())
                          }
                      }, {
                          key: "onGetToken",
                          value: function(t) {
                              this.antiCode = t.sFlvToken,
                              this.onGetTokenCb && this.onGetTokenCb();
                              var e = "GetCdnToken.onGetToken"
                                , i = t.sFlvToken.match(/wsTime=(.+?)($|\&)/);
                              if (i) {
                                  var s = 1e3 * parseInt(i[1], 16)
                                    , a = c.a.getDateTimeStr(s, !1);
                                  e += "\n【wsTime】" + i[1] + " => " + a
                              }
                              e += "\n" + t.sFlvToken,
                              e += "\nstreamName" + this.streamName,
                              l.a.log(e)
                          }
                      }], [{
                          key: "getToken",
                          value: function(t) {
                              return new Promise((function(e, i) {
                                  var s = u.default.getRequestId()
                                    , a = new us.default.GetCdnTokenExReq;
                                  a.sStreamName = t,
                                  u.default.sendWup("liveui", "getCdnTokenInfoEx", a, (function(a) {
                                      return a.iRequestId === s ? e(a) : i(new Error("GetCdnToken.getToken" + t))
                                  }
                                  ), !0, s)
                              }
                              ))
                          }
                      }]),
                      t
                  }()
                    , Ys = (i(46),
                  function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i(t, a) {
                          var r;
                          return Object(s.a)(this, i),
                          r = e.call(this, t, a),
                          l.a.log("P2PPlayer(".concat(r._id, ") version ").concat(z.a.version)),
                          r.hyPlayer = a.hyPlayer || t,
                          r.G = new cs,
                          r.fastTimerInterval = 10,
                          r.restartTimes = 0,
                          r.resetProperty(),
                          r.p2pStat = new Ds(Object(g.a)(r)),
                          r.qaStat = new Rs(Object(g.a)(r)),
                          r.wakeChecker = new xs(t,a.stat,a.tsdb),
                          r.url = null,
                          r.player = null,
                          r.sliceProtoHandler = new js,
                          r.streamDomain = new Gs,
                          r.p2pMgr = new Bs(Object(g.a)(r)),
                          r.loaderMgr = new ms(Object(g.a)(r)),
                          r.userClose = new Hs(Object(g.a)(r)),
                          r.firstRecvFullStreamFrameTs = 0,
                          r.lastRecvFullStreamFrameTs = 0,
                          r.fullStreamLoading = !1,
                          r.startFullStreamTs = 0,
                          r.stopFullStreamTs = 0,
                          r.isH265 = !1,
                          r.exceptionStat = new di(Object(g.a)(r)),
                          r.playerType = xi,
                          r.askAITimeout = null,
                          r
                      }
                      return Object(a.a)(i, [{
                          key: "getCdnip",
                          value: function() {
                              return this.p2pMgr.stream ? this.p2pMgr.stream.stat.core.cdnip : this.streamDomain.cdnip
                          }
                      }, {
                          key: "addHandler",
                          value: function() {
                              this.sliceProtoHandler.on(j.a.PP2pSliceData, this.onFastSliceData, this)
                          }
                      }, {
                          key: "delHandler",
                          value: function() {
                              this.sliceProtoHandler.off(j.a.PP2pSliceData, this.onFastSliceData, this)
                          }
                      }, {
                          key: "addTimer",
                          value: function() {
                              k.a.add(this.onCheckTimer, this, 1e3),
                              k.a.add(this.onCheckFastTimer, this, this.fastTimerInterval)
                          }
                      }, {
                          key: "delTimer",
                          value: function() {
                              k.a.remove(this.onCheckTimer, this),
                              k.a.remove(this.onCheckFastTimer, this)
                          }
                      }, {
                          key: "delTimerOnce",
                          value: function() {
                              k.a.remove(this.playTimeout, this),
                              k.a.remove(this.onFastTimeOver, this)
                          }
                      }, {
                          key: "resetProperty",
                          value: function() {
                              this.loadStream = !1,
                              this.started = !1,
                              this.startTs = 0,
                              this.loadTime = 0,
                              this.pauseStartTs = 0,
                              this.hasEmptyFrames = !1,
                              this.videoStatus = r.b.VIDEO_STOP,
                              this.isEverSuccessPlayed = !1,
                              this.fastTimeOver = !1,
                              this.firstSlicePrinted = !1,
                              this.pauseCnt = 0,
                              this.pauseTime = 0,
                              this.pauseCnt5 = 0,
                              this.pauseTime5 = 0,
                              this.pauseCheckLock = !1,
                              this.loaderErrorTimes = 0
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              l.a.log("P2PPlayer(".concat(this._id, ").stop")),
                              this.started && (this._checkPaused(c.a.now(), "stop"),
                              this.qaStat.sendFlow(this.pauseCnt, this.pauseTime, this.pauseStartTs > 0, 0, this.player.getStat().forceSkipFrameNums, !0),
                              this.delHandler(),
                              this.delTimer(),
                              this.delTimerOnce(),
                              this.loaderMgr.stop(),
                              this.p2pMgr.stop(),
                              this.disposePlayer(),
                              this.resetProperty());
                              var t = this.G;
                              t.firstP2POnDataTime = 0,
                              t.firstP2PIframeTime = 0,
                              E(Object(S.a)(i.prototype), "stop", this).call(this)
                          }
                      }, {
                          key: "destroy",
                          value: function() {
                              this.stop(),
                              this.p2pMgr.destroy(),
                              this.askAITimeout = null
                          }
                      }, {
                          key: "disposePlayer",
                          value: function() {
                              this.player && (this.player.dispose(),
                              this.player = null)
                          }
                      }, {
                          key: "resetRestart",
                          value: function() {
                              this.exceptionStat.reset(),
                              this.loaderMgr && this.loaderMgr.reset && this.loaderMgr.reset(),
                              this.disposePlayer(),
                              this.loadStream = !1,
                              this.startTs = 0,
                              this.loadTime = 0,
                              this.pauseCnt = 0,
                              this.pauseTime = 0,
                              this.pauseCnt5 = 0,
                              this.pauseTime5 = 0,
                              this.pauseStartTs = 0,
                              this.firstRecvFullStreamFrameTs = 0,
                              this.lastRecvFullStreamFrameTs = 0,
                              this.startFullStreamTs = 0,
                              this.stopFullStreamTs = 0,
                              this.fullStreamLoading = !1,
                              this.pauseCheckLock = !1,
                              this.hasEmptyFrames = !1,
                              this.firstSlicePrinted = !1,
                              this.isEverSuccessPlayed = !1,
                              this.videoStatus = r.b.VIDEO_STOP,
                              this.loaderErrorTimes = 0,
                              this.qaStat.isFirstReport = !0
                          }
                      }, {
                          key: "removeTimer",
                          value: function() {
                              k.a.remove(this.onCheckTimer, this),
                              k.a.remove(this.onCheckFastTimer, this),
                              k.a.remove(this.playTimeout, this),
                              k.a.remove(this.onFastTimeOver, this)
                          }
                      }, {
                          key: "resetGlobal",
                          value: function() {
                              var t = this.G;
                              t.streamSeqSN = 0,
                              t.quickAccessBeginIndex = 0,
                              t.quickAccessEndIndex = 0,
                              t.quickTime = 0,
                              t.exip = 0,
                              t.sslUrl = "",
                              t.myIp = "",
                              t.wanIp = "",
                              t.wanPort = 0,
                              t.cdnpConnected = 0
                          }
                      }, {
                          key: "reset",
                          value: function(t) {
                              l.a.group("P2PPlayer(".concat(this._id, ").reset")),
                              this.resetRestart(),
                              this.wakeChecker.reset(),
                              this.removeTimer(),
                              this.resetGlobal(),
                              this.p2pMgr.stop(t),
                              this.stat.reset(),
                              this.p2pStat.reset(),
                              l.a.groupEnd()
                          }
                      }, {
                          key: "start",
                          value: function(t) {
                              var e = this;
                              E(Object(S.a)(i.prototype), "start", this).call(this),
                              localStorage._sP2PUrl && (t.sP2pUrl = localStorage._sP2PUrl),
                              this.isH265 = this.h265Proxy.isReady,
                              t.isH265 = this.isH265;
                              var s = JSON.stringify(t).replace(/\,/g, "\n").replace(/[\"\{\}]/g, "");
                              if (!(t.sP2pUrl && t.sStreamName && t.sFlvUrl && t.sFlvAntiCode && void 0 !== t.curBitrate && void 0 !== t.lineType))
                                  return console.error("P2PPlayer(".concat(this._id, ").start P2P参数不完整，跳转至FLV！\n") + s),
                                  void this.turnToFlv(C.a.turnToFlvReason.P2P_ARGS_ERROR, !0, !0);
                              this.started = !0,
                              this.info = t,
                              l.a.log("P2PPlayer(".concat(this._id, ").start \n") + s),
                              this.validAntiCode(t.sFlvAntiCode) ? this.realStart(t) : Ws.getToken(t.sStreamName).then((function(i) {
                                  l.a.log("P2PPlayer(".concat(e._id, ").start getToken"), i.sFlvToken),
                                  t.sFlvAntiCode = i.sFlvToken,
                                  e.realStart(t)
                              }
                              ));
                              var a = Math.floor(2e3 * Math.random() + 1e3);
                              0 !== Number(o.a.isAiP2PToFlv) && (clearTimeout(this.askAITimeout),
                              this.eventEmitter.sdkTurnToP2P || (this.askAITimeout = setTimeout((function() {
                                  e.notSdkPlay()
                              }
                              ), a)),
                              this.eventEmitter.sdkTurnToP2P = !1)
                          }
                      }, {
                          key: "notSdkPlay",
                          value: function() {
                              this.eventEmitter.isBusiStop || this.getRecSysRsp({
                                  info: this.info,
                                  type: "p2p",
                                  metadata: this.player ? this.player.msePlayer.metadata : null,
                                  reason: C.a.turnToFlvReason.IS_NOT_FIRST_FETCH,
                                  isNotFirstFetch: !0
                              })
                          }
                      }, {
                          key: "_getUsePcdn",
                          value: function(t) {
                              return 1 === Number(t[us.default.EM_PCDN_MODE.E_PcdnMode_P2pHttpSubstream]) ? 1 : 0
                          }
                      }, {
                          key: "_getPcdnName",
                          value: function(t) {
                              var e = "";
                              return t && (e = t[us.default.EM_PCDN_MODE.E_PcdnMode_P2pHttpSubstream]),
                              e
                          }
                      }, {
                          key: "realStart",
                          value: function(t) {
                              if (this.started) {
                                  var e = this.isUseAV1(t);
                                  this.startTs = c.a.now(),
                                  l.a.log("P2PPlayer(".concat(this._id, ").startNow"), Date.now(), this.startTs),
                                  this.stat.setComDim(d.a.DIM_COM.ORIGINAL_BITRATE, 0 === t.originalBitrate ? 1 : 0),
                                  this.stat.setComDim(d.a.DIM_COM.P2P, d.a.LIVE_TYPE.P2P),
                                  this.stat.setComDim(d.a.DIM_COM.STREAM_TYPE, 2),
                                  this.stat.setComDim(d.a.DIM_COM.H265, this.isH265 ? 1 : 0),
                                  this.stat.setComDim(d.a.DIM_COM.V_DECODEC, e ? 2 : this.isH265 ? 1 : 0),
                                  t.isAv1 = e;
                                  var i = this.G;
                                  i.isStartFromUrl = !1,
                                  Object.assign(i, t),
                                  i.streamId = this.createStreamId(Number(t.iIsP2PSupport), this.isH265, e),
                                  this.streamDomain.initDomain(t.sP2pUrl, t.domainList ? t.domainList.slice() : []),
                                  this.statDomain(),
                                  this.loaderMgr.init(this.streamDomain.sP2pUrl, t.sFlvAntiCode, this.isH265),
                                  this.isH265 && this.tsdb.sendMetrics([this.stat.createAct(d.a.ACT.H265_STATUS, {
                                      value: [0],
                                      str: [0]
                                  })]),
                                  this.statSwitch.check(t, !1),
                                  delete t.pullStreamFrom,
                                  this.player = this.createPlayer(),
                                  this.player.needFreeBuffer = t.curBitrate <= o.a.freeBufferBitrate,
                                  this.checkAud(),
                                  this.quickAccessVideoOnly(!0),
                                  this.addHandler(),
                                  this.addTimer(),
                                  k.a.once(this.playTimeout, this, 4e3),
                                  this.wakeChecker.startWakeTimeoutChecker(),
                                  o.a.setJitterCfg(this.player.msePlayer, t.presenterUid, t.curBitrate)
                              }
                          }
                      }, {
                          key: "createPlayer",
                          value: function() {
                              return new bs(this)
                          }
                      }, {
                          key: "validAntiCode",
                          value: function(t) {
                              for (var e = t.split("&"), i = e.length, s = 0; s < i; s++) {
                                  var a = e[s].split("=")
                                    , r = a[0]
                                    , n = a[1];
                                  if ("wsTime" === r)
                                      return new Date(1e3 * parseInt(n, 16)).getTime() + 24e4 > Date.now()
                              }
                              return !1
                          }
                      }, {
                          key: "checkAud",
                          value: function() {
                              Xt.isNeedAud() ? this.player.msePlayer.setDeleteH264Aud(-1 === o.a.deleteH264Aud.indexOf(this.G.presenterUid) ? 0 : 1) : this.player.msePlayer.setDeleteH264Aud(0)
                          }
                      }, {
                          key: "changeDomain",
                          value: function() {
                              var t = this.streamDomain.changeDomain();
                              return this.statDomain(),
                              t
                          }
                      }, {
                          key: "setEnableLowLatency",
                          value: function(t) {
                              t && this.player && this.player.msePlayer && o.a.setLowLatency(this.player.msePlayer)
                          }
                      }, {
                          key: "statDomain",
                          value: function() {
                              "" === this.streamDomain.cdnip ? this.stat.delDim(d.a.DIM_EXT.CDN_IP) : this.stat.setExtDim(d.a.DIM_EXT.CDN_IP, this.streamDomain.cdnip)
                          }
                      }, {
                          key: "recvDataFull",
                          value: function() {
                              this.G.recvDataTime = c.a.now(),
                              this.eventEmitter.trigger(r.a.RECV_VIDEO_FRAME),
                              l.a.log("P2PPlayer(".concat(this._id, ").recvDataFull"))
                          }
                      }, {
                          key: "getCurrentTime",
                          value: function() {
                              return this.player ? this.player.getCurrentRealTime() : 0
                          }
                      }, {
                          key: "getCurrentDts",
                          value: function() {
                              return this.player ? this.player.getCurrentDts() : 0
                          }
                      }, {
                          key: "getCurrentSeiOffsetDts",
                          value: function() {
                              return this.player ? this.player.getCurrentSeiOffsetDts() : 0
                          }
                      }, {
                          key: "getFrameData",
                          value: function() {
                              return {
                                  pts: this.player ? this.player.getCurrentRealTime() : 0
                              }
                          }
                      }, {
                          key: "getBufferLen",
                          value: function() {
                              return this.player ? this.player.getBufferLen() : 0
                          }
                      }, {
                          key: "getFrameBufferLen",
                          value: function() {
                              return this.player ? this.player.getFrameBufferLen() : 0
                          }
                      }, {
                          key: "getWaitBufferLen",
                          value: function() {
                              return this.player ? this.player.getWaitBufferLen() : 0
                          }
                      }, {
                          key: "getWaitFrameTime",
                          value: function(t) {
                              return this.player ? this.player.getWaitFrameTime(t) : 0
                          }
                      }, {
                          key: "playTimeout",
                          value: function() {
                              var t = 0
                                , e = 0;
                              this.isPlaying ? (this.p2pStat.printLoadFail(!1),
                              t = 100) : (this.p2pStat.printLoadFail(!0),
                              this.p2pStat.p2pState = 0,
                              e = this.tsdb.httpError ? 1 : 2);
                              var i = [];
                              i.push(this.stat.createAct(d.a.ACT.P2P_LOAD_VIDEO, {
                                  value: [t, e]
                              })),
                              this.tsdb.sendMetrics(i)
                          }
                      }, {
                          key: "onRenderTimeout",
                          value: function() {
                              this.started && !this.isPlaying && (l.a.warn("P2PPlayer(".concat(this._id, ").onRenderTimeout")),
                              this.turnToFlv(C.a.turnToFlvReason.FULL_PLAY_FAIL),
                              this.loaderErrorTimes++)
                          }
                      }, {
                          key: "turnToFlv",
                          value: function(t) {
                              var e = arguments.length > 1 && void 0 !== arguments[1] && arguments[1]
                                , i = arguments.length > 2 ? arguments[2] : void 0;
                              (this.started || e) && this.getRecSysRsp({
                                  info: this.info,
                                  type: "p2p",
                                  metadata: this.player ? this.player.msePlayer.metadata : null,
                                  reason: t,
                                  isNotAi: i
                              })
                          }
                      }, {
                          key: "recSysRspHandler",
                          value: function(t, e, i) {
                              var s = i.reason;
                              if (!t || e && e.tRecSysInfo && 1 == e.tRecSysInfo.lAction) {
                                  if (e && e.tRecSysInfo) {
                                      var a = e.tRecSysInfo.sActValue;
                                      if (i.isNotFirstFetch && "" != a)
                                          try {
                                              var n = JSON.parse(v.b.unescapeHTML(a)).sAiPidsP2PDes.split("|")
                                                , o = n[n.length - 1];
                                              if (l.a.log("P2PPlayer(".concat(this._id, ").recSysRspHandler isTurnToFlv"), o),
                                              0 == o)
                                                  return
                                          } catch (t) {
                                              l.a.error("P2PPlayer(".concat(this._id, ").recSysRspHandler isNotFirstFetch"), t)
                                          }
                                  }
                                  l.a.warn("P2PPlayer(".concat(this._id, ").recSysRspHandler.turnToFlv reason=").concat(s)),
                                  this.tsdb.turnToFlvReason = s,
                                  this.tsdb.turnToFlvTimes++,
                                  this.stop(),
                                  this.eventEmitter.trigger(r.a.P2P_TIMEOUT)
                              } else {
                                  if (i && i.isNotFirstFetch)
                                      return;
                                  l.a.warn("P2PPlayer(".concat(this._id, ").recSysRspHandler fail reason=").concat(s)),
                                  this.eventEmitter.trigger(r.a.H5_PLAYER_ERROR)
                              }
                          }
                      }, {
                          key: "setPcdnName",
                          value: function(t) {
                              null != t && this.stat.setComDim(d.a.DIM_COM.PCDN_ORIGIN, t)
                          }
                      }, {
                          key: "quickAccessVideoOnly",
                          value: function(t, e, i) {
                              var s = this.G
                                , a = c.a.now();
                              s.initUseTime(a),
                              this.fullStreamLoading = !0,
                              this.firstRecvFullStreamFrameTs = 0,
                              this.lastRecvFullStreamFrameTs = 0,
                              s.quickTime = 2e3,
                              s.quickAccessBeginIndex = s.exip = 0,
                              t && this.startFastSample(),
                              this.loadFullStream("quickTime", e, i),
                              this._startContinueBuffer(),
                              pi(this.stat, this.loaderMgr.url, this.info.sStreamName),
                              k.a.once(this.onFastTimeOver, this, Number(o.a.fastTime))
                          }
                      }, {
                          key: "onFastTimeOver",
                          value: function() {
                              this.fastTimeOver = !0,
                              this.player.setFastOver && this.player.setFastOver(),
                              this.videoStatus !== r.b.VIDEO_STOP && this.p2pMgr.start()
                          }
                      }, {
                          key: "onPausedTooLong",
                          value: function() {
                              this.player.pausedTooLong && this.player.pausedTooLong()
                          }
                      }, {
                          key: "onStartP2P",
                          value: function() {
                              if (this.fastSample.setOver(),
                              this.loaderMgr.stopFullStream(),
                              this.fullStreamLoading = !1,
                              this.stopFullStreamTs = c.a.now(),
                              this.startFullStreamTs && this.firstRecvFullStreamFrameTs > 0) {
                                  var t = this.lastRecvFullStreamFrameTs - this.firstRecvFullStreamFrameTs - (this.stopFullStreamTs - this.startFullStreamTs);
                                  this.player.setQuickVideoLen(t)
                              }
                          }
                      }, {
                          key: "startP2PUrl",
                          value: function(t) {
                              var e = t.p2purl;
                              l.a.log("P2PPlayer(".concat(this._id, ").startP2PUrl ") + e),
                              this.reset(0),
                              this.addHandler(),
                              this.addTimer(),
                              this.info = {};
                              var i = this.G;
                              i.isStartFromUrl = !0,
                              this.url = e,
                              this.started = !0,
                              this.startTs = c.a.now(),
                              i.initUseTime(this.startTs),
                              i.getVPTime = this.startTs,
                              i.connectVpTime = this.startTs,
                              i.connectVideoTime = this.startTs,
                              i.loginTime = this.startTs,
                              this.player = this.createPlayer(),
                              this.loaderMgr.fullLoader.connect(e)
                          }
                      }, {
                          key: "onRestart",
                          value: function(t) {
                              l.a.log("%cP2PPlayer(".concat(this._id, ").onRestart"), "background:#FFBFFF", t),
                              this.checkSendRestart(t);
                              var e = this.G;
                              if (t === C.a.restartReason.FLV_TO_P2P || e.isStartFromUrl)
                                  e.isStartFromUrl ? this.startP2PUrl(this.url) : this.start(this.info);
                              else {
                                  if (this.restartTimes >= 5)
                                      return void this.turnToFlv(C.a.turnToFlvReason.RESTART_TIMES);
                                  this.restartTimes++,
                                  this.fullStreamLoading = !1,
                                  this.firstRecvFullStreamFrameTs = 0,
                                  this.lastRecvFullStreamFrameTs = 0,
                                  this.startFullStreamTs = 0,
                                  this.stopFullStreamTs = 0;
                                  var i = this.getMse().buffered.continueBuffer;
                                  this.loaderMgr.stopFullStream(),
                                  this.disposePlayer(),
                                  this.resetProperty(),
                                  this.p2pMgr.onRestart(),
                                  this.started = !0,
                                  this.player = this.createPlayer(),
                                  this.quickAccessVideoOnly(!1),
                                  this.getMse().buffered.continueBuffer = i
                              }
                          }
                      }, {
                          key: "checkSendRestart",
                          value: function(t) {
                              if (t) {
                                  this.tsdb.restartReason = t,
                                  this.tsdb.restartTimes++;
                                  var e = !0;
                                  if (t === C.a.restartReason.LOST_SEQ_JUMP || t === C.a.restartReason.CONNECT) {
                                      var i = c.a.now();
                                      this.restartStamp > 0 && i - this.restartStamp < 2e4 && (e = !1),
                                      this.restartStamp = i
                                  }
                                  if (e) {
                                      var s = [];
                                      s.push(this.stat.createAct(d.a.ACT.P2P_RESTART, {
                                          value: [t]
                                      })),
                                      this.tsdb.sendMetrics(s)
                                  }
                              }
                          }
                      }, {
                          key: "setPlaybackrateAccess",
                          value: function(t) {
                              this.player && this.player.setPlaybackrateAccess(t)
                          }
                      }, {
                          key: "setAutoJitter",
                          value: function(t) {
                              this.player && (this.player.msePlayer.autoJitter = t)
                          }
                      }, {
                          key: "setJitter",
                          value: function(t, e, i) {
                              this.player && this.player.msePlayer && this.player.msePlayer.setJitter(t, e, i)
                          }
                      }, {
                          key: "play",
                          value: function() {
                              this.player && this.player.msePlayer.play()
                          }
                      }, {
                          key: "pause",
                          value: function() {
                              this.player && this.player.msePlayer.pause()
                          }
                      }, {
                          key: "AV1CodeFromCodeRate",
                          value: function(t) {
                              return 1e3 * t / 1e5 + 9e3 >> 0
                          }
                      }, {
                          key: "h264CodeFromCodeRate",
                          value: function(t) {
                              var e = 1e3 * t;
                              return e > 8e6 && e % 1e5 == 0 ? e / 1e5 + 1e3 >> 0 : e > 0 && e % 1e5 == 0 ? e / 1e5 + 400 >> 0 : 0
                          }
                      }, {
                          key: "h265CodeFromCodeRate",
                          value: function(t) {
                              var e = 1e3 * t;
                              return e > 8e6 && e % 1e5 == 0 ? e / 1e5 + 4e3 >> 0 : e > 0 && e % 1e5 == 0 ? e / 1e5 + 500 >> 0 : 2
                          }
                      }, {
                          key: "createStreamId",
                          value: function(t, e, i) {
                              t = t > 1 ? t : 0;
                              var s = this.info.sStreamName
                                , a = Number(this.info.iBitRate);
                              -1 !== o.a.useChangeRate.indexOf(Number(this.info.presenterUid)) && (a = this.info.curBitrate),
                              a = i ? this.AV1CodeFromCodeRate(a) : e ? this.h265CodeFromCodeRate(a) : this.h264CodeFromCodeRate(a);
                              var r = new Vs.default;
                              return r.streamName = s,
                              r.codecType = a,
                              r.cdnBrand = t,
                              r
                          }
                      }, {
                          key: "loadFullStream",
                          value: function(t, e, i) {
                              this.loadStream || (l.a.log("%cQuickAccess from " + t, "background:#FFBFFF"),
                              this.loadStream = !0,
                              this.startFullStreamTs = 0,
                              this.loaderMgr.loadFullStream(this.G.quickAccessBeginIndex, e, i))
                          }
                      }, {
                          key: "getDurationTime",
                          value: function() {
                              var t = ((this.player.msePlayer || {}).video || {}).video
                                , e = 0;
                              return t && (e = Math.floor(t.duration || 0)),
                              e
                          }
                      }, {
                          key: "turnToH264",
                          value: function() {
                              this.stop(),
                              this.eventEmitter.trigger(r.a.TURN_TO_H264)
                          }
                      }, {
                          key: "h265Retry",
                          value: function() {
                              this.stop(),
                              this.eventEmitter.trigger(r.a.H265_VIDEO_RETRY)
                          }
                      }, {
                          key: "onFastSliceData",
                          value: function(t) {
                              var e = this.G;
                              0 == e.firstP2POnDataTime && (e.firstP2POnDataTime = c.a.now()),
                              this.onSliceData(t),
                              this.p2pMgr.onFastSliceData(t)
                          }
                      }, {
                          key: "onSliceData",
                          value: function(t) {
                              var e = t.parent.uri === j.a.PP2pSliceVideoData;
                              if (t.parent.uri === j.a.PP2pSliceAudioData || e) {
                                  if (!this.firstSlicePrinted) {
                                      this.firstSlicePrinted = !0;
                                      var i = "%cFirst Slice isVideo=".concat(e, " seq=").concat(t.parent.seq);
                                      l.a.log(i, "background:#FFBFFF")
                                  }
                                  this.player && this.player.onVideoStreamData && (e ? this.player.onVideoStreamData(t.child) : this.player.onAudioStreamData(t.child))
                              }
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              if (e % 10 == 0 && (this.restartTimes = 0),
                              this.player && this.player.onCheckTimer(t, e),
                              this.player) {
                                  this.p2pStat.onCheckTimer(t, e);
                                  var i = this.G;
                                  if (i.globalSpeedCalc.calculate(),
                                  e % (Number(localStorage._speedPrintRate) || 20) == 0) {
                                      var s = i.curBitrate / 8
                                        , a = this.getGlobalSpeed();
                                      l.a.log("P2PPlayer(".concat(this._id, ").onCheckTimer avgSpeed=").concat(a, "KB/s expectSpeed=").concat(s, "KB/s"))
                                  }
                                  if (0 === this.heart20Ts)
                                      this.heart20Ts = t;
                                  else if (t - this.heart20Ts > 2e4) {
                                      this.heart20Ts = t,
                                      this._checkPaused(t, rs),
                                      this.loaderErrorTimes,
                                      this.loaderErrorTimes = 0;
                                      var r = this.player.getStat();
                                      this.p2pStat.record.dropFrames = r.dropFrames,
                                      this.p2pStat.record.playedFrames = r.playedFrames,
                                      this.p2pStat.record.dtsJumpPauseTimes = r.dtsJumpPauseTimes,
                                      this.p2pStat.record.skipFramePauseTimes = r.skipFramePauseTimes;
                                      var n = r.dropFrames;
                                      this.p2pStat.record.fullFrameRatio = 0 == n ? 100 : 0,
                                      this.stat.setComp(d.a.FRAME_INFO.name, d.a.FRAME_INFO.LATE_SEQS, r.lateSeqs),
                                      this.stat.setComp(d.a.FRAME_INFO.name, d.a.FRAME_INFO.LOSS_FRAMES, r.dropFrames),
                                      this.stat.setComp(d.a.FRAME_INFO.name, d.a.FRAME_INFO.PLAY_FRAMES, r.playedFrames),
                                      this.stat.setComp(d.a.FRAME_INFO.name, d.a.FRAME_INFO.DTS_JUMPPAUSE_CNT, r.dtsJumpPauseTimes),
                                      this.stat.setComp(d.a.FRAME_INFO.name, d.a.FRAME_INFO.SKIP_PAUSE_CNT, r.skipFramePauseTimes),
                                      this.stat.setComp(d.a.FRAME_INFO.name, d.a.FRAME_INFO.FULL_RATIO, 0 == n ? 100 : 0),
                                      this.stat.setComp(d.a.FRAME_INFO.name, d.a.FRAME_INFO.EMPTY_FRAMES, r.emptyFrames),
                                      this.stat.setCore(d.a.CORE.PLAY_DELAY, this.bufferLen),
                                      this.stat.setCore(d.a.CORE.FRAME_BUFFER_DELAY, this.getFrameBufferLen());
                                      var o = this.pauseStartTs > 0;
                                      this.qaStat.record(this.pauseCnt, this.pauseTime, o, 0, r.forceSkipFrameNums),
                                      this.qaStat.hasEmptyFrames = this.hasEmptyFrames,
                                      this.pauseStartTs > 0 && this.autoMonitor.setPause(this.pauseStartTs, this.getBufferLen()),
                                      this.pauseCnt = 0,
                                      this.pauseTime = 0
                                  }
                                  e % 300 == 0 && (this.tsdb.sendMetrics([{
                                      sMetricName: f.METRIC.VIDEO_VIDEO_BAD_QUALITY_5M_RATIO,
                                      vField: {
                                          value: this.pauseCnt5 > 0 ? 100 : 0
                                      }
                                  }]),
                                  this.pauseCnt5 = 0,
                                  this.pauseTime5 = 0)
                              }
                          }
                      }, {
                          key: "onCheckFastTimer",
                          value: function(t, e) {
                              this.started && (this.wakeChecker.onCheckFastTimer(t, e),
                              this.player && this.player.onCheckFastTimer(t, e),
                              !this.pauseCheckLock && this.pauseStartTs > 0 && t - this.pauseStartTs > 200 && (this.pauseCheckLock = !0))
                          }
                      }, {
                          key: "getGlobalSpeed",
                          value: function() {
                              var t = this.G.globalSpeedCalc.average();
                              return Math.round(t / 1024)
                          }
                      }, {
                          key: "isLowNet",
                          value: function() {
                              var t = this.G.curBitrate / 8;
                              return this.getGlobalSpeed() < t - 20
                          }
                      }, {
                          key: "setVolume",
                          value: function(t) {
                              this.player && this.player.msePlayer.setVolume(t)
                          }
                      }, {
                          key: "setMuted",
                          value: function(t) {
                              this.player && this.player.msePlayer.setMuted(t)
                          }
                      }, {
                          key: "getMuted",
                          value: function() {
                              return this.player ? this.player.msePlayer.getMuted() : -1
                          }
                      }, {
                          key: "getMse",
                          value: function() {
                              return this.mse
                          }
                      }, {
                          key: "onPlayVideo",
                          value: function(t, e, s, a, n, o, h) {
                              E(Object(S.a)(i.prototype), "onPlayVideo", this).call(this, t, e, s, a, n, o, h),
                              this.stat.setComDim(d.a.DIM_COM.DPI, e + "*" + s),
                              this.p2pStat.recordPlayBuf(),
                              this.p2pMgr.loadLib();
                              var u = this.G
                                , p = c.a.now();
                              0 !== this.startTs && (u.onPlayTime = o,
                              l.a.log("%c[TIME] P2PPlayer(".concat(this._id, ").onPlayVideo onPlayTime=") + (p - u.firstRenderTime) + " totalTime=" + (p - u.startTime), "color:#A23400;background:#FFF5C2"));
                              var f = {
                                  video: t,
                                  width: e,
                                  height: s,
                                  hasVideo: a,
                                  connectTime: u.connectVideoTime - this.startTs,
                                  recvDataTime: u.recvDataTime - this.startTs,
                                  canvas: n,
                                  delayRemove: this.info._delayRemove
                              };
                              this.info._delayRemove = !1,
                              f.videoCodec = h,
                              this.eventEmitter.trigger(r.a.VIDEO_PLAY, f),
                              this.waitRemuxTime = 0,
                              this.mse && this.mse.parser && 0 != this.mse.parser.waitRemuxTime && (this.waitRemuxTime = this.mse.parser.waitRemuxTime),
                              0 !== this.startTs ? (this.loadTime = p - this.startTs,
                              u.loadedDataTs = p - this.eventEmitter.startTs,
                              u.hyPlayerLoadTs = p - this.eventEmitter.startTs,
                              this.mse && (u.firstP2PIframeTime = this.mse.parser.decodeIFRTime),
                              l.a.log("%cP2PPlayer(".concat(this._id, ").onPlayVideo w/h=") + e + "/" + s + " loadTime=" + this.loadTime, "color:#A23400;background:#FFF5C2"),
                              l.a.log("%cP2PPlayer(".concat(this._id, ").onPlayVideo G.loadedDataTs=") + u.loadedDataTs + " G.hyPlayerLoadTs=" + u.hyPlayerLoadTs, "color:#A23400;background:#FFF5C2"),
                              this.tsdb.sendCdnTime(u, !0, this.waitRemuxTime),
                              this.startTs = 0,
                              u.printUseTime()) : l.a.log("P2PPlayer(".concat(this._id, ").onPlayVideo w/h=") + e + "/" + s),
                              this.isEverSuccessPlayed = !0,
                              this.updateStatus(r.b.VIDEO_PLAYING)
                          }
                      }, {
                          key: "onVideoStop",
                          value: function(t, e) {
                              l.a.log("P2PPlayer(".concat(this._id, ").onVideoStop hasVideo=") + e),
                              e && (this.updateStatus(r.b.VIDEO_STOP),
                              this.eventEmitter.trigger(r.a.VIDEO_STOP, {
                                  video: t,
                                  haveVideo: !0
                              }))
                          }
                      }, {
                          key: "onSendSeiData",
                          value: function(t) {
                              this.eventEmitter.trigger(r.a.H264_SEI_PLAY, {
                                  data: t
                              })
                          }
                      }, {
                          key: "onSendScriptVolumeInfo",
                          value: function(t, e) {
                              this.eventEmitter.trigger(r.a.UPDATE_INTERSITY, {
                                  uid: t,
                                  intensity: e
                              })
                          }
                      }, {
                          key: "onPlayerError",
                          value: function(t) {
                              var e = this;
                              setTimeout((function() {
                                  e.eventEmitter.isBusiStop || t && (e.tsdb.restartReason = C.a.restartReason.PLAYER_ERROR,
                                  e.eventEmitter.trigger(r.a.H5_PLAYER_ERROR))
                              }
                              ), 1e3)
                          }
                      }, {
                          key: "onErrorEvent",
                          value: function(t) {
                              if (E(Object(S.a)(i.prototype), "onErrorEvent", this).call(this, t),
                              3 === t.type) {
                                  var e = this.player.getStat()
                                    , s = e.dropFrames
                                    , a = e.playedFrames;
                                  l.a.log("P2PPlayer(".concat(this._id, ") onErrorEvent dropFrames"), s, "playedFrames", a)
                              }
                              var r = [];
                              r.push(this.stat.createAct(d.a.ACT.P2P_PLAY_FAIL, {
                                  value: [t.type, this.bufferLen]
                              })),
                              this.tsdb.sendMetrics(r)
                          }
                      }, {
                          key: "updateFrameTs",
                          value: function(t) {
                              this.fullStreamLoading && (0 == this.firstRecvFullStreamFrameTs ? (this.startFullStreamTs = c.a.now(),
                              this.firstRecvFullStreamFrameTs = t) : t > this.lastRecvFullStreamFrameTs && (this.lastRecvFullStreamFrameTs = t))
                          }
                      }, {
                          key: "_switchStart",
                          value: function(t, e) {
                              E(Object(S.a)(i.prototype), "_switchStart", this).call(this, t, e),
                              this.loadStream = !1,
                              this.p2pMgr.switchStart(),
                              this.player.switchStart(),
                              this.loaderMgr.stopFullStream(),
                              l.a.groupEnd();
                              var s = this.info;
                              s.isH265 = this.isH265 = this.h265Proxy.isReady,
                              this.G.streamId = this.createStreamId(Number(s.iIsP2PSupport), this.isH265),
                              this.loaderMgr.init(this.streamDomain.sP2pUrl, this.loaderMgr.antiCode),
                              this.quickAccessVideoOnly(!1, t, e),
                              o.a.setJitterCfg(this.player.msePlayer, s.presenterUid, s.curBitrate)
                          }
                      }, {
                          key: "_switchDone",
                          value: function(t, e, s) {
                              E(Object(S.a)(i.prototype), "_switchDone", this).call(this, t, e, s),
                              this.p2pMgr.loadLib()
                          }
                      }, {
                          key: "streamName",
                          get: function() {
                              return this.info ? this.info.sStreamName : ""
                          }
                      }, {
                          key: "isPlaying",
                          get: function() {
                              return this.videoStatus !== r.b.VIDEO_STOP
                          }
                      }, {
                          key: "hasPicture",
                          get: function() {
                              var t = this.isPlaying && this.player && 0 !== this.player.getCurrentTime();
                              return this.h265Proxy.rendering && (t = t && this.isH265Playing),
                              t
                          }
                      }, {
                          key: "bufferLen",
                          get: function() {
                              return this.player ? this.player.getBufferLen() : 0
                          }
                      }, {
                          key: "frameBufferLen",
                          get: function() {
                              return this.player && this.player.msePlayer && this.player.msePlayer.getFrameBufferLen ? this.player.msePlayer.getFrameBufferLen() : 0
                          }
                      }, {
                          key: "mse",
                          get: function() {
                              return this.player && this.player.msePlayer
                          }
                      }]),
                      i
                  }(os))
                    , qs = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          e && e.xhrSetup && (this.xhrSetup = e.xhrSetup)
                      }
                      return Object(a.a)(t, [{
                          key: "destroy",
                          value: function() {
                              this.abort(),
                              this.loader = null
                          }
                      }, {
                          key: "abort",
                          value: function() {
                              this.loader && (this.stats.aborted = !0,
                              this.loader.abort()),
                              this.timeoutHandle && window.clearTimeout(this.timeoutHandle)
                          }
                      }, {
                          key: "load",
                          value: function(t, e, i, s, a, r, n, o) {
                              var h = arguments.length > 8 && void 0 !== arguments[8] ? arguments[8] : null;
                              this.url = t,
                              this.responseType = e,
                              this.onSuccess = i,
                              this.onError = s,
                              this.onTimeout = a,
                              this.onProgress = h,
                              this.stats = {
                                  trequest: performance.now(),
                                  retry: 0
                              },
                              this.timeout = r,
                              this.maxRetry = n,
                              this.retryDelay = o,
                              this.timeoutHandle = window.setTimeout(this.loadtimeout.bind(this), r),
                              this.loadInternal()
                          }
                      }, {
                          key: "loadBuffer",
                          value: function(t, e, i, s, a, r, n, o, h) {
                              this.onOpen = e,
                              this.load(t, "arraybuffer", (function(t) {
                                  var e = t.target;
                                  return s(e.response)
                              }
                              ), a, r, n, o, h)
                          }
                      }, {
                          key: "loadInternal",
                          value: function() {
                              var t = this.loader = new XMLHttpRequest;
                              t.onload = this.loadsuccess.bind(this),
                              t.onerror = this.loaderror.bind(this),
                              t.onprogress = this.loadprogress.bind(this),
                              t.onloadend = this.loadend.bind(this),
                              t.onloadstart = this.loadstart.bind(this),
                              t.responseType = this.responseType,
                              t.open("GET", this.url, !0),
                              null != this.fromByte && null != this.toByte && t.setRequestHeader("Range", "bytes=" + this.fromByte + "-" + this.toByte),
                              this.stats.tstart = null,
                              this.stats.loaded = 0,
                              this.xhrSetup && this.xhrSetup(t),
                              this.stats.tstart = performance.now(),
                              t.send()
                          }
                      }, {
                          key: "loadsuccess",
                          value: function(t) {
                              window.clearTimeout(this.timeoutHandle),
                              this.stats.tload = performance.now(),
                              t.requestURL = this.url,
                              this.onSuccess(t, this.stats)
                          }
                      }, {
                          key: "loaderror",
                          value: function(t) {
                              404 !== t.currentTarget.status && 0 !== t.currentTarget.status ? this.stats.retry < this.maxRetry ? (l.a.warn("XhrLoader.loaderror url=" + this.url + " retryDelay=" + this.retryDelay),
                              this.destroy(),
                              window.setTimeout(this.loadInternal.bind(this), this.retryDelay),
                              this.retryDelay = Math.min(2 * this.retryDelay, 64e3),
                              this.stats.retry++) : (window.clearTimeout(this.timeoutHandle),
                              l.a.warn("XhrLoader.loaderror reach max retry url=" + this.url),
                              this.onError(t)) : this.onError(t)
                          }
                      }, {
                          key: "loadtimeout",
                          value: function() {
                              this.stats.retry < this.maxRetry ? (l.a.warn("XhrLoader.loadtimeout url=" + this.url + " retryDelay=" + this.retryDelay),
                              this.destroy(),
                              window.setTimeout(this.loadInternal.bind(this), this.retryDelay),
                              this.retryDelay = Math.min(2 * this.retryDelay, 64e3),
                              this.stats.retry++) : (window.clearTimeout(this.timeoutHandle),
                              l.a.warn("XhrLoader.loadtimeout max retry url=" + this.url),
                              this.onTimeout())
                          }
                      }, {
                          key: "loadstart",
                          value: function() {
                              this.onOpen && this.onOpen()
                          }
                      }, {
                          key: "loadprogress",
                          value: function(t) {
                              var e = this.stats;
                              null === e.tfirst && (e.tfirst = performance.now()),
                              e.loaded = t.loaded,
                              this.onProgress && this.onProgress(t, e)
                          }
                      }, {
                          key: "loadend",
                          value: function(t) {
                              404 === t.currentTarget.status && this.loaderror(t)
                          }
                      }]),
                      t
                  }()
                    , Ks = i(45)
                    , zs = i.n(Ks)
                    , Js = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.startSeq = 1e3,
                          this.m3u8Len = 0,
                          this.preTsArr = void 0
                      }
                      return Object(a.a)(t, [{
                          key: "genSnFromM3u8",
                          value: function(t) {
                              var e = this.convertM3u8ToArray(t);
                              if (void 0 === this.preTsArr)
                                  this.preTsArr = e;
                              else {
                                  var i = this.findSeq(this.preTsArr, e[0], this.startSeq);
                                  -1 === i && (i = this.startSeq + this.preTsArr.length),
                                  this.preTsArr = e,
                                  this.startSeq = i
                              }
                              return this.startSeq
                          }
                      }, {
                          key: "convertM3u8ToArray",
                          value: function(t) {
                              for (var e, i = /#EXT(INF):([\d\.]+)[^\r\n]*[\r\n]+([^#|\r\n]+)?/gi, s = []; null !== (e = i.exec(t)); )
                                  e.shift(),
                                  "INF" === (e = e.filter((function(t) {
                                      return void 0 !== t
                                  }
                                  )))[0] && s.push(e[2]),
                                  e = [];
                              return s
                          }
                      }, {
                          key: "findSeq",
                          value: function(t, e, i) {
                              for (var s = t.length - 1; s >= 0; s--) {
                                  var a = t[s]
                                    , r = a.split("?");
                                  a = r.length > 1 ? r[0] : a;
                                  var n = e.split("?");
                                  if (a === (e = n.length > 1 ? n[0] : e))
                                      return i + s
                              }
                              return -1
                          }
                      }]),
                      t
                  }()
                    , Qs = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.isLive = e,
                          this.seqGener = new Js,
                          this.isSwitchSeamLessLine = !1
                      }
                      return Object(a.a)(t, [{
                          key: "resolve",
                          value: function(t, e) {
                              return zs.a.buildAbsoluteURL(e, t)
                          }
                      }, {
                          key: "cloneObj",
                          value: function(t) {
                              return JSON.parse(JSON.stringify(t))
                          }
                      }, {
                          key: "parseMasterPlaylist",
                          value: function(t, e) {
                              for (var i, s, a, r = [], n = {}, o = /#EXT-X-STREAM-INF:([^\n\r]*(BAND)WIDTH=(\d+))?([^\n\r]*(CODECS)=\"([^\"\n\r]*)\",?)?([^\n\r]*(RES)OLUTION=(\d+)x(\d+))?([^\n\r]*(NAME)=\"(.*)\")?[^\n\r]*[\r\n]+([^\r\n]+)/gi; null != (i = o.exec(t)); ) {
                                  for (i.shift(),
                                  i = i.filter((function(t) {
                                      return void 0 !== t
                                  }
                                  )),
                                  (n = {}).url = this.resolve(i.pop(), e); i.length > 0; )
                                      switch (i.shift()) {
                                      case "RES":
                                          n.width = parseInt(i.shift()),
                                          n.height = parseInt(i.shift());
                                          break;
                                      case "BAND":
                                          n.bitrate = parseInt(i.shift());
                                          break;
                                      case "NAME":
                                          n.name = i.shift();
                                          break;
                                      case "CODECS":
                                          for (s = i.shift().split(","); s.length > 0; )
                                              -1 !== (a = s.shift()).indexOf("avc1") ? n.videoCodec = this.avc1toavcoti(a) : n.audioCodec = a
                                      }
                                  r.push(n)
                              }
                              return r
                          }
                      }, {
                          key: "avc1toavcoti",
                          value: function(t) {
                              var e, i = t.split(".");
                              return i.length > 2 ? (e = i.shift() + ".",
                              e += parseInt(i.shift()).toString(16),
                              e += ("00" + parseInt(i.shift()).toString(16)).substr(-4)) : e = t,
                              e
                          }
                      }, {
                          key: "parseKeyParamsByRegex",
                          value: function(t, e) {
                              var i = e.exec(t);
                              return i && (i.shift(),
                              2 === (i = i.filter((function(t) {
                                  return void 0 !== t
                              }
                              ))).length) ? i[1] : null
                          }
                      }, {
                          key: "parseLevelPlaylist",
                          value: function(t, e, i) {
                              return this._parseByLine(t, e, i)
                          }
                      }, {
                          key: "_getValue",
                          value: function(t, e, i) {
                              for (var s = e + 1; s < i; s++)
                                  if (!t[s].startsWith("#"))
                                      return [s, t[s]];
                              return !1
                          }
                      }, {
                          key: "_getIv",
                          value: function(t) {
                              for (var e = new Uint8Array(16), i = 12; i < 16; i++)
                                  e[i] = t >> 8 * (15 - i) & 255;
                              return e
                          }
                      }, {
                          key: "_parseByLine",
                          value: function(t, e, i) {
                              var s, a, r, n, h, u, c = 0, d = 0, p = !1, f = 0, _ = {
                                  url: e,
                                  fragments: [],
                                  live: this.isLive,
                                  startSN: 0
                              }, m = !1, v = 0, y = !1;
                              this.isLive || (y = !0,
                              s = this.seqGener.genSnFromM3u8(t),
                              _.startSN = s);
                              for (var T = {
                                  method: null,
                                  key: null,
                                  iv: null,
                                  uri: null
                              }, g = t.replace("\r").split("\n"), S = g.length, P = 0; P < S; P++) {
                                  var E = g[P];
                                  if (-1 !== E.indexOf("#EXT-X-MEDIA-SEQUENCE"))
                                      this.isLive && (d = _.startSN = parseInt(E.match(/\d+/g)[0]));
                                  else if (-1 !== E.indexOf("#EXT-X-TARGETDURATION"))
                                      _.targetduration = parseFloat(E.match(/[\d\.]+/g)[0]);
                                  else if (-1 !== E.indexOf("#EXT-X-ENDLIST"))
                                      _.live = !1,
                                      l.a.info("M3u8Parser.parseLevelPlaylist ENDLIST isLive=false");
                                  else if (-1 !== E.indexOf("#EXT-X-DISCONTINUITY"))
                                      m = !0,
                                      v++;
                                  else if (-1 !== E.indexOf("#EXT-X-BYTERANGE")) {
                                      var I = E.match(/[\d@]+/g)[0].split("@");
                                      if (u = 1 === I.length ? h : parseInt(I[1]),
                                      h = parseInt(I[0]) + u,
                                      (n = _.fragments.length ? _.fragments[_.fragments.length - 1] : null) && (n.byteRangeStartOffset = u,
                                      n.byteRangeEndOffset = h,
                                      (a = this._getValue(g, P, S)) && !n.url)) {
                                          var A = a[1];
                                          n.url = A ? this.resolve(A, e) : null
                                      }
                                  } else if (-1 !== E.indexOf("#EXT-ALIGN-PTS"))
                                      1 === o.a.switchSeamLessLine && (c = Number(E.replace("#EXT-ALIGN-PTS:", "")),
                                      p = !0,
                                      this.isSwitchSeamLessLine = !0);
                                  else if (-1 !== E.indexOf("#EXTINF")) {
                                      var C = parseFloat(E.match(/[\d\.]+/g)[0]);
                                      if (!isNaN(C)) {
                                          if (y && C < 1)
                                              continue;
                                          var k;
                                          if (y = !1,
                                          r = p ? c : ++d,
                                          this.isLive || (r = s++),
                                          T.method && T.uri && !T.iv ? (k = this.cloneObj(T)).iv = this._getIv(this.isLive ? d : r) : k = T,
                                          a = this._getValue(g, P, S)) {
                                              var b = a[1];
                                              _.fragments.push({
                                                  url: b ? this.resolve(b, e) : null,
                                                  time: b ? zs.a.getTimeFromUrl(b, this.isLive) : 0,
                                                  duration: C,
                                                  start: f,
                                                  level: i,
                                                  sn: r,
                                                  discontinuity: m,
                                                  discontinuityCnt: v,
                                                  byteRangeStartOffset: u,
                                                  byteRangeEndOffset: h,
                                                  decryptdata: k
                                              }),
                                              m && (m = !1),
                                              f += C,
                                              u = null
                                          }
                                      }
                                  } else if (-1 !== E.indexOf("#EXT-X-KEY")) {
                                      var R = E.replace("#EXT-X-KEY:", "")
                                        , L = this.parseKeyParamsByRegex(R, /(METHOD)=([^,]*)/)
                                        , w = this.parseKeyParamsByRegex(R, /(URI)=["]([^,]*)["]/)
                                        , O = this.parseKeyParamsByRegex(R, /(IV)=([^,]*)/);
                                      L && (T = {
                                          method: null,
                                          key: null,
                                          iv: null,
                                          uri: null
                                      },
                                      w && "AES-128" === L && (T.method = L,
                                      T.uri = this.resolve(w, e),
                                      T.key = null,
                                      O && (T.iv = O,
                                      "0x" === T.iv.substring(0, 2) && (T.iv = T.iv.substring(2)),
                                      T.iv = T.iv.match(/.{8}/g),
                                      T.iv[0] = parseInt(T.iv[0], 16),
                                      T.iv[1] = parseInt(T.iv[1], 16),
                                      T.iv[2] = parseInt(T.iv[2], 16),
                                      T.iv[3] = parseInt(T.iv[3], 16),
                                      T.iv = new Uint32Array(T.iv))))
                                  }
                              }
                              return _.totalduration = f,
                              _.endSN = c - 1,
                              this.isLive || (_.endSN = s - 1),
                              _
                          }
                      }, {
                          key: "_parseByReg",
                          value: function(t, e, i) {
                              var s, a, r, n, o, h = 0, u = 0, c = {
                                  url: e,
                                  fragments: [],
                                  live: this.isLive,
                                  startSN: 0
                              }, d = !1;
                              this.isLive || (s = this.seqGener.genSnFromM3u8(t),
                              c.startSN = s);
                              for (var p = {
                                  method: null,
                                  key: null,
                                  iv: null,
                                  uri: null
                              }, f = /(?:#EXT-X-(MEDIA-SEQUENCE):(\d+))|(?:#EXT-X-(TARGETDURATION):(\d+))|(?:#EXT-X-(KEY):(.*))|(?:#EXT(INF):([\d\.]+)[^\r\n]*([\r\n]+[^#|\r\n]+)?)|(?:#EXT-X-(BYTERANGE):([\d]+[@[\d]*)]*[\r\n]+([^#|\r\n]+)?|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DIS)CONTINUITY))/g; null !== (a = f.exec(t)); )
                                  switch (a.shift(),
                                  (a = a.filter((function(t) {
                                      return void 0 !== t
                                  }
                                  )))[0]) {
                                  case "MEDIA-SEQUENCE":
                                      this.isLive && (h = c.startSN = parseInt(a[1]));
                                      break;
                                  case "TARGETDURATION":
                                      c.targetduration = parseFloat(a[1]);
                                      break;
                                  case "ENDLIST":
                                      c.live = !1,
                                      l.a.info("M3u8Parser.parseLevelPlaylist ENDLIST isLive=false");
                                      break;
                                  case "DIS":
                                      d = !0;
                                      break;
                                  case "BYTERANGE":
                                      var _ = a[1].split("@");
                                      o = 1 === _.length ? n : parseInt(_[1]),
                                      n = parseInt(_[0]) + o,
                                      (r = c.fragments.length ? c.fragments[c.fragments.length - 1] : null) && !r.url && (r.byteRangeStartOffset = o,
                                      r.byteRangeEndOffset = n,
                                      r.url = this.resolve(a[2], e));
                                      break;
                                  case "INF":
                                      var m = parseFloat(a[1]);
                                      if (!isNaN(m)) {
                                          var v, y = h++;
                                          if (this.isLive || (y = s++),
                                          p.method && p.uri && !p.iv) {
                                              v = this.cloneObj(p);
                                              for (var T = new Uint8Array(16), g = 12; g < 16; g++)
                                                  T[g] = y >> 8 * (15 - g) & 255;
                                              v.iv = T
                                          } else
                                              v = p;
                                          var S = a[2];
                                          c.fragments.push({
                                              url: S ? this.resolve(S, e) : null,
                                              time: S ? zs.a.getTimeFromUrl(S, this.isLive) : 0,
                                              duration: m,
                                              start: u,
                                              level: i,
                                              sn: y,
                                              discontinuity: d,
                                              byteRangeStartOffset: o,
                                              byteRangeEndOffset: n,
                                              decryptdata: v
                                          }),
                                          d && (d = !1),
                                          u += m,
                                          o = null
                                      }
                                      break;
                                  case "KEY":
                                      var P = a[1]
                                        , E = this.parseKeyParamsByRegex(P, /(METHOD)=([^,]*)/)
                                        , I = this.parseKeyParamsByRegex(P, /(URI)=["]([^,]*)["]/)
                                        , A = this.parseKeyParamsByRegex(P, /(IV)=([^,]*)/);
                                      E && (p = {
                                          method: null,
                                          key: null,
                                          iv: null,
                                          uri: null
                                      },
                                      I && "AES-128" === E && (p.method = E,
                                      p.uri = this.resolve(I, e),
                                      p.key = null,
                                      A && (p.iv = A,
                                      "0x" === p.iv.substring(0, 2) && (p.iv = p.iv.substring(2)),
                                      p.iv = p.iv.match(/.{8}/g),
                                      p.iv[0] = parseInt(p.iv[0], 16),
                                      p.iv[1] = parseInt(p.iv[1], 16),
                                      p.iv[2] = parseInt(p.iv[2], 16),
                                      p.iv[3] = parseInt(p.iv[3], 16),
                                      p.iv = new Uint32Array(p.iv))))
                                  }
                              return c.totalduration = u,
                              c.endSN = h - 1,
                              this.isLive || (c.endSN = s - 1),
                              c
                          }
                      }]),
                      t
                  }()
                    , Xs = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.hls = e,
                          this.isLive = e.isLive,
                          this.config = e.config,
                          this.m3u8Parser = new Qs(e.isLive),
                          this.currLevelId = 0,
                          this.currFrag = null,
                          this.lastFrag = null,
                          this.levels = [],
                          this.flagStartList = null,
                          this.firstLevelLoaded = !1,
                          this.loader = null,
                          this.seekTime = 0,
                          this.manifestLoadedTs = 0,
                          this.isMasterPlayList = !1,
                          this.currLevel = null
                      }
                      return Object(a.a)(t, [{
                          key: "destroy",
                          value: function() {
                              this.m3u8Parser = null,
                              this.currLevelId = 0,
                              this.currFrag = null,
                              this.lastFrag = null,
                              this.levels = null,
                              this.currLevel = null,
                              this.firstLevelLoaded = !1,
                              this.loader.abort(),
                              this.loader = null,
                              this.flagStartList = null,
                              this.seekTime = 0,
                              this.manifestLoadedTs = 0,
                              this.isMasterPlayList = !1
                          }
                      }, {
                          key: "getNearFragStart",
                          value: function(t) {
                              if (this.flagStartList.length > 1)
                                  for (var e = 1; e < this.flagStartList.length; e++)
                                      if (this.flagStartList[e] > t && this.flagStartList[e - 1] < t)
                                          return this.flagStartList[e];
                              return Math.ceil(t + 1)
                          }
                      }, {
                          key: "getNextFrag",
                          value: function() {
                              var t = this.currDetails
                                , e = t.fragments
                                , i = null;
                              return this.isLive ? e.length > 0 && (i = e.shift()) : (null == t.fragIdx && (t.fragIdx = 0),
                              t.fragIdx < e.length && (i = e[t.fragIdx++])),
                              i && (this.lastFrag = this.currFrag,
                              this.currFrag = i),
                              i
                          }
                      }, {
                          key: "getCurrentFrag",
                          value: function() {
                              var t = this.currDetails
                                , e = t.fragments
                                , i = null;
                              return this.isLive ? e.length > 0 && (i = e[0]) : (null == t.fragIdx && (t.fragIdx = 0),
                              t.fragIdx < e.length && (i = e[t.fragIdx])),
                              i && (this.lastFrag = this.currFrag,
                              this.currFrag = i),
                              i
                          }
                      }, {
                          key: "seek",
                          value: function(t) {
                              if (this.isLive)
                                  return !1;
                              var e = this.currDetails
                                , i = e ? e.fragments : null;
                              if (!i)
                                  return this.seekTime = t,
                                  !1;
                              t = Math.min(t, e.totalduration);
                              var s, a, r = !1;
                              if (this.isLive)
                                  for (; i.length && !((s = i[0]).start > t); ) {
                                      if (a = s.start + s.duration,
                                      s.start <= t && a > t) {
                                          a - .2 < t && i.length > 1 && i.shift(),
                                          i.length > 0 && (i[0].seeking = !0,
                                          r = !0);
                                          break
                                      }
                                      i.shift()
                                  }
                              else {
                                  for (var n = 0, o = i.length; n < o; ) {
                                      if (a = (s = i[n]).start + s.duration,
                                      s.start <= t && a > t) {
                                          a - .2 < t && n < o - 1 && n++,
                                          n < o && (i[n].seeking = !0,
                                          r = !0);
                                          break
                                      }
                                      n++
                                  }
                                  l.a.info("HlsPlaylist.seek seekTime=".concat(t, " fragIdx=").concat(e.fragIdx, ", ").concat(n), i[n] ? i[n].sn : ""),
                                  e.fragIdx = n
                              }
                              return this.seekTime = 0,
                              r
                          }
                      }, {
                          key: "loadManifest",
                          value: function(t) {
                              this.m3u8Parser.isSwitchSeamLessLine = !1,
                              this.loader && (this.loader.destroy(),
                              this.loader = null),
                              this.flagStartList || (this.flagStartList = [0]),
                              t = this.addUrlParams(t),
                              this.manifsetUrl = t,
                              this.hls.stat.addComp(d.a.HLS_INFO.name, d.a.HLS_INFO.M3U8_CNT, 1),
                              this.loader = new qs(this.config),
                              this.loader.load(t, "", this.onManifestLoaded.bind(this), this.loadManifestError.bind(this), this.loadManifestTimeout.bind(this), this.config.listLoadingTimeOut, this.config.listLoadingMaxRetry, this.config.listLoadingRetryDelay)
                          }
                      }, {
                          key: "refreshManifsetUrl",
                          value: function(t) {
                              t = this.addUrlParams(t),
                              this.manifsetUrl = t
                          }
                      }, {
                          key: "addUrlParams",
                          value: function(t) {
                              var e = o.a.platform
                                , i = C.a.PLATFORM_TYPE[e] || C.a.PLATFORM_TYPE.web;
                              t += -1 === t.indexOf("?") ? "?" : "&";
                              var s = e === C.a.PLATFORM_TYPE_NAME.wap ? "&uid=".concat(z.a.uid, "&uuid=").concat(z.a.uuid) : "&u=".concat(z.a.convertUid);
                              return t + "".concat(s, "&t=").concat(i, "&sv=").concat(2202140215)
                          }
                      }, {
                          key: "onManifestLoaded",
                          value: function(t, e) {
                              0 == this.manifestLoadedTs && (this.manifestLoadedTs = c.a.now());
                              var i = t.currentTarget.status;
                              if (404 === i || 0 === i || 403 === i)
                                  return this.hls.stat.addComp(d.a.HLS_INFO.name, d.a.HLS_INFO.M3U8_FAIL_CNT, 1),
                                  l.a.warn("HlsPlaylist.onManifestLoaded status=".concat(i)),
                                  void this.hls.setLoadStatus(C.a.LoadVideoTimeoutReason.HLS_LOADMANIFEST_ERROR);
                              var s, a = t.currentTarget.responseText, r = this.manifsetUrl, n = null, o = [];
                              if (-1 == a.indexOf("#EXTM3U"))
                                  return this.hls.stat.addComp(d.a.HLS_INFO.name, d.a.HLS_INFO.M3U8_WRONG_CNT, 1),
                                  l.a.error("HlsPlaylist.onManifestLoaded m3u8 doesn't match #EXTM3U\n", a),
                                  void this.hls.setLoadStatus(C.a.LoadVideoTimeoutReason.HLS_LOADMANIFEST_ERROR);
                              this.hls.stat.addComp(d.a.HLS_INFO.name, d.a.HLS_INFO.M3U8_SUC_CNT, 1);
                              var h = -1 == a.indexOf("#EXTINF:");
                              h ? (this.isMasterPlayList = !0,
                              n = this.m3u8Parser.parseMasterPlaylist(a, r)) : (this.isMasterPlayList = !1,
                              n = [{
                                  url: r
                              }]),
                              s = (o = n)[0].bitrate,
                              o.sort((function(t, e) {
                                  return t.bitrate - e.bitrate
                              }
                              )),
                              this.levels = o;
                              for (var u = 0; u < o.length; u++)
                                  if (o[u].bitrate === s) {
                                      this.currLevelId = u;
                                      break
                                  }
                              this.currLevel = {
                                  bitrate: s
                              },
                              h ? (this.currLevel.url = o[this.currLevelId].url,
                              this.loadLevel()) : (this.currLevel.url = this.manifsetUrl,
                              this.onLevelLoaded(t)),
                              this.hls.setLoadStatus(C.a.LoadVideoTimeoutReason.HLS_LOADMANIFEST_SUCCESS)
                          }
                      }, {
                          key: "loadManifestError",
                          value: function(t) {
                              this.hls.stat.addComp(d.a.HLS_INFO.name, d.a.HLS_INFO.M3U8_FAIL_CNT, 1),
                              l.a.warn("HlsPlaylist.loadManifestError " + t.currentTarget.status),
                              404 !== t.currentTarget.status && 0 !== t.currentTarget.status || this.hls.onAnchorStop(),
                              this.hls.onLoadM3u8Error()
                          }
                      }, {
                          key: "loadManifestTimeout",
                          value: function(t) {
                              this.hls.stat.addComp(d.a.HLS_INFO.name, d.a.HLS_INFO.M3U8_TIMEOUT_CNT, 1),
                              t >= 2 ? this.hls.onLoadManifestTimeout() : this.hls.onConnectManifestTimeout()
                          }
                      }, {
                          key: "loadLevel",
                          value: function() {
                              if (this.currLevel) {
                                  var t = this.currLevel.url;
                                  if (!this.isLive && this.currDetails) {
                                      var e = this.currDetails.fragments
                                        , i = e[e.length - 1];
                                      i || (l.a.log("HlsPlaylist.loadLevel: fragments run out"),
                                      i = this.currFrag),
                                      t = e.length <= this.config.minFragBufferNum ? this.currLevel.url.replace(/\?btime=\d*$/, "?btime=".concat(i.time)) : null
                                  }
                                  t && this._loadLevel(t)
                              }
                          }
                      }, {
                          key: "updateLiveVodUrl",
                          value: function(t) {
                              this.currLevel && (this.manifsetUrl = t,
                              this.m3u8Updating = !0,
                              this.currLevel.url = t,
                              this._loadLevel(t))
                          }
                      }, {
                          key: "_loadLevel",
                          value: function(t) {
                              this.loader && (this.loader.destroy(),
                              this.loader = null),
                              this.anticode && (t += "?" + this.anticode),
                              this.hls.stat.addComp(d.a.HLS_INFO.name, d.a.HLS_INFO.M3U8_CNT, 1),
                              this.loader = new qs(this.config),
                              this.loader.load(t, "", this.onLevelLoaded.bind(this), this.loadLevelError.bind(this), this.loadLevelTimeout.bind(this), this.config.listLoadingTimeOut, this.config.listLoadingMaxRetry, this.config.listLoadingRetryDelay)
                          }
                      }, {
                          key: "onLevelLoaded",
                          value: function(t, e) {
                              if (404 !== t.currentTarget.status && 0 !== t.currentTarget.status) {
                                  var i = t.currentTarget.responseText
                                    , s = this.manifsetUrl
                                    , a = this.currLevel
                                    , n = null;
                                  if (s && (a.url = s),
                                  0 === i.indexOf("#EXTM3U") && i.indexOf("#EXTINF:") > 0) {
                                      if (this.hls.stat.addComp(d.a.HLS_INFO.name, d.a.HLS_INFO.M3U8_SUC_CNT, 1),
                                      n = this.m3u8Parser.parseLevelPlaylist(i, a.url, this.currLevelId, this.flagStartList),
                                      a.details = this.mergeDetails(a.details, n),
                                      this.isLive || this.hls.eventEmitter.trigger(r.a.PLAYBACK_M3U8_UPDATED, {
                                          totalDuration: this.totalDuration
                                      }),
                                      this.isLive && a.details.fragments.length > 10)
                                          return l.a.info("HlsPlaylist.onLevelLoaded fragments.length =", a.details.fragments.length),
                                          void this.hls.reconnectLive();
                                      this.hls.setTargetDuration(this.currDetails.targetduration),
                                      this.seekTime && this.seek(this.seekTime),
                                      this.firstLevelLoaded || (this.firstLevelLoaded = !0,
                                      this.hls.loadFragment())
                                  } else {
                                      this.hls.stat.addComp(d.a.HLS_INFO.name, d.a.HLS_INFO.M3U8_EMPTY_CNT, 1);
                                      var o = a.details.fragments.length;
                                      l.a.warn("HlsPlaylist.onLevelLoaded no playlist. fragments.length=".concat(o, "\n").concat(i))
                                  }
                                  this.hls.isSwitchSeamLessLine = this.m3u8Parser.isSwitchSeamLessLine
                              } else
                                  this.hls.stat.addComp(d.a.HLS_INFO.name, d.a.HLS_INFO.M3U8_FAIL_CNT, 1)
                          }
                      }, {
                          key: "loadLevelError",
                          value: function(t) {
                              this.hls.stat.addComp(d.a.HLS_INFO.name, d.a.HLS_INFO.M3U8_FAIL_CNT, 1),
                              l.a.warn("HlsPlaylist.loadLevelError " + t.currentTarget.status),
                              404 !== t.currentTarget.status && 0 !== t.currentTarget.status || this.hls.onAnchorStop()
                          }
                      }, {
                          key: "loadLevelTimeout",
                          value: function() {
                              this.hls.stat.addComp(d.a.HLS_INFO.name, d.a.HLS_INFO.M3U8_TIMEOUT_CNT, 1),
                              this.hls.reset()
                          }
                      }, {
                          key: "mergeDetails",
                          value: function(t, e) {
                              if (!t)
                                  return e;
                              var i, s, a = 0, r = 0;
                              return s = t.fragments.length > 0 ? t.fragments[t.fragments.length - 1] : this.currFrag,
                              i = s.sn,
                              r = s.start + s.duration,
                              e.fragments.forEach((function(e) {
                                  e.sn > i && t.fragments.push(e)
                              }
                              )),
                              t.endSN = e.endSN,
                              t.fragments.forEach((function(t) {
                                  a += t.duration,
                                  t.sn > i && (t.start = r,
                                  r += t.duration)
                              }
                              )),
                              t.totalduration = a,
                              t
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t) {
                              this.isLive && this.loadLevel()
                          }
                      }, {
                          key: "currDetails",
                          get: function() {
                              return this.currLevel ? this.currLevel.details : null
                          }
                      }, {
                          key: "currFragNum",
                          get: function() {
                              var t = this.currDetails
                                , e = t ? t.fragments : null;
                              return e ? e.length : 0
                          }
                      }, {
                          key: "totalDuration",
                          get: function() {
                              var t = this.currDetails;
                              return t ? t.totalduration : 0
                          }
                      }]),
                      t
                  }()
                    , Zs = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this._config = e,
                          this._receivedLength = 0
                      }
                      return Object(a.a)(t, null, [{
                          key: "isSupported",
                          value: function() {
                              try {
                                  var t = _.a.msedge && _.a.version.minor >= 15048
                                    , e = !_.a.msedge || t;
                                  return fetch && ReadableStream && e
                              } catch (t) {
                                  return !1
                              }
                          }
                      }]),
                      Object(a.a)(t, [{
                          key: "destroy",
                          value: function() {
                              this.onChunk = null,
                              this.onSuccess = null,
                              this.onError = null,
                              this.onTimeout = null,
                              this.abort()
                          }
                      }, {
                          key: "loadBuffer",
                          value: function(t, e, i, s, a, r, n, o, h) {
                              this.url = t,
                              this.onOpen = e,
                              this.onChunk = i,
                              this.onSuccess = s,
                              this.onError = a,
                              this.onTimeout = r,
                              this.stats = {
                                  trequest: performance.now(),
                                  retry: 0
                              },
                              this.timeout = n,
                              this.maxRetry = o,
                              this.retryDelay = h,
                              this.timeoutHandle = window.setTimeout(this.loadtimeout.bind(this), n),
                              this.loadInternal()
                          }
                      }, {
                          key: "loadInternal",
                          value: function() {
                              var t = this
                                , e = this.fromByte
                                , i = this.toByte
                                , s = new self.Headers;
                              null != this.fromByte && null != this.toByte && s.append("Range", "bytes=".concat(e, "-").concat(i));
                              var a = {
                                  method: "GET",
                                  headers: s,
                                  mode: "cors",
                                  cache: "default",
                                  referrerPolicy: "no-referrer-when-downgrade"
                              };
                              fetch(this.url, a).then((function(e) {
                                  if (!t._requestAbort)
                                      return e.ok && e.status >= 200 && e.status <= 299 ? (t._onopen(),
                                      t._pump.call(t, e.body.getReader())) : void t._onerror({
                                          code: e.status,
                                          msg: e.statusText
                                      });
                                  t._requestAbort = !1
                              }
                              )).catch((function(e) {
                                  t._onerror({
                                      code: -1,
                                      msg: e.message
                                  })
                              }
                              ))
                          }
                      }, {
                          key: "abort",
                          value: function() {
                              this._requestAbort = !0
                          }
                      }, {
                          key: "_clearTimeout",
                          value: function() {
                              var t = this.timeoutHandle;
                              t && (clearTimeout(t),
                              this.timeoutHandle = null)
                          }
                      }, {
                          key: "_pump",
                          value: function(t) {
                              var e = this;
                              return t.read().then((function(i) {
                                  if (e._clearTimeout(),
                                  i.done)
                                      e._onsuccess();
                                  else {
                                      if (!0 === e._requestAbort)
                                          return e._requestAbort = !1,
                                          t.cancel();
                                      var s = i.value.buffer;
                                      e.onChunk && e.onChunk(s),
                                      e._pump(t)
                                  }
                              }
                              )).catch((function(t) {
                                  if (11 !== t.code || !_.a.msedge) {
                                      var i = {
                                          code: t.code,
                                          msg: t.message
                                      };
                                      e._onerror(i)
                                  }
                              }
                              ))
                          }
                      }, {
                          key: "_onopen",
                          value: function() {
                              this.onOpen && this.onOpen()
                          }
                      }, {
                          key: "_onerror",
                          value: function(t) {
                              0 !== t.code && 404 !== t.code ? this.stats.retry < this.maxRetry ? (l.a.warn("FetchLoader.loaderror url=" + this.url + " retryDelay=" + this.retryDelay),
                              window.setTimeout(this.loadInternal.bind(this), this.retryDelay),
                              this.retryDelay = Math.min(2 * this.retryDelay, 64e3),
                              this.stats.retry++,
                              this.abort()) : (this._clearTimeout(),
                              l.a.warn("FetchLoader.loaderror reach max retry url=" + this.url),
                              this.onError(t)) : this.onError(t)
                          }
                      }, {
                          key: "_onsuccess",
                          value: function(t) {
                              this._clearTimeout(),
                              this.onSuccess && this.onSuccess(t)
                          }
                      }, {
                          key: "loadtimeout",
                          value: function() {
                              this.stats.retry < this.maxRetry ? (l.a.warn("FetchLoader.loadtimeout url=" + this.url + " retryDelay=" + this.retryDelay),
                              this.abort(),
                              window.setTimeout(this.loadInternal.bind(this), this.retryDelay),
                              this.retryDelay = Math.min(2 * this.retryDelay, 64e3),
                              this.stats.retry++) : (this._clearTimeout(),
                              l.a.warn("FetchLoader.loadtimeout max retry url=" + this.url),
                              this.onTimeout && this.onTimeout())
                          }
                      }]),
                      t
                  }()
                    , $s = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.hlsPlayer = e,
                          this.stat = this.hlsPlayer.stat,
                          this.tsdbUtil = this.hlsPlayer.tsdb,
                          this.isPaused = !1,
                          this.tsOpens = [],
                          this.tsLoadeds = [],
                          this.tsSpeeds = [],
                          this.tsSizes = []
                      }
                      return Object(a.a)(t, [{
                          key: "setPause",
                          value: function() {
                              this.isPaused = !0,
                              this.stat.setCore(d.a.DIM_CORE.VIDEO_BAD_QUALITY, 100)
                          }
                      }, {
                          key: "start",
                          value: function() {
                              this.stop(),
                              k.a.once(this.checkSuc, this, 1e4),
                              k.a.once(this.checkVideo, this, 2e4)
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              this.tsOpens = [],
                              this.tsLoadeds = [],
                              this.tsSpeeds = [],
                              this.tsSizes = [],
                              k.a.remove(this.checkSuc, this),
                              k.a.remove(this.checkVideo, this)
                          }
                      }, {
                          key: "checkSuc",
                          value: function() {
                              var t = this.hlsPlayer
                                , e = t._loaderType
                                , i = t.hasVideo
                                , s = t.url
                                , a = t.playTs
                                , r = i ? 100 : 0
                                , n = [];
                              n.push(this.stat.createAct(d.a.ACT.HLS_PLAY_SUCC, {
                                  value: [r, e],
                                  str: [s, "".concat(a)]
                              })),
                              this.tsdbUtil.sendMetrics(n)
                          }
                      }, {
                          key: "checkVideo",
                          value: function() {
                              var t = this.hlsPlayer.hasVideo ? 100 : 0
                                , e = [];
                              e.push(this.stat.createAct(d.a.ACT.HLS_LOAD_SUCC, {
                                  value: [t]
                              })),
                              this.tsdbUtil.sendMetrics(e)
                          }
                      }, {
                          key: "report",
                          value: function() {
                              var t = [{
                                  sMetricName: f.METRIC.VIDEO_BAD_QUALITY_RATIO,
                                  vField: {
                                      value: this.isPaused ? 100 : 0
                                  },
                                  vDimension: {
                                      p2p: 2
                                  }
                              }];
                              this.hlsPlayer.mse.metadata.recvAudioFps && this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.AUDIO_RATE, this.hlsPlayer.mse.metadata.recvAudioFps),
                              this.hlsPlayer.mse.metadata.recvVideoFps && this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.VIDEO_RATE, this.hlsPlayer.mse.metadata.recvVideoFps),
                              this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.SPEED, this.hlsPlayer.getSpeed()),
                              this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.VIDEO_DTS, this.hlsPlayer.mse.curVideoDts),
                              this.stat.setComp(d.a.DIM_LINK_SAM.name, d.a.DIM_LINK_SAM.AUDIO_DTS, this.hlsPlayer.mse.curAudioDts),
                              this.stat.setCompFormat(d.a.DIM_LINK_SAM.name, ":", ","),
                              this.stat.setCore(d.a.CORE.PLAY_DELAY, this.hlsPlayer.getBufferLen()),
                              this.stat.setCore(d.a.CORE.FRAME_BUFFER_DELAY, this.hlsPlayer.getFrameBufferLen()),
                              this.stat.setCoreDim(d.a.DIM_CORE.VIDEO_BAD_QUALITY, this.isPaused ? 100 : 0),
                              this.stat.setComp(d.a.HLS_INFO.name, d.a.HLS_INFO.TS_OPEN_AVG, this.getAvg(this.tsOpens)),
                              this.stat.setComp(d.a.HLS_INFO.name, d.a.HLS_INFO.TS_LOADED_AVG, this.getAvg(this.tsLoadeds)),
                              this.stat.setComp(d.a.HLS_INFO.name, d.a.HLS_INFO.TS_SPEED_AVG, this.getAvg(this.tsSpeeds)),
                              this.stat.setComp(d.a.HLS_INFO.name, d.a.HLS_INFO.TS_SIZE_AVG, this.getAvg(this.tsSizes)),
                              this.stat.fill(t, !1),
                              this.tsdbUtil.sendMetrics(t),
                              this.isPaused = !1,
                              this.tsOpens = [],
                              this.tsLoadeds = [],
                              this.tsSpeeds = [],
                              this.tsSizes = []
                          }
                      }, {
                          key: "getAvg",
                          value: function(t) {
                              var e = t.length;
                              if (0 === e)
                                  return 0;
                              for (var i = 0, s = 0; s < e; s++)
                                  i += t[s];
                              return Math.floor(i / e)
                          }
                      }]),
                      t
                  }()
                    , ta = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this._hlsPlayer = e,
                          this._seekTime = 0
                      }
                      return Object(a.a)(t, [{
                          key: "seek",
                          value: function(t) {
                              this._seekTime = t
                          }
                      }, {
                          key: "check",
                          value: function() {
                              this._seekTime > 0 && (this._seek() ? this._seekTime = 0 : this._reseek())
                          }
                      }, {
                          key: "_seek",
                          value: function() {
                              for (var t = this._seekTime, e = this._hlsPlayer.mse.video.video.buffered, i = [], s = !1, a = 0; a < e.length; a++) {
                                  var r = e.start(a)
                                    , n = e.end(a);
                                  if (i.push("[".concat(r, ", ").concat(n, "]")),
                                  r - .5 <= t && t < n + 1) {
                                      s = !0;
                                      break
                                  }
                                  if (t < r) {
                                      this._seekTime = r;
                                      break
                                  }
                              }
                              return s && (this._hlsPlayer.onVideoSeek(t),
                              !this._hlsPlayer.userPaused && this._hlsPlayer.play()),
                              l.a.log("HlsSeek.buffered", i.join(" ")),
                              s
                          }
                      }, {
                          key: "_reseek",
                          value: function() {
                              l.a.log("HlsSeek._reseek");
                              var t = this._hlsPlayer.playlist.currDetails;
                              t && t.fragments && (t.fragIdx > 1 && t.fragIdx--,
                              this._hlsPlayer.mse.seek(this._seekTime),
                              this._hlsPlayer.mse.resetHls(),
                              this._hlsPlayer.seekTime = this._seekTime,
                              l.a.log("HlsSeek._reseek", t.fragIdx))
                          }
                      }, {
                          key: "_findIdxFront",
                          value: function(t, e, i) {
                              for (var s = e.length, a = null, r = i; r < s; r++)
                                  if ((t += (a = e[r]).duration) >= this._seekTime)
                                      return a.seeking = !0,
                                      r;
                              return s - 1
                          }
                      }, {
                          key: "_findIdxBack",
                          value: function(t, e, i) {
                              for (var s = null, a = i; a > 0; a--)
                                  if ((t -= (s = e[a]).duration) < this._seekTime)
                                      return s.seeking = !0,
                                      a;
                              return 0
                          }
                      }]),
                      t
                  }()
                    , ea = function() {
                      function t(e, i) {
                          Object(s.a)(this, t);
                          var a = i.stat
                            , n = i.tsdb
                            , h = i.videoElement
                            , u = i.h265Proxy;
                          this.config = {
                              autoStartLoad: !0,
                              maxBufferLength: 30,
                              minBufferLength: 15,
                              bs2Delay: 3e3,
                              fragLoadingTimeOut: 5e3,
                              fragLoadingMaxRetry: h ? 3 : 1,
                              fragLoadingRetryDelay: 1e3,
                              listLoadingTimeOut: h ? 15e3 : 3e3,
                              listLoadingMaxRetry: h ? 0 : 3,
                              listLoadingRetryDelay: 1e3,
                              appendErrorMaxRetry: 200,
                              minFragBufferNum: 3,
                              autoReconnect: !0
                          },
                          this.eventEmitter = e,
                          this.stat = a,
                          this.tsdb = n,
                          this.h265Proxy = u,
                          this.isLive = !1,
                          this.liveType = 0,
                          this.url = null,
                          this.cdnName = null,
                          this.seekTime = 0,
                          this.playlist = null,
                          this.mse = null,
                          this.userPaused = !1,
                          this.targetDuration = 0,
                          this.isLoading = !1,
                          this.fragStartTs = 0,
                          this.fragOpenTs = 0,
                          this.fragSize = 0,
                          this.startTs = 0,
                          this.pauseTs = 0,
                          this.pauseCnt = 0,
                          this.playTs = 0,
                          this.started = !1,
                          this.isTryAgain = !1,
                          this.fragLoader = null,
                          this.tryTimer = null,
                          this.hasVideo = !1,
                          this.playStat = new $s(this),
                          this.hlsSeek = new ta(this),
                          this.firstPlay = !0,
                          this.firstFragLoadTs = 0,
                          this.firstFragLoadedTs = 0,
                          this.firstFragSize = 0,
                          this.videoStatus = r.b.VIDEO_STOP,
                          this.flvLoadTimeSended = !1,
                          this.curAppendFrag = null,
                          this.seeking = !1,
                          this.skipStatForSeek = !1,
                          this.playTriggered = !1;
                          var l, c, d, p, f = (l = o.a.hlsUseFetch > Math.floor(100 * Math.random()) && Zs.isSupported(),
                          d = (c = C.a.HLS_LOAD_TYPE).FETCH,
                          p = c.XHR,
                          {
                              clz: l ? Zs : qs,
                              type: l ? d : p
                          }), _ = f.clz, m = f.type;
                          this._loaderClz = _,
                          this._loaderType = m,
                          this.videoElement = h,
                          this.loadHlsStatus = C.a.LoadVideoTimeoutReason.HLS_DISCONNECTED,
                          this.needReset = !1,
                          this.lastPlayTs = 0,
                          this.pauseInBufferFullTimes = 0,
                          this.sendPauseTimeout = 0,
                          this.businessStartCost = 0,
                          this.startTimeStamp = 0,
                          this.loadStartTs = 0,
                          this.anticode = new ci,
                          this.isSwitchSeamLessLine = !1,
                          this.pausedByBrowser = !1,
                          this._nextRefreshTime = Number.MAX_SAFE_INTEGER,
                          this.avgSpeed = new y(20),
                          this.exceptionStat = new di(this),
                          this.realStartBind = this.realStart.bind(this),
                          this._clickEventBind = this._clickEvent.bind(this),
                          this.refreshAnticodeBind = this.refreshAnticode.bind(this),
                          this.anticode.on(ci.Events.REFRESH, this.refreshAnticodeBind)
                      }
                      return Object(a.a)(t, [{
                          key: "getSpeed",
                          value: function() {
                              var t = this.avgSpeed.average();
                              return t === v.b.UintMax ? 0 : t
                          }
                      }, {
                          key: "destroy",
                          value: function() {
                              l.a.log("HlsPlayer.destroy"),
                              this.started = !1,
                              this.removeTimer(),
                              this.tryTimer && (clearTimeout(this.tryTimer),
                              this.tryTimer = null),
                              this.mse && (this.mse.destroy(),
                              this.mse = null),
                              this.playlist && (this.playlist.destroy(),
                              this.playlist = null),
                              this.releaseLoader(),
                              this.isSwitchSeamLessLine = !1
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              l.a.log("HlsPlayer.reset"),
                              this.exceptionStat.reset(),
                              this.avgSpeed.reset(),
                              this.removeTimer(),
                              this.isLive = null,
                              this.liveType = 0,
                              this.url = null,
                              this.cdnName = null,
                              this.seekTime = 0,
                              this.targetDuration = 0,
                              this.isLoading = !1,
                              this.startTs = 0,
                              this.pauseTs = 0,
                              this.pauseCnt = 0,
                              this.playTs = 0,
                              this.hasVideo = !1,
                              this.started = !1,
                              this.userPaused = !1,
                              this.isTryAgain = !1,
                              this.playStat.stop(),
                              this.firstFragLoadTs = 0,
                              this.firstFragLoadedTs = 0,
                              this.firstFragSize = 0,
                              this.curAppendFrag = null,
                              this.seeking = !1,
                              this.skipStatForSeek = !1,
                              this.firstPlay = !0,
                              this.playTriggered = !1,
                              this.stat.reset(),
                              this.isSwitchSeamLessLine = !1,
                              this.pausedByBrowser = !1
                          }
                      }, {
                          key: "resetMediasource",
                          value: function() {
                              this.needReset = !0
                          }
                      }, {
                          key: "reloadInError",
                          value: function() {
                              this.mse.getCurrentTime();
                              var t = this.mse.getCurrentTime() / 1e3
                                , e = this.playlist.getNearFragStart(t);
                              this.releaseLoader(),
                              this.destroyMse(),
                              this.mse = this.createMse(),
                              this.isLoading = !1,
                              this.seek(e)
                          }
                      }, {
                          key: "destroyMse",
                          value: function() {
                              this.mse && (this.mse.destroy(),
                              this.mse = null)
                          }
                      }, {
                          key: "createMse",
                          value: function() {
                              var t = {
                                  isLive: this.isLive,
                                  videoType: "ts",
                                  videoElement: this.videoElement,
                                  h265Proxy: this.h265Proxy
                              };
                              return new Qt(this,t)
                          }
                      }, {
                          key: "releaseLoader",
                          value: function() {
                              this.fragLoader && (this.fragLoader.destroy(),
                              this.fragLoader = null)
                          }
                      }, {
                          key: "removeTimer",
                          value: function() {
                              k.a.remove(this.onCheckTimer, this),
                              k.a.remove(this.onCheckFastTimer, this)
                          }
                      }, {
                          key: "setConfig",
                          value: function(t, e) {}
                      }, {
                          key: "start",
                          value: function(t) {
                              this.stop(),
                              this.checkParams(t, this.realStartBind)
                          }
                      }, {
                          key: "checkParams",
                          value: function(t, e) {
                              l.a.log("HlsPlayer.checkParams", JSON.stringify(t)),
                              this.started = !0,
                              t.isLive && t.sHlsUrl && t.sStreamName ? (t.sHlsUrl = t.sHlsUrl.replace("http://", "https://"),
                              t.sHlsAntiCode ? (this.anticode.init(t.sHlsUrl, t.sStreamName, t.sHlsAntiCode),
                              this.anticode.valid().then((function() {
                                  e(t)
                              }
                              ))) : e(t)) : t.url ? e(t) : l.a.error("HlsPlayer.checkParams has no params(sHlsUrl,sStreamName,url)")
                          }
                      }, {
                          key: "initInfo",
                          value: function(t) {
                              this.info = t,
                              t.sHlsUrl && t.sStreamName && (t.url = t.sHlsUrl + "/" + t.sStreamName + ".m3u8");
                              var e = [];
                              this.anticode.hasAnticode() && e.push(this.anticode.getAnticode()),
                              t.iBitRate > 0 && e.push("ratio=".concat(t.iBitRate)),
                              e.length > 0 && (t.url += (-1 !== t.url.indexOf("?") ? "&" : "?") + "".concat(e.join("&"))),
                              this.lineType = t.lineType
                          }
                      }, {
                          key: "realStart",
                          value: function(t) {
                              if (this.started) {
                                  this.initInfo(t);
                                  var e = (new Date).getTime();
                                  this.businessStartCost = 0,
                                  this.UIStartCost = 0,
                                  this.loadStartTs = 0,
                                  this.startTimeStamp = Number(t.startTimeStamp) || 0,
                                  t.noNeedSendVideoLoadTime ? this.noNeedSendVideoLoadTime = !0 : (this.businessStartCost = t.startTimeStamp ? Math.floor(e - t.startTimeStamp) : 0,
                                  this.noNeedSendVideoLoadTime = !1),
                                  t.uistartTs && t.uistartTs > 0 && (this.UIStartCost = Math.floor(e - t.uistartTs)),
                                  l.a.log("HlsPlayer.start startTimeStamp=" + t.startTimeStamp, "uistartTs=" + t.uistartTs, "businessStartCost=" + this.businessStartCost, "UIStartCost=" + this.UIStartCost, "now=" + e, "uistartTs=" + t.uistartTs);
                                  var i = t.url;
                                  i ? (this.loadHlsStatus = C.a.LoadVideoTimeoutReason.HLS_DISCONNECTED,
                                  this.url = i,
                                  this.isLive = t.isLive,
                                  this.cdnName = t.cdnName,
                                  this.liveType = t.liveType,
                                  l.a.log("HlsPlayer.start isLive=".concat(this.isLive, " url=").concat(i)),
                                  this.playlist = new Xs(this),
                                  this.destroyMse(),
                                  this.mse = this.createMse(),
                                  this.playlist.loadManifest(this.url),
                                  pi(this.stat, this.url, this.info.sStreamName),
                                  this.seek(t.seekTime || this.seekTime),
                                  this.startTs = c.a.now(),
                                  this.playStat.start(),
                                  this.stat.setComDim(d.a.DIM_COM.STREAM_URL, i),
                                  this.stat.setComDim(d.a.DIM_COM.P2P, d.a.LIVE_TYPE.HLS),
                                  this.stat.setComDim(d.a.DIM_COM.STREAM_TYPE, 3),
                                  this.stat.setComDim(d.a.DIM_COM.HLS_TYPE, t.isLhls ? 2 : 1)) : l.a.error("HlsPlayer.start invalid argument, pls check the url.")
                              }
                          }
                      }, {
                          key: "refreshAnticode",
                          value: function() {
                              this.initInfo(this.info),
                              this.url = this.info.url,
                              this.playlist.refreshManifsetUrl(this.url)
                          }
                      }, {
                          key: "setVideoPlayTimeSended",
                          value: function() {
                              this.flvLoadTimeSended = !0
                          }
                      }, {
                          key: "setLoadStatus",
                          value: function(t) {
                              this.loadHlsStatus < t && (t === C.a.LoadVideoTimeoutReason.HLS_LOADMANIFEST_SUCCESS && this.exceptionStat.setStat(d.a.DIM_LINK_STA.CONNECT_SUC, 1),
                              this.loadHlsStatus = t)
                          }
                      }, {
                          key: "sendLoadVideoErrorStatus",
                          value: function() {
                              this.eventEmitter.tsdbUtil.sendMetrics([this.stat.createAct(TsdbUtil.METRIC.VIDEO_VIDEO_LOAD_ERROR, {
                                  value: [this.loadHlsStatus]
                              })])
                          }
                      }, {
                          key: "getPlayVideo",
                          value: function() {
                              return this.mse.getPlayVideo()
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              this.started && (l.a.log("HlsPlayer.stop"),
                              this.destroy(),
                              this.reset())
                          }
                      }, {
                          key: "seek",
                          value: function(t) {
                              if (!this.isLive && null != t) {
                                  if (this.seeking = !0,
                                  this.skipStatForSeek = !0,
                                  this.seekTime = t,
                                  this.hlsSeek.seek(0),
                                  0 == t) {
                                      if (this.firstPlay = !1,
                                      !this.mse || !this.mse.video)
                                          return;
                                      if (0 == this.mse.video.currentTime)
                                          return
                                  }
                                  this.playlist && (l.a.log("HlsPlayer.seek " + t),
                                  t = Math.max(0, Number(t)),
                                  this.playlist.seek(t) ? (this.mse.seek(t),
                                  this.mse.resetHls(),
                                  this.releaseLoader(),
                                  this.isLoading = !1,
                                  this.loadFragment(),
                                  this.hlsSeek.seek(this.seekTime)) : this.playlist.firstLevelLoaded && (l.a.warn("HlsPlayer.seek out of range."),
                                  this.stop(),
                                  this.onAnchorStop()))
                              }
                          }
                      }, {
                          key: "pause",
                          value: function() {
                              this.started && (l.a.info("HlsPlayer.pause"),
                              this.userPaused = !0,
                              this.mse && this.mse.pause())
                          }
                      }, {
                          key: "play",
                          value: function() {
                              this.started && (l.a.info("HlsPlayer.play"),
                              this.userPaused = !1,
                              this.mse && this.mse.play())
                          }
                      }, {
                          key: "setVolume",
                          value: function(t) {
                              this.mse && this.mse.setVolume(t)
                          }
                      }, {
                          key: "getVolume",
                          value: function() {
                              return this.mse ? this.mse.getVolume() : -1
                          }
                      }, {
                          key: "getBufferLen",
                          value: function() {
                              return this.mse.getBufferLen()
                          }
                      }, {
                          key: "getFrameBufferLen",
                          value: function() {
                              return this.mse.getFrameBufferLen()
                          }
                      }, {
                          key: "getCurrentTime",
                          value: function() {
                              return this.mse && (this.lastPlayTs = Math.round(this.mse.getCurrentTime() / 1e3)),
                              this.lastPlayTs > this.getDurationTime() ? this.getDurationTime() : this.lastPlayTs
                          }
                      }, {
                          key: "getCurrentDts",
                          value: function() {
                              return this.mse.getCurrentDts()
                          }
                      }, {
                          key: "getCurrentSeiOffsetDts",
                          value: function() {
                              return this.mse.getCurrentSeiOffsetDts()
                          }
                      }, {
                          key: "getDurationTime",
                          value: function() {
                              return Math.floor(this.playlist && this.playlist.totalDuration ? this.playlist.totalDuration : 0)
                          }
                      }, {
                          key: "getAnticodeHandler",
                          value: function() {
                              return this.anticode
                          }
                      }, {
                          key: "updateFlvConfig",
                          value: function() {
                              this.mse && this.mse.setJitter(o.a.hlsJitCfg[0], o.a.hlsJitCfg[1], o.a.hlsJitCfg[2])
                          }
                      }, {
                          key: "updateLiveVodUrl",
                          value: function(t, e) {
                              e !== this.cdnName ? this.eventEmitter.trigger(r.a.PLAYBACK_DIF_CDN) : this.playlist.updateLiveVodUrl(t)
                          }
                      }, {
                          key: "setMuted",
                          value: function(t) {
                              this.mse && this.mse.setMuted(t)
                          }
                      }, {
                          key: "getMuted",
                          value: function() {
                              return this.mse ? this.mse.getMuted() : -1
                          }
                      }, {
                          key: "reconnectLive",
                          value: function() {
                              l.a.log("HlsPlayer.reconnectLive"),
                              this.isLive ? (this.url,
                              this.isLive,
                              this.destroy(),
                              this.reset(),
                              this.start(this.info)) : this.loadFragment()
                          }
                      }, {
                          key: "setTargetDuration",
                          value: function(t) {
                              this.targetDuration = t * this.config.minFragBufferNum
                          }
                      }, {
                          key: "loadFragment",
                          value: function() {
                              var t = arguments.length > 0 && void 0 !== arguments[0] && arguments[0];
                              if (!this.isLoading && null !== this.playlist.currDetails && (this.hlsSeek.check(),
                              this.started)) {
                                  var e = void 0;
                                  if (0 == this.seekTime) {
                                      var i = this.targetDuration > this.config.maxBufferLength ? this.config.maxBufferLength : this.targetDuration < this.config.minBufferLength ? this.config.minBufferLength : this.targetDuration
                                        , s = this.mse.getPlayVideo();
                                      if ((e = this.bufferedInfo(s.currentTime, s.buffered).len) >= i)
                                          return
                                  }
                                  var a = t ? this.playlist.getCurrentFrag() : this.playlist.getNextFrag();
                                  if (a) {
                                      var r = this.config
                                        , n = r.bs2Delay + this.targetDuration / 3 * 1e3
                                        , o = a.url;
                                      0 == this.firstFragLoadTs && (this.firstFragLoadTs = c.a.now()),
                                      this.isLoading = !0,
                                      this.releaseLoader();
                                      var h = new this._loaderClz(r);
                                      this.fragLoader = h,
                                      a.byteRangeEndOffset && (h.fromByte = a.byteRangeStartOffset,
                                      h.toByte = a.byteRangeEndOffset - 1),
                                      this.fragStartTs = c.a.now(),
                                      this.fragSize = 0,
                                      this.stat.addComp(d.a.HLS_INFO.name, d.a.HLS_INFO.TS_CNT, 1),
                                      h.loadBuffer(o, this.loadOpen.bind(this), this.loadChunk.bind(this), this.loadSuccess.bind(this), this.loadError.bind(this), this.loadTimeout.bind(this), n, r.fragLoadingMaxRetry, r.fragLoadingRetryDelay)
                                  } else if (null != e && e <= 1) {
                                      if (l.a.log("HlsPlayer.loadFragment ANCHOR_STOP bufferedLen=" + e.toFixed(2)),
                                      !this.isLive) {
                                          var u = this.mse.getPlayVideo()
                                            , p = u.currentTime
                                            , f = this.getDurationTime();
                                          f - p - e <= 2 && (2 === Number(this.liveType) ? (this.stop(),
                                          this.onAnchorStop()) : u.currentTime = f)
                                      }
                                  } else if (this.seekTime > 0)
                                      if (l.a.warn("HlsPlayer.seek out of range."),
                                      this.isLive)
                                          this.stop(),
                                          this.onAnchorStop();
                                      else {
                                          var _ = this.mse.getPlayVideo()
                                            , m = _.currentTime
                                            , v = this.getDurationTime();
                                          v - m <= 2 && this.seek(v)
                                      }
                              }
                          }
                      }, {
                          key: "loadOpen",
                          value: function() {
                              this.fragOpenTs = c.a.now();
                              var t = this.fragOpenTs - this.fragStartTs;
                              t < 5e3 && this.playStat.tsOpens.push(t)
                          }
                      }, {
                          key: "loadChunk",
                          value: function(t) {
                              this.pushData(t)
                          }
                      }, {
                          key: "loadSuccess",
                          value: function(t) {
                              this.isLoading = !1,
                              this.pushData(t);
                              var e = c.a.now() - this.fragOpenTs;
                              e < 1e4 && (this.playStat.tsLoadeds.push(e),
                              this.playStat.tsSpeeds.push(this.fragSize / e),
                              this.playStat.tsSizes.push(this.fragSize)),
                              this.stat.addComp(d.a.HLS_INFO.name, d.a.HLS_INFO.TS_SUC_CNT, 1),
                              this.fragSize = 0
                          }
                      }, {
                          key: "pushData",
                          value: function(t) {
                              if (t) {
                                  this.exceptionStat.setStat(d.a.DIM_LINK_STA.HAS_DATA, 1),
                                  this.avgSpeed.addCur(t.byteLength),
                                  this.fragSize += t.byteLength,
                                  this.stat.addCore(d.a.CORE.CDN_TOTAL_BW, t.byteLength);
                                  var e = this.playlist.currLevel
                                    , i = this.playlist.currFrag
                                    , s = this.playlist.lastFrag
                                    , a = e.details.totalduration;
                                  0 == this.firstFragLoadedTs && (this.firstFragLoadedTs = c.a.now(),
                                  this.firstFragSize = t.byteLength / 1024 | 0);
                                  var r = i.discontinuity;
                                  this.curAppendFrag && this.curAppendFrag.sn === i.sn ? r = !1 : this.curAppendFrag && this.curAppendFrag.sn !== i.sn && (this.curAppendFrag = i),
                                  this.curAppendFrag || (this.curAppendFrag = i),
                                  this.mse.appendTs({
                                      data: t,
                                      audioCodec: e.audioCodec,
                                      videoCodec: e.videoCodec,
                                      timeOffset: i.start,
                                      duration: a,
                                      discontinuity: r,
                                      _discontinuity: i.seeking && s && i.discontinuityCnt !== s.discontinuityCnt,
                                      level: i.level,
                                      sn: i.sn,
                                      seeking: i.seeking,
                                      hlsDT: i.hlsDT,
                                      tsDT: i.tsDT
                                  }),
                                  i && i.seeking && (i.seeking = !1,
                                  this.firstPlay && (this.firstPlay = !1,
                                  this.mse.seek(this.seekTime),
                                  this.onVideoSeek(this.seekTime),
                                  this.play()),
                                  this.seekTime = 0),
                                  k.a.has(this.onCheckTimer, this) || (k.a.add(this.onCheckTimer, this, 1e3),
                                  k.a.add(this.onCheckFastTimer, this, 100)),
                                  this.setLoadStatus(C.a.LoadVideoTimeoutReason.HLS_LOADFRAMENT_SUCCESS)
                              }
                          }
                      }, {
                          key: "loadError",
                          value: function(t) {
                              var e = t.code
                                , i = t.currentTarget;
                              this.stat.addComp(d.a.HLS_INFO.name, d.a.HLS_INFO.TS_FAIL_CNT, 1),
                              l.a.warn("load fragment error:".concat(e || i.status)),
                              this.isLoading = !1,
                              this.config.autoReconnect && this.reconnectLive(),
                              this.setLoadStatus(C.a.LoadVideoTimeoutReason.HLS_LOADFRAMENT_ERROR)
                          }
                      }, {
                          key: "loadTimeout",
                          value: function(t) {
                              this.stat.addComp(d.a.HLS_INFO.name, d.a.HLS_INFO.TS_TIMEOUT_CNT, 1),
                              l.a.warn("load fragment timeout", t),
                              this.isLoading = !1,
                              this.config.autoReconnect && this.reconnectLive()
                          }
                      }, {
                          key: "bufferedInfo",
                          value: function(t, e) {
                              var i, s, a, r, n, o = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : .3, h = [], u = [];
                              for (n = 0; n < e.length; n++)
                                  h.push({
                                      start: e.start(n),
                                      end: e.end(n)
                                  });
                              for (h.sort((function(t, e) {
                                  return t.start - e.start || e.end - t.end
                              }
                              )),
                              n = 0; n < h.length; n++) {
                                  var l = u.length;
                                  if (l) {
                                      var c = u[l - 1].end;
                                      h[n].start - c < o ? h[n].end > c && (u[l - 1].end = h[n].end) : u.push(h[n])
                                  } else
                                      u.push(h[n])
                              }
                              for (n = 0,
                              i = 0,
                              s = a = t; n < u.length; n++) {
                                  var d = u[n].start
                                    , p = u[n].end;
                                  if (t + o >= d && t < p)
                                      s = d,
                                      i = (a = p) - t;
                                  else if (t + o < d) {
                                      r = d;
                                      break
                                  }
                              }
                              return {
                                  len: i,
                                  start: s,
                                  end: a,
                                  nextStart: r
                              }
                          }
                      }, {
                          key: "checkCatonError",
                          value: function() {
                              if (this.mse && this.mse.getBufferLen && this.mse.getBufferLen() > 8e3 && !this.mse.video.paused && Math.floor(this.mse.getCurrentTime() / 1e3) < 5) {
                                  if (Math.floor(this.lastPlayTs) == Math.floor(this.mse.getCurrentTime() / 1e3) && this.pauseInBufferFullTimes++,
                                  this.playTriggered)
                                      return;
                                  if (this.pauseInBufferFullTimes >= 5) {
                                      var t = this.playlist.getNearFragStart(this.lastPlayTs + 1);
                                      this.seek(t),
                                      this.pauseInBufferFullTimes = 0
                                  }
                              }
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              if (this.anticode.onCheckTimer(t, e),
                              this.avgSpeed.calculate(),
                              this.started && this.mse && !this.needReset && (this.loadFragment(),
                              this.mse && !this.mse.userPaused)) {
                                  if (this.mse && this.mse.onCheckTimer(t, e),
                                  this.playlist && this.playlist.onCheckTimer(e),
                                  this.playTs > 0) {
                                      var i = t - this.pauseTs;
                                      this.playStat && (this.pauseTs > 0 && i > 200 && !this.skipStatForSeek && 0 == this.pauseCnt && this.playStat.setPause(),
                                      this.pauseCnt > 0 && (this.pauseCnt = 0,
                                      this.playStat.setPause()),
                                      e % 20 == 0 && this.playStat.report()),
                                      this.pauseTs > 0 && i > 5e3 && (l.a.warn("HlsPlayer.onCheckTimer pauseTime=" + i),
                                      this.isLive || (this.triggerH5PlayError(),
                                      this.pauseTs = 0))
                                  }
                                  this.checkCatonError(),
                                  this.eventEmitter.trigger(r.a.PLAY_TIME_STATUS, {
                                      current: this.getCurrentTime(),
                                      total: this.getDurationTime()
                                  }),
                                  this.eventEmitter.trigger(r.a.PLAY_FRAME_BUFFER, {
                                      frameStorage: this.mse && this.mse.getFrameReadyed(),
                                      jitterBuffer: this.mse && this.mse.getBufferLen()
                                  })
                              }
                          }
                      }, {
                          key: "onCheckFastTimer",
                          value: function(t, e) {
                              this.needReset ? this.mse && this.mse.getBufferLen() < 500 && (this.reloadInError(),
                              this.needReset = !1) : this.started && this.mse && !this.mse.userPaused && this.mse && this.mse.onCheckFastTimer(t, e)
                          }
                      }, {
                          key: "updateStatus",
                          value: function(t) {
                              this.videoStatus !== t && (this.videoStatus = t,
                              this.eventEmitter.trigger(r.a.PLAY_STATUS, {
                                  status: t
                              }))
                          }
                      }, {
                          key: "onStartVideo",
                          value: function() {
                              this.loadStartTs = c.a.now()
                          }
                      }, {
                          key: "onPlayVideo",
                          value: function(t, e, i, s) {
                              var a = c.a.now();
                              if (this.playTs = a,
                              this.hasVideo = s,
                              0 !== this.startTs) {
                                  var n = a - this.startTs
                                    , o = this.playlist.manifestLoadedTs - this.startTs
                                    , h = this.firstFragLoadTs - this.playlist.manifestLoadedTs
                                    , u = this.firstFragLoadedTs - this.firstFragLoadTs
                                    , d = this.UIStartCost > 0 ? n + this.UIStartCost : 0
                                    , p = 0;
                                  this.startTimeStamp > 1 ? p = n + this.businessStartCost : 1 === this.startTimeStamp && (p = a - this.loadStartTs),
                                  this.tsdb.sendHlsTime(this._loaderType, n, o, h, u, this.firstFragSize, p, d),
                                  l.a.log("%cHlsPlayer.onPlayVideo loadTime=" + n, "color:#A23400;background:#FFF5C2"),
                                  this.startTs = 0
                              }
                              this.eventEmitter.trigger(r.a.VIDEO_PLAY, {
                                  video: t,
                                  width: e,
                                  height: i
                              }),
                              !this.pausedByBrowser && this.updateStatus(r.b.VIDEO_PLAYING),
                              this.seeking = !1,
                              this.skipStatForSeek = !1,
                              this.playTriggered = !0
                          }
                      }, {
                          key: "onVideoStop",
                          value: function(t, e) {
                              l.a.log("HlsPlayer.onVideoStop hasVideo=" + e),
                              this.hasVideo = !1,
                              e && (this.updateStatus(r.b.VIDEO_STOP),
                              this.eventEmitter.trigger(r.a.VIDEO_STOP, {
                                  video: t
                              }))
                          }
                      }, {
                          key: "onAnchorStop",
                          value: function() {
                              var t = this.mse ? this.mse.getPlayVideo() : null;
                              this.eventEmitter.trigger(r.a.ANCHOR_STOP, {
                                  video: t
                              })
                          }
                      }, {
                          key: "onLoadM3u8Error",
                          value: function() {
                              this.eventEmitter.trigger(r.a.HLS_URL_UNAVAILABLE)
                          }
                      }, {
                          key: "onLoadManifestTimeout",
                          value: function() {
                              this.eventEmitter.trigger(r.a.HLS_MAINFEST_LOAD_TIMEOUT)
                          }
                      }, {
                          key: "onConnectManifestTimeout",
                          value: function() {
                              this.eventEmitter.trigger(r.a.HLS_URL_LOAD_TIMEOUT)
                          }
                      }, {
                          key: "onPlayerError",
                          value: function(t) {
                              this.videoElement
                          }
                      }, {
                          key: "triggerH5PlayError",
                          value: function() {
                              var t = this.getCurrentTime();
                              l.a.log("HlsPlayer.triggerH5PlayError seekTime = ".concat(t)),
                              this.info && (this.eventEmitter.trigger(r.a.PAUSE_5S_RETRY),
                              this.info.seekTime = t,
                              this.start(this.info))
                          }
                      }, {
                          key: "onErrorEvent",
                          value: function(t) {
                              var e = this.mse ? this.mse.getPlayVideo() : null;
                              this.eventEmitter.trigger(r.a.H5_PLAYER_ERROR, {
                                  video: e,
                                  code: t.type,
                                  msg: "播放错误"
                              }),
                              this.setLoadStatus(C.a.LoadVideoTimeoutReason.HLS_PLAY_ERROR)
                          }
                      }, {
                          key: "onPlayPause",
                          value: function(t, e) {
                              if (e && (this.pauseTs = t,
                              this.updateStatus(r.b.VIDEO_CACHING),
                              this.playlist && !this.isLive)) {
                                  var i = 1e3 * this.playlist.totalDuration
                                    , s = this.mse ? this.mse.getCurrentTime() : 0;
                                  i > 0 && s > 0 && Math.abs(i - s) < 1e3 && this.isLive && (l.a.warn("HlsPlayer detect anchor stop."),
                                  this.onAnchorStop(),
                                  this.stop()),
                                  this.startSendPauseTimer()
                              }
                          }
                      }, {
                          key: "onPlayResume",
                          value: function(t, e) {
                              if (this.pauseTs > 0) {
                                  var i = t - this.pauseTs;
                                  i > 200 && !this.skipStatForSeek && (l.a.warn("HlsPlayer.onPlayResume pauseTime=" + i),
                                  this.pauseCnt++,
                                  this.stat.addCore(d.a.CORE.VIDEO_BLOCK_COUNT, 1),
                                  this.stat.addCore(d.a.CORE.VIDEO_BLOCK_DURATION, i),
                                  this.eventEmitter.trigger(r.a.VIDEO_BAD_QUALITY)),
                                  this.pauseTs = 0
                              }
                              this.skipStatForSeek = this.seeking,
                              e && this.updateStatus(r.b.VIDEO_PLAYING)
                          }
                      }, {
                          key: "onVideoSeek",
                          value: function(t) {
                              this.seeking = !1;
                              var e = this.mse ? this.mse.getPlayVideo() : null;
                              this.eventEmitter.trigger(r.a.VIDEO_SEEK, {
                                  video: e,
                                  currentTime: t
                              })
                          }
                      }, {
                          key: "onPauseByBrowser",
                          value: function() {
                              window && (l.a.warn("HlsPlayer.onPauseBrowser: video was paused by browser, define click listener"),
                              window.removeEventListener("click", this._clickEventBind, !0),
                              window.addEventListener("click", this._clickEventBind, !0),
                              this.pausedByBrowser = !0)
                          }
                      }, {
                          key: "_clickEvent",
                          value: function() {
                              document && (l.a.log("HlsPlayer._clickEvent: click for play a temp video"),
                              document.createElement("video").play(),
                              this.pausedByBrowser = !1,
                              window && window.removeEventListener("click", this._clickEventBind, !0))
                          }
                      }, {
                          key: "startSendPauseTimer",
                          value: function() {
                              this.stopSendPauseTimer(),
                              this.sendPauseTimeout = setTimeout(this.sendPauseEvent.bind(this), 200)
                          }
                      }, {
                          key: "stopSendPauseTimer",
                          value: function() {
                              clearTimeout(this.sendPauseTimeout)
                          }
                      }, {
                          key: "sendPauseEvent",
                          value: function() {
                              this.videoStatus !== r.b.VIDEO_PLAYING && this.eventEmitter.trigger(r.a.PLAY_CARTON)
                          }
                      }, {
                          key: "getCostTimes",
                          value: function() {
                              return this.playlist ? [this.playlist.manifestLoadedTs > 0 ? this.playlist.manifestLoadedTs - this.startTs : 0, this.firstFragLoadedTs > 0 ? this.firstFragLoadTs - this.playlist.manifestLoadedTs : 0, this.firstFragLoadedTs > 0 ? this.firstFragLoadedTs - this.firstFragLoadTs : 0] : [0, 0, 0]
                          }
                      }, {
                          key: "switchLevel",
                          value: function(t) {
                              var e = this.playlist.levels
                                , i = t.curBitRate;
                              if (e.length > 0 && this.playlist.isMasterPlayList) {
                                  for (var s = 0; s < e.length; s++)
                                      if (e[s].bitrate === i && this.playlist.currLevel.bitrate != i) {
                                          this.playlist.currLevel.bitrate = i,
                                          this.playlist.currLevelId = s,
                                          this.playlist.currLevel.url = e[s].url,
                                          this.mse.parser.switchLevel(),
                                          this.play();
                                          break
                                      }
                              } else
                                  this.playlist.currLevel.url = t.url,
                                  this.playlist.currLevel.bitrate = i,
                                  this.mse.parser.switchLevel(),
                                  this.play()
                          }
                      }, {
                          key: "isPlaying",
                          get: function() {
                              return this.videoStatus !== r.b.VIDEO_STOP
                          }
                      }, {
                          key: "hasPicture",
                          get: function() {
                              return this.isPlaying && 0 !== this.mse.getCurrentTime()
                          }
                      }]),
                      t
                  }()
                    , ia = function() {
                      return performance.now()
                  }
                    , sa = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this._init()
                      }
                      return Object(a.a)(t, [{
                          key: "_init",
                          value: function() {
                              this.index = 0,
                              this.data = new Float64Array(64),
                              this.now = ia()
                          }
                      }, {
                          key: "start",
                          value: function() {
                              this.now = ia()
                          }
                      }, {
                          key: "finish",
                          value: function() {
                              var t = ia() - this.now;
                              this.data[this.index] = t,
                              this.index++,
                              this.index >= this.data.length && (this.index = 0)
                          }
                      }, {
                          key: "average",
                          value: function() {
                              var t, e = 0, i = 0, s = Object(m.a)(this.data);
                              try {
                                  for (s.s(); !(t = s.n()).done; ) {
                                      var a = t.value;
                                      a && a > 0 && (e += a,
                                      i++)
                                  }
                              } catch (t) {
                                  s.e(t)
                              } finally {
                                  s.f()
                              }
                              return e ? e / i : 0
                          }
                      }]),
                      t
                  }()
                    , aa = new sa
                    , ra = new sa
                    , na = function() {
                      function t() {
                          var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 0;
                          Object(s.a)(this, t),
                          this._updateFunc = null,
                          this._lastTime = 0,
                          this._frameRate = e
                      }
                      return Object(a.a)(t, [{
                          key: "_update",
                          value: function(t) {
                              if (this._lastTime > 0) {
                                  var e = t - this._lastTime;
                                  e > 0 && this._updateFunc && this._updateFunc(e)
                              }
                              this._lastTime = t
                          }
                      }, {
                          key: "start",
                          value: function(t) {
                              this._updateFunc = t
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              this._updateFunc = null
                          }
                      }]),
                      t
                  }()
                    , oa = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i(t) {
                          var a;
                          return Object(s.a)(this, i),
                          (a = e.call(this, t))._requestId = 0,
                          a._updateBind = a._update.bind(Object(g.a)(a)),
                          a
                      }
                      return Object(a.a)(i, [{
                          key: "_update",
                          value: function(t) {
                              E(Object(S.a)(i.prototype), "_update", this).call(this, t),
                              this._requestId = requestAnimationFrame(this._updateBind)
                          }
                      }, {
                          key: "start",
                          value: function(t) {
                              E(Object(S.a)(i.prototype), "start", this).call(this, t),
                              this._requestId = requestAnimationFrame(this._updateBind)
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              E(Object(S.a)(i.prototype), "stop", this).call(this),
                              this._requestId > 0 && cancelAnimationFrame(this._requestId),
                              this._requestId = 0
                          }
                      }]),
                      i
                  }(na)
                    , ha = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i(t) {
                          return Object(s.a)(this, i),
                          e.call(this, t)
                      }
                      return Object(a.a)(i, [{
                          key: "start",
                          value: function(t) {
                              E(Object(S.a)(i.prototype), "start", this).call(this, t),
                              k.a.add(this._update, this, this._frameRate)
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              E(Object(S.a)(i.prototype), "stop", this).call(this),
                              k.a.remove(this._update, this)
                          }
                      }]),
                      i
                  }(na)
                    , ua = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i(t) {
                          var a;
                          return Object(s.a)(this, i),
                          (a = e.call(this, t))._webWorkerString = "            var running = false;            function tick(){                postMessage(Date.now());                if (running){                    setTimeout(tick, 1000/".concat(t || 60, ");                }            }            self.addEventListener('message',function(msg){                var data = msg.data;                if (data === 'start'){                    running = true;                    tick();                }                if (data === 'stop') running = false;            });"),
                          a._webWorker = null,
                          a
                      }
                      return Object(a.a)(i, [{
                          key: "_initWebWorker",
                          value: function() {
                              var t = this;
                              window.URL = window.URL || window.webkitURL;
                              var e = new Blob([this._webWorkerString],{
                                  type: "application/javascript"
                              });
                              this._webWorker = new Worker(URL.createObjectURL(e)),
                              this._webWorker.onmessage = function(e) {
                                  t._update(e.data)
                              }
                          }
                      }, {
                          key: "start",
                          value: function(t) {
                              E(Object(S.a)(i.prototype), "start", this).call(this, t),
                              this._webWorker || this._initWebWorker(),
                              this._webWorker.postMessage("start")
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              E(Object(S.a)(i.prototype), "stop", this).call(this),
                              this._webWorker && this._webWorker.postMessage("stop")
                          }
                      }]),
                      i
                  }(na)
                    , la = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this._updateFuc = e,
                          this._main = null,
                          this._worker = null,
                          this._isInit = !1
                      }
                      return Object(a.a)(t, [{
                          key: "init",
                          value: function() {
                              var t = this;
                              if (!this._isInit) {
                                  if (this._isInit = !0,
                                  0 === o.a.obsFrame ? this._main = new oa(0) : this._main = new ha(o.a.obsFrame),
                                  this._worker = new ua(30),
                                  void 0 === document.hidden)
                                      return window.addEventListener("focus", this._gainedVisibility.bind(this)),
                                      void window.addEventListener("blur", this._lostVisibility.bind(this));
                                  document.addEventListener("visibilitychange", (function() {
                                      !0 === document.hidden ? t._lostVisibility() : t._gainedVisibility()
                                  }
                                  ), !1)
                              }
                          }
                      }, {
                          key: "start",
                          value: function() {
                              this.init(),
                              this._main.start(this._updateFuc)
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              this._main.stop(),
                              this._worker.stop()
                          }
                      }, {
                          key: "_lostVisibility",
                          value: function() {
                              this._main.stop(),
                              this._worker.start(this._updateFuc)
                          }
                      }, {
                          key: "_gainedVisibility",
                          value: function() {
                              this._worker.stop(),
                              this._main.start(this._updateFuc)
                          }
                      }]),
                      t
                  }();
                  function ca(t, e, i) {
                      var s = t.createShader(i);
                      if (t.shaderSource(s, e),
                      t.compileShader(s),
                      !t.getShaderParameter(s, t.COMPILE_STATUS))
                          throw "could not compile shader:" + t.getShaderInfoLog(s);
                      return s
                  }
                  function da(t) {
                      var e = t.createTexture();
                      return t.bindTexture(t.TEXTURE_2D, e),
                      t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_S, t.CLAMP_TO_EDGE),
                      t.texParameteri(t.TEXTURE_2D, t.TEXTURE_WRAP_T, t.CLAMP_TO_EDGE),
                      t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MIN_FILTER, t.NEAREST),
                      t.texParameteri(t.TEXTURE_2D, t.TEXTURE_MAG_FILTER, t.NEAREST),
                      e
                  }
                  var pa = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this._updateables = [],
                          this._active = !1,
                          this._RAFTimes = 0,
                          this.fps = new y(3600),
                          this.fpsHeart = new y(20),
                          this._timer = new la(this._updateRAFTime.bind(this)),
                          this._totalTime = 0,
                          this._time1s = 0,
                          this._checkTimes = 0
                      }
                      return Object(a.a)(t, [{
                          key: "_updateRAFTime",
                          value: function(t) {
                              if (this._RAFTimes++,
                              this._totalTime += t,
                              ra.finish(),
                              ra.start(),
                              this._update(t),
                              0 === this._time1s && (this._time1s = this._totalTime),
                              this._totalTime - this._time1s > 1e3) {
                                  this._checkTimes++,
                                  this._time1s = this._totalTime;
                                  var e = 1e3 / ra.average();
                                  this.fps.add(e),
                                  this.fpsHeart.add(e),
                                  this._checkTimes % 20 == 0 && (l.a.log("OBSPlayer fps = ".concat(1e3 / ra.average())),
                                  l.a.log("OBSPlayer teximage2d = ".concat(aa.average())))
                              }
                          }
                      }, {
                          key: "_update",
                          value: function(t) {
                              t /= 1e3;
                              for (var e = 0; e < this._updateables.length; e++)
                                  this._updateables[e]._update(t)
                          }
                      }, {
                          key: "register",
                          value: function(t) {
                              -1 === this._updateables.indexOf(t) && this._updateables.push(t),
                              !1 === this._active && (this._active = !0,
                              this._timer.start())
                          }
                      }, {
                          key: "unregister",
                          value: function(t) {
                              var e = this._updateables.indexOf(t);
                              -1 !== e && this._updateables.splice(e, 1)
                          }
                      }]),
                      t
                  }();
                  function fa(t, e, i, s, a, r, n) {
                      return (n = n || new Float32Array(16))[0] = 2 / (e - t),
                      n[1] = 0,
                      n[2] = 0,
                      n[3] = 0,
                      n[4] = 0,
                      n[5] = 2 / (s - i),
                      n[6] = 0,
                      n[7] = 0,
                      n[8] = 0,
                      n[9] = 0,
                      n[10] = 2 / (a - r),
                      n[11] = 0,
                      n[12] = (t + e) / (t - e),
                      n[13] = (i + s) / (i - s),
                      n[14] = (a + r) / (a - r),
                      n[15] = 1,
                      n
                  }
                  function _a(t, e, i, s, a) {
                      a = a || new Float32Array(16);
                      var r = t[0]
                        , n = t[1]
                        , o = t[2]
                        , h = t[3]
                        , u = t[4]
                        , l = t[5]
                        , c = t[6]
                        , d = t[7]
                        , p = t[8]
                        , f = t[9]
                        , _ = t[10]
                        , m = t[11]
                        , v = t[12]
                        , y = t[13]
                        , T = t[14]
                        , g = t[15];
                      return t !== a && (a[0] = r,
                      a[1] = n,
                      a[2] = o,
                      a[3] = h,
                      a[4] = u,
                      a[5] = l,
                      a[6] = c,
                      a[7] = d,
                      a[8] = p,
                      a[9] = f,
                      a[10] = _,
                      a[11] = m),
                      a[12] = r * e + u * i + p * s + v,
                      a[13] = n * e + l * i + f * s + y,
                      a[14] = o * e + c * i + _ * s + T,
                      a[15] = h * e + d * i + m * s + g,
                      a
                  }
                  function ma(t, e, i, s, a) {
                      return (a = a || new Float32Array(16))[0] = e * t[0],
                      a[1] = e * t[1],
                      a[2] = e * t[2],
                      a[3] = e * t[3],
                      a[4] = i * t[4],
                      a[5] = i * t[5],
                      a[6] = i * t[6],
                      a[7] = i * t[7],
                      a[8] = s * t[8],
                      a[9] = s * t[9],
                      a[10] = s * t[10],
                      a[11] = s * t[11],
                      t !== a && (a[12] = t[12],
                      a[13] = t[13],
                      a[14] = t[14],
                      a[15] = t[15]),
                      a
                  }
                  function va(t, e, i, s) {
                      return (s = s || new Float32Array(16))[0] = 1,
                      s[1] = 0,
                      s[2] = 0,
                      s[3] = 0,
                      s[4] = 0,
                      s[5] = 1,
                      s[6] = 0,
                      s[7] = 0,
                      s[8] = 0,
                      s[9] = 0,
                      s[10] = 1,
                      s[11] = 0,
                      s[12] = t,
                      s[13] = e,
                      s[14] = i,
                      s[15] = 1,
                      s
                  }
                  function ya(t, e, i, s) {
                      return (ya = "undefined" != typeof Reflect && Reflect.set ? Reflect.set : function(t, e, i, s) {
                          var a, r = P(t, e);
                          if (r) {
                              if ((a = Object.getOwnPropertyDescriptor(r, e)).set)
                                  return a.set.call(s, i),
                                  !0;
                              if (!a.writable)
                                  return !1
                          }
                          if (a = Object.getOwnPropertyDescriptor(s, e)) {
                              if (!a.writable)
                                  return !1;
                              a.value = i,
                              Object.defineProperty(s, e, a)
                          } else
                              re(s, e, i);
                          return !0
                      }
                      )(t, e, i, s)
                  }
                  var Ta = function() {
                      function t(e, i, a) {
                          var r = arguments.length > 3 && void 0 !== arguments[3] && arguments[3];
                          Object(s.a)(this, t),
                          this._renderGraph = i,
                          this._limitConnections = r,
                          this._inputNames = a,
                          this._destroyed = !1,
                          this._gl = e,
                          this._index = 0,
                          this._renderGraph = i,
                          this._rendered = !1,
                          this._displayName = "GraphNode"
                      }
                      return Object(a.a)(t, [{
                          key: "_log",
                          value: function(t) {
                              l.a.log("OBSPlayer index-".concat(this.index, " ").concat(t))
                          }
                      }, {
                          key: "connect",
                          value: function(t, e) {
                              return this._renderGraph.registerConnection(this, t, e)
                          }
                      }, {
                          key: "disconnect",
                          value: function(t) {
                              var e = this;
                              if (void 0 === t) {
                                  var i = this._renderGraph.getOutputsForNode(this);
                                  return i.forEach((function(t) {
                                      return e._renderGraph.unregisterConnection(e, t)
                                  }
                                  )),
                                  i.length > 0
                              }
                              return this._renderGraph.unregisterConnection(this, t)
                          }
                      }, {
                          key: "destroy",
                          value: function() {
                              this.disconnect();
                              var t, e = Object(m.a)(this.inputs);
                              try {
                                  for (e.s(); !(t = e.n()).done; )
                                      t.value.disconnect(this)
                              } catch (t) {
                                  e.e(t)
                              } finally {
                                  e.f()
                              }
                              this._destroyed = !0
                          }
                      }, {
                          key: "index",
                          get: function() {
                              return this._index
                          },
                          set: function(t) {
                              this._index = t
                          }
                      }, {
                          key: "displayName",
                          get: function() {
                              return this._displayName
                          }
                      }, {
                          key: "inputNames",
                          get: function() {
                              return this._inputNames.slice()
                          }
                      }, {
                          key: "maximumConnections",
                          get: function() {
                              return !1 === this._limitConnections ? 1 / 0 : this._inputNames.length
                          }
                      }, {
                          key: "inputs",
                          get: function() {
                              var t = this._renderGraph.getInputsForNode(this);
                              return t.filter((function(t) {
                                  return void 0 !== t
                              }
                              ))
                          }
                      }, {
                          key: "outputs",
                          get: function() {
                              return this._renderGraph.getOutputsForNode(this)
                          }
                      }, {
                          key: "destroyed",
                          get: function() {
                              return this._destroyed
                          }
                      }]),
                      t
                  }()
                    , ga = 1
                    , Sa = 2
                    , Pa = 0
                    , Ea = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i(t, a, r, n, o) {
                          var h;
                          return Object(s.a)(this, i),
                          (h = e.call(this, r, n, [], !0))._element = void 0,
                          h._elementURL = t,
                          h._isResponsibleForElementLifeCycle = !0,
                          h._state = Pa,
                          h._currentDTS = o,
                          h._startTime = NaN,
                          h._stopTime = 1 / 0,
                          h._ready = !1,
                          h._loadCalled = !1,
                          h._stretchPaused = !1,
                          h._renderMode = a,
                          a === Sa && (h._texture = da(r)),
                          h._isTextureCleared = void 0,
                          h._callbacks = [],
                          h._renderPaused = !1,
                          h._displayName = "SourceNode",
                          h
                      }
                      return Object(a.a)(i, [{
                          key: "_load",
                          value: function() {
                              this._loadCalled || (this._triggerCallbacks("load"),
                              this._loadCalled = !0)
                          }
                      }, {
                          key: "_unload",
                          value: function() {
                              var t, e;
                              this._triggerCallbacks("destroy"),
                              this._loadCalled = !1,
                              this._rendered = !1,
                              this._state = Pa,
                              this._isTextureCleared = void 0,
                              this._renderMode === Sa && (t = this._gl,
                              (e = this._texture) && !e._isTextureCleared && (t.bindTexture(t.TEXTURE_2D, e),
                              t.texImage2D(t.TEXTURE_2D, 0, t.RGBA, 1, 1, 0, t.RGBA, t.UNSIGNED_BYTE, new Uint8Array([0, 0, 0, 0])),
                              e._isTextureCleared = !0))
                          }
                      }, {
                          key: "registerCallback",
                          value: function(t, e) {
                              this._callbacks.push({
                                  type: t,
                                  func: e
                              })
                          }
                      }, {
                          key: "unregisterCallback",
                          value: function(t) {
                              var e, i = [], s = Object(m.a)(this._callbacks);
                              try {
                                  for (s.s(); !(e = s.n()).done; ) {
                                      var a = e.value;
                                      (void 0 === t || a.func === t) && i.push(a)
                                  }
                              } catch (t) {
                                  s.e(t)
                              } finally {
                                  s.f()
                              }
                              for (var r = 0, n = i; r < n.length; r++) {
                                  var o = n[r]
                                    , h = this._callbacks.indexOf(o);
                                  this._callbacks.splice(h, 1)
                              }
                          }
                      }, {
                          key: "clearCallbacks",
                          value: function() {
                              this._callbacks = []
                          }
                      }, {
                          key: "_triggerCallbacks",
                          value: function(t, e) {
                              var i, s = Object(m.a)(this._callbacks);
                              try {
                                  for (s.s(); !(i = s.n()).done; ) {
                                      var a = i.value;
                                      a.type === t && (void 0 !== e ? a.func(this, e) : a.func(this))
                                  }
                              } catch (t) {
                                  s.e(t)
                              } finally {
                                  s.f()
                              }
                          }
                      }, {
                          key: "start",
                          value: function(t) {
                              return this._state !== Pa ? (console.debug("SourceNode is has already been sequenced. Can't sequence twice."),
                              !1) : (this._triggerCallbacks("start", t),
                              this._startTime = t,
                              this._state = 1,
                              !0)
                          }
                      }, {
                          key: "startAt",
                          value: function(t) {
                              return this._state !== Pa ? (console.debug("SourceNode is has already been sequenced. Can't sequence twice."),
                              !1) : (this._startTime = t,
                              this._state = 1,
                              !0)
                          }
                      }, {
                          key: "stop",
                          value: function(t) {
                              return 4 === this._state ? (console.debug("SourceNode has already ended. Cannot call stop."),
                              !1) : this._state === Pa ? (console.debug("SourceNode must have start called before stop is called"),
                              !1) : this._currentDTS + t <= this._startTime ? (console.debug("SourceNode must have a stop time after it's start time, not before."),
                              !1) : (this._stopTime = this._currentDTS + t,
                              this._stretchPaused = !1,
                              this._triggerCallbacks("durationchange", this.duration),
                              !0)
                          }
                      }, {
                          key: "stopAt",
                          value: function(t) {
                              return 4 === this._state ? (console.debug("SourceNode has already ended. Cannot call stop."),
                              !1) : this._state === Pa ? (console.debug("SourceNode must have start called before stop is called"),
                              !1) : t <= this._startTime ? (console.debug("SourceNode must have a stop time after it's start time, not before."),
                              !1) : (this._stopTime = t,
                              this._stretchPaused = !1,
                              this._triggerCallbacks("durationchange", this.duration),
                              !0)
                          }
                      }, {
                          key: "_seek",
                          value: function(t) {
                              this._renderPaused = !1,
                              this._triggerCallbacks("seek", t),
                              this._state !== Pa && (t >= this._startTime && 3 !== this._state && (this._state = 2),
                              this._currentDTS = t)
                          }
                      }, {
                          key: "_pause",
                          value: function() {
                              (2 === this._state || 0 === this._currentDTS && 0 === this._startTime) && (this._triggerCallbacks("pause"),
                              this._state = 3,
                              this._renderPaused = !1)
                          }
                      }, {
                          key: "_play",
                          value: function() {
                              3 === this._state && (this._triggerCallbacks("play"),
                              this._state = 2)
                          }
                      }, {
                          key: "_isReady",
                          value: function() {
                              return !this._buffering && (2 === this._state || 3 === this._state || 5 === this._state) && this._ready
                          }
                      }, {
                          key: "_update",
                          value: function(t) {
                              var e = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1]
                                , i = t - this._currentDTS;
                              return this._currentDTS = t,
                              this._state !== Pa && 4 !== this._state && 5 !== this._state && (this._triggerCallbacks("render", t),
                              t >= this._startTime && 3 !== this._state && 5 !== this._state && (2 !== this._state && this._triggerCallbacks("play"),
                              this._state = 2),
                              void 0 === this._element || !1 === this._ready || 2 === this._state && (e && 0 !== this._element.readyState ? (this._isTextureCleared = !1,
                              this._renderMode === Sa && this._updateWebgl(t)) : this._isTextureCleared = void 0,
                              this._stretchPaused && (this._stopTime += i)),
                              !0)
                          }
                      }, {
                          key: "_updateWebgl",
                          value: function(t) {
                              var e, i, s;
                              e = this._gl,
                              i = this._texture,
                              void 0 !== (s = this._element).readyState && 0 === s.readyState || (aa.start(),
                              e.bindTexture(e.TEXTURE_2D, i),
                              e.texImage2D(e.TEXTURE_2D, 0, e.RGBA, e.RGBA, e.UNSIGNED_BYTE, s),
                              aa.finish()),
                              !this._rendered && this._startTime > 0 && (this._log("render in currentTime=".concat(t, " startTime=").concat(this._startTime, " cost=").concat(t - this._startTime)),
                              this._rendered = !0)
                          }
                      }, {
                          key: "clearTimelineState",
                          value: function() {
                              this._startTime = NaN,
                              this._stopTime = 1 / 0,
                              this._state = Pa
                          }
                      }, {
                          key: "destroy",
                          value: function() {
                              this._unload(),
                              E(Object(S.a)(i.prototype), "destroy", this).call(this),
                              this.unregisterCallback(),
                              delete this._element,
                              this._elementURL = void 0,
                              this._state = Pa,
                              this._currentDTS = 0,
                              this._startTime = NaN,
                              this._stopTime = 1 / 0,
                              this._ready = !1,
                              this._loadCalled = !1,
                              this._renderMode === Sa && (this._gl.deleteTexture(this._texture),
                              this._texture = void 0)
                          }
                      }, {
                          key: "state",
                          get: function() {
                              return this._state
                          }
                      }, {
                          key: "element",
                          get: function() {
                              return this._element
                          }
                      }, {
                          key: "duration",
                          get: function() {
                              if (!isNaN(this._startTime))
                                  return this._stopTime === 1 / 0 ? 1 / 0 : this._stopTime - this._startTime
                          }
                      }, {
                          key: "stretchPaused",
                          set: function(t) {
                              this._stretchPaused = t
                          },
                          get: function() {
                              return this._stretchPaused
                          }
                      }, {
                          key: "isTextureCleared",
                          get: function() {
                              return this._isTextureCleared
                          }
                      }, {
                          key: "startTime",
                          get: function() {
                              return this._startTime
                          }
                      }, {
                          key: "stopTime",
                          get: function() {
                              return this._stopTime
                          }
                      }]),
                      i
                  }(Ta)
                    , Ia = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.comDim = new Map,
                          this.coreDim = new Map,
                          this.actDim = new Map,
                          this.extDim = new Map,
                          this.comFormatMap = new Map,
                          this.coreMap = new Map,
                          this.compMap = new Map,
                          this.heart_type = d.a.HEART_TYPE.START
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              this.comDim.clear(),
                              this.coreDim.clear(),
                              this.actDim.clear(),
                              this.extDim.clear(),
                              this.coreMap.clear(),
                              this.compMap.clear(),
                              this.heart_type = d.a.HEART_TYPE.START
                          }
                      }, {
                          key: "createAct",
                          value: function(t, e) {
                              return this._createAct(t, e)
                          }
                      }, {
                          key: "createActs",
                          value: function(t) {
                              var e = [];
                              if (t)
                                  for (var i = 0; i < t.length; i++) {
                                      var s = t[i]
                                        , a = this._createAct(s.type, s.params);
                                      e.push(a)
                                  }
                              return e
                          }
                      }, {
                          key: "_createAct",
                          value: function(t, e) {
                              var i = {
                                  sMetricName: d.a.ACT.name,
                                  vField: {},
                                  vDimension: {}
                              };
                              if (i.vDimension[d.a.ACT.field] = t,
                              this._fillFromMap(i.vDimension, this.comDim),
                              this._fillFromMap(i.vDimension, this.actDim),
                              e) {
                                  var s = 0;
                                  if (e.hasOwnProperty(d.a.KEY_VALUE)) {
                                      var a = e[d.a.KEY_VALUE];
                                      for (s = 0; s < a.length; s++)
                                          i.vField[d.a.KEY_VALUE + (s + 1)] = a[s]
                                  }
                                  if (e.hasOwnProperty(d.a.KEY_STR)) {
                                      var r = e[d.a.KEY_STR];
                                      for (s = 0; s < r.length; s++)
                                          i.vDimension[d.a.KEY_STR + (s + 1)] = r[s]
                                  }
                                  e.hasOwnProperty(d.a.KEY_DIM) && Object.assign(i.vDimension, e[d.a.KEY_DIM])
                              }
                              return i.vDimension.appid = z.a.appid,
                              this.actDim.clear(),
                              i
                          }
                      }, {
                          key: "fill",
                          value: function(t, e) {
                              e ? (this.heart_type = d.a.HEART_TYPE.END,
                              this._fill(t),
                              this.heart_type = d.a.HEART_TYPE.START) : this._fill(t)
                          }
                      }, {
                          key: "_fill",
                          value: function(t) {
                              if (0 != this.coreMap.size || 0 != this.compMap.size) {
                                  var e = {
                                      sMetricName: d.a.CORE.name,
                                      vField: {},
                                      vDimension: {},
                                      vExLog: {}
                                  };
                                  this.coreDim.set(d.a.DIM_CORE.HEART_TYPE, this.heart_type),
                                  this._fillFromMap(e.vDimension, this.comDim),
                                  this._fillFromMap(e.vDimension, this.coreDim),
                                  this._fillFromMap(e.vExLog, this.extDim),
                                  this._fillFromMap(e.vField, this.coreMap),
                                  this._fillComp(e.vDimension),
                                  this.coreDim.clear(),
                                  this.extDim.clear(),
                                  this.coreMap.clear(),
                                  this.compMap.clear(),
                                  this.heart_type == d.a.HEART_TYPE.START && (this.heart_type = d.a.HEART_TYPE.CONTINUS),
                                  e.vDimension.appid = z.a.appid,
                                  t.push(e)
                              }
                          }
                      }, {
                          key: "_fillComp",
                          value: function(t) {
                              var e, i = Object(m.a)(this.compMap.keys());
                              try {
                                  for (i.s(); !(e = i.n()).done; ) {
                                      var s, a = e.value, r = this._getCompMapFormat(a), n = r.get("ref") || ",", o = r.get("split") || ";", h = this.compMap.get(a), u = "", l = Object(m.a)(h.keys());
                                      try {
                                          for (l.s(); !(s = l.n()).done; ) {
                                              var c = s.value;
                                              u.length > 0 && (u += o),
                                              u += c + n + h.get(c)
                                          }
                                      } catch (t) {
                                          l.e(t)
                                      } finally {
                                          l.f()
                                      }
                                      t[a] = u
                                  }
                              } catch (t) {
                                  i.e(t)
                              } finally {
                                  i.f()
                              }
                          }
                      }, {
                          key: "_fillFromMap",
                          value: function(t, e) {
                              var i, s = Object(m.a)(e.keys());
                              try {
                                  for (s.s(); !(i = s.n()).done; ) {
                                      var a = i.value;
                                      t[a] = e.get(a)
                                  }
                              } catch (t) {
                                  s.e(t)
                              } finally {
                                  s.f()
                              }
                          }
                      }, {
                          key: "setComDim",
                          value: function(t, e) {
                              this.comDim.set(t, e)
                          }
                      }, {
                          key: "setCoreDim",
                          value: function(t, e) {
                              this.coreDim.set(t, e)
                          }
                      }, {
                          key: "setActDim",
                          value: function(t, e) {
                              this.actDim.set(t, e)
                          }
                      }, {
                          key: "setExtDim",
                          value: function(t, e) {
                              this.extDim.set(t, e)
                          }
                      }, {
                          key: "delDim",
                          value: function(t) {
                              this.comDim.has(t) ? this.comDim.delete(t) : this.coreDim.has(t) ? this.coreDim.delete(t) : this.actDim.has(t) && this.actDim.delete(t)
                          }
                      }, {
                          key: "setCore",
                          value: function(t, e) {
                              this.coreMap.set(t, e)
                          }
                      }, {
                          key: "addCore",
                          value: function(t, e) {
                              this._addValue(this.coreMap, t, e)
                          }
                      }, {
                          key: "setComp",
                          value: function(t, e, i) {
                              this._getCompMap(t).set(e, i)
                          }
                      }, {
                          key: "addComp",
                          value: function(t, e, i) {
                              var s = this._getCompMap(t);
                              this._addValue(s, e, i)
                          }
                      }, {
                          key: "setCompFormat",
                          value: function(t, e, i) {
                              var s = this._getCompMapFormat(t);
                              s.set("ref", e),
                              s.set("split", i)
                          }
                      }, {
                          key: "_getCompMapFormat",
                          value: function(t) {
                              if (this.comFormatMap.has(t))
                                  return this.comFormatMap.get(t);
                              var e = new Map;
                              return this.comFormatMap.set(t, e),
                              e
                          }
                      }, {
                          key: "_getCompMap",
                          value: function(t) {
                              if (this.compMap.has(t))
                                  return this.compMap.get(t);
                              var e = new Map;
                              return this.compMap.set(t, e),
                              e
                          }
                      }, {
                          key: "_addValue",
                          value: function(t, e, i) {
                              if (t.has(e)) {
                                  var s = t.get(e);
                                  t.set(e, s + i)
                              } else
                                  t.set(e, i)
                          }
                      }]),
                      t
                  }()
                    , Aa = "VIDEO_TIMEUPDATE"
                    , Ca = "VIDEO_PROGRESS"
                    , ka = [r.c.H264_SEI_PLAY, r.c.AUDIO_SOUND, r.c.SIGNAL_DATA, r.c.UPDATE_INTERSITY, r.c.SIGNAL_HEART, r.c.METADATA, r.c.TRANS_END, r.c.PLAY_DOWNLINK_INFO, r.c.PLAY_FRAME_BUFFER, r.c.PLAY_TIME_STATUS, r.c.PLAYBACK_UPDATE, r.c.PLAYBACK_M3U8_UPDATED, Aa, Ca];
                  function ba() {
                      var t = new ie.a;
                      return t.trigger = function(e) {
                          for (var i = arguments.length, s = new Array(i > 1 ? i - 1 : 0), a = 1; a < i; a++)
                              s[a - 1] = arguments[a];
                          var n = s;
                          "Array" === s.constructor.name && (n = s[0]),
                          e === r.c.PLAY_STATUS ? l.a.log("%c" + e + " %c" + n.status, "color:#F9F900;background:gray", "color:#53FF53;background:gray") : -1 === ka.indexOf(e) && l.a.log("%c" + e, "color:#F9F900;background:gray", n),
                          t.emit.apply(t, [e, e].concat(s))
                      }
                      ,
                      t.off = function(e) {
                          for (var i = arguments.length, s = new Array(i > 1 ? i - 1 : 0), a = 1; a < i; a++)
                              s[a - 1] = arguments[a];
                          t.removeListener.apply(t, [e].concat(s))
                      }
                      ,
                      t
                  }
                  var Ra = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.type = 0,
                          this.uid = 0,
                          this.sid = 0,
                          this.subSid = 0,
                          this.presenterUid = 0,
                          this.lineType = 0,
                          this.roomId = 0,
                          this.isPureAudio = !1,
                          this.sStreamName = "",
                          this.bitrate = 0,
                          this.curBitrate = 0,
                          this.originalBitrate = 0,
                          this.latencyLevel = 0,
                          this.domainList = null,
                          this.sFlvUrl = "",
                          this.sFlvAntiCode = "",
                          this.sFlvUrlSuffix = "",
                          this.ratio = 0,
                          this.url = "",
                          this.sP2pUrl = "",
                          this.sP2pAntiCode = "",
                          this.sP2pUrlSuffix = "",
                          this.iIsP2PSupport = 0,
                          this.h5Root = "",
                          this.gridWidth = 960,
                          this.gridHeight = 540,
                          this.column = 4,
                          this.row = 4,
                          this.x = 0,
                          this.y = 0,
                          this.scale = .25,
                          this.scaleMax = 1,
                          this.scaleMin = .15,
                          this.renderMode = Sa,
                          this.container = null,
                          this.obsUseP2P = !1
                      }
                      return Object(a.a)(t, [{
                          key: "getFlvUrl",
                          value: function() {
                              var t = "".concat(this.sFlvUrl, "/").concat(this.sStreamName, ".").concat(this.sFlvUrlSuffix, "?").concat(this.sFlvAntiCode);
                              return this.ratio > 0 && (t += "&ratio=".concat(this.ratio)),
                              t
                          }
                      }]),
                      t
                  }()
                    , La = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i(t, a, n, o, h, u) {
                          var l, c = arguments.length > 6 && void 0 !== arguments[6] ? arguments[6] : 1, p = arguments.length > 7 && void 0 !== arguments[7] ? arguments[7] : 0, m = arguments.length > 8 && void 0 !== arguments[8] ? arguments[8] : 4, v = arguments.length > 9 && void 0 !== arguments[9] ? arguments[9] : void 0, y = arguments.length > 10 && void 0 !== arguments[10] ? arguments[10] : {}, T = arguments.length > 11 ? arguments[11] : void 0, S = arguments.length > 12 ? arguments[12] : void 0, P = arguments.length > 13 ? arguments[13] : void 0;
                          Object(s.a)(this, i),
                          (l = e.call(this, t, n, o, h, u))._player = null,
                          l._startInfo = P,
                          l._container = S,
                          l._streamIndex = a,
                          l._index = a,
                          l._huyaPlayer = T,
                          l._observer = ba(),
                          l._preloadTime = m,
                          l._sourceOffset = p,
                          l._globalPlaybackRate = c,
                          l._mediaElementCache = v,
                          l._playbackRate = 1,
                          l._playbackRateUpdated = !0,
                          l._attributes = y,
                          l._loopElement = !1,
                          l._isElementPlaying = !1,
                          l._isPureAudio = !1,
                          l._turnToFlv = !1,
                          l._attributes.loop && (l._loopElement = l._attributes.loop),
                          l.sync_start_ts = 0,
                          l.sync_cost_ts = 0,
                          l.failNum = 0,
                          l._volume = 0,
                          l._width = 0,
                          l._height = 0,
                          l._lastP2PInfo = null,
                          l._stat = new Ia,
                          l._stat.setComDim(d.a.SIGNAL_HEART20.STREAM_NAME, P.sStreamName),
                          l._stat.setComDim(d.a.DIM_COM.BROWSER_KERNEL, _.a.name),
                          l._stat.setComDim(d.a.DIM_COM.BROWSER_KERNEL_VERSION, _.a.version.major),
                          l._tsdb = new f({
                              stat: l._stat,
                              eventEmiter: T
                          });
                          var E = l._onObserver.bind(Object(g.a)(l));
                          return l._observer.on(r.c.VIDEO_PLAY, E),
                          l._observer.on(r.c.FLV_URL_UNAVAILABLE, E),
                          l._observer.on(r.c.H5_PLAYER_ERROR, E),
                          l._observer.on(r.c.NO_DATA_RECEIVED, E),
                          l._observer.on(r.c.P2P_TIMEOUT, E),
                          l._observer.on(r.c.FLV_TRY_TO_P2P, E),
                          l
                      }
                      return Object(a.a)(i, [{
                          key: "_onObserver",
                          value: function(t, e) {
                              switch (t) {
                              case r.c.VIDEO_PLAY:
                                  this._playCallback(e),
                                  this._triggerCallbacks(r.c.VIDEO_PLAY);
                                  break;
                              case r.c.FLV_URL_UNAVAILABLE:
                                  this._unload(),
                                  ++this.failNum > 5 && this._triggerCallbacks(r.c.FLV_URL_UNAVAILABLE);
                                  break;
                              case r.c.H5_PLAYER_ERROR:
                              case r.c.NO_DATA_RECEIVED:
                                  this._unload();
                                  break;
                              case r.c.P2P_TIMEOUT:
                                  this._unload(),
                                  this._turnToFlv = !0;
                                  break;
                              case r.c.FLV_TRY_TO_P2P:
                                  this._unload(),
                                  this._turnToFlv = !1
                              }
                          }
                      }, {
                          key: "setVolume",
                          value: function(t) {
                              this._volume = t,
                              this._player && this._player.setVolume(t)
                          }
                      }, {
                          key: "_playCallback",
                          value: function(t) {
                              this._log("loaded currentDTS=".concat(this._currentDTS, ", dts=").concat(this.playDts)),
                              this._element = t.video,
                              this._element.playbackRate = this._globalPlaybackRate,
                              this._width = t.width,
                              this._height = t.height,
                              this._player.setAutoJitter(!1),
                              this._player.setVolume(this._volume)
                          }
                      }, {
                          key: "_errorCallback",
                          value: function() {
                              this._player._reportFlvFlow(),
                              this._unload()
                          }
                      }, {
                          key: "_triggerLoad",
                          value: function(t) {
                              this._log("start currentDTS=".concat(t)),
                              this._loadTriggered = !0,
                              this.start(t),
                              this.sync_cost_ts = 0,
                              this.sync_start_ts = c.a.now(),
                              this._isResponsibleForElementLifeCycle && this.startPlayer()
                          }
                      }, {
                          key: "startPlayer",
                          value: function() {
                              var t = this._player;
                              t || (this._turnToFlv || !this._startInfo.obsUseP2P ? (t = new hs(this._observer,{
                                  stat: this._stat,
                                  isPureAudio: this._isPureAudio,
                                  tsdb: this._tsdb
                              }),
                              this._lastP2PInfo && (t.backToP2P.lastP2PInfo = this._lastP2PInfo)) : t = new Ys(this._observer,{
                                  stat: this._stat,
                                  isPureAudio: this._isPureAudio,
                                  tsdb: this._tsdb
                              })),
                              this._player = t,
                              t.start(this.getStartInfo())
                          }
                      }, {
                          key: "getStartInfo",
                          value: function() {
                              var t = this._turnToFlv || !this._startInfo.obsUseP2P
                                , e = new Ra;
                              return Object.assign(e, this._startInfo),
                              t ? (e.type = 1,
                              e.url = e.getFlvUrl()) : (e.type = 2,
                              this._lastP2PInfo = e),
                              e
                          }
                      }, {
                          key: "_load",
                          value: function(t) {
                              E(Object(S.a)(i.prototype), "_load", this).call(this),
                              this._loadTriggered || this._triggerLoad(t),
                              void 0 !== this._element && (this._seek(t),
                              this._element.readyState > 3 && !this._element.seeking ? (!0 !== this._ready && (this._triggerCallbacks("loaded"),
                              this._playbackRateUpdated = !0),
                              this._ready = !0) : 5 !== this._state && (this._ready = !1))
                          }
                      }, {
                          key: "_unload",
                          value: function() {
                              E(Object(S.a)(i.prototype), "_unload", this).call(this),
                              this._isResponsibleForElementLifeCycle && this._player && (this._element = void 0,
                              this._player.stop(),
                              this._player = null),
                              this._ready = !1,
                              this._isElementPlaying = !1,
                              this._loadTriggered = !1
                          }
                      }, {
                          key: "_seek",
                          value: function(t) {
                              if (1 != localStorage.obsPause) {
                                  if (E(Object(S.a)(i.prototype), "_seek", this).call(this, t),
                                  2 === this.state || 3 === this.state) {
                                      if (!this._element || !this._player)
                                          return this._load();
                                      if (this._isReady()) {
                                          var e = this.playDts;
                                          if (e > 0) {
                                              var s = e - t
                                                , a = Math.abs(s);
                                              if (a > o.a.obsSeekTs) {
                                                  var r = this._element.buffered
                                                    , n = this.currentTime - s / 1e3;
                                                  n > 0 && r.length > 0 && n < r.end(r.length - 1) ? (this._element.currentTime = n,
                                                  this._ready = !1) : s >= 1e3 && (this._element.playbackRate = .1)
                                              } else
                                                  a > o.a.obsRateTs ? this._element.playbackRate = this._globalPlaybackRate * this._playbackRate * (s < 0 ? 1.1 : .9) : this._element.playbackRate = s < 0 ? this._globalPlaybackRate * this._playbackRate * 1.1 : this._globalPlaybackRate * this._playbackRate
                                          }
                                      }
                                  }
                              } else
                                  this._element && !this._obsPause && (this._obsPause = !0,
                                  this._element.pause())
                          }
                      }, {
                          key: "_update",
                          value: function(t) {
                              var e = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1]
                                , s = this.playDts
                                , a = Math.abs(s - t)
                                , r = e && a < o.a.obsSyncTs;
                              return 1 == localStorage._printSyncTs && l.a.log("MediaNode(".concat(this._index, ")._update playDts=").concat(s, " currentTime=").concat(t, " gap=").concat(a, " updateAble=").concat(r)),
                              E(Object(S.a)(i.prototype), "_update", this).call(this, t, r),
                              this.sync_start_ts > 0 && !1 === this.isTextureCleared && (this.sync_cost_ts = c.a.now() - this.sync_start_ts,
                              this.sync_start_ts = 0),
                              4 !== this._state && this._load(t),
                              !!this._element && (2 === this._state ? (this._isElementPlaying || (this._stretchPaused,
                              this._isElementPlaying = !0),
                              !0) : 3 === this._state ? (this._isElementPlaying = !1,
                              !0) : 4 === this._state && void 0 !== this._element ? (this._isElementPlaying && this._unload(),
                              !1) : void 0)
                          }
                      }, {
                          key: "clearTimelineState",
                          value: function() {
                              E(Object(S.a)(i.prototype), "clearTimelineState", this).call(this),
                              void 0 !== this._element && (this._isElementPlaying = !1),
                              this._unload()
                          }
                      }, {
                          key: "destroy",
                          value: function() {
                              this._player && this._player.mse && this._player.mse.video,
                              this._lastP2PInfo = null,
                              E(Object(S.a)(i.prototype), "destroy", this).call(this)
                          }
                      }, {
                          key: "playbackRate",
                          set: function(t) {
                              t !== this._playbackRate && (this._log(t),
                              this._playbackRate = t,
                              this._playbackRateUpdated = !0)
                          },
                          get: function() {
                              return this._element ? this._element.playbackRate : 0
                          }
                      }, {
                          key: "stretchPaused",
                          set: function(t) {
                              !function(t, e, i, s, a) {
                                  if (!ya(t, "stretchPaused", i, s || t))
                                      throw new Error("failed to set property")
                              }(Object(S.a)(i.prototype), 0, t, this),
                              this._element && (this._stretchPaused ? this._player.mse.video.pause() : 2 === this._state && this._player.mse.video.play())
                          },
                          get: function() {
                              return this._stretchPaused
                          }
                      }, {
                          key: "elementURL",
                          get: function() {
                              return this._elementURL
                          }
                      }, {
                          key: "currentTime",
                          get: function() {
                              return this._element ? this._element.currentTime : 0
                          }
                      }, {
                          key: "playDts",
                          get: function() {
                              return this._player ? this._player.getCurrentTime() : 0
                          }
                      }, {
                          key: "_buffering",
                          get: function() {
                              return !(!this._element || !this._player) && this._element.readyState < HTMLMediaElement.HAVE_FUTURE_DATA
                          }
                      }, {
                          key: "width",
                          get: function() {
                              return this._width
                          }
                      }, {
                          key: "height",
                          get: function() {
                              return this._height
                          }
                      }, {
                          key: "bufferLen",
                          get: function() {
                              return this._player ? this._player.getBufferLen() : 0
                          }
                      }]),
                      i
                  }(Ea)
                    , wa = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i() {
                          var t;
                          return Object(s.a)(this, i),
                          (t = e.apply(this, arguments))._displayName = "VideoNode",
                          t._elementType = "video",
                          t
                      }
                      return i
                  }(La)
                    , Oa = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i() {
                          var t;
                          return Object(s.a)(this, i),
                          (t = e.apply(this, arguments))._displayName = "AudioNode",
                          t._elementType = "audio",
                          t._isPureAudio = !0,
                          t
                      }
                      return Object(a.a)(i, [{
                          key: "_updateWebgl",
                          value: function(t) {}
                      }]),
                      i
                  }(La);
                  function Da(t) {
                      this.message = t,
                      this.name = "ConnectionException"
                  }
                  function Na(t) {
                      this.message = t,
                      this.name = "RenderException"
                  }
                  var Fa = {
                      vertexShader: "attribute vec4 a_position;\nattribute vec2 a_texCoord;\n\nuniform mat4 u_matrix;\nuniform mat4 u_textureMatrix;\n\nvarying vec2 v_texcoord;\n\nvoid main() {\n   gl_Position = u_matrix * a_position;\n   v_texcoord = (u_textureMatrix * vec4(a_texCoord, 0, 1)).xy;\n}",
                      fragmentShader: "precision mediump float;\n\nvarying vec2 v_texcoord;\n\nuniform sampler2D u_image;\n\nvoid main() {\n   gl_FragColor = texture2D(u_image, v_texcoord);\n}",
                      properties: {
                          u_matrix: {
                              type: "uniform"
                          },
                          u_textureMatrix: {
                              type: "uniform"
                          }
                      },
                      inputs: ["u_image"]
                  }
                    , Ma = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i(t, a, r, n, o, h) {
                          var u;
                          return Object(s.a)(this, i),
                          (u = e.call(this, t, r, n, Fa, Fa.inputs, !1))._stat = h.stat,
                          u._tsdb = h.tsdbUtil,
                          u._canvas = a,
                          u._transitions = null,
                          u._gridM = o.column,
                          u._gridN = o.row,
                          u._gridWidth = o.gridWidth,
                          u._gridHeight = o.gridHeight,
                          u._mapWidth = o.column * o.gridWidth,
                          u._mapHeight = o.row * o.gridHeight,
                          u._scaleMax = Math.min(o.scaleMax, 1),
                          u._scaleMin = Math.max(o.scaleMin, .05),
                          u._scale = Math.min(u._scaleMax, Math.max(o.scale, u._scaleMin)),
                          u._viewWidth = 0,
                          u._viewHeight = 0,
                          u._updateView(),
                          u.x = o.x * u._mapWidth,
                          u.y = o.y * u._mapHeight,
                          u._renderMode = r,
                          u._displayName = "CompositingNode",
                          u.backStream = !0,
                          u.faceStream = !0,
                          u.faceStreamMask = !1,
                          u._syncStartTs = c.a.now(),
                          u._syncLastStartTs = c.a.now(),
                          u._displayChangeNum = 0,
                          u._lastDisplayVertex = null,
                          u._nodes = [],
                          u._nodesInfo = [],
                          u._inputs = null,
                          u.forceFace = !1,
                          u
                      }
                      return Object(a.a)(i, [{
                          key: "_updateView",
                          value: function() {
                              this._viewWidth = Math.min(this._mapWidth, this._mapWidth * this._scale),
                              this._viewHeight = Math.min(this._mapHeight, this._mapHeight * this._scale),
                              this._canvas.width = this._viewWidth,
                              this._canvas.height = this._viewHeight
                          }
                      }, {
                          key: "_useFace",
                          value: function(t) {
                              for (var e = oe(t, 4), i = e[0], s = e[1], a = e[2], r = e[3], n = 0, o = s; o <= r; o++)
                                  for (var h = i; h <= a; h++)
                                      n++;
                              return n > 4
                          }
                      }, {
                          key: "init",
                          value: function(t, e, i) {
                              this._inputs = t,
                              this._bgNode = e,
                              this._faceNode = i,
                              this._checkSync(),
                              this.useFace = this._useFace(this._lastDisplayVertex)
                          }
                      }, {
                          key: "getNodes",
                          value: function() {
                              return this._nodes
                          }
                      }, {
                          key: "validScale",
                          value: function(t) {
                              return void 0 === t ? this._scale : (t < this._scaleMin ? t = this._scaleMin : t > this._scaleMax && (t = this._scaleMax),
                              t)
                          }
                      }, {
                          key: "setScale",
                          value: function(t, e) {
                              t = this.validScale(t);
                              var i = this._mapWidth * this._scale
                                , s = this._mapHeight * this._scale
                                , a = this._mapWidth * t
                                , r = this._mapHeight * t
                                , n = this.x + (i >> 1)
                                , o = this.y + (s >> 1)
                                , h = Math.max(0, n - (a >> 1))
                                , u = Math.max(0, o - (r >> 1));
                              this._transition(h, u, t, e)
                          }
                      }, {
                          key: "getViewport",
                          value: function() {
                              return {
                                  x: this._x / this._mapWidth,
                                  y: this._y / this._mapHeight,
                                  scale: this._viewWidth / this._mapWidth
                              }
                          }
                      }, {
                          key: "setViewport",
                          value: function(t) {
                              var e = t.x
                                , s = t.y
                                , a = t.scale
                                , r = t.duration
                                , n = void 0 === r ? 0 : r
                                , o = t.callback
                                , h = void 0 === o ? null : o
                                , u = t.easingFn
                                , l = void 0 === u ? i.circular : u;
                              e = void 0 === e ? this.x : Math.floor(e * this._mapWidth),
                              s = void 0 === s ? this.y : Math.floor(s * this._mapHeight),
                              a = this.validScale(a),
                              this._transition(e, s, a, n, h, l)
                          }
                      }, {
                          key: "addViewport",
                          value: function(t) {
                              var e = t.x
                                , s = t.y
                                , a = t.scale
                                , r = t.duration
                                , n = void 0 === r ? 0 : r
                                , o = t.callback
                                , h = void 0 === o ? null : o
                                , u = t.easingFn
                                , l = void 0 === u ? i.circular : u;
                              e = this.x + (void 0 === e ? 0 : Math.floor(-e * this._mapWidth * this._scale)),
                              s = this.y + (void 0 === s ? 0 : Math.floor(-s * this._mapHeight * this._scale)),
                              a = this.validScale(this.scale + (void 0 === a ? 0 : a)),
                              this._transition(e, s, a, n, h, l)
                          }
                      }, {
                          key: "_transition",
                          value: function(t, e, s) {
                              var a = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 0
                                , r = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : null
                                , n = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : i.circular;
                              if (s = this.validScale(s),
                              t < 0 ? t = 0 : t + this._mapWidth * s > this._mapWidth && (t = this._mapWidth - this._mapWidth * s),
                              e < 0 ? e = 0 : e + this._mapHeight * s > this._mapHeight && (e = this._mapHeight - this._mapHeight * s),
                              t !== this.x || e !== this.y || s !== this.scale) {
                                  if (0 === a)
                                      return s === this.scale || isNaN(s) || (this._scale = s,
                                      this._updateView()),
                                      t === this.x || isNaN(t) || (this.x = t),
                                      e === this.y || isNaN(e) || (this.y = e),
                                      this._checkSync(),
                                      void (r && r());
                                  this._transitions && this._transitions.callback && this._transitions.callback(),
                                  this._transitions = {
                                      start: this._currentTime,
                                      end: this._currentTime + a,
                                      properties: [],
                                      callback: r,
                                      easingFn: n
                                  },
                                  s === this.scale || isNaN(s) || this._transitions.properties.push({
                                      name: "scale",
                                      current: this.scale,
                                      target: s
                                  }),
                                  t === this.x || isNaN(t) || this._transitions.properties.push({
                                      name: "x",
                                      current: this.x,
                                      target: t
                                  }),
                                  e === this.y || isNaN(e) || this._transitions.properties.push({
                                      name: "y",
                                      current: this.y,
                                      target: e
                                  })
                              }
                          }
                      }, {
                          key: "_calculate",
                          value: function(t, e) {
                              var i = this._gridWidth
                                , s = this._gridHeight
                                , a = t % i
                                , r = e % s
                                , n = i - a
                                , o = s - r
                                , h = fa(1, this._viewWidth, this._viewHeight, 0, -1, 1);
                              h = ma(h = _a(h, t - this.x, e - this.y, 0), n, o, 1),
                              this.setProperty("u_matrix", h);
                              var u = va(a / i, r / s, 0);
                              u = ma(u, n / i, o / s, 1),
                              this.setProperty("u_textureMatrix", u)
                          }
                      }, {
                          key: "_calculate2",
                          value: function(t, e) {
                              var i = this._viewWidth
                                , s = this._viewHeight
                                , a = fa(1, i, s, 0, -1, 1);
                              a = ma(a = _a(a, 0, 0, 0), i, s, 1),
                              this.setProperty("u_matrix", a);
                              var r = this._mapWidth
                                , n = this._mapHeight
                                , o = va(t / r, e / n, 0);
                              o = ma(o, i / r, s / n, 1),
                              this.setProperty("u_textureMatrix", o)
                          }
                      }, {
                          key: "isNodeContained",
                          value: function(t) {
                              var e = this._gridM
                                , i = oe(this._lastDisplayVertex, 4)
                                , s = i[0]
                                , a = i[1]
                                , r = i[2]
                                , n = i[3]
                                , o = t._streamIndex % e
                                , h = Math.floor(t._streamIndex / e);
                              return o >= s && o <= r && h >= a && h <= n
                          }
                      }, {
                          key: "_update",
                          value: function(t) {
                              var e = this;
                              if (E(Object(S.a)(i.prototype), "_update", this).call(this, t),
                              this._transitions) {
                                  if (t > this._transitions.start) {
                                      var s = 0;
                                      s = this._transitions.end === this._transitions.start ? 1 : this._transitions.easingFn((this._currentTime - this._transitions.start) / (this._transitions.end - this._transitions.start)),
                                      isNaN(s) ? (this._transitions.end = this._transitions.start,
                                      s = 1) : s > 1 && (s = 1),
                                      this._transitions.properties.forEach((function(t) {
                                          e[t.name] = t.current + (t.target - t.current) * s,
                                          "scale" === t.name && (e._scale < .25 && (e.useFace = !1),
                                          e._updateView())
                                      }
                                      ))
                                  }
                                  t > this._transitions.end && (this._checkSync(),
                                  this._transitions.callback && this._transitions.callback(),
                                  this._transitions = null)
                              }
                          }
                      }, {
                          key: "_clearCallbacks",
                          value: function() {
                              if (this._lastDisplayVertex)
                                  for (var t = oe(this._lastDisplayVertex, 4), e = t[0], i = t[1], s = t[2], a = t[3], r = i; r <= a; r++)
                                      for (var n = e; n <= s; n++)
                                          this._inputs[this._gridM * r + n].clearCallbacks()
                          }
                      }, {
                          key: "onFlvUrlUnavailable",
                          value: function(t) {
                              this.forceFace = !0
                          }
                      }, {
                          key: "_checkSync",
                          value: function() {
                              var t = this._displayVertex;
                              if (!this._lastDisplayVertex || t.toString() !== this._lastDisplayVertex.toString()) {
                                  this._clearCallbacks();
                                  var e = oe(t, 4)
                                    , i = e[0]
                                    , s = e[1]
                                    , a = e[2]
                                    , n = e[3]
                                    , o = !1
                                    , h = 0;
                                  this._nodes = [];
                                  for (var u = s; u <= n; u++)
                                      for (var l = i; l <= a; l++) {
                                          var d = this._inputs[this._gridM * u + l];
                                          this._nodes.push(d),
                                          h++,
                                          d.registerCallback(r.c.FLV_URL_UNAVAILABLE, this.onFlvUrlUnavailable.bind(this)),
                                          d && !1 !== d.isTextureCleared && (d.failNum = 0,
                                          o = !0)
                                      }
                                  if ((this.forceFace || !this.useFace && h > 4) && (this.useFace = !0),
                                  this._lastDisplayVertex = t,
                                  0 !== this._syncStartTs && this.recordSync(),
                                  o) {
                                      var p = c.a.now();
                                      this._syncLastStartTs = p,
                                      this._displayChangeNum++,
                                      0 === this._syncStartTs && (this._syncStartTs = p)
                                  }
                              }
                          }
                      }, {
                          key: "recordSync",
                          value: function() {}
                      }, {
                          key: "reportSync",
                          value: function(t) {
                              if (t && this._syncStartTs > 0) {
                                  this.recordSync();
                                  var e = c.a.now()
                                    , i = e - this._syncStartTs
                                    , s = e - this._syncLastStartTs;
                                  this._syncStartTs = 0,
                                  this._syncLastStartTs = 0;
                                  var a = {
                                      value: [i, this._displayChangeNum, s]
                                  };
                                  this._displayChangeNum = 0,
                                  this._nodesInfo.length > 0 && (a.str = [this._nodesInfo.join(";")],
                                  this._nodesInfo = []),
                                  this._tsdb.sendMetrics([this._stat.createAct(d.a.ACT.OB_BG_DURATION, a)])
                              }
                          }
                      }, {
                          key: "_isSync",
                          value: function() {
                              for (var t = null, e = !0, i = this._nodes.length, s = 0; s < i; s++)
                                  void 0 !== (t = this._nodes[s]).isTextureCleared && !0 !== t.isTextureCleared || (e = !1);
                              return e
                          }
                      }, {
                          key: "updatePlaybackRate",
                          value: function(t) {
                              if (this.isLoaded()) {
                                  var e = []
                                    , i = 0;
                                  this._nodes.forEach((function(t) {
                                      if (t._element) {
                                          var s = {
                                              node: t,
                                              playDts: t.playDts,
                                              bufferLen: t.bufferLen
                                          };
                                          i = Math.max(s.playDts, i),
                                          e.push(s)
                                      }
                                  }
                                  ));
                                  var s = 0;
                                  e.forEach((function(t) {
                                      t.playDts < i ? (s = i - t.playDts,
                                      t.node.playbackRate = s > 4e3 ? 1.4 : s > 2e3 ? 1.2 : s > 500 ? 1.1 : 1) : t.node.playbackRate = 1
                                  }
                                  ));
                                  var a = this._bgNode.bufferLen;
                                  i > t && (s = i - t,
                                  this._bgNode.playbackRate = s > 4e3 ? a > 4 ? 1.4 : a > 2 ? 1.2 : 1 : s > 2e3 ? a > 2 ? 1.2 : 1 : s > 500 ? 1.1 : 1)
                              }
                          }
                      }, {
                          key: "isLoaded",
                          value: function() {
                              for (var t = !0, e = oe(this._lastDisplayVertex, 4), i = e[0], s = e[1], a = e[2], r = e[3], n = s; n <= r; n++)
                                  for (var o = i; o <= a; o++)
                                      this._inputs[this._gridM * n + o]._element || (t = !1);
                              return t
                          }
                      }, {
                          key: "_drawBgWebgl",
                          value: function(t, e) {
                              this._calculate2(t, e),
                              E(Object(S.a)(i.prototype), "_render", this).call(this),
                              this.backStream && this._drawWebgl(this._bgNode._texture)
                          }
                      }, {
                          key: "_drawWebgl",
                          value: function(t) {
                              var e, i = this._gl, s = Object(m.a)(this._shaderInputsTextureUnitMapping);
                              try {
                                  for (s.s(); !(e = s.n()).done; ) {
                                      var a = e.value;
                                      i.activeTexture(a.textureUnit),
                                      i.uniform1i(a.location, a.textureUnitIndex),
                                      i.bindTexture(i.TEXTURE_2D, t)
                                  }
                              } catch (t) {
                                  s.e(t)
                              } finally {
                                  s.f()
                              }
                              i.drawArrays(i.TRIANGLES, 0, 6)
                          }
                      }, {
                          key: "_drawBg2d",
                          value: function(t, e, i) {
                              this.backStream && this._draw2d(t, e, i)
                          }
                      }, {
                          key: "_draw2d",
                          value: function(t, e, i) {
                              var s = t.width / this._mapWidth
                                , a = e * s
                                , r = i * s
                                , n = this._viewWidth * s
                                , o = this._viewHeight * s;
                              this._gl.drawImage(t._element, a, r, n, o, 0, 0, this._viewWidth, this._viewHeight)
                          }
                      }, {
                          key: "_drawFaceWebgl",
                          value: function(t, e) {
                              if (!this._transitions) {
                                  var s = null
                                    , a = !0;
                                  if (this.useFace)
                                      !1 === this._faceNode.isTextureCleared ? (this._calculate2(t, e),
                                      E(Object(S.a)(i.prototype), "_render", this).call(this),
                                      this.faceStream && this._drawWebgl(this._faceNode._texture)) : a = !1;
                                  else if (a = this._isSync())
                                      for (var r = oe(this._lastDisplayVertex, 4), n = r[0], o = r[1], h = r[2], u = r[3], l = o; l <= u; l++) {
                                          for (var c = n; c <= h; c++)
                                              !1 === (s = this._inputs[this._gridM * l + c]).isTextureCleared && (this._calculate(t, e),
                                              E(Object(S.a)(i.prototype), "_render", this).call(this),
                                              this.faceStream && this._drawWebgl(s._texture)),
                                              t = this._gridWidth * (c + 1);
                                          t = this.x,
                                          e = this._gridHeight * (l + 1)
                                      }
                                  this.reportSync(a)
                              }
                          }
                      }, {
                          key: "_drawFace2D",
                          value: function(t, e) {
                              if (!this._transitions) {
                                  var i = null
                                    , s = !0;
                                  if (this.useFace)
                                      !1 === this._faceNode.isTextureCleared && this._faceNode._element ? this.faceStream && this._draw2d(this._faceNode, t, e) : s = !1;
                                  else if (s = this._isSync())
                                      for (var a = 0, r = 0, n = 0, o = 0, h = 0, u = 0, l = 0, c = 0, d = this._gridWidth, p = this._gridHeight, f = (this._viewWidth,
                                      oe(this._lastDisplayVertex, 4)), _ = f[0], m = f[1], v = f[2], y = f[3], T = m; T <= y; T++) {
                                          T === m ? o = p - (r = e % p) : (r = 0,
                                          o = T === y ? this._viewHeight - o : p),
                                          c = o,
                                          h = 0;
                                          for (var g = _; g <= v; g++) {
                                              if (g === _ ? n = d - (a = t % d) : (a = 0,
                                              n = g === v ? this._viewWidth - n : d),
                                              l = n,
                                              !1 === (i = this._inputs[this._gridM * T + g]).isTextureCleared && i._element) {
                                                  if (this.faceStream) {
                                                      var S = d / i.width;
                                                      this._gl.drawImage(i._element, a / S, r / S, n / S, o / S, h, u, l, c)
                                                  }
                                                  this.faceStream && this.faceStreamMask && (this._gl.fillStyle = "rgba(255,0,0,.1)",
                                                  this._gl.fillRect(h, u, l, c))
                                              } else
                                                  s = !1;
                                              h += l
                                          }
                                          u += c
                                      }
                                  this.reportSync(s)
                              }
                          }
                      }, {
                          key: "_render",
                          value: function() {
                              var t = this._renderMode === Sa;
                              if (t ? this._clearWebgl() : this._clear2D(),
                              this._bgNode._element) {
                                  var e = this.x
                                    , i = this.y;
                                  t ? (this._drawBgWebgl(e, i),
                                  0 === o.a.obsUseFull && this._drawFaceWebgl(e, i)) : (this._drawBg2d(this._bgNode, e, i),
                                  0 === o.a.obsUseFull && (aa.start(),
                                  this._drawFace2D(e, i),
                                  aa.finish()))
                              }
                          }
                      }, {
                          key: "_clearWebgl",
                          value: function() {
                              var t = this._gl;
                              t.clearColor(0, 0, 0, 0),
                              t.clear(t.COLOR_BUFFER_BIT),
                              t.blendFuncSeparate(t.SRC_ALPHA, t.ONE_MINUS_SRC_ALPHA, t.ONE, t.ONE_MINUS_SRC_ALPHA)
                          }
                      }, {
                          key: "_clear2D",
                          value: function() {
                              this._gl.clearRect(0, 0, this._viewWidth, this._viewHeight)
                          }
                      }, {
                          key: "destroyWebgl",
                          value: function() {
                              this._clearWebgl(),
                              E(Object(S.a)(i.prototype), "destroyWebgl", this).call(this)
                          }
                      }, {
                          key: "destroy2D",
                          value: function() {
                              this._clear2D()
                          }
                      }, {
                          key: "x",
                          get: function() {
                              return this._x
                          },
                          set: function(t) {
                              t < 0 && (t = 0),
                              t + this._viewWidth > this._mapWidth && (t = this._mapWidth - this._viewWidth),
                              this._x = t
                          }
                      }, {
                          key: "y",
                          get: function() {
                              return this._y
                          },
                          set: function(t) {
                              t < 0 && (t = 0),
                              t + this._viewHeight > this._mapHeight && (t = this._mapHeight - this._viewHeight),
                              this._y = t
                          }
                      }, {
                          key: "scale",
                          get: function() {
                              return this._scale
                          },
                          set: function(t) {
                              this._scale = t
                          }
                      }, {
                          key: "_displayVertex",
                          get: function() {
                              return [Math.floor(this.x / this._gridWidth), Math.floor(this.y / this._gridHeight), Math.floor((this.x + this._viewWidth - 1) / this._gridWidth), Math.floor((this.y + this._viewHeight - 1) / this._gridHeight)]
                          }
                      }], [{
                          key: "circular",
                          value: function(t) {
                              return Math.sqrt(1 - --t * t)
                          }
                      }]),
                      i
                  }(function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i(t, a, r, n, o, h) {
                          var u;
                          return Object(s.a)(this, i),
                          u = e.call(this, t, r, o, h),
                          a === Sa && u.constructorWebgl(t, r, n),
                          u._renderMode = a,
                          u._displayName = "ProcessingNode",
                          u
                      }
                      return Object(a.a)(i, [{
                          key: "constructorWebgl",
                          value: function(t, e, i) {
                              var s = this;
                              for (var a in this._vertexShader = ca(t, i.vertexShader, t.VERTEX_SHADER),
                              this._fragmentShader = ca(t, i.fragmentShader, t.FRAGMENT_SHADER),
                              this._definition = i,
                              this._properties = {},
                              i.properties) {
                                  var r = i.properties[a].value;
                                  "[object Array]" === Object.prototype.toString.call(r) && (r = i.properties[a].value.slice());
                                  var n = i.properties[a].type;
                                  this._properties[a] = {
                                      type: n,
                                      value: r
                                  }
                              }
                              this._shaderInputsTextureUnitMapping = [],
                              this._maxTextureUnits = t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),
                              this._boundTextureUnits = 0,
                              this._texture = da(t),
                              t.texImage2D(t.TEXTURE_2D, 0, t.RGBA, t.canvas.width, t.canvas.height, 0, t.RGBA, t.UNSIGNED_BYTE, null),
                              this._program = function(t, e, i) {
                                  var s = t.createProgram();
                                  if (t.attachShader(s, e),
                                  t.attachShader(s, i),
                                  t.linkProgram(s),
                                  !t.getProgramParameter(s, t.LINK_STATUS))
                                      throw {
                                          error: 4,
                                          msg: "Can't link shader program for track",
                                          toString: function() {
                                              return this.msg
                                          }
                                      };
                                  return s
                              }(t, this._vertexShader, this._fragmentShader),
                              t.useProgram(this._program),
                              this._framebuffer = t.createFramebuffer(),
                              t.bindFramebuffer(t.FRAMEBUFFER, this._framebuffer),
                              t.framebufferTexture2D(t.FRAMEBUFFER, t.COLOR_ATTACHMENT0, t.TEXTURE_2D, this._texture, 0),
                              t.bindFramebuffer(t.FRAMEBUFFER, null);
                              var o = function(t) {
                                  Object.defineProperty(s, t, {
                                      get: function() {
                                          return this._properties[t].value
                                      },
                                      set: function(e) {
                                          this._properties[t].value = e
                                      }
                                  })
                              };
                              for (var h in this._properties)
                                  o(h);
                              for (var u in this._properties)
                                  if (this._properties[u].value instanceof Image && (this._properties[u].texture = da(t),
                                  this._properties[u].textureUnit = t.TEXTURE0 + this._boundTextureUnits,
                                  this._properties[u].textureUnitIndex = this._boundTextureUnits,
                                  this._boundTextureUnits += 1,
                                  this._boundTextureUnits > this._maxTextureUnits))
                                      throw new Na("Trying to bind more than available textures units to shader");
                              var l, c = Object(m.a)(i.inputs);
                              try {
                                  for (c.s(); !(l = c.n()).done; ) {
                                      var d = l.value;
                                      if (this._shaderInputsTextureUnitMapping.push({
                                          name: d,
                                          textureUnit: t.TEXTURE0 + this._boundTextureUnits,
                                          textureUnitIndex: this._boundTextureUnits,
                                          location: t.getUniformLocation(this._program, d)
                                      }),
                                      this._boundTextureUnits += 1,
                                      this._boundTextureUnits > this._maxTextureUnits)
                                          throw new Na("Trying to bind more than available textures units to shader")
                                  }
                              } catch (t) {
                                  c.e(t)
                              } finally {
                                  c.f()
                              }
                              for (var p in this._properties)
                                  "uniform" === this._properties[p].type && (this._properties[p].location = this._gl.getUniformLocation(this._program, p));
                              this._currentTimeLocation = this._gl.getUniformLocation(this._program, "currentTime"),
                              this._currentTime = 0;
                              var f = t.getAttribLocation(this._program, "a_position")
                                , _ = t.createBuffer();
                              t.bindBuffer(t.ARRAY_BUFFER, _),
                              t.enableVertexAttribArray(f),
                              t.vertexAttribPointer(f, 2, t.FLOAT, !1, 0, 0),
                              t.bufferData(t.ARRAY_BUFFER, new Float32Array([1, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 0]), t.STATIC_DRAW);
                              var v = t.getAttribLocation(this._program, "a_texCoord");
                              t.enableVertexAttribArray(v),
                              t.vertexAttribPointer(v, 2, t.FLOAT, !1, 0, 0)
                          }
                      }, {
                          key: "setProperty",
                          value: function(t, e) {
                              this._properties[t].value = e
                          }
                      }, {
                          key: "getProperty",
                          value: function(t) {
                              return this._properties[t].value
                          }
                      }, {
                          key: "destroy",
                          value: function() {
                              E(Object(S.a)(i.prototype), "destroy", this).call(this),
                              this._renderMode === Sa ? this.destroyWebgl() : this.destroy2D()
                          }
                      }, {
                          key: "destroyWebgl",
                          value: function() {
                              for (var t in this._properties)
                                  this._properties[t].value instanceof Image && (this._gl.deleteTexture(this._properties[t].texture),
                                  this._texture = void 0);
                              this._gl.deleteTexture(this._texture),
                              this._texture = void 0,
                              this._gl.detachShader(this._program, this._vertexShader),
                              this._gl.detachShader(this._program, this._fragmentShader),
                              this._gl.deleteShader(this._vertexShader),
                              this._gl.deleteShader(this._fragmentShader),
                              this._gl.deleteProgram(this._program),
                              this._gl.deleteFramebuffer(this._framebuffer)
                          }
                      }, {
                          key: "destroy2D",
                          value: function() {}
                      }, {
                          key: "_update",
                          value: function(t) {
                              this._currentTime = t
                          }
                      }, {
                          key: "_seek",
                          value: function(t) {
                              this._currentTime = t
                          }
                      }, {
                          key: "_render",
                          value: function() {
                              this._rendered = !0,
                              this._renderMode === Sa && this._renderWebgl()
                          }
                      }, {
                          key: "_renderWebgl",
                          value: function() {
                              var t = this._gl;
                              for (var e in t.viewport(0, 0, t.canvas.width, t.canvas.height),
                              t.uniform1f(this._currentTimeLocation, parseFloat(this._currentTime)),
                              this._properties) {
                                  var i = this._properties[e].value
                                    , s = this._properties[e].type
                                    , a = this._properties[e].location;
                                  "uniform" === s && ("number" == typeof i ? t.uniform1f(a, i) : "[object Float32Array]" === Object.prototype.toString.call(i) ? t.uniformMatrix4fv(a, !1, i) : "[object Array]" === Object.prototype.toString.call(i) && (1 === i.length ? t.uniform1fv(a, i) : 2 === i.length ? t.uniform2fv(a, i) : 3 === i.length ? t.uniform3fv(a, i) : 4 === i.length ? t.uniform4fv(a, i) : console.debug("Shader parameter", e, "is too long an array:", i)))
                              }
                          }
                      }]),
                      i
                  }(Ta))
                    , Ua = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.connections = []
                      }
                      return Object(a.a)(t, [{
                          key: "getOutputsForNode",
                          value: function(t) {
                              var e = [];
                              return this.connections.forEach((function(i) {
                                  i.source === t && e.push(i.destination)
                              }
                              )),
                              e
                          }
                      }, {
                          key: "getNamedInputsForNode",
                          value: function(t) {
                              var e = [];
                              return this.connections.forEach((function(i) {
                                  i.destination === t && "name" === i.type && e.push(i)
                              }
                              )),
                              e
                          }
                      }, {
                          key: "getZIndexInputsForNode",
                          value: function(t) {
                              var e = [];
                              return this.connections.forEach((function(i) {
                                  i.destination === t && "zIndex" === i.type && e.push(i)
                              }
                              )),
                              e.sort((function(t, e) {
                                  return t.zIndex - e.zIndex
                              }
                              )),
                              e
                          }
                      }, {
                          key: "getInputsForNode",
                          value: function(t) {
                              var e = t.inputNames
                                , i = []
                                , s = this.getNamedInputsForNode(t)
                                , a = this.getZIndexInputsForNode(t);
                              if (!0 === t._limitConnections) {
                                  for (var r = 0; r < e.length; r++)
                                      i[r] = void 0;
                                  var n, o = Object(m.a)(s);
                                  try {
                                      for (o.s(); !(n = o.n()).done; ) {
                                          var h = n.value;
                                          i[e.indexOf(h.name)] = h.source
                                      }
                                  } catch (t) {
                                      o.e(t)
                                  } finally {
                                      o.f()
                                  }
                                  for (var u = 0, l = 0; l < i.length; l++)
                                      void 0 === i[l] && void 0 !== a[u] && (i[l] = a[u].source,
                                      u += 1)
                              } else {
                                  var c, d = Object(m.a)(s);
                                  try {
                                      for (d.s(); !(c = d.n()).done; ) {
                                          var p = c.value;
                                          i.push(p.source)
                                      }
                                  } catch (t) {
                                      d.e(t)
                                  } finally {
                                      d.f()
                                  }
                                  var f, _ = Object(m.a)(a);
                                  try {
                                      for (_.s(); !(f = _.n()).done; ) {
                                          var v = f.value;
                                          i.push(v.source)
                                      }
                                  } catch (t) {
                                      _.e(t)
                                  } finally {
                                      _.f()
                                  }
                              }
                              return i
                          }
                      }, {
                          key: "isInputAvailable",
                          value: function(t, e) {
                              if (-1 === t._inputNames.indexOf(e))
                                  return !1;
                              var i, s = Object(m.a)(this.connections);
                              try {
                                  for (s.s(); !(i = s.n()).done; ) {
                                      var a = i.value;
                                      if ("name" === a.type && a.destination === t && a.name === e)
                                          return !1
                                  }
                              } catch (t) {
                                  s.e(t)
                              } finally {
                                  s.f()
                              }
                              return !0
                          }
                      }, {
                          key: "registerConnection",
                          value: function(t, e, i) {
                              if (e.inputs.length >= e.inputNames.length && !0 === e._limitConnections)
                                  throw new Da("Node has reached max number of inputs, can't connect");
                              if (!1 === e._limitConnections && this.getInputsForNode(e).includes(t) && (console.debug("WARNING - node connected mutliple times, removing previous connection"),
                              this.unregisterConnection(t, e)),
                              "number" == typeof i)
                                  this.connections.push({
                                      source: t,
                                      type: "zIndex",
                                      zIndex: i,
                                      destination: e
                                  });
                              else if ("string" == typeof i && e._limitConnections) {
                                  if (!this.isInputAvailable(e, i))
                                      throw new Da("Port " + i + " is already connected to");
                                  this.connections.push({
                                      source: t,
                                      type: "name",
                                      name: i,
                                      destination: e
                                  })
                              } else {
                                  var s = this.getZIndexInputsForNode(e)
                                    , a = 0;
                                  s.length > 0 && (a = s[s.length - 1].zIndex + 1),
                                  t.index = a,
                                  this.connections.push({
                                      source: t,
                                      type: "zIndex",
                                      zIndex: a,
                                      destination: e
                                  })
                              }
                              return !0
                          }
                      }, {
                          key: "unregisterConnection",
                          value: function(t, e) {
                              var i = this
                                , s = [];
                              return this.connections.forEach((function(i) {
                                  i.source === t && i.destination === e && s.push(i)
                              }
                              )),
                              0 !== s.length && (s.forEach((function(t) {
                                  var e = i.connections.indexOf(t);
                                  i.connections.splice(e, 1)
                              }
                              )),
                              !0)
                          }
                      }], [{
                          key: "outputEdgesFor",
                          value: function(t, e) {
                              var i, s = [], a = Object(m.a)(e);
                              try {
                                  for (a.s(); !(i = a.n()).done; ) {
                                      var r = i.value;
                                      r.source === t && s.push(r)
                                  }
                              } catch (t) {
                                  a.e(t)
                              } finally {
                                  a.f()
                              }
                              return s
                          }
                      }, {
                          key: "inputEdgesFor",
                          value: function(t, e) {
                              var i, s = [], a = Object(m.a)(e);
                              try {
                                  for (a.s(); !(i = a.n()).done; ) {
                                      var r = i.value;
                                      r.destination === t && s.push(r)
                                  }
                              } catch (t) {
                                  a.e(t)
                              } finally {
                                  a.f()
                              }
                              return s
                          }
                      }, {
                          key: "getInputlessNodes",
                          value: function(t) {
                              var e, i = [], s = Object(m.a)(t);
                              try {
                                  for (s.s(); !(e = s.n()).done; ) {
                                      var a = e.value;
                                      i.push(a.source)
                                  }
                              } catch (t) {
                                  s.e(t)
                              } finally {
                                  s.f()
                              }
                              var r, n = Object(m.a)(t);
                              try {
                                  for (n.s(); !(r = n.n()).done; ) {
                                      var o = r.value
                                        , h = i.indexOf(o.destination);
                                      -1 !== h && i.splice(h, 1)
                                  }
                              } catch (t) {
                                  n.e(t)
                              } finally {
                                  n.f()
                              }
                              return i
                          }
                      }]),
                      t
                  }()
                    , Ba = new pa
                    , Va = function() {
                      function t(e) {
                          var i = this
                            , a = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : Sa
                            , r = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : {}
                            , n = (r.manualUpdate,
                          r.webglContextAttributes)
                            , o = void 0 === n ? {} : n;
                          Object(s.a)(this, t),
                          this.initLocalStorage(),
                          Number(localStorage._obsRenderMode) > 0 && (a = Number(localStorage._obsRenderMode));
                          var h = document.createElement("canvas");
                          this._canvas = h,
                          this._webglContextAttributes = o,
                          a === Sa ? (this._gl = h.getContext("experimental-webgl", Object.assign({
                              preserveDrawingBuffer: !0
                          }, o, {
                              alpha: !1,
                              antialias: !1
                          })),
                          null === this._gl ? (l.a.warn("Failed to intialise WebGL."),
                          a = ga,
                          this._gl = h.getContext("2d")) : (h.addEventListener("webglcontextlost", this.onWebglContextLost.bind(this), !1),
                          h.addEventListener("webglcontextrestored", this.setupWebGLStateAndResources.bind(this), !1))) : this._gl = h.getContext("2d"),
                          this._renderMode = a,
                          l.a.log("OBSPlayer.constructor renderMode=" + a),
                          this._stat = e.stat,
                          this._stat.setComDim(d.a.DIM_COM.OBS_RENDER_MODE, a),
                          this._initHyplayer(e),
                          this._renderGraph = new Ua,
                          this._sourceNodes = [],
                          this._processingNodes = [],
                          this._timeline = [],
                          this._currentDTS = 0,
                          this._currentTime = 0,
                          this._state = t.STATE.PAUSED,
                          this._playbackRate = 1,
                          this._volume = 1,
                          this._backgroundNode = null,
                          this._faceNode = null,
                          this._srAudioNode = null,
                          this._sourcesPlaying = void 0,
                          this._compositingNode = void 0,
                          this._container = void 0,
                          this._startInfo = null,
                          this._callbacks = new Map,
                          Object.keys(t.EVENTS).forEach((function(e) {
                              return i._callbacks.set(t.EVENTS[e], [])
                          }
                          )),
                          this._timelineCallbacks = [],
                          this._onTransEnd = this.onTransEnd.bind(this),
                          this._onBgPlayBind = this._onBgPlay.bind(this),
                          this._checkTimes = 0
                      }
                      return Object(a.a)(t, [{
                          key: "initLocalStorage",
                          value: function() {
                              localStorage._obsUseFull && (o.a.obsUseFull = Number(localStorage._obsUseFull)),
                              localStorage._obsFullRatio && (o.a.obsFullRatio = Number(localStorage._obsFullRatio)),
                              localStorage._obsBgRatio && (o.a.obsBgRatio = Number(localStorage._obsBgRatio)),
                              localStorage._obsFaceRatio && (o.a.obsFaceRatio = Number(localStorage._obsFaceRatio)),
                              localStorage._obsSrAudio && (o.a.obsSrAudio = Number(localStorage._obsSrAudio)),
                              localStorage._obsFrame && (o.a.obsFrame = Number(localStorage._obsFrame)),
                              localStorage._obsSyncTs && (o.a.obsSyncTs = Number(localStorage._obsSyncTs)),
                              localStorage._obsSeekTs && (o.a.obsSeekTs = Number(localStorage._obsSeekTs)),
                              localStorage._obsSeekJumpTs && (o.a.obsSeekJumpTs = Number(localStorage._obsSeekJumpTs)),
                              localStorage._obsRateTs && (o.a.obsRateTs = Number(localStorage._obsRateTs))
                          }
                      }, {
                          key: "onWebglContextLost",
                          value: function(t) {
                              t.preventDefault(),
                              l.a.log("OBSPlayer.onWebglContextLost")
                          }
                      }, {
                          key: "setupWebGLStateAndResources",
                          value: function() {
                              this.stop(),
                              l.a.log("OBSPlayer.setupWebGLStateAndResources"),
                              this._gl = this._canvas.getContext("2d"),
                              this._renderMode = ga,
                              this.start(this._startInfo)
                          }
                      }, {
                          key: "start",
                          value: function(t) {
                              var e = new Ra;
                              Object.assign(e, t),
                              this._startInfo = e,
                              Ba.fps.reset(),
                              this._container = e.container;
                              var i = this.compositor();
                              this._compositingNode = i;
                              for (var s = null, a = 1; a < 17; a++)
                                  s = new Ra,
                                  Object.assign(s, t),
                                  s.sStreamName += "-".concat(a),
                                  this.video("", a - 1, s);
                              s = new Ra(t),
                              Object.assign(s, t),
                              (1 === o.a.obsUseFull && 0 === o.a.obsFullRatio || 0 === o.a.obsUseFull && 0 === o.a.obsBgRatio) && (s.sStreamName += "-ai-enhance"),
                              1 === o.a.obsUseFull && o.a.obsFullRatio > 1 ? s.ratio = o.a.obsFullRatio : 0 === o.a.obsUseFull && o.a.obsBgRatio > 0 && (s.ratio = o.a.obsBgRatio),
                              this._backgroundNode = this.video("", 20, s, 0, 4, {
                                  volume: this._volume
                              }),
                              s = new Ra,
                              Object.assign(s, t),
                              s.ratio = o.a.obsFaceRatio,
                              this._faceNode = this.video("", 21, s, 0, 4, {
                                  volume: 0
                              }),
                              1 === o.a.obsSrAudio && (s = new Ra,
                              Object.assign(s, t),
                              s.sStreamName += "-sr-audio",
                              this._srAudioNode = this.audio("", 22, s, 0, 4, {
                                  volume: this._volume
                              })),
                              i.init(this._sourceNodes, this._backgroundNode, this._faceNode),
                              this._hyplayer.trigger(r.a.VIDEO_PLAY, {
                                  video: this._canvas
                              }),
                              this._checkTimes = 0,
                              Ba.fpsHeart.reset(),
                              k.a.add(this.onCheckTimer, this, 1e3),
                              this.playbackRate = 1,
                              this._onBgPlay()
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              if (1 === Number(localStorage._printNodeInfo) && this.printNodesInfo(),
                              this.playbackRate = this.getPlaybackrate(),
                              this._checkTimes++,
                              this._checkTimes % 20 == 0) {
                                  Ba.fpsHeart.average() !== v.b.UintMax && this._stat.setCore(d.a.CORE.OBS_FPS, Ba.fpsHeart.average()),
                                  this._stat.setCore(d.a.CORE.OBS_UPLOAD_TS, Math.floor(100 * aa.average()));
                                  var i = [];
                                  this._stat.fill(i),
                                  this._hyplayer.tsdbUtil.sendMetrics(i)
                              }
                          }
                      }, {
                          key: "scale",
                          value: function(t) {
                              var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0
                                , i = this._compositingNode;
                              i && i.setScale(t, e)
                          }
                      }, {
                          key: "translate",
                          value: function(t, e) {
                              var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0
                                , s = this._compositingNode;
                              !s || 0 === t && 0 === e || s._transition(s.x + t, s.y + e, s.scale, i, this._onTransEnd)
                          }
                      }, {
                          key: "ctrl",
                          value: function(t, e, i) {
                              this._compositingNode && (this._compositingNode.backStream = t,
                              this._compositingNode.faceStream = e,
                              this._compositingNode.faceStreamMask = i)
                          }
                      }, {
                          key: "registerTimelineCallback",
                          value: function(t, e) {
                              var i = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0;
                              this._timelineCallbacks.push({
                                  time: t,
                                  func: e,
                                  ordering: i
                              })
                          }
                      }, {
                          key: "unregisterTimelineCallback",
                          value: function(t) {
                              var e, i = [], s = Object(m.a)(this._timelineCallbacks);
                              try {
                                  for (s.s(); !(e = s.n()).done; ) {
                                      var a = e.value;
                                      a.func === t && i.push(a)
                                  }
                              } catch (t) {
                                  s.e(t)
                              } finally {
                                  s.f()
                              }
                              for (var r = 0, n = i; r < n.length; r++) {
                                  var o = n[r]
                                    , h = this._timelineCallbacks.indexOf(o);
                                  this._timelineCallbacks.splice(h, 1)
                              }
                          }
                      }, {
                          key: "registerCallback",
                          value: function(t, e) {
                              if (!this._callbacks.has(t))
                                  return !1;
                              this._callbacks.get(t).push(e)
                          }
                      }, {
                          key: "unregisterCallback",
                          value: function(t) {
                              var e, i = Object(m.a)(this._callbacks.values());
                              try {
                                  for (i.s(); !(e = i.n()).done; ) {
                                      var s = e.value
                                        , a = s.indexOf(t);
                                      if (-1 !== a)
                                          return s.splice(a, 1),
                                          !0
                                  }
                              } catch (t) {
                                  i.e(t)
                              } finally {
                                  i.f()
                              }
                              return !1
                          }
                      }, {
                          key: "_callCallbacks",
                          value: function(t) {
                              var e, i = this._callbacks.get(t), s = Object(m.a)(i);
                              try {
                                  for (s.s(); !(e = s.n()).done; )
                                      (0,
                                      e.value)(this._currentDTS)
                              } catch (t) {
                                  s.e(t)
                              } finally {
                                  s.f()
                              }
                          }
                      }, {
                          key: "setVolume",
                          value: function(t) {
                              this._volume = t,
                              this._backgroundNode && this._backgroundNode.setVolume(t),
                              this._srAudioNode && this._srAudioNode.setVolume(t)
                          }
                      }, {
                          key: "_onBgPlay",
                          value: function(e) {
                              return l.a.log("OBSPlayer._onBgPlay"),
                              this._state = t.STATE.PLAYING,
                              Ba.register(this),
                              !0
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              return this._state !== t.STATE.ENDED && (this._state = t.STATE.ENDED,
                              Ba.unregister(this),
                              k.a.remove(this.onCheckTimer, this),
                              this.reset(),
                              !0)
                          }
                      }, {
                          key: "pause",
                          value: function() {
                              return this._state = t.STATE.PAUSED,
                              !0
                          }
                      }, {
                          key: "video",
                          value: function(t, e, i) {
                              var s = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 0
                                , a = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 4
                                , r = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : {
                                  volume: 0
                              }
                                , n = new wa(t,e,this._renderMode,this._gl,this._renderGraph,this._currentDTS,this._playbackRate,s,a,this._videoElementCache,r,this._hyplayer,this._container,i);
                              return n.setVolume(r.volume),
                              this._sourceNodes.push(n),
                              n
                          }
                      }, {
                          key: "audio",
                          value: function(t, e, i) {
                              var s = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 0
                                , a = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 4
                                , r = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : {
                                  volume: 0
                              }
                                , n = new Oa(t,e,this._renderMode,this._gl,this._renderGraph,this._currentDTS,this._playbackRate,s,a,this._audioElementCache,r,this._hyplayer,this._container,i);
                              return n.setVolume(r.volume),
                              n
                          }
                      }, {
                          key: "compositor",
                          value: function() {
                              var t = new Ma(this._gl,this._canvas,this._renderMode,this._renderGraph,this._startInfo,this._hyplayer);
                              return this._processingNodes.push(t),
                              t
                          }
                      }, {
                          key: "update",
                          value: function(t) {
                              this._update(t)
                          }
                      }, {
                          key: "_update",
                          value: function(e) {
                              var i = this;
                              if (this._state === t.STATE.PLAYING || this._state === t.STATE.STALLED || this._state === t.STATE.PAUSED) {
                                  this._callCallbacks(t.EVENTS.UPDATE),
                                  this._state !== t.STATE.PAUSED && (this._isStalled() ? (this._callCallbacks(t.EVENTS.STALLED),
                                  this._state = t.STATE.STALLED) : this._state = t.STATE.PLAYING),
                                  this._currentTime += e,
                                  this._state === t.STATE.PLAYING && (this._currentDTS = this._backgroundNode.playDts);
                                  var s = !1
                                    , a = this._compositingNode;
                                  a._update(this._currentTime);
                                  var r = a.useFace;
                                  0 === o.a.obsUseFull ? this._sourceNodes.forEach((function(t) {
                                      r ? t === i._faceNode || t === i._backgroundNode ? i._updateNode(t) && (s = !0) : t._unload() : t === i._faceNode || t !== i._backgroundNode && !a.isNodeContained(t) ? t._unload() : i._updateNode(t) && (s = !0)
                                  }
                                  )) : s = this._updateNode(this._backgroundNode),
                                  s !== this._sourcesPlaying && this._state === t.STATE.PLAYING && (!0 === s ? this._callCallbacks(t.EVENTS.CONTENT) : this._callCallbacks(t.EVENTS.NOCONTENT),
                                  this._sourcesPlaying = s),
                                  this._srAudioNode && this._updateNode(this._srAudioNode),
                                  a._render()
                              }
                          }
                      }, {
                          key: "_updateNode",
                          value: function(e) {
                              return this._state === t.STATE.STALLED && 2 === e._state && e._pause(),
                              this._state === t.STATE.PAUSED && e._pause(),
                              this._state === t.STATE.PLAYING && e._play(),
                              e._update(this._currentDTS),
                              3 === e._state || 2 === e._state
                          }
                      }, {
                          key: "printNodesInfo",
                          value: function() {
                              var t = "\nb_b streamIndex=" + this._backgroundNode._streamIndex + " bufferLen=" + this._backgroundNode.bufferLen + " playDts=" + this._backgroundNode.playDts + " playbackRate=" + this._backgroundNode.playbackRate;
                              if (this._compositingNode.useFace)
                                  t += "\nf_f streamIndex=" + this._faceNode._streamIndex + " bufferLen=" + this._faceNode.bufferLen + " playdts=" + this._faceNode.playDts + " playbackRate=" + this._faceNode.playbackRate;
                              else
                                  for (var e = 0; e < this._sourceNodes.length; e++) {
                                      var i = this._sourceNodes[e];
                                      this._compositingNode.isNodeContained(i) && i && "video" === i._elementType && (t += "\n" + e % 4 + "_" + Math.floor(e / 4) + " streamIndex=" + (i._streamIndex + 1) + " bufferLen=" + i.bufferLen + " playdts=" + i.playDts + " playbackRate=" + i.playbackRate)
                                  }
                              t += "\nplaybackrate=".concat(this.playbackRate),
                              l.a.log(t)
                          }
                      }, {
                          key: "_isStalled",
                          value: function() {
                              return !1
                          }
                      }, {
                          key: "getPlaybackrate",
                          value: function() {
                              if (o.a.obsUseFull || !this._compositingNode.isLoaded())
                                  return 1;
                              for (var t = 2, e = 0; e < this._sourceNodes.length; e++) {
                                  var i = this._sourceNodes[e];
                                  if (i._element) {
                                      var s = i.bufferLen;
                                      s > 6e3 ? t = t > 1.4 ? 1.4 : t : s > 4e3 ? t = t > 1.2 ? 1.2 : t : s > 2e3 ? t = t > 1 ? 1 : t : s <= 2e3 && (t = t > .9 ? .9 : t)
                                  }
                              }
                              return t
                          }
                      }, {
                          key: "_initHyplayer",
                          value: function(t) {
                              this._hyplayer = t,
                              t.scaleOBPlayer = this.scale.bind(this),
                              t.translateOBPlayer = this.translate.bind(this),
                              t.getFrameData = this.getFrameData.bind(this),
                              t.getViewport = this.getViewport.bind(this),
                              t.setViewport = this.setViewport.bind(this),
                              t.addViewport = this.addViewport.bind(this)
                          }
                      }, {
                          key: "getCurrentTime",
                          value: function() {
                              return this._currentDTS
                          }
                      }, {
                          key: "getFrameData",
                          value: function() {
                              return {
                                  pts: this._currentDTS
                              }
                          }
                      }, {
                          key: "getViewport",
                          value: function() {
                              return this._compositingNode.getViewport()
                          }
                      }, {
                          key: "setViewport",
                          value: function(t) {
                              1 == localStorage._printObsInfo && l.a.log("OBSPlayer.setViewport", t),
                              t.callback = this._onTransEnd,
                              this._compositingNode.setViewport(t)
                          }
                      }, {
                          key: "addViewport",
                          value: function(t) {
                              1 == localStorage._printObsInfo && l.a.log("OBSPlayer.addViewport", t),
                              t.callback = this._onTransEnd,
                              this._compositingNode.addViewport(t)
                          }
                      }, {
                          key: "onTransEnd",
                          value: function() {
                              this._hyplayer.trigger(r.a.TRANS_END)
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              var e, i = this, s = Object(m.a)(this._callbacks);
                              try {
                                  for (s.s(); !(e = s.n()).done; ) {
                                      var a = e.value;
                                      this.unregisterCallback(a)
                                  }
                              } catch (t) {
                                  s.e(t)
                              } finally {
                                  s.f()
                              }
                              var r, n = Object(m.a)(this._sourceNodes);
                              try {
                                  for (n.s(); !(r = n.n()).done; )
                                      r.value.destroy()
                              } catch (t) {
                                  n.e(t)
                              } finally {
                                  n.f()
                              }
                              var o, h = Object(m.a)(this._processingNodes);
                              try {
                                  for (h.s(); !(o = h.n()).done; )
                                      o.value.destroy()
                              } catch (t) {
                                  h.e(t)
                              } finally {
                                  h.f()
                              }
                              this._backgroundNode && this._backgroundNode.destroy(),
                              this._faceNode && this._faceNode.destroy(),
                              this._srAudioNode && this._srAudioNode.destroy(),
                              this._update(0),
                              this._sourceNodes = [],
                              this._processingNodes = [],
                              this._timeline = [],
                              this._currentDTS = 0,
                              this._state = t.STATE.PAUSED,
                              this._playbackRate = 1,
                              this._sourcesPlaying = void 0,
                              Object.keys(t.EVENTS).forEach((function(e) {
                                  return i._callbacks.set(t.EVENTS[e], [])
                              }
                              )),
                              this._timelineCallbacks = []
                          }
                      }, {
                          key: "element",
                          get: function() {
                              return this._canvas
                          }
                      }, {
                          key: "state",
                          get: function() {
                              return this._state
                          }
                      }, {
                          key: "playbackRate",
                          set: function(t) {
                              t !== this._playbackRate && l.a.log("OBSPlayer.playbackRate change, old=".concat(this._playbackRate, " now=").concat(t));
                              var e, i = Object(m.a)(this._sourceNodes);
                              try {
                                  for (i.s(); !(e = i.n()).done; )
                                      e.value._globalPlaybackRate = t
                              } catch (t) {
                                  i.e(t)
                              } finally {
                                  i.f()
                              }
                              this._playbackRate = t
                          },
                          get: function() {
                              return this._playbackRate
                          }
                      }, {
                          key: "fps",
                          get: function() {
                              return Ba.fps.getSamples()
                          }
                      }]),
                      t
                  }()
                    , xa = Object.freeze({
                      PLAYING: 0,
                      PAUSED: 1,
                      STALLED: 2,
                      ENDED: 3,
                      BROKEN: 4
                  });
                  Va.STATE = xa;
                  var Ha = Object.freeze({
                      UPDATE: "update",
                      STALLED: "stalled",
                      ENDED: "ended",
                      CONTENT: "content",
                      NOCONTENT: "nocontent"
                  });
                  Va.EVENTS = Ha;
                  var Ga = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.sampleController = e.handler.sampleController,
                          this.flacPlayer = new FlacPlayer(e,this.sampleController.realFlacSample),
                          this.flacPlayer.setLogger(l.a),
                          this.flacPlayer.uuid = z.a.uuid
                      }
                      return Object(a.a)(t, [{
                          key: "setVolume",
                          value: function(t) {
                              this.flacPlayer.setVolume(t)
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              this.flacPlayer.stop(),
                              this.sampleController = null
                          }
                      }, {
                          key: "onHeader",
                          value: function(t) {
                              this.flacPlayer.onHeader && this.flacPlayer.onHeader(t)
                          }
                      }, {
                          key: "onConnected",
                          value: function() {
                              this.flacPlayer.onConnected && this.flacPlayer.onConnected()
                          }
                      }, {
                          key: "onClosed",
                          value: function() {
                              this.flacPlayer.onClosed && this.flacPlayer.onClosed()
                          }
                      }, {
                          key: "onLoadError",
                          value: function() {
                              this.flacPlayer.onLoadError && this.flacPlayer.onLoadError()
                          }
                      }, {
                          key: "onData",
                          value: function(t) {
                              this.sampleController.addTotalSample(t.byteLength),
                              this.flacPlayer.onData && this.flacPlayer.onData(t)
                          }
                      }, {
                          key: "onLoadTimeout",
                          value: function() {
                              this.flacPlayer.onLoadTimeout && this.flacPlayer.onLoadTimeout()
                          }
                      }, {
                          key: "requestUrl",
                          value: function() {
                              this.flacPlayer.requestUrl && this.flacPlayer.requestUrl()
                          }
                      }]),
                      t
                  }()
                    , ja = function() {
                      function t(e, i) {
                          Object(s.a)(this, t),
                          this.handler = e,
                          this.connected = !1,
                          this.startTs = 0,
                          this.playing = !1,
                          this.loadTime = 0,
                          this.connectTime = 0,
                          this.players = [],
                          this.libURL = i,
                          this.libLoaded = !1,
                          this.flacURL = "",
                          this.playInfo = null,
                          this.anticode = new ci,
                          this.playUrlBind = this.playUrl.bind(this),
                          this.refreshAnticodeBind = this.refreshAnticode.bind(this),
                          this.anticode.on(ci.Events.REFRESH, this.refreshAnticodeBind)
                      }
                      return Object(a.a)(t, [{
                          key: "loadFlacLib",
                          value: function(t) {
                              var e = document.createElement("script");
                              e.type = "text/javaScript",
                              e.onload = this.flacLibLoaded.bind(this),
                              e.src = t,
                              document.getElementsByTagName("head")[0].appendChild(e)
                          }
                      }, {
                          key: "flacLibLoaded",
                          value: function() {
                              l.a.log("flaclib complete"),
                              this.libLoaded = !0,
                              this.play(this.playInfo)
                          }
                      }, {
                          key: "isPlaying",
                          value: function() {
                              return this.playing
                          }
                      }, {
                          key: "getLoger",
                          value: function() {
                              return l.a
                          }
                      }, {
                          key: "play",
                          value: function(t) {
                              t && (this.playInfo = t),
                              this.libLoaded ? this.checkParams(this.playInfo, this.playUrlBind) : this.loadFlacLib(this.libURL)
                          }
                      }, {
                          key: "playUrl",
                          value: function(t, e) {
                              this.initInfo(t, e);
                              var i = new Ga(this)
                                , s = new yi(i)
                                , a = {
                                  player: i,
                                  loader: s
                              };
                              this.players.push(a),
                              s.connect(this.flacURL),
                              k.a.add(this.onCheckTimer, this, 1e3)
                          }
                      }, {
                          key: "checkParams",
                          value: function(t, e) {
                              l.a.log("FlacPlayer.checkParams", JSON.stringify(t)),
                              t.sFlvUrl && t.sStreamName ? (t.sFlvUrl = t.sFlvUrl.replace("http://", "https://"),
                              this.initDomain(t),
                              t.sFlvAntiCode ? (this.anticode.init(t.sFlvUrl, t.sStreamName, t.sFlvAntiCode),
                              this.anticode.valid().then((function() {
                                  e(t)
                              }
                              ))) : e(t)) : t.url ? e(t) : l.a.error("FlacPlayer.checkParams has no params(sFlvUrl, sStreamName, url)")
                          }
                      }, {
                          key: "_getUrlParams",
                          value: function(t, e) {
                              var i = "";
                              e && (i += "pulltype=pcdn&");
                              var s = o.a.platform
                                , a = C.a.PLATFORM_TYPE[s] || C.a.PLATFORM_TYPE.web
                                , r = s === C.a.PLATFORM_TYPE_NAME.wap ? "uid=".concat(z.a.uid, "&uuid=").concat(z.a.uuid) : "u=".concat(z.a.convertUid);
                              return i += "".concat(r, "&t=").concat(a, "&sv=").concat(2202140215),
                              -1 === t.indexOf("?") ? t += "?" : t += "&",
                              t + i
                          }
                      }, {
                          key: "initDomain",
                          value: function(t) {
                              if (!t.inited) {
                                  t.inited = !0;
                                  var e = t.domainList;
                                  if (e && e.length) {
                                      var i = t.sFlvUrl.match(/\/\/(.+?)\//i);
                                      t._domain = i ? i[1] : "",
                                      l.a.log("FlvPlayer.initDomain:\n\t" + e.join("\n\t"));
                                      var s = e.shift();
                                      t.sFlvUrl = t.sFlvUrl.replace(/\/\/(.+?)\//, "//" + s + "/" + t._domain + "/")
                                  }
                              }
                          }
                      }, {
                          key: "initInfo",
                          value: function(t, e) {
                              this.playInfo = t,
                              t.sFlvUrl && t.sStreamName && (t.url = "".concat(t.sFlvUrl, "/").concat(t.sStreamName, "_audio.flv"));
                              var i = [];
                              this.anticode.hasAnticode() && i.push(this.anticode.getAnticode(e)),
                              t.bitrate > 0 ? i.push("ratio=".concat(t.bitrate)) : localStorage._ratio && i.push("&ratio=".concat(localStorage._ratio)),
                              -1 === t.url.indexOf("va.huya.com") && -1 === t.url.indexOf("cdnweb.huya.com") && -1 === t.url.indexOf("va-cmcc.huya.com") || i.push("&https=1"),
                              i.length > 0 && (t.url += (-1 !== t.url.indexOf("?") ? "&" : "?") + "".concat(i.join("&")));
                              var s = this._getUrlParams(t.url, !1);
                              this.flacURL = s
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              this.anticode.onCheckTimer(t, e)
                          }
                      }, {
                          key: "refreshAnticode",
                          value: function() {
                              this.initInfo(this.playInfo)
                          }
                      }, {
                          key: "setVolume",
                          value: function(t) {
                              for (var e = 0; e < this.players.length; e++)
                                  this.players[e].player.setVolume(110 * t)
                          }
                      }, {
                          key: "getCurrentTime",
                          value: function() {
                              return this.handler && this.handler.playingMgr ? Math.floor(this.handler.playingMgr.getCurrentTime()) : 0
                          }
                      }, {
                          key: "playerFlacError",
                          value: function(t) {
                              l.a.log("playerFlacError error:" + t),
                              this.isPlaying() && (this.playing = !1,
                              this.handler.flacPlayStatusChange(),
                              this.handler.trigger(r.a.FLAC_AUDIO_ERROR))
                          }
                      }, {
                          key: "onstartplay",
                          value: function() {
                              this.isPlaying() || (this.playing = !0,
                              setTimeout(function() {
                                  this.isPlaying() && (this.handler.trigger(r.a.FLAC_AUDIO_START),
                                  this.handler.flacPlayStatusChange())
                              }
                              .bind(this), 1e3))
                          }
                      }, {
                          key: "onClosed",
                          value: function() {
                              this.reset()
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              this.reset(),
                              this.handler.flacPlayStatusChange()
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              this.connected = !1,
                              this.startTs = 0,
                              this.playing = !1;
                              for (var t = 0; t < this.players.length; t++) {
                                  var e = this.players[t].player
                                    , i = this.players[t].loader;
                                  e && (e.stop(),
                                  e = null),
                                  i && (i.close(),
                                  i = null)
                              }
                              this.players = [],
                              this.playInfo = null,
                              this.anticode.off(ci.Events.REFRESH, this.refreshAnticodeBind),
                              k.a.remove(this.onCheckTimer, this)
                          }
                      }]),
                      t
                  }()
                    , Wa = i(30)
                    , Ya = i(33)
                    , qa = i(39)
                    , Ka = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i(t) {
                          var a;
                          return Object(s.a)(this, i),
                          (a = e.call(this)).player = t,
                          a.wupProtocolList = [],
                          a.vpRequestId = 0,
                          a.vpGetted = !1,
                          u.default.connected ? a._onConnected() : u.default.inited && u.default.addListener(u.default.WEBSOCKET_CONNECTED, a._onConnected.bind(Object(g.a)(a))),
                          a
                      }
                      return Object(a.a)(i, [{
                          key: "_onConnected",
                          value: function() {}
                      }, {
                          key: "getRequestId",
                          value: function() {
                              return u.default.getRequestId()
                          }
                      }, {
                          key: "resetVpRequest",
                          value: function() {
                              this.vpRequestId = 0
                          }
                      }, {
                          key: "setTafWup",
                          value: function(t) {
                              this._tafwup = t,
                              us.default.setTaf(this._tafwup),
                              this.emit(i.TAF_WUP_READY)
                          }
                      }, {
                          key: "getVoiceProxy",
                          value: function(t) {
                              var e = this;
                              t && t.requestId ? this.vpRequestId = t.requestId : (this.vpRequestId = this.getRequestId(),
                              t.requestId = this.vpRequestId),
                              this.vpGetted = !1,
                              u.default.connected ? this._getVoiceProxy(t) : (u.default.on(u.default.TAFLINK_INITED, (function() {
                                  e.vpGetted ? l.a.log("vp had been getted by http") : e._getVoiceProxy(t)
                              }
                              )),
                              this.on(i.TAF_WUP_READY, (function() {
                                  e.vpGetted ? l.a.log("vp had been getted by socket") : e._getVoiceProxyHttp(t)
                              }
                              )))
                          }
                      }, {
                          key: "_getVoiceProxyHttp",
                          value: function() {
                              var t = this
                                , e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                              this.vpGetted = !0;
                              var i = e.userid
                                , s = e.presenterUid
                                , a = e.streamName
                                , r = e.sid
                                , n = new Wa.default;
                              n.sid = s,
                              n.fuzzyParam.h264Only = !0,
                              n.fuzzyParam.maxCodeRateH264 = 0,
                              n.fuzzyParam.maxCodeRateH265 = 0;
                              var h = new Ya.default;
                              h.uid = i,
                              h.version = 1,
                              h.sdkVersion = 1,
                              h.fuzzyQueryKeys = [n],
                              h.streamNames = [a],
                              h.appid = z.a.appid,
                              h.clientAppid = 0,
                              h.clientType = 14,
                              h.sendTime = .001 * Date.now() >> 0,
                              h.useCase = 3,
                              h.appUA = "webh5&".concat(2202140215, "&websocket");
                              var u = o.a.playerdata || {}
                                , c = (u.gameId || 0) + "";
                              h.extInfo.set("categoryId", c),
                              l.a.log("TafLinkSignal._getVoiceProxyHttp req=", h);
                              var d = h.constructor.name
                                , p = j.a[d]
                                , f = new us.default.GetInfoFromVGReq;
                              f.lUid = i,
                              f.sProtoName = "yy",
                              f.iUri = p || 0,
                              f.lSid = r || 0,
                              f.tId = this._getUserId();
                              var _ = this._tafwup.BinBuffer;
                              f.sMsg = new _(h.marshall().buffer);
                              var m = "videogateway"
                                , v = "getInfoFromVG"
                                , y = new this._tafwup.Wup;
                              y.setServant(m),
                              y.setFunc(v),
                              y.writeStruct("tReq", f);
                              var T = y.encode().getBuffer();
                              this._tafwup.Util.ajax("//cdn.wup.huya.com", T, (function(e) {
                                  var i = new t._tafwup.Wup;
                                  i.decode(e);
                                  var s = new us.default.GetInfoFromVGRsp;
                                  i.readStruct("tRsp", s, us.default.GetInfoFromVGRsp),
                                  t._onGetProxyResp(s)
                              }
                              ), (function(t) {
                                  l.a.error("Get vp error, status=", t)
                              }
                              ))
                          }
                      }, {
                          key: "_getVoiceProxy",
                          value: function(t) {
                              var e = t.streamName
                                , i = (t.subSid,
                              t.presenterUid)
                                , s = (t.serviceType,
                              t.userid)
                                , a = (t.maxCodeRateH264,
                              t.maxCodeRateH265,
                              t.clientType,
                              t.sid)
                                , r = t.requestId;
                              this.vpGetted = !0;
                              var n = new Wa.default;
                              n.sid = i,
                              n.fuzzyParam.h264Only = !0,
                              n.fuzzyParam.maxCodeRateH264 = 0,
                              n.fuzzyParam.maxCodeRateH265 = 0;
                              var h = s || (Date.now() % 1e10 * 1e3 + (1e3 * Math.random() | 0)) % 4294967295
                                , c = new Ya.default;
                              c.uid = h,
                              c.version = 1,
                              c.sdkVersion = 1,
                              c.fuzzyQueryKeys = [n],
                              c.streamNames = [e],
                              c.appid = z.a.appid,
                              c.clientAppid = 0,
                              c.clientType = 14,
                              c.sendTime = .001 * Date.now() >> 0,
                              c.useCase = 3,
                              c.appUA = "webh5&".concat(2202140215, "&websocket");
                              var d = ((o.a.playerdata || {}).gameId || 0) + "";
                              c.extInfo.set("categoryId", d),
                              l.a.log("TafLinkSignal._getVoiceProxy uid=%s, requestId=%s", h, r, c);
                              var p = c.constructor.name
                                , f = j.a[p]
                                , _ = new us.default.GetInfoFromVGReq;
                              _.lUid = h;
                              var m = u.default.getTaf().getTaf().BinBuffer;
                              _.sMsg = new m(c.marshall().buffer),
                              _.sProtoName = "yy",
                              _.iUri = f || 0,
                              _.lSid = a || 0,
                              _.tId = u.default.getUserId(),
                              u.default.sendWup("videogateway", "getInfoFromVG", _, this._onGetProxyResp.bind(this), !0, r)
                          }
                      }, {
                          key: "_onGetProxyResp",
                          value: function(t) {
                              l.a.log("TafLinkSignal.onGetProxyResp", t);
                              var e = t.iRequestId;
                              if (e && e !== this.vpRequestId)
                                  l.a.error("Request id is inequality iRequestId=%d, vpRequestId=%d", e, this.vpRequestId);
                              else {
                                  var i = new DataView(t.sMsg.buffer)
                                    , s = new G.a(i)
                                    , a = new qa.default;
                                  a.unmarshall(s);
                                  var r = [];
                                  a.allocatedStreams.forEach((function(t, e) {
                                      r = r.concat(t)
                                  }
                                  )),
                                  this.emit(j.a.PAudienceGetProxyListRsp, a)
                              }
                          }
                      }, {
                          key: "_getUserId",
                          value: function(t) {
                              var e = new us.default.UserId;
                              return e.lUid = t,
                              e.sGuid = v.b.getCookie("guid"),
                              e.sToken = "",
                              e.sHuYaUA = "webh5&0.0.0&websocket",
                              e.sCookie = document.cookie,
                              e
                          }
                      }, {
                          key: "onVoiceProxy",
                          value: function(t, e) {
                              var i = this;
                              return function(s) {
                                  if (s.uid == e) {
                                      if (0 != s.result) {
                                          var a = "UNKNOWN ERROR!";
                                          return 1 == s.result ? a = "EGetVP_NO_RESOURCE" : 2 == s.result && (a = "EGetVP_FUZZY_NO_MATCH"),
                                          void l.a.warn("AudioMgr._getVoiceProxy", a, s)
                                      }
                                      var r = t.streamName;
                                      i.stopVoice(r),
                                      l.a.log("%cAudioMgr._onVoiceProxy lPresenterUid=".concat(t.presenterUid, "\nsStreamName=").concat(r), "background:#FFBFFF");
                                      var n = new AudioLink(t);
                                      n.uid = e,
                                      n.connect(s),
                                      i.audioLinkDict[r] = n
                                  } else
                                      l.a.warn("[x] AudioMgr._onVoiceProxy No requested uid.")
                              }
                          }
                      }, {
                          key: "connected",
                          get: function() {
                              return u.default.connected
                          }
                      }]),
                      i
                  }(ee.EventEmitter);
                  Ka.TAF_WUP_READY = "TAF_WUP_READY";
                  var za = Ka
                    , Ja = function() {
                      function t() {
                          Object(s.a)(this, t)
                      }
                      return Object(a.a)(t, [{
                          key: "parseInfo",
                          value: function(t) {
                              var e = []
                                , i = new Map;
                              t.allocatedStreams.forEach((function(t, i) {
                                  e.push({
                                      stream: t,
                                      streamName: i
                                  })
                              }
                              ));
                              for (var s = [], a = 0; a < e.length; a++) {
                                  var r = e[a].stream
                                    , n = []
                                    , o = [];
                                  if (r.length < 1)
                                      return {};
                                  for (var h = 0; h < r.length; h++) {
                                      if (r[h].streamId)
                                          if (r[h].streamId.streamType < 32) {
                                              var u = r[h].streamId.appid + "-" + r[h].streamId.streamType + "-" + r[h].streamId.codecType + "-" + r[h].streamId.sid + "-" + r[h].streamId.startTs + "-" + r[h].streamId.serverGenSeq;
                                              o.push(u)
                                          } else {
                                              var c = r[h].streamId.appid + "-" + r[h].streamId.streamType + "-" + r[h].streamId.codecType + "-" + r[h].streamId.sid + "-" + r[h].streamId.startTs + "-" + r[h].streamId.serverGenSeq;
                                              n.push(c)
                                          }
                                      for (var d = 0; d < r[h].videoProxyInfos.length; d++)
                                          s.push(r[h].videoProxyInfos[d])
                                  }
                                  0 !== n.length && 0 !== o.length || l.a.warn("streams[streamIndex].streamName aStreamIdList.size=".concat(n.length, " vStreamIdList.size=").concat(o.length)),
                                  i.set(e[a].streamName, {
                                      aStreamIdList: n,
                                      vStreamIdList: o
                                  })
                              }
                              for (var p = new Map, f = s.length - 1; f >= 0; f--)
                                  p.has(s[f].ip) ? s.splice(f, 1) : p.set(s[f].ip, 1);
                              return {
                                  streams: i,
                                  videoProxyInfos: s
                              }
                          }
                      }]),
                      t
                  }()
                    , Qa = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.flvPlayer = e,
                          this.hyPlayer = e.hyPlayer,
                          this.stat = e.hyPlayer.stat,
                          this.data = {
                              act: "webhuyah5qa",
                              uid: 0,
                              sid: 0,
                              subsid: 0,
                              linetype: -1,
                              sendcnt: 0,
                              paucount: 0,
                              paulength: 0,
                              bflength: 0,
                              vr: 0,
                              httphead: "",
                              rel: "jsscene",
                              ref: location.href,
                              isp2p: 0
                          },
                          this.img = null,
                          this.pausedCount = 0,
                          this.pausedTime = 0,
                          this.isPaused = !1,
                          this.isFirstReport = !0
                      }
                      return Object(a.a)(t, [{
                          key: "send",
                          value: function() {}
                      }, {
                          key: "sendFlow",
                          value: function(t) {
                              var e = [];
                              this.stat.setCoreDim(d.a.DIM_CORE.USER_PROPERTY, this.getUserProperty()),
                              this.stat.fill(e, !0),
                              this.hyPlayer.tsdbUtil.sendMetrics(e)
                          }
                      }, {
                          key: "getUserProperty",
                          value: function() {
                              var t = this.hyPlayer.tsdbUtil;
                              return this.flvPlayer.getConfig(100) ? this.flvPlayer.getConfig(101) ? Xt.isBrowserSupport() ? Xt.isP2PCooling() ? C.a.userProperty.P2P_COOLING : 1 == t.turnToFlvTimes && 0 == t.restartTimes ? t.turnToFlvReason == C.a.turnToFlvReason.FULL_CONNECT_TIMEOUT ? C.a.userProperty.FIRST_FULL_CONNECT_TIMEOUT : t.turnToFlvReason == C.a.turnToFlvReason.FULL_NO_DATA ? C.a.userProperty.FIRST_FULL_NO_DATA : t.turnToFlvReason == C.a.turnToFlvReason.FULL_PLAY_FAIL ? C.a.userProperty.FIRST_FULL_PLAY_FAIL : t.turnToFlvReason == C.a.turnToFlvReason.SUB_CONNECT_TIMEOUT ? C.a.userProperty.SUB_CONNECT_TIMEOUT : t.turnToFlvReason == C.a.turnToFlvReason.SUB_NO_DATA ? C.a.userProperty.SUB_NO_DATA : t.turnToFlvReason == C.a.turnToFlvReason.P2P_ARGS_ERROR ? C.a.userProperty.P2P_ARGS_ERROR : t.turnToFlvReason == C.a.turnToFlvReason.P2P_COOLING ? C.a.userProperty.P2P_COOLING : C.a.userProperty.UNKNOW : t.turnToFlvReason == C.a.turnToFlvReason.FULL_CONNECT_TIMEOUT || t.turnToFlvReason == C.a.turnToFlvReason.FULL_NO_DATA || t.turnToFlvReason == C.a.turnToFlvReason.FULL_PLAY_FAIL ? t.restartReason == C.a.restartReason.RANGE_SEQ_MAX ? C.a.userProperty.RESTART_RANGE_MAX : t.restartReason == C.a.restartReason.RANGE_SEQ_LARGE ? C.a.userProperty.RESTART_RANGE_LARGE : t.restartReason == C.a.restartReason.CONNECT ? C.a.userProperty.RESTART_CONNECT : t.restartReason == C.a.restartReason.MULTI_CDN ? C.a.userProperty.RESTART_MUTI_CDN : t.restartReason == C.a.restartReason.PLAYER_NO_DATA ? C.a.userProperty.RESTART_PLAYER_NO_DATA : t.restartReason == C.a.restartReason.PLAYER_ERROR ? C.a.userProperty.RESTART_PLAYER_ERROR : t.restartReason == C.a.restartReason.FLV_TO_P2P ? C.a.userProperty.FLV_TO_P2P : t.restartReason == C.a.restartReason.LOST_SEQ ? C.a.userProperty.LOST_SEQ : C.a.userProperty.UNKNOW : t.turnToFlvReason == C.a.turnToFlvReason.SUB_CONNECT_TIMEOUT ? C.a.userProperty.SUB_CONNECT_TIMEOUT : t.turnToFlvReason == C.a.turnToFlvReason.SUB_NO_DATA ? C.a.userProperty.SUB_NO_DATA : t.turnToFlvReason == C.a.turnToFlvReason.P2P_ARGS_ERROR ? C.a.userProperty.P2P_ARGS_ERROR : t.turnToFlvReason == C.a.turnToFlvReason.P2P_COOLING ? C.a.userProperty.P2P_COOLING : C.a.userProperty.UNKNOW : C.a.userProperty.BROWSER_UN_SUPPORT : C.a.userProperty.CLIENT_CLOSE : C.a.userProperty.SERVER_CLOSE
                          }
                      }, {
                          key: "record",
                          value: function(t, e, i, s, a, r, n, o) {
                              if (this.pausedCount += e,
                              this.pausedTime += i,
                              t % 120 == 0 && (s && this.pausedCount++,
                              this.send()),
                              s && (this.isPaused = !0),
                              t % 20 == 0) {
                                  var h = this.getUserProperty();
                                  this.stat.setCoreDim(d.a.DIM_CORE.USER_PROPERTY, h),
                                  this.stat.setCoreDim(d.a.DIM_CORE.SIGNAL_USER_PROPERTY, 0);
                                  var u = [];
                                  this.flvPlayer.info,
                                  this.stat.setCoreDim(d.a.DIM_CORE.VIDEO_BAD_QUALITY_OLD, s ? 100 : 0),
                                  this.stat.setCoreDim(d.a.DIM_CORE.VIDEO_BAD_QUALITY, s || e > 0 ? 100 : 0),
                                  this.stat.setCoreDim(d.a.DIM_CORE.VIDEO_BAD_REASON, r),
                                  this.stat.setCore(d.a.CORE.BUFFER_LENGTH, o),
                                  this.stat.setCore(d.a.CORE.PLAY_DELAY, o),
                                  this.stat.setCore(d.a.CORE.DELAY_ANCHOR, n),
                                  this.isFirstReport && (this.isFirstReport = !1),
                                  this.stat.setComDim(d.a.DIM_COM.CDNIP, this.flvPlayer.cdnip),
                                  this.stat.fill(u),
                                  this.hyPlayer.tsdbUtil.sendMetrics(u),
                                  this.isPaused = !1
                              }
                          }
                      }, {
                          key: "getHost",
                          value: function(t) {
                              return t.replace("https*://", "").split("/")[0]
                          }
                      }, {
                          key: "setHttpHead",
                          value: function(t) {
                              this.data.httphead = this.getHost(t)
                          }
                      }]),
                      t
                  }()
                    , Xa = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.hyPlayer = e,
                          this.video = null,
                          this.mediaMgr = null,
                          this.roomId = 0,
                          this.appid = z.a.appid,
                          this.playerList = [],
                          this.playerMap = new Map,
                          this.playerStreamList = [],
                          this.tafLinkSignal = new za(this),
                          this.qaStat = new Qa(this),
                          this.started = !1,
                          this.videoProxyInfos = [],
                          this.streamsWaiting = [],
                          this.vpConnectedList = [],
                          this.lastCheckPlayTime = 0,
                          this.pauseTs = 0,
                          this.paused = !1,
                          this.pauseCount = 0,
                          this.sendMetricTimes = 0,
                          this.pauseTime = 0,
                          this.startLoadTime = 0,
                          this.videoInfo = null,
                          this.getVpStartTs = 0,
                          this.getVpSuccessTs = 0,
                          this.videoDelaySended = !1,
                          this.pauseStartTs = 0,
                          this.videoVolume = -1,
                          this._curAnchorDelay = 0,
                          this._curPlayDelay = 0,
                          this._curKbps = 0,
                          this._curAnchorDelaySum = 0,
                          this._curAnchorDelayCnt = 0,
                          this._curPlayDelaySum = 0,
                          this._curPlayDelayCnt = 0,
                          this.libFile = "hymda.js",
                          this.sslUrl = "-server.va.huya.com",
                          this.videoStatus = r.b.VIDEO_STOP,
                          this.callbacks = {
                              onLoaded: this.webrtcPlayerLibLoaded,
                              onTimeout: this.webrtcPlayerTimeout,
                              thisObj: this
                          },
                          this.clickEventBind = this._clickEvent.bind(this),
                          this.initPlayer()
                      }
                      return Object(a.a)(t, [{
                          key: "initPlayer",
                          value: function() {
                              this._addTafSignalEvents()
                          }
                      }, {
                          key: "start",
                          value: function(t) {
                              this.videoInfo = t,
                              this.videoDelaySended = !1,
                              t.sStreamName && this._getVoiceProxy(),
                              this.startLoadTime = c.a.now(),
                              this.loadWebrtcPlayerLib(t.h5Root || "./")
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              l.a.log("WebrtcPlayer.stop"),
                              k.a.remove(this._getVoiceProxy, this),
                              k.a.remove(this.onCheckTimer, this),
                              k.a.remove(this.onCheckFastTimer, this),
                              k.a.remove(this.onSendStatTimer, this),
                              this.removeLibHandler(),
                              this.started = !1,
                              this.video = null,
                              this.videoProxyInfos = [],
                              this.streamsWaiting = [],
                              this.vpConnectedList = [],
                              this.lastCheckPlayTime = 0,
                              this.pauseTs = 0,
                              this.paused = !1,
                              this.pauseCount = 0,
                              this.sendMetricTimes = 0,
                              this.pauseTime = 0,
                              this.getVpStartTs = 0,
                              this.getVpSuccessTs = 0,
                              this.pauseStartTs = 0,
                              this._curAnchorDelay = 0,
                              this._curPlayDelay = 0,
                              this._curKbps = 0,
                              this._curAnchorDelaySum = 0,
                              this._curAnchorDelayCnt = 0,
                              this._curPlayDelaySum = 0,
                              this._curPlayDelayCnt = 0,
                              this.tafLinkSignal.resetVpRequest(),
                              this.mediaMgr && (this.mediaMgr.stop(),
                              this.mediaMgr = null)
                          }
                      }, {
                          key: "_initMediaMgr",
                          value: function() {
                              this.mediaMgr = new MediaMgr({
                                  type: "applets"
                              }),
                              this.mediaMgr.setLogger(l.a),
                              this.tafLinkSignal.setTafWup(this.mediaMgr.getTaf()),
                              this._setPlayout()
                          }
                      }, {
                          key: "_setPlayout",
                          value: function() {
                              o.a.playoutUids.length > 0 ? o.a.playoutUids.indexOf(this.videoInfo.presenterUid) >= 0 && this.mediaMgr.setPlayout(o.a.minPlayout, o.a.maxPlayout) : this.mediaMgr.setPlayout(o.a.minPlayout, o.a.maxPlayout)
                          }
                      }, {
                          key: "_getVoiceProxy",
                          value: function(t) {
                              if (this.videoInfo) {
                                  this.started && this.stop(),
                                  l.a.log("WebrtcPlayer._getVoiceProxy: get voice proxy"),
                                  this.started = !0;
                                  var e = this.videoInfo.sStreamName;
                                  -1 === this.playerStreamList.indexOf(e) && this.playerStreamList.push(e),
                                  this.getVpStartTs = c.a.now(),
                                  this.tafLinkSignal.getVoiceProxy({
                                      streamName: e,
                                      presenterUid: this.videoInfo.presenterUid,
                                      clientType: 14,
                                      userid: z.a.uid
                                  }),
                                  k.a.add(this.onCheckFastTimer, this, 100),
                                  k.a.add(this.onCheckTimer, this, 1e3),
                                  k.a.add(this.onSendStatTimer, this, 2e4),
                                  k.a.add(this._getVoiceProxy, this, 1e4)
                              }
                          }
                      }, {
                          key: "setVolume",
                          value: function(t) {
                              t < 0 || this.video && (this.video.volume = t,
                              this.videoVolume = t)
                          }
                      }, {
                          key: "loadWebrtcPlayerLib",
                          value: function(t) {
                              Ii(t, this.libFile, this.callbacks)
                          }
                      }, {
                          key: "webrtcPlayerLibLoaded",
                          value: function() {
                              this.removeLibHandler(),
                              l.a.log("webrtcplayer lib complete"),
                              this.streamsWaiting.length > 0 ? this._playStreams(this.streamsWaiting.shift()) : this._initMediaMgr()
                          }
                      }, {
                          key: "webrtcPlayerTimeout",
                          value: function() {
                              this.removeLibHandler(),
                              l.a.log("webrtcplayer lib timeout")
                          }
                      }, {
                          key: "removeLibHandler",
                          value: function() {
                              Ai(this.libFile, this.callbacks)
                          }
                      }, {
                          key: "getConfig",
                          value: function(t) {
                              return this.hyPlayer.getConfig(t)
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {}
                      }, {
                          key: "onCheckFastTimer",
                          value: function(t, e) {
                              this.checkPause(t)
                          }
                      }, {
                          key: "onSendStatTimer",
                          value: function(t, e) {
                              if (this.qaStat) {
                                  var i = this.pauseStartTs > 0;
                                  this.sendMetricTimes++;
                                  var s = this._curAnchorDelayCnt > 0 ? parseInt(this._curAnchorDelaySum / this._curAnchorDelayCnt) : 0
                                    , a = this._curPlayDelayCnt > 0 ? parseInt(this._curPlayDelaySum / this._curPlayDelayCnt) : 0;
                                  this.qaStat.record(20 * this.sendMetricTimes, this.pauseCount, this.pauseTime, i, 0, 0, s, a),
                                  this.pauseCount = 0,
                                  this._curAnchorDelaySum = 0,
                                  this._curAnchorDelayCnt = 0,
                                  this._curPlayDelaySum = 0,
                                  this._curPlayDelayCnt = 0
                              }
                          }
                      }, {
                          key: "checkPause",
                          value: function(t) {
                              this.video && this.videoStatus !== r.b.BROWSER_PAUSE && (this.video.currentTime == this.lastCheckPlayTime ? 0 == this.pauseStartTs ? this.pauseStartTs = t : t - this.pauseStartTs > 200 && (this.paused || (this.pauseCount++,
                              this.paused = !0),
                              l.a.warn("Webrtcplayer.checkPause: video paused ".concat(t - this.pauseStartTs)),
                              t - this.pauseStartTs >= 5e3 && (l.a.warn("Video had been Paused ".concat(5e3, ", reload vp")),
                              this._getVoiceProxy())) : (this.pauseStartTs > 0 && t - this.pauseStartTs > 200 && (this.pauseTime += t - this.pauseStartTs),
                              this.paused = !1,
                              this.pauseStartTs = 0),
                              this.lastCheckPlayTime = this.video ? this.video.currentTime : 0)
                          }
                      }, {
                          key: "onPAudienceGetProxyListRsp",
                          value: function(t) {
                              l.a.log("WebrtcPlayer.onPAudienceGetProxyListRsp", t);
                              var e = (new Ja).parseInfo(t);
                              t.sslUrl && (this.sslUrl = t.sslUrl),
                              !e.streams || e.streams.size < 0 ? l.a.warn("WebrtcPlayer.onPAudienceGetProxyListRsp no streams") : (this.videoProxyInfos = e.videoProxyInfos,
                              this.getVpSuccessTs = c.a.now(),
                              window.MediaMgr ? this._playStreams(e) : this.streamsWaiting.push(e))
                          }
                      }, {
                          key: "_playStreams",
                          value: function(t) {
                              t.streams.forEach(this._playStreamGroupIds.bind(this))
                          }
                      }, {
                          key: "_playStreamGroupIds",
                          value: function(t, e) {
                              if (this.started && -1 != this.playerStreamList.indexOf(e)) {
                                  this.mediaMgr || this._initMediaMgr();
                                  var i = t.vStreamIdList[0]
                                    , s = t.aStreamIdList[0];
                                  this.mediaMgr.on(MediaMgr.ONVIDEOPLAY, this.onVideoPlay.bind(this)),
                                  this.mediaMgr.on(MediaMgr.ONPEERSTATS, this.onWebRtcStat.bind(this)),
                                  this.mediaMgr.on(MediaMgr.UPDATE_SEI_DATA, this.onUpdateSeiData.bind(this));
                                  var a = this._getIpPort();
                                  if ("" == a.ip || "" == a.port && "" == a.sslPort)
                                      l.a.log("WebrtcPlayer._playStreamGroupIds  no vp play"),
                                      this._videoError();
                                  else {
                                      var r = a.sslPort ? v.b.ip2uint(a.ip) + this.sslUrl : a.ip
                                        , n = a.sslPort ? a.sslPort : a.port;
                                      this.mediaMgr.connect(r, n, !!a.sslPort, i, s, z.a.uid),
                                      this.playerMap.set(e, this.mediaMgr)
                                  }
                              }
                          }
                      }, {
                          key: "_getIpPort",
                          value: function() {
                              if (this.videoProxyInfos.length > 0) {
                                  for (var t, e = "", i = "", s = null, a = 1; a < this.videoProxyInfos.length; a++)
                                      -1 == this.vpConnectedList.indexOf(this.videoProxyInfos[a].ip) && (this.vpConnectedList.push(this.videoProxyInfos[a].ip),
                                      s = this.videoProxyInfos[a]);
                                  if (s || (s = this.videoProxyInfos[0],
                                  this.vpConnectedList = []),
                                  t = s.ip,
                                  s.tcpPorts && s.tcpPorts.length > 0 && (e = s.tcpPorts[Math.floor(Math.random() * s.tcpPorts.length)]),
                                  s.videoProxyInfo && s.videoProxyInfo.has(8)) {
                                      var r = s.videoProxyInfo.get(8)
                                        , n = [65535 & r, r >> 16];
                                      i = n[Math.floor(Math.random() * n.length)]
                                  }
                                  return {
                                      ip: t,
                                      port: e,
                                      sslPort: i
                                  }
                              }
                              return {
                                  ip: "",
                                  port: ""
                              }
                          }
                      }, {
                          key: "getRecvInfo",
                          value: function() {
                              var t = [this.getVpSuccessTs - this.getVpStartTs];
                              if (this.mediaMgr && this.mediaMgr.getVideoPlayDelay) {
                                  var e = this.mediaMgr.getVideoPlayDelay();
                                  t.push(e.connectVPDelay),
                                  t.push(e.recvStreamIdDelay),
                                  t.push(e.waitingVideoDelay)
                              }
                              return t
                          }
                      }, {
                          key: "onVideoPlay",
                          value: function(t) {
                              this.started && (l.a.log("WebrtcPlayer.onVideoPlay", t),
                              k.a.remove(this._getVoiceProxy, this),
                              this.video != t.video && (this.video = t.video,
                              this.video.muted = !1,
                              this.videoVolume >= 0 && (this.video.volume = this.videoVolume),
                              l.a.log("WebrtcPlayer.onVideoPlay this.video.paused", this.video.paused),
                              this.updateStatus(r.b.VIDEO_PLAYING),
                              this.hyPlayer.trigger(r.a.VIDEO_PLAY, {
                                  video: t.video
                              }),
                              this.sendStat(),
                              this.video.paused && (this.hyPlayer.trigger(r.a.BROWSER_PAUSE),
                              this._initClickEvent())))
                          }
                      }, {
                          key: "sendNoVideoStat",
                          value: function() {
                              this.sendStat(!1)
                          }
                      }, {
                          key: "sendStat",
                          value: function() {
                              var t = !(arguments.length > 0 && void 0 !== arguments[0]) || arguments[0];
                              if (!this.videoDelaySended)
                                  if (this.videoDelaySended = !0,
                                  this.mediaMgr) {
                                      var e = this.mediaMgr.getVideoPlayDelay();
                                      this.hyPlayer.tsdbUtil.sendWebRtcTime(t ? c.a.now() - this.startLoadTime : 99999, this.getVpSuccessTs - this.getVpStartTs, e.connectVPDelay, e.recvStreamIdDelay, e.waitingVideoDelay)
                                  } else
                                      this.hyPlayer.tsdbUtil.sendWebRtcTime(99999, 0, 0, 0, 0)
                          }
                      }, {
                          key: "onWebRtcStat",
                          value: function(t) {}
                      }, {
                          key: "onUpdateSeiData",
                          value: function(t) {
                              var e = t.serverDts
                                , i = t.seiData
                                , s = t.playDelay || {};
                              this._curPlayDelay = s.delay > 0 ? s.delay : 0,
                              this._curKbps = s.kbps > 0 ? s.kbps : 0,
                              this._curPlayDelaySum += this._curPlayDelay,
                              this._curPlayDelayCnt++,
                              this._recordDelay(e, i)
                          }
                      }, {
                          key: "startJoinRoom",
                          value: function() {}
                      }, {
                          key: "updateStatus",
                          value: function(t) {
                              this.videoStatus !== t && (this.videoStatus = t,
                              this.hyPlayer.trigger(r.a.PLAY_STATUS, {
                                  status: t
                              }))
                          }
                      }, {
                          key: "_recordDelay",
                          value: function(t, e) {
                              if (X.isFinishNtp()) {
                                  var i = X.getSyncTime()
                                    , s = t - e.serverSei.dtsGapSum - e.anchorSei.frameDts
                                    , a = i - e.anchorSei.sendFrameTime - s;
                                  0 < a && a < 3e5 && (this._curAnchorDelay = i - e.anchorSei.caputureTime - s,
                                  this._curAnchorDelaySum += this._curAnchorDelay,
                                  this._curAnchorDelayCnt++)
                              }
                          }
                      }, {
                          key: "getDelayInfo",
                          value: function() {
                              var t = {
                                  total_delay: this._curAnchorDelay + this._curPlayDelay,
                                  buffer_delay: this._curPlayDelay,
                                  status: 0
                              };
                              return 0 === this._curAnchorDelay && 0 === this._curPlayDelay && (t.status = 1),
                              l.a.log("WebrtcPlayer.getDelayInfo: delay: ", t),
                              t
                          }
                      }, {
                          key: "getRealBitrate",
                          value: function() {
                              return this._curKbps
                          }
                      }, {
                          key: "_videoError",
                          value: function() {
                              this.stop(),
                              this.hyPlayer.onWebrtcVideoError(this.videoInfo)
                          }
                      }, {
                          key: "_addTafSignalEvents",
                          value: function() {
                              this.tafLinkSignal.on(j.a.PAudienceGetProxyListRsp, this.onPAudienceGetProxyListRsp.bind(this))
                          }
                      }, {
                          key: "_initClickEvent",
                          value: function() {
                              window && (window.addEventListener("click", this.clickEventBind, !1),
                              this.updateStatus(r.b.BROWSER_PAUSE))
                          }
                      }, {
                          key: "_clickEvent",
                          value: function() {
                              l.a.log("WebrtcPlayer._clickEvent: listen click event, video status is playing"),
                              this.video && this.video.play(),
                              this.updateStatus(r.b.VIDEO_PLAYING),
                              window && window.removeEventListener("click", this.clickEventBind, !1)
                          }
                      }, {
                          key: "hasPicture",
                          get: function() {
                              return this.videoStatus === r.b.VIDEO_PLAYING
                          }
                      }]),
                      t
                  }()
                    , Za = new (function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i() {
                          var t;
                          return Object(s.a)(this, i),
                          (t = e.call(this)).libName = "HYThree.js",
                          t.loaded = !1,
                          t.ON_LOAD = "on_load",
                          t.callbacks = {
                              onLoaded: t.onLoaded,
                              thisObj: Object(g.a)(t)
                          },
                          t
                      }
                      return Object(a.a)(i, [{
                          key: "loadLib",
                          value: function(t) {
                              this.loaded ? this.trigger(this.ON_LOAD) : Ii(t, this.libName, this.callbacks)
                          }
                      }, {
                          key: "onLoaded",
                          value: function() {
                              this.loaded = !0,
                              Ai(this.libName, this.callbacks),
                              window.HYThree && window.HYThree.default.init({
                                  logger: l.a
                              }),
                              this.trigger(this.ON_LOAD)
                          }
                      }, {
                          key: "createVr",
                          value: function(t, e) {
                              return window.HYThree ? window.HYThree.default.createVr(t, e) : null
                          }
                      }]),
                      i
                  }(H))
                    , $a = function() {
                      function t(e, i) {
                          Object(s.a)(this, t),
                          this._hyPlayer = e,
                          this._sampleContrllor = i.sampleController,
                          this._h265Proxy = i.h265Proxy,
                          this._statSwitch = i.statSwitch,
                          this._autoMonitor = i.autoMonitor,
                          this._recSysStat = i.recSysStat,
                          this._observer = ba(),
                          this._player = null,
                          this._onObserverBind = this._onObserver.bind(this),
                          this._observer.on(r.c.VIDEO_PLAY, this._onObserverBind),
                          this._observer.on(r.c.FLV_URL_UNAVAILABLE, this._onObserverBind),
                          this._observer.on(r.c.H5_PLAYER_ERROR, this._onObserverBind),
                          this._observer.on(r.c.NO_DATA_RECEIVED, this._onObserverBind),
                          this._observer.on(r.c.P2P_TIMEOUT, this._onObserverBind),
                          this._observer.on(r.c.FLV_TRY_TO_P2P, this._onObserverBind),
                          this._info = null,
                          this._data = null,
                          this._vr = null,
                          this._viewWidth = 0,
                          this._viewHeight = 0,
                          this._hyPlayer.setSize = this.setSize.bind(this),
                          this._hyPlayer.addViewport = this.addViewport.bind(this),
                          this._hyPlayer.getViewport = this.getViewport.bind(this),
                          this._hyPlayer.setViewport = this.setViewport.bind(this)
                      }
                      return Object(a.a)(t, [{
                          key: "_onObserver",
                          value: function(t, e) {
                              switch (t) {
                              case r.c.VIDEO_PLAY:
                                  this.onPlayVideo(t, e);
                                  break;
                              case r.c.FLV_URL_UNAVAILABLE:
                              case r.c.H5_PLAYER_ERROR:
                              case r.c.NO_DATA_RECEIVED:
                              case r.c.P2P_TIMEOUT:
                                  this._hyPlayer.trigger(t);
                                  break;
                              case r.c.FLV_TRY_TO_P2P:
                                  this._hyPlayer.lastP2PInfo && (this._hyPlayer.lastP2PInfo.vr.playerType = 1,
                                  this.start(this._hyPlayer.lastP2PInfo))
                              }
                          }
                      }, {
                          key: "destroy",
                          value: function() {
                              this.stop(),
                              this._data = null
                          }
                      }, {
                          key: "disposeVr",
                          value: function() {
                              this._vr && (this._vr.dispose(),
                              this._vr = null)
                          }
                      }, {
                          key: "disposePlayer",
                          value: function() {
                              this._player && (this._player.stop(),
                              this._player = null)
                          }
                      }, {
                          key: "start",
                          value: function(t) {
                              this.disposeVr(),
                              this.disposePlayer(),
                              l.a.log("VrPlayer.play", t),
                              this._info = t;
                              var e = {
                                  isPureAudio: !1,
                                  isPureVideo: !1,
                                  stat: this._hyPlayer.stat,
                                  tsdb: this._hyPlayer.tsdbUtil,
                                  sampleController: this._sampleContrllor,
                                  hyPlayer: this._hyPlayer,
                                  h265Proxy: this._h265Proxy,
                                  statSwitch: this._statSwitch,
                                  autoMonitor: this._autoMonitor,
                                  recSysStat: this._recSysStat
                              };
                              this._hyPlayer.stat.setComDim(d.a.DIM_COM.VR_MODE, t.vr && t.vr.type ? t.vr.type : 0);
                              var i = Object.assign({}, t);
                              1 === t.vr.playerType ? (i.type = Nr.P2P,
                              this._hyPlayer.lastP2PInfo = t,
                              this._player = new Ys(this._observer,e)) : (i.type = Nr.FLV,
                              this._player = new hs(this._observer,e),
                              this._hyPlayer.lastP2PInfo && (this._player.backToP2P.lastP2PInfo = this._hyPlayer.lastP2PInfo)),
                              this._player.start(i)
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              Za.off(Za.ON_LOAD, this.onLoadVrLib, this),
                              this._viewWidth = 0,
                              this._viewHeight = 0,
                              this.disposeVr(),
                              this.disposePlayer()
                          }
                      }, {
                          key: "setVolume",
                          value: function(t) {
                              this._player && this._player.setVolume(t)
                          }
                      }, {
                          key: "setMuted",
                          value: function(t) {
                              this._player && this._player.setMuted(t)
                          }
                      }, {
                          key: "getMuted",
                          value: function() {
                              return !!this._player && this._player.getMuted()
                          }
                      }, {
                          key: "getBufferLen",
                          value: function() {
                              return this._player ? this._player.getBufferLen() : 0
                          }
                      }, {
                          key: "getCurrentTime",
                          value: function() {
                              return this._player && this._player.getCurrentRealTime ? this._player.getCurrentRealTime() : this._player && this._player.getCurrentTime ? this._player.getCurrentTime() : 0
                          }
                      }, {
                          key: "getCurrentDts",
                          value: function() {
                              return this._player ? this._player.getCurrentDts() : 0
                          }
                      }, {
                          key: "getCurrentSeiOffsetDts",
                          value: function() {
                              return this._player ? this._player.getCurrentSeiOffsetDts() : 0
                          }
                      }, {
                          key: "play",
                          value: function() {
                              this._player && this._player.play()
                          }
                      }, {
                          key: "pause",
                          value: function() {
                              this._player && this._player.pause()
                          }
                      }, {
                          key: "setSize",
                          value: function(t, e) {
                              this._viewWidth = t,
                              this._viewHeight = e,
                              this._vr && this._vr.setSize(t, e)
                          }
                      }, {
                          key: "getViewport",
                          value: function() {
                              return this._vr ? this._vr.getViewport() : {
                                  x: 0,
                                  y: 0,
                                  z: 0
                              }
                          }
                      }, {
                          key: "setViewport",
                          value: function(t) {
                              this._vr && this._vr.setViewport(t)
                          }
                      }, {
                          key: "addViewport",
                          value: function(t) {
                              this._vr && this._vr.addViewport(t)
                          }
                      }, {
                          key: "onPlayVideo",
                          value: function(t, e) {
                              this._data = e,
                              this._info.vr.videoWidth = e.width,
                              this._info.vr.videoHeight = e.height,
                              Za.on(Za.ON_LOAD, this.onLoadVrLib, this),
                              Za.loadLib(this._info.h5Root)
                          }
                      }, {
                          key: "onLoadVrLib",
                          value: function() {
                              Za.off(Za.ON_LOAD, this.onLoadVrLib, this),
                              this._data.width = this._viewWidth || this._data.width,
                              this._data.height = this._viewHeight || this._data.height,
                              this._vr = Za.createVr(this._data.video, this._info.vr),
                              this._vr.play(),
                              this._hyPlayer.trigger(r.c.VIDEO_PLAY, {
                                  video: this._vr.getView(),
                                  width: this._data.width,
                                  height: this._data.height
                              })
                          }
                      }, {
                          key: "connected",
                          get: function() {
                              return !!this._player && this._player.connected
                          }
                      }, {
                          key: "isPlaying",
                          get: function() {
                              return !!this._player && this._player.isPlaying
                          }
                      }]),
                      t
                  }()
                    , tr = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this._mediaUserId = null,
                          this._bAnonymous = 0,
                          this._tryTimes = 0,
                          this._isLogin = !1,
                          this._roomId = 0
                      }
                      return Object(a.a)(t, [{
                          key: "loginMedia",
                          value: function(t, e, i) {
                              if (this._roomId = e,
                              !this._mediaUserId) {
                                  var s = new us.default.MediaUserId;
                                  s.lUid = i,
                                  s.sGuid = v.b.getCookie("guid"),
                                  s.sToken = t,
                                  s.sUA = "media_web&1000&",
                                  s.iAppid = z.a.appid,
                                  s.sStrUid = "",
                                  this._mediaUserId = s
                              }
                              this._login()
                          }
                      }, {
                          key: "_login",
                          value: function() {
                              this._mediaUserId.bAnonymous = this._bAnonymous;
                              var t = new us.default.LoginVerifyReq;
                              t.tId = this._mediaUserId,
                              u.default.sendWup("mediaui", "loginVerify", t, this._onLogin.bind(this), !0, u.default.getRequestId(), !0)
                          }
                      }, {
                          key: "_onLogin",
                          value: function(t) {
                              l.a.log("MediaLink._onLogin iResCode=".concat(t.iResCode)),
                              0 === t.iResCode ? (this._isLogin = !0,
                              this._mediaUserId.sCookie = t.sCookie,
                              this._join()) : 1 === t.iResCode && (this._tryTimes++,
                              this._tryTimes < 5 && (this._bAnonymous = 1,
                              this._login()))
                          }
                      }, {
                          key: "_join",
                          value: function() {
                              var t = new us.default.JoinMediaGroupReq;
                              t.tId = this._mediaUserId,
                              t.vGroupId.value = [this._roomId],
                              u.default.sendWup("mediaui", "joinGroup", t, this._onJoin.bind(this), !0, u.default.getRequestId(), !0)
                          }
                      }, {
                          key: "_onJoin",
                          value: function(t) {
                              l.a.log("MediaLink._onJoin iCode=".concat(t.iCode))
                          }
                      }, {
                          key: "quitMedia",
                          value: function() {
                              var t = new us.default.QuitMediaGroupReq;
                              t.tId = this._mediaUserId,
                              t.vGroupId.value = [this._roomId],
                              u.default.sendWup("mediaui", "quitGroup", t, this._onQuit.bind(this), !0, u.default.getRequestId(), !0)
                          }
                      }, {
                          key: "_onQuit",
                          value: function(t) {
                              l.a.log("MediaLink._onQuit iCode=".concat(t.iCode))
                          }
                      }]),
                      t
                  }()
                    , er = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i(t, a) {
                          var r;
                          return Object(s.a)(this, i),
                          (r = e.call(this, t, a)).player = null,
                          r.updating = !1,
                          r.seeking = !1,
                          r.waitSeekTime = 0,
                          r.onSeekBind = r.onSeek.bind(Object(g.a)(r)),
                          r.onM3u8UpdatedBind = r.onM3u8Updated.bind(Object(g.a)(r)),
                          r.m3u8UpdateTime = 30,
                          r
                      }
                      return Object(a.a)(i, [{
                          key: "start",
                          value: function(t) {
                              t.isLive = !1,
                              E(Object(S.a)(i.prototype), "start", this).call(this, t),
                              t.m3u8UpdateTime && (this.m3u8UpdateTime = Number(t.m3u8UpdateTime)),
                              this.seeking = !0,
                              this.player = new ea(this.eventEmitter,{
                                  stat: this.stat,
                                  tsdb: this.tsdb,
                                  sampleController: this.sampleController,
                                  h265Proxy: this.h265Proxy,
                                  autoMonitor: this.autoMonitor,
                                  recSysStat: this.recSysStat
                              }),
                              this.player.start(t),
                              k.a.add(this.onCheckTimer, this, 1e3),
                              this.eventEmitter.on(r.a.VIDEO_SEEK, this.onSeekBind),
                              this.eventEmitter.on(r.a.PLAYBACK_M3U8_UPDATED, this.onM3u8UpdatedBind)
                          }
                      }, {
                          key: "seek",
                          value: function(t) {
                              this.player && this.player.playlist && (this.seeking = !0,
                              this.player.playlist.totalDuration - t < 30 ? (this.waitSeekTime = t,
                              this.eventEmitter.trigger(r.a.NEED_UPDATE_M3U8)) : (this.waitSeekTime = 0,
                              this.player.seek(t)))
                          }
                      }, {
                          key: "onSeek",
                          value: function(t, e) {
                              this.seeking = !1
                          }
                      }, {
                          key: "onM3u8Updated",
                          value: function(t, e) {
                              l.a.log("PlaybackPlayer.onM3u8Updated totalDuration=".concat(e)),
                              this.waitSeekTime && (this.player.seek(this.waitSeekTime),
                              this.waitSeekTime = 0),
                              this.updating = !1
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              this.player && (this.player.stop(),
                              this.player = null),
                              this.seeking = !1,
                              k.a.remove(this.onCheckTimer, this),
                              this.eventEmitter.off(r.a.VIDEO_SEEK, this.onSeekBind),
                              this.eventEmitter.off(r.a.PLAYBACK_M3U8_UPDATED, this.onM3u8UpdatedBind)
                          }
                      }, {
                          key: "setVolume",
                          value: function(t) {
                              this.player && this.player.setVolume(t)
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              !this.updating && this.needUpdate() && (this.updating = !0,
                              this.eventEmitter.trigger(r.a.NEED_UPDATE_M3U8)),
                              !this.seeking && this.player && this.player.mse && this.player.playlist && this.eventEmitter.trigger(r.a.PLAYBACK_UPDATE, {
                                  currentTime: this.player.mse.getCurrentTime(),
                                  totalDuration: this.player.playlist.totalDuration
                              })
                          }
                      }, {
                          key: "needUpdate",
                          value: function() {
                              if (this.player && this.player.mse && this.player.playlist) {
                                  var t = this.player.mse.getCurrentTime() / 1e3;
                                  if (t > 0) {
                                      var e = this.player.playlist.totalDuration;
                                      if (e > 0)
                                          return e - t < this.m3u8UpdateTime
                                  }
                              }
                              return !1
                          }
                      }, {
                          key: "updateLiveVodUrl",
                          value: function(t) {
                              this.player && this.player.updateLiveVodUrl(t)
                          }
                      }]),
                      i
                  }(os)
                    , ir = i(22)
                    , sr = i.n(ir)
                    , ar = function() {
                      function t(e, i, a) {
                          Object(s.a)(this, t),
                          this.tsdb = e,
                          this.stat = i,
                          this.autoMonitor = null,
                          this.recSysStat = null,
                          this.autoForce = null,
                          this.lineType = -1,
                          this.curBitrate = -1,
                          this.isAuto = !1,
                          this.handler = a
                      }
                      return Object(a.a)(t, [{
                          key: "init",
                          value: function(t, e, i) {
                              this.autoMonitor = t,
                              this.recSysStat = e,
                              this.autoForce = i
                          }
                      }, {
                          key: "check",
                          value: function(t, e) {
                              if (!isNaN(t.lineType) && !isNaN(t.curBitrate) && -1 !== t.lineType) {
                                  if (-1 !== this.lineType) {
                                      var i = null;
                                      if (this.lineType !== t.lineType)
                                          i = this.stat.createAct(d.a.ACT.SWITCH_LINE, {
                                              value: [this.lineType, t.lineType]
                                          });
                                      else {
                                          var s = 1e3 * t.curBitrate
                                            , a = 1e3 * this.curBitrate
                                            , r = this.isAuto ? 1 : 0
                                            , n = 0;
                                          e ? this.curBitrate !== t.curBitrate && (n = 2) : t && 1 == t.pullStreamFrom && (n = 1);
                                          var o = [s, a, r, n, 0, 0, 1, t.bitrateList ? t.bitrateList.length : 0];
                                          1 == n && this.handler && (o[8] = c.a.now() - this.handler.inRoomTimeNow),
                                          1 === r && (this.recSysStat.recordAct(this.stat),
                                          1 === n && (this.autoForce.addForce(),
                                          this.recSysStat.removeItem(1))),
                                          this.autoMonitor.addSwitch(c.a.now(), s, a, n),
                                          i = this.stat.createAct(d.a.ACT.SWITCH_BITRATE, {
                                              value: o
                                          }),
                                          l.a.log("StatSwitch.reportSwitchBitrate value4=".concat(n, " metric="), i)
                                      }
                                      i && this.tsdb.sendMetrics([i])
                                  }
                                  this.lineType = t.lineType,
                                  this.curBitrate = t.curBitrate,
                                  this.isAuto = t.isAuto
                              }
                          }
                      }, {
                          key: "sendSwitchAuto",
                          value: function(t) {
                              t[0] === Ft ? this.stat.addComp(d.a.AUTO_INFO.name, d.a.AUTO_INFO.UP_CNT, 1) : t[0] === Mt ? this.stat.addComp(d.a.AUTO_INFO.name, d.a.AUTO_INFO.DOWN_CNT, 1) : t[0] === Ut && this.stat.addComp(d.a.AUTO_INFO.name, d.a.AUTO_INFO.BACK_CNT, 1);
                              var e = this.stat.createAct(d.a.ACT.SWITCH_AUTO, {
                                  value: t
                              });
                              this.tsdb.sendMetrics([e])
                          }
                      }, {
                          key: "sendSwitchCost",
                          value: function(t, e) {
                              this._sendMetric(d.a.ACT.SWITCH_COST, t, e)
                          }
                      }, {
                          key: "sendSwitchPts",
                          value: function(t, e) {
                              this._sendMetric(d.a.ACT.SWITCH_PTS, t, e)
                          }
                      }, {
                          key: "_sendMetric",
                          value: function(t, e, i) {
                              var s = this.stat.createAct(t, {
                                  value: e,
                                  str: i
                              });
                              this.tsdb.sendMetrics([s])
                          }
                      }]),
                      t
                  }()
                    , rr = function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i(t) {
                          var a, r = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 100;
                          return Object(s.a)(this, i),
                          (a = e.call(this, r)).duration = t,
                          a.lastTs = 0,
                          a
                      }
                      return Object(a.a)(i, [{
                          key: "addCur",
                          value: function(t, e) {
                              E(Object(S.a)(i.prototype), "addCur", this).call(this, t, e),
                              this.samples.addCur(t),
                              this.calculate(e)
                          }
                      }, {
                          key: "calculate",
                          value: function(t) {
                              0 === this.lastTs ? this.lastTs = t : t - this.lastTs >= this.duration && (this.lastTs = t,
                              this.samples.calculate())
                          }
                      }, {
                          key: "onCheckFastTimer",
                          value: function(t, e) {
                              this.calculate(t)
                          }
                      }]),
                      i
                  }(yt)
                    , nr = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.recvTotalSample = new rr(1e3),
                          this.recvLanSample = new rr(1e3),
                          this.realFlacSample = new Tt
                      }
                      return Object(a.a)(t, [{
                          key: "start",
                          value: function() {
                              k.a.add(this.onCheckFastTimer, this, 100)
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              k.a.remove(this.onCheckFastTimer, this)
                          }
                      }, {
                          key: "onCheckFastTimer",
                          value: function(t, e) {
                              this.recvTotalSample.onCheckFastTimer(t, e),
                              this.recvLanSample.onCheckFastTimer(t, e)
                          }
                      }, {
                          key: "addTotalSample",
                          value: function(t) {
                              this.recvTotalSample.addCur(t, c.a.now())
                          }
                      }, {
                          key: "recordStat",
                          value: function(t, e) {
                              this._recordStat(t, d.a.CORE.RECV_TOTAL_SAMPLE, this.recvTotalSample, !0, e),
                              this._recordStat(t, d.a.CORE.RECV_LAN_SAMPLE, this.recvLanSample, !0, e),
                              this._recordStat(t, d.a.CORE.REAL_FLAC_KBPS_SAMPLE, this.realFlacSample)
                          }
                      }, {
                          key: "_recordStat",
                          value: function(t, e, i, s, a) {
                              if (i.hasSample) {
                                  var r = i.getResult();
                                  "" !== r && (i.reset(),
                                  s ? t.setCoreDim(e, "type:".concat(a ? 2 : t.heart_type, ",").concat(r)) : t.setCoreDim(e, r))
                              }
                          }
                      }, {
                          key: "addLanSample",
                          value: function(t) {
                              this.recvLanSample.addCur(t, c.a.now())
                          }
                      }]),
                      t
                  }()
                    , or = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.handler = e,
                          this._duration = 0,
                          this._pauseTs = 0
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              this._duration = 0
                          }
                      }, {
                          key: "pause",
                          value: function() {
                              0 === this._pauseTs && (this._pauseTs = c.a.now())
                          }
                      }, {
                          key: "resume",
                          value: function() {
                              this.calc(!0)
                          }
                      }, {
                          key: "calc",
                          value: function(t) {
                              if (this._pauseTs > 0) {
                                  var e = c.a.now();
                                  this._duration += e - this._pauseTs,
                                  this._duration < 0 && (this._duration = 0),
                                  this._pauseTs = t ? 0 : e
                              }
                          }
                      }, {
                          key: "getRoomStat",
                          value: function() {
                              this.calc(!1);
                              var t = {
                                  duration: this._duration
                              };
                              return this.reset(),
                              t
                          }
                      }]),
                      t
                  }()
                    , hr = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.handler = e,
                          this.sessionId = this.handler.sdkInRoomTs,
                          this.lastRealTime = 0,
                          this.repeatPicTs = 0,
                          this.noRenderTs = 0,
                          this.roomNoRenderStat = new or(this),
                          this.roomNoRenderStat.pause(),
                          this.liveType = 1,
                          this.anchoruid = 0
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              this.lastRealTime = 0,
                              this.repeatPicTs = 0,
                              this.noRenderTs = 0
                          }
                      }, {
                          key: "getMetric",
                          value: function() {
                              var t = {
                                  sMetricName: d.a.ROOM_HEART60.name,
                                  vDimension: {},
                                  vExLog: {},
                                  vField: {}
                              };
                              return l.a.log("RoomRecord.getMetric", "repeatPicTs = ".concat(this.repeatPicTs, ", noRenderTs=").concat(this.noRenderTs)),
                              t.vDimension[d.a.ROOM_HEART60.SESSION_ID] = this.sessionId,
                              t.vDimension[d.a.ROOM_HEART60.NOW_TS] = this.sessionId,
                              t.vDimension[d.a.DIM_COM.P2P] = this.liveType,
                              this.repeatPicTs < 0 ? t.vField[d.a.ROOM_HEART60.REPEAT_PIC_TS] = 0 : t.vField[d.a.ROOM_HEART60.REPEAT_PIC_TS] = this.repeatPicTs,
                              t.vField[d.a.ROOM_HEART60.MAX_NO_RENDER_DU] = 0,
                              this.noRenderTs >= 6e4 && (this.noRenderTs = 6e4),
                              t.vField[d.a.ROOM_HEART60.NO_RENDER_DURATION] = this.noRenderTs,
                              t
                          }
                      }, {
                          key: "fillCore",
                          value: function(t, e) {
                              if (e.core)
                                  for (var i in e.core)
                                      t[i] = e.core[i]
                          }
                      }, {
                          key: "fillComp",
                          value: function(t, e, i) {
                              if (e.hasOwnProperty(i)) {
                                  var s = ""
                                    , a = e[i];
                                  for (var r in a)
                                      s.length > 0 && (s += ";"),
                                      s += r + "," + a[r];
                                  "" !== s && (t[i] = s)
                              }
                          }
                      }, {
                          key: "fillFlow",
                          value: function(t, e) {
                              if (e.bw)
                                  for (var i in e.bw) {
                                      var s = e.bw[i];
                                      s > 0 && (t[i] = s)
                                  }
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              var i = this.handler.getFrameData();
                              if (i && i.pts > 0) {
                                  var s = i.pts;
                                  s < this.lastRealTime && (this.repeatPicTs += this.lastRealTime - s),
                                  this.lastRealTime = s
                              }
                              if (e % 60 == 0) {
                                  this.getPauseStat();
                                  var a = this.getMetric();
                                  this.handler.trigger(r.c.DATA_METRIC2, [a]),
                                  this.reset()
                              }
                          }
                      }, {
                          key: "getPauseStat",
                          value: function() {
                              var t = this.roomNoRenderStat.getRoomStat().duration;
                              this.noRenderTs = t
                          }
                      }]),
                      t
                  }()
                    , ur = function() {
                      function t(e, i) {
                          Object(s.a)(this, t),
                          this.stat = e,
                          this.tsdb = i,
                          this.isP2PUseH265 = !0,
                          this.isFlvUseH265 = !0,
                          this.costUs = 0,
                          this.isCodecSupport = !1,
                          this.isBrowserSupport = !1,
                          this.isCfgSupport = !1
                      }
                      return Object(a.a)(t, [{
                          key: "onTurntoH264",
                          value: function(t) {
                              t === Nr.P2P ? this.isP2PUseH265 = !1 : t === Nr.FLV && (this.isFlvUseH265 = !1)
                          }
                      }, {
                          key: "init",
                          value: function(t) {
                              this.isCodecSupport = !1,
                              this.isBrowserSupport = !1,
                              this.isCfgSupport = !1,
                              this._initCodec(t),
                              this._initBrowser(),
                              this._initRandom(t),
                              this._initCfg(),
                              l.a.log("H265Support.init isCodecSupport=".concat(this.isCodecSupport, " isBrowserSupport=").concat(this.isBrowserSupport, " isCfgSupport=").concat(this.isCfgSupport))
                          }
                      }, {
                          key: "_initCodec",
                          value: function(t) {
                              var e = arguments;
                              if (1 == localStorage.open265 && (localStorage.w265LastCost = 0),
                              this.isReport265 || t.type === Nr.STREAM || (this.tsdb.sendMetrics([this.stat.createAct(d.a.ACT.H265_STATUS, {
                                  value: [10],
                                  str: [v.b.is64bitSoftware() ? 1 : 2]
                              })]),
                              this.tsdb.sendMetrics([this.stat.createAct(d.a.ACT.H265_STATUS, {
                                  value: [5],
                                  str: [navigator.hardwareConcurrency]
                              })]),
                              l.a.log("HYPlayer.initH265 support hardwareConcurrency hardwareConcurrency=", navigator.hardwareConcurrency),
                              this.isReport265 = !0),
                              this._isSupported(t) && sr.a && sr.a.getInstance) {
                                  var i = {
                                      enableWebH265: 1,
                                      baseCostUs: {
                                          2e3: 32e3,
                                          4e3: 3e4
                                      },
                                      loopCount: 100,
                                      singleThreadBitKbps: [10],
                                      multiThreadBitKbps: [4e3, 2e3, 500],
                                      threadCount: 2,
                                      degrade: 0,
                                      statIntervalMs: 1e3,
                                      fmt: 11,
                                      share: 0,
                                      wasmLoad: 500,
                                      core: {
                                          2e3: 3,
                                          4e3: 4
                                      },
                                      x86: {
                                          4e3: 1
                                      }
                                  }
                                    , s = {};
                                  v.b.is64bitSoftware() || (o.a.h265Config[3][1][1] = o.a.h265Config2[0]),
                                  1 == Number(o.a.h265Config2[1]) ? i.x86 = {
                                      4e3: 1
                                  } : i.x86 = {
                                      4e3: 0
                                  },
                                  o.a.h265Config[0][0].forEach((function(t, e) {
                                      s[t] = o.a.h265Config[0][1][e]
                                  }
                                  )),
                                  i.baseCostUs = s,
                                  i.multiThreadBitKbps = o.a.h265Config[1];
                                  var a = {};
                                  o.a.h265Config[3][0].forEach((function(t, e) {
                                      a[t] = o.a.h265Config[3][1][e]
                                  }
                                  )),
                                  i.core = a,
                                  1 === Number(localStorage._enable4000Bitrate) && (i.multiThreadBitKbps = [4e3, 2e3, 500],
                                  i.core = 2),
                                  sr.a.getInstance().parseConfigs(i);
                                  var r = sr.a.getInstance().isSupportH265(0 === t.originalBitrate ? 0 : t.curBitrate)
                                    , n = window.screen.height;
                                  1 != o.a.isH265Filter4MCfg[0] || 4e3 != t.curBitrate || v.b.isGameIdSupport265(o.a.h265GameIds, t.gameId) ? 1 == o.a.isH265Filter4MCfg[1] && 4e3 == t.curBitrate && -1 != navigator.userAgent.indexOf("Macintosh") ? (r.isSupport = !1,
                                  r.reason = 101) : 1 == o.a.isH265Filter4MCfg[2] && 4e3 == t.curBitrate && n < (o.a.isH265Filter4MCfg[3] || 1080) && (r.isSupport = !1,
                                  r.reason = 102) : (r.isSupport = !1,
                                  r.reason = 100),
                                  l.a.log("H265Support.initH265 bitRate", 0 === t.originalBitrate ? 0 : t.curBitrate, r),
                                  this.isCodecSupport = r.isSupport,
                                  this.costUs = r.costUs,
                                  this.tsdb.sendMetrics([this.stat.createAct(d.a.ACT.H265_STATUS, {
                                      value: [2],
                                      str: [r.reason]
                                  })]),
                                  sr.a.getInstance().setLogCallback((function() {
                                      var t = ["H265 render setLogCallback"].concat(Array.apply(null, e));
                                      l.a.log.apply(l.a, t)
                                  }
                                  ))
                              }
                          }
                      }, {
                          key: "_isSupported",
                          value: function(t) {
                              var e;
                              return e = t.iIsHEVCSupport > 0 && t.iHEVCBitRate >= 0 || this._isH265(t.iCodecType) && 0 === t.iBitRate,
                              t.type === Nr.FLV ? this.isFlvUseH265 && e : t.type === Nr.P2P && this.isP2PUseH265 && e
                          }
                      }, {
                          key: "_isH265",
                          value: function(t) {
                              return 1 === t || 4 === t || 6 === t || 8 === t
                          }
                      }, {
                          key: "_initBrowser",
                          value: function() {
                              var t = _.a.version.major
                                , e = !1;
                              _.a.chrome && t >= o.a.h265Config[2] && (e = !0),
                              1 === Number(localStorage._enableBrowser) && (e = !0),
                              this.isBrowserSupport = e
                          }
                      }, {
                          key: "_initRandom",
                          value: function(t) {
                              var e = this._getRandomUse(t);
                              this.isCodecSupport && (e ? this.stat.setComDim("backup_field2", 1) : (this.isCodecSupport = !1,
                              this.stat.setComDim("backup_field2", 2))),
                              t.randomH265 = e
                          }
                      }, {
                          key: "_getRandomUse",
                          value: function(t) {
                              var e = localStorage.h265PresentUid
                                , i = t.presenterUid
                                , s = !0;
                              if (o.a.h265BlackUids.forEach((function(t) {
                                  i && t.toString() == i.toString() && (s = !1)
                              }
                              )),
                              !s)
                                  return !1;
                              localStorage.randomH265Percent && e == i || (localStorage.randomH265Percent = o.a.randomH265Percent),
                              1 == localStorage.open265 ? localStorage.randomH265Percent = 3e3 : 2 == localStorage.open265 && (localStorage.randomH265Percent = 6e3);
                              var a = Number(localStorage.randomH265Percent);
                              return localStorage.h265PresentUid = t.presenterUid,
                              a < o.a.h265PercentConfig
                          }
                      }, {
                          key: "_initCfg",
                          value: function() {
                              this.isCfgSupport = 1 === Number(o.a.isConfigSupportH265)
                          }
                      }, {
                          key: "isSupported",
                          get: function() {
                              return this.isCodecSupport && this.isBrowserSupport && this.isCfgSupport
                          }
                      }, {
                          key: "canPreload",
                          get: function() {
                              return this.isBrowserSupport && this.isCfgSupport
                          }
                      }]),
                      t
                  }()
                    , lr = function() {
                      function t(e, i) {
                          Object(s.a)(this, t),
                          this._stat = e,
                          this._tsdb = i,
                          this._onMessageBind = this._onMessage.bind(this),
                          this._onErrorBind = this._onError.bind(this),
                          this._startTs = 0,
                          this._readyTs = 0,
                          this._isReady = !1,
                          this._isTimeout = !1,
                          this._isError = !1,
                          this._decoder = null,
                          this._callbacks = null,
                          this._onMessageCb = null
                      }
                      return Object(a.a)(t, [{
                          key: "terminate",
                          value: function() {
                              l.a.log("H265Decoder.terminate"),
                              this._destroyDecoder(),
                              k.a.remove(this._onTimeout, this),
                              this._callbacks = null,
                              this._onMessageCb = null,
                              this._isReady = !1,
                              this._startTs = 0,
                              this._readyTs = 0
                          }
                      }, {
                          key: "destroy",
                          value: function() {
                              l.a.log("H265Decoder.destroy"),
                              this._stat = null,
                              this._tsdb = null,
                              this.stopDecoder()
                          }
                      }, {
                          key: "_destroyDecoder",
                          value: function() {
                              if (this._decoder) {
                                  this._decoder.onmessage = null,
                                  this._decoder.onerror = null,
                                  this.stopDecoder();
                                  try {
                                      this._decoder.terminate()
                                  } catch (t) {
                                      l.a.log("H265Decoder._destroyDecoder", t)
                                  }
                                  this._decoder = null
                              }
                          }
                      }, {
                          key: "stopDecoder",
                          value: function() {
                              this._decoder && this._decoder.postMessage({
                                  t: 6
                              })
                          }
                      }, {
                          key: "load",
                          value: function(t, e) {
                              if (this._callbacks = e,
                              this._decoder)
                                  this._callbacks && this._callbacks.ready();
                              else {
                                  var i = _.a.chrome && _.a.version.major >= 91;
                                  1 == Number(localStorage._unSupportSimd) && (i = !1),
                                  l.a.log("H265Decoder.load"),
                                  this._startTs = c.a.now();
                                  var s = 'importScripts("'.concat(t + (i ? "decoder.worker.simd.js" : "decoder.worker.js"), '")')
                                    , a = new Blob([s],{
                                      type: "application/javascript"
                                  })
                                    , r = window.URL.createObjectURL(a)
                                    , n = new Worker(r);
                                  n.onmessage = this._onMessageBind,
                                  n.onerror = this._onErrorBind,
                                  this._decoder = n,
                                  k.a.once(this._onTimeout, this, 1e3)
                              }
                          }
                      }, {
                          key: "_onMessage",
                          value: function(e) {
                              switch (e.data.t) {
                              case 0:
                                  this._decoder.postMessage({
                                      t: 1
                                  });
                                  break;
                              case 2:
                                  l.a.log("H265Decoder._onMessage worker isReady!"),
                                  k.a.remove(this._onTimeout, this),
                                  t.preloaded = !0,
                                  this._isReady = !0,
                                  this._readyTs = c.a.now();
                                  var i = this._readyTs - this._startTs;
                                  this._tsdb.sendMetrics([this._stat.createAct(d.a.ACT.H265_WORKER_LOAD_TS, {
                                      value: [i]
                                  })]),
                                  this._isError || this._isTimeout || this._callbacks && this._callbacks.ready()
                              }
                              this._onMessageCb && this._onMessageCb(e)
                          }
                      }, {
                          key: "_onError",
                          value: function(t) {
                              l.a.error("H265Decoder._onError", t),
                              this._tsdb.sendMetrics([this._stat.createAct(d.a.ACT.H265_STATUS, {
                                  value: [1],
                                  str: [11]
                              })]),
                              this._destroyDecoder(),
                              k.a.remove(this._onTimeout, this),
                              this._readyTs = 0,
                              this._isReady = !1,
                              this._isError = !0,
                              localStorage.h265WorkerError = 1,
                              this._callbacks && this._callbacks.error()
                          }
                      }, {
                          key: "_onTimeout",
                          value: function() {
                              l.a.log("H265Decoder._onTimeout"),
                              this._destroyDecoder(),
                              this._readyTs = 0,
                              this._isTimeout = !0,
                              this._isReady = !1,
                              this._callbacks && this._callbacks.timeout()
                          }
                      }, {
                          key: "onMessageCb",
                          set: function(t) {
                              this._onMessageCb = t
                          }
                      }, {
                          key: "decoder",
                          get: function() {
                              return this._decoder
                          }
                      }, {
                          key: "isReady",
                          get: function() {
                              return this._isReady
                          }
                      }]),
                      t
                  }();
                  lr.preloaded = !1;
                  var cr = lr
                    , dr = i(69).default
                    , pr = function() {
                      function t(e, i) {
                          Object(s.a)(this, t),
                          this._stat = e,
                          this._tsdb = i,
                          this._support = new ur(e,i),
                          this._decoder = new cr(e,i),
                          this._render = new dr(e,i),
                          this._renderInited = !1,
                          this._rendering = !1
                      }
                      return Object(a.a)(t, [{
                          key: "stop",
                          value: function() {
                              l.a.log("H265Proxy.stop"),
                              this._rendering = !1,
                              this._renderInited = !1,
                              this._decoder.stopDecoder(),
                              this._render.destroy()
                          }
                      }, {
                          key: "destroy",
                          value: function() {
                              this._render.destroy(),
                              this._support.destroy(),
                              this._decoder.destroy(),
                              this._stat = null,
                              this._tsdb = null,
                              this._render = null,
                              this._support = null,
                              this._decoder = null
                          }
                      }, {
                          key: "initSupport",
                          value: function(t) {
                              this._support.init(t)
                          }
                      }, {
                          key: "loadDecoder",
                          value: function(t, e) {
                              this._decoder.load(t, e)
                          }
                      }, {
                          key: "initRender",
                          value: function(t) {
                              l.a.log("H265Proxy.initRender isSupported=".concat(this._support.isSupported, " isReady=").concat(this._decoder.isReady)),
                              this._rendering = !1,
                              this._renderInited = !1,
                              this._render.destroy(),
                              this.isReady && (this._renderInited = !0,
                              this._render.attachMse(t))
                          }
                      }, {
                          key: "terminate",
                          value: function() {
                              this._decoder.terminate()
                          }
                      }, {
                          key: "containerResize",
                          value: function(t) {
                              this.rendering && this._render.containerResize(t)
                          }
                      }, {
                          key: "pushVideoFrame",
                          value: function(t, e) {
                              this._rendering = !0,
                              this._render && this._render.pushVideoFrame(t, e)
                          }
                      }, {
                          key: "onTurnToH264",
                          value: function(t) {
                              this._rendering = !1,
                              this._renderInited = !1,
                              this._support.onTurntoH264(t)
                          }
                      }, {
                          key: "checkUrl",
                          value: function(t) {
                              this.isReady && -1 === t.url.indexOf("codec=265") && (t.url += "&codec=265")
                          }
                      }, {
                          key: "on265StartCodeError",
                          value: function(t) {
                              this._render && this._render.handlerError(t)
                          }
                      }, {
                          key: "reportDecodeRenderTime",
                          value: function(t, e) {
                              this._render && this._render.reportDecodeRenderTime(t, e)
                          }
                      }, {
                          key: "getStats",
                          value: function() {
                              return this._render.getStats()
                          }
                      }, {
                          key: "jumpBuffer",
                          value: function(t, e, i, s) {
                              this._rendering && this._render.jumpBuffer(t, e, i, s)
                          }
                      }, {
                          key: "render",
                          get: function() {
                              return this._render
                          }
                      }, {
                          key: "canvas",
                          get: function() {
                              return this._render.canvas
                          }
                      }, {
                          key: "decoder",
                          get: function() {
                              return this._decoder
                          }
                      }, {
                          key: "isSupported",
                          get: function() {
                              return this._support.isSupported
                          }
                      }, {
                          key: "isReady",
                          get: function() {
                              return this._support.isSupported && this._decoder.isReady
                          }
                      }, {
                          key: "needPreload",
                          get: function() {
                              return !cr.preloaded && this._support.canPreload && !this._decoder.isReady
                          }
                      }, {
                          key: "renderInited",
                          get: function() {
                              return this._renderInited
                          }
                      }, {
                          key: "rendering",
                          get: function() {
                              return this._rendering
                          }
                      }]),
                      t
                  }()
                    , fr = new (function(t) {
                      Object(I.a)(i, t);
                      var e = Object(A.a)(i);
                      function i(t) {
                          var a;
                          return Object(s.a)(this, i),
                          (a = e.call(this)).loadCount = 0,
                          a.libName = "mainlib.js",
                          a.loaded = !1,
                          a.p2pLib = null,
                          a.ON_LOAD = "on_mainlib_load",
                          a.callbacks = {
                              onLoaded: a.onLoaded,
                              onError: a.onLoadedError,
                              thisObj: Object(g.a)(a)
                          },
                          a
                      }
                      return Object(a.a)(i, [{
                          key: "hasLib",
                          value: function() {
                              return null !== window.MainLib
                          }
                      }, {
                          key: "loadLib",
                          value: function(t) {
                              this.loadCount >= 3 ? Ai(this.libName, this.callbacks) : (this.loadCount++,
                              t ? (this.root = t,
                              this.loaded ? this.trigger(this.ON_LOAD) : Ii(t, this.libName, this.callbacks)) : l.a.warn("MainLibProxy.loadLib root none"))
                          }
                      }, {
                          key: "onLoadedError",
                          value: function() {
                              this.loadLib(this.root)
                          }
                      }, {
                          key: "onLoaded",
                          value: function() {
                              Ai(this.libName, this.callbacks),
                              window.MainLib && (this.loaded = !0,
                              this.mainlib = new MainLib({
                                  UserInfo: z.a,
                                  roomInfo: null,
                                  config: o.a,
                                  TafLink: u.default,
                                  Timer: k.a,
                                  TimeUtil: c.a,
                                  logger: l.a,
                                  HUYA: us.default,
                                  Taf: Fs,
                                  hyPlayer: this.hyPlayer,
                                  Const: C.a,
                                  Event: r.a,
                                  StatCfg: d.a,
                                  P2PLibProxy: Ms,
                                  Ntp: X,
                                  AverageCalculator: y,
                                  NtpInfo: K,
                                  Utils: v.b,
                                  ProtoLink: fi,
                                  Status: r.b,
                                  MetadataTick: te,
                                  AacFrame: N,
                                  MSEPlayer: Qt
                              }),
                              this.trigger(this.ON_LOAD))
                          }
                      }]),
                      i
                  }(H))
                    , _r = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.handler = e,
                          this.libLoaded = !1,
                          this.StreamPlayer = null,
                          this.playInfo = null,
                          fr.on(fr.ON_LOAD, this.onLoadLib, this)
                      }
                      return Object(a.a)(t, [{
                          key: "onLoadLib",
                          value: function() {
                              this.libLoaded = !0,
                              this.play(this.playInfo)
                          }
                      }, {
                          key: "play",
                          value: function(t) {
                              this.playInfo = t,
                              (this.libLoaded || fr.loaded) && (this.StreamPlayer = new window.MainLib.StreamPlayer(this.handler),
                              this.StreamPlayer.start(t))
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              this.reset(),
                              this.StreamPlayer && this.StreamPlayer.stop()
                          }
                      }, {
                          key: "reset",
                          value: function() {}
                      }]),
                      t
                  }()
                    , mr = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.handler = e,
                          this.libLoaded = !1,
                          this.huyaMgr = null,
                          this.voiceStreamMgr = null,
                          this.liveMeetingMgr = null,
                          this.pureAudioMgr = null,
                          this.startVoiceInfo = null,
                          this.liveMeetingObj = null,
                          this.auidoInfos = null,
                          this.meetingStatByUidRsp = null,
                          this.isLiveMeeting = !1,
                          this.isPlayAudio = !1,
                          this.isVoice = !1,
                          this.isSetMeetingStat = !1,
                          fr.on(fr.ON_LOAD, this.onLoadLib.bind(this), this)
                      }
                      return Object(a.a)(t, [{
                          key: "init",
                          value: function() {
                              (this.libLoaded || fr.loaded) && this.createVoice()
                          }
                      }, {
                          key: "createVoice",
                          value: function() {
                              try {
                                  this.huyaMgr || (this.huyaMgr = new window.MainLib.HuyaMgr(this.handler),
                                  this.voiceStreamMgr = new window.MainLib.VoiceStreamMgr(this.handler,this.huyaMgr),
                                  this.liveMeetingMgr = new window.MainLib.LiveMeetingMgr(this.handler,this.huyaMgr),
                                  this.pureAudioMgr = new window.MainLib.AudioMgr(this.handler,this.huyaMgr))
                              } catch (t) {
                                  l.a.error("VoiceMgr.createVoice", t)
                              }
                          }
                      }, {
                          key: "onLoadLib",
                          value: function() {
                              this.libLoaded = !0,
                              this.createVoice(),
                              this.loadedPlay()
                          }
                      }, {
                          key: "loadedPlay",
                          value: function() {
                              (this.libLoaded || fr.loaded) && (this.isVoice && this.startVoiceStreamMgr(this.startVoiceInfo),
                              this.isLiveMeeting && this.startLiveMeeting(this.liveMeetingObj.presenterUid, this.liveMeetingObj.sid, this.liveMeetingObj.subSid),
                              this.isPlayAudio && this.updateAudioPlay(this.auidoInfos),
                              this.isSetMeetingStat && this.setMeetingStat())
                          }
                      }, {
                          key: "startVoiceStreamMgr",
                          value: function(t) {
                              this.isVoice = !0,
                              this.startVoiceInfo = t,
                              (this.libLoaded || fr.loaded) && (this.voiceStreamMgr && this.voiceStreamMgr.getLivingStreamInfo(t),
                              this.isVoice = !1)
                          }
                      }, {
                          key: "startLiveMeeting",
                          value: function(t, e, i) {
                              this.isLiveMeeting = !0,
                              this.liveMeetingObj = {
                                  presenterUid: t,
                                  sid: e,
                                  subSid: i
                              },
                              (this.libLoaded || fr.loaded) && (this.liveMeetingMgr && this.liveMeetingMgr.start(t, e, i),
                              this.isLiveMeeting = !1)
                          }
                      }, {
                          key: "setMeetingStat",
                          value: function(t) {
                              this.isSetMeetingStat = !0,
                              this.meetingStatByUidRsp = t,
                              (this.libLoaded || fr.loaded) && (this.liveMeetingMgr && this.liveMeetingMgr.setMeetingStat(t),
                              this.isSetMeetingStat = !1)
                          }
                      }, {
                          key: "updateAudioPlay",
                          value: function() {
                              var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : [];
                              this.isPlayAudio = !0,
                              this.auidoInfos = t,
                              (this.libLoaded || fr.loaded) && (this.pureAudioMgr && this.pureAudioMgr.updateAudioPlay(t),
                              this.isPlayAudio = !1)
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              this.reset()
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              this.startVoiceInfo = null,
                              this.liveMeetingObj = null,
                              this.auidoInfos = null,
                              this.meetingStatByUidRsp = null
                          }
                      }]),
                      t
                  }()
                    , vr = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.handler = e,
                          this.libLoaded = !1,
                          this.videoPixelate = null,
                          this.videoPixelateBox = null,
                          this.playInfo = null,
                          fr.on(fr.ON_LOAD, this.onLoadLib, this)
                      }
                      return Object(a.a)(t, [{
                          key: "onLoadLib",
                          value: function() {
                              this.libLoaded = !0,
                              this.init()
                          }
                      }, {
                          key: "init",
                          value: function() {
                              this.videoPixelate = new window.MainLib.VideoPixelateUtil(this.handler,this.handler.stat),
                              this.playInfo && this.setEnablePixelate(this.playInfo),
                              this.videoPixelateBox && this.setVideoPixelateBox(this.videoPixelateBox)
                          }
                      }, {
                          key: "setVideoPixelate",
                          value: function() {
                              if (this.handler.player && this.handler.player.mse && this.videoPixelate && this.videoPixelateBox) {
                                  var t = this.handler.player.mse || {}
                                    , e = this.videoPixelateBox;
                                  this.videoPixelate.setVideoPixelateBox({
                                      viewElm: e,
                                      mse: t
                                  })
                              }
                          }
                      }, {
                          key: "setVideoPixelateBox",
                          value: function(t) {
                              t ? (this.videoPixelateBox = t,
                              (this.libLoaded || fr.loaded) && this.setVideoPixelate()) : l.a.warn("video pixelate box is null")
                          }
                      }, {
                          key: "setEnablePixelate",
                          value: function(t) {
                              this.playInfo = t,
                              (this.libLoaded || fr.loaded) && this.videoPixelate && this.videoPixelate.setEnablePixelate(t)
                          }
                      }, {
                          key: "containerResize",
                          value: function(t) {
                              this.videoPixelate && this.videoPixelate.containerResize(t)
                          }
                      }, {
                          key: "pushVideoPixlateInfo",
                          value: function(t) {
                              this.videoPixelate && this.videoPixelate.pushVideoPixlateInfo(t)
                          }
                      }, {
                          key: "destory",
                          value: function() {
                              this.videoPixelate && this.videoPixelate.destory(),
                              this.playInfo = null
                          }
                      }]),
                      t
                  }()
                    , yr = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.hyPlayer = e,
                          this.hasEvent = !1,
                          this.isSupported = void 0 !== document.addEventListener && void 0 !== document.hidden,
                          this.onVisibilitychangeBind = this.onVisibilitychange.bind(this),
                          this.stat = null
                      }
                      return Object(a.a)(t, [{
                          key: "setStat",
                          value: function(t) {
                              this.stat = t,
                              this.onVisibilitychange(),
                              this.addVisibilitychange()
                          }
                      }, {
                          key: "addVisibilitychange",
                          value: function() {
                              !this.hasEvent && this.isSupported && (this.hasEvent = !0,
                              document.addEventListener("visibilitychange", this.onVisibilitychangeBind))
                          }
                      }, {
                          key: "delVisibilitychange",
                          value: function() {
                              this.hasEvent && (this.hasEvent = !1,
                              document.removeEventListener("visibilitychange", this.onVisibilitychangeBind))
                          }
                      }, {
                          key: "onVisibilitychange",
                          value: function() {
                              this.isSupported && (l.a.log("Visibility.onVisibilitychange visibilityState=".concat(document.visibilityState)),
                              this.stat && this.stat.setComDim(d.a.DIM_COM.VISIBILITY_STATE, document.visibilityState),
                              this.hyPlayer.trigger(r.a.VISIBILITY_CHANGE))
                          }
                      }]),
                      t
                  }()
                    , Tr = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this._buffer = -1
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              this._buffer = -1
                          }
                      }, {
                          key: "buffer",
                          get: function() {
                              return this._buffer
                          },
                          set: function(t) {
                              (-1 === this._buffer || t < this._buffer) && (this._buffer = t < 0 ? 0 : t)
                          }
                      }]),
                      t
                  }()
                    , gr = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this._badBuffer = new Tr
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              this._badBuffer.reset()
                          }
                      }, {
                          key: "setItem",
                          value: function(t) {
                              this._badBuffer.buffer = t.badBuffer
                          }
                      }, {
                          key: "setBuffers",
                          value: function(t) {
                              this._badBuffer.buffer = t
                          }
                      }, {
                          key: "badBuffer",
                          get: function() {
                              return this._badBuffer.buffer
                          }
                      }]),
                      t
                  }()
                    , Sr = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.autoBuffer = new gr,
                          this.videoBuffer = new gr
                      }
                      return Object(a.a)(t, [{
                          key: "reset",
                          value: function() {
                              this.autoBuffer.reset(),
                              this.videoBuffer.reset()
                          }
                      }]),
                      t
                  }()
                    , Pr = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.stat = null,
                          this.endTs = 0,
                          this.pausedStartTs = 0,
                          this.isInTime = !1,
                          this.switchType = 0,
                          this.switchCodecType = 0,
                          this.recordCodecType = 0,
                          this.heartType = 0,
                          this.monitorTime = Number(o.a.autoCfg.monitorTime),
                          this.tempBuffer = new Sr,
                          this.usefulBuffer = new Sr,
                          this._continueBuffer = -1,
                          this._badReasons = 0,
                          this._minReason = 0
                      }
                      return Object(a.a)(t, [{
                          key: "init",
                          value: function(t) {
                              this.stat = t
                          }
                      }, {
                          key: "start",
                          value: function(t, e) {
                              0 === this.endTs && (this._badReasons = 0,
                              this._minReason = 0),
                              this.switchType = t,
                              this.switchCodecType = e,
                              l.a.log("AutoSwitchMonitor.start"),
                              this.endTs = c.a.now() + this.monitorTime,
                              this.pausedStartTs > 0 && (this.isInTime = !0,
                              this.tempBuffer.autoBuffer.setItem(this.tempBuffer.videoBuffer)),
                              this._checkStat(),
                              k.a.add(this.onCheckTimer, this, 100)
                          }
                      }, {
                          key: "_checkStat",
                          value: function() {
                              this.endTs > c.a.now() ? (this.heartType = this._getHeartType(),
                              this.recordCodecType = this.switchCodecType) : (this.heartType = 0,
                              this.recordCodecType = 0)
                          }
                      }, {
                          key: "recordHeartType",
                          value: function() {
                              this.stat.setCoreDim(d.a.DIM_CORE.AUTO_HEART_TYPE, this.heartType),
                              this.stat.setCoreDim(d.a.DIM_CORE.AUTO_CODEC_CHANGE_TYPE, this.recordCodecType),
                              this.stat.setCoreDim(d.a.CORE.AUTO_BAD_BUFFER, this.usefulBuffer.autoBuffer.badBuffer),
                              this.stat.setCoreDim(d.a.CORE.VIDEO_BAD_BUFFER, this.usefulBuffer.videoBuffer.badBuffer),
                              this.stat.setCore(d.a.CORE.AUTO_CONTINUE_BUFFER, this._continueBuffer),
                              this.usefulBuffer.reset(),
                              this._continueBuffer = -1,
                              this._checkStat()
                          }
                      }, {
                          key: "_getHeartType",
                          value: function() {
                              return this.switchType === Ft ? 1 : 2
                          }
                      }, {
                          key: "stop",
                          value: function() {
                              this.endTs = 0,
                              k.a.remove(this.onCheckTimer, this)
                          }
                      }, {
                          key: "addBadReason",
                          value: function(t) {
                              this._badReasons |= t;
                              var e = Math.log2(t) + 1;
                              (0 === this._minReason || this._minReason > e) && (this._minReason = e)
                          }
                      }, {
                          key: "addSwitch",
                          value: function(t, e, i, s) {
                              1 === s && (l.a.log("AutoSwitchMonitor.addSwitch"),
                              this.stat.addCore(d.a.CORE.AUTO_SWITCH_CNT, 1),
                              e === i && this.stat.addCore(d.a.CORE.AUTO_SWITCH_SAME_CNT, 1),
                              this.endTs > t && (e === i && this.stat.addCore(d.a.CORE.AUTO_BAD_SWITCH_SAME, 1),
                              this.switchType === Ft && this.stat.addCore(d.a.CORE.AUTO_BAD_SWITCH_UP, 1),
                              this.stat.addCore(d.a.CORE.AUTO_BAD_SWITCH, 1)))
                          }
                      }, {
                          key: "addBadQuality",
                          value: function(t, e, i, s) {
                              l.a.log("AutoSwitchMonitor.addBadQuality isIntime=".concat(this.isInTime, " pausedStartTs=").concat(this.pausedStartTs, " endTs=").concat(this.endTs, " now=").concat(t)),
                              this.usefulBuffer.videoBuffer.setItem(this.tempBuffer.videoBuffer),
                              this.isInTime && (this.usefulBuffer.autoBuffer.setItem(this.tempBuffer.autoBuffer),
                              this.stat.addCore(d.a.CORE.AUTO_BAD_QUALITY, 1),
                              this.stat.addCore(d.a.CORE.AUTO_BAD_DURATION, e),
                              this.stat.setCoreDim(d.a.DIM_CORE.AUTO_BAD_REASON, this._badReasons),
                              this.stat.setCoreDim(d.a.DIM_CORE.AUTO_BAD_MIN_REASON, this._minReason),
                              this._continueBuffer = s,
                              this.switchType === Ft && (this.stat.addCore(d.a.CORE.AUTO_BAD_QUALITY_UP, 1),
                              this.stat.addCore(d.a.CORE.AUTO_BAD_DURATION_UP, e))),
                              i !== rs && (this.pausedStartTs = 0,
                              this.isInTime = !1),
                              this.tempBuffer.reset()
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(t, e) {
                              t >= this.endTs && (l.a.log("AutoSwitchMonitor.onCheckTimer stop."),
                              this.stat.setCore(d.a.CORE.AUTO_BAD_DONE, 1),
                              this.stop())
                          }
                      }, {
                          key: "resetPausedTs",
                          value: function() {
                              this.tempBuffer.reset(),
                              this.pausedStartTs = 0,
                              this.isInTime = !1
                          }
                      }, {
                          key: "setPause",
                          value: function(t, e) {
                              l.a.log("AutoSwitchMonitor.setPause now=".concat(t, " buffer=").concat(e, " endTs=").concat(this.endTs)),
                              this.pausedStartTs = t,
                              this.tempBuffer.videoBuffer.setBuffers(e),
                              this.endTs > t ? (this.isInTime = !0,
                              this.tempBuffer.autoBuffer.setBuffers(e)) : this.isInTime = !1
                          }
                      }]),
                      t
                  }()
                    , Er = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this.scene = e,
                          this.sDispatchId = "",
                          this.expiredTime = 0
                      }
                      return Object(a.a)(t, [{
                          key: "isExpired",
                          value: function(t) {
                              return t > this.expiredTime
                          }
                      }]),
                      t
                  }()
                    , Ir = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this._sysMap = new Map
                      }
                      return Object(a.a)(t, [{
                          key: "addItem",
                          value: function(t, e, i) {
                              l.a.log("RecSysStat.addItem scene=".concat(t, " now=").concat(c.a.now(), " expiredTime=").concat(i));
                              var s = this._sysMap.get(t);
                              s || (s = new Er(t),
                              this._sysMap.set(t, s)),
                              s.sDispatchId = e,
                              s.expiredTime = Number(i) || c.a.now() + 6e4
                          }
                      }, {
                          key: "removeItem",
                          value: function(t) {
                              this._sysMap.delete(t)
                          }
                      }, {
                          key: "recordAct",
                          value: function(t) {
                              var e = this.getResult();
                              e.length > 0 && t.setActDim(d.a.DIM_CORE.DISPATCH_ID, e)
                          }
                      }, {
                          key: "recordHeart",
                          value: function(t) {
                              var e = this.getResult();
                              e.length > 0 && t.setCoreDim(d.a.DIM_CORE.DISPATCH_ID, e)
                          }
                      }, {
                          key: "getResult",
                          value: function() {
                              var t = []
                                , e = c.a.now();
                              return this._sysMap.forEach((function(i) {
                                  i.isExpired(e) || t.push("".concat(i.scene, ":").concat(i.sDispatchId))
                              }
                              )),
                              t.join(",")
                          }
                      }]),
                      t
                  }()
                    , Ar = "force_auto_count"
                    , Cr = "force_auto_effective_time"
                    , kr = localStorage
                    , br = function() {
                      function t(e, i) {
                          Object(s.a)(this, t),
                          this._abConfig = i,
                          this._forceCnt = 0,
                          this._sysForceCnt = 0,
                          this._effectiveTime = 0,
                          this._sysEffectiveTime = 0,
                          this._isInit = !1,
                          this._closed = !1,
                          e.on(r.c.AUTO_FORCE_RSP, this.onAutoForceRsp.bind(this))
                      }
                      return Object(a.a)(t, [{
                          key: "_init",
                          value: function() {
                              if (!this._isInit)
                                  if (this._isInit = !0,
                                  this._sysEffectiveTime > 0 ? this._effectiveTime = this._sysEffectiveTime : this._effectiveTime = Number(o.a.force_auto_effective_time),
                                  this._sysForceCnt > 0)
                                      this._forceCnt = this._sysForceCnt,
                                      l.a.log("AutoForce._init useSys");
                                  else {
                                      this._forceCnt = Number(o.a.force_auto_count);
                                      var t = []
                                        , e = this._abConfig.getConfig("quitAutoCount");
                                      null !== e && (this._forceCnt = Number(e),
                                      t.push("_forceCnt=".concat(this._forceCnt)));
                                      var i = this._abConfig.getConfig("isWebAutoABBBB");
                                      null !== i && (this._closed = 1 === i,
                                      t.push("isWebAutoAB=".concat(i))),
                                      l.a.log("AutoForce._init ".concat(t.join(" ")))
                                  }
                          }
                      }, {
                          key: "onAutoForceRsp",
                          value: function(t, e) {
                              var i = e.force_auto_count
                                , s = e.force_auto_effective_time;
                              l.a.log("AutoForce.onAutoForceRsp force_auto_count=".concat(i, " force_auto_effective_time=").concat(s)),
                              this._forceCnt = this._sysForceCnt = i,
                              this._effectiveTime = this._sysEffectiveTime = 1e3 * s,
                              this._checkEffective()
                          }
                      }, {
                          key: "addForce",
                          value: function() {
                              var t = Number(kr.getItem(Ar)) || 0;
                              kr.setItem(Ar, t + 1),
                              l.a.log("AutoForce.addForce forceCnt=".concat(t + 1)),
                              this._checkEffective()
                          }
                      }, {
                          key: "_checkEffective",
                          value: function() {
                              (Number(kr.getItem(Ar)) || 0) >= this._forceCnt && !kr.hasOwnProperty(Cr) && (kr.setItem(Cr, Date.now() + this._effectiveTime),
                              l.a.log("AutoForce._checkEffective cooling"))
                          }
                      }, {
                          key: "getUseAuto",
                          value: function() {
                              if (this._init(),
                              this._closed)
                                  return !1;
                              if (kr.hasOwnProperty(Cr)) {
                                  var t = Number(kr.getItem(Cr));
                                  if (Date.now() < t)
                                      return l.a.log("AutoForce.getUseAuto cooling!"),
                                      !1;
                                  kr.removeItem(Ar),
                                  kr.removeItem(Cr)
                              }
                              var e = Number(kr.getItem(Ar)) || 0;
                              return l.a.log("AutoForce.getUseAuto forceCnt=".concat(e, " _forceCnt=").concat(this._forceCnt)),
                              e < this._forceCnt
                          }
                      }]),
                      t
                  }()
                    , Rr = localStorage
                    , Lr = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this._isInit = !1,
                          this._mpConfig = null
                      }
                      return Object(a.a)(t, [{
                          key: "_init",
                          value: function() {
                              if (!this._isInit) {
                                  l.a.log("AbConfigParser._init", Rr.abConfig),
                                  this._isInit = !0;
                                  try {
                                      var t = JSON.parse(Rr.abConfig);
                                      t && t.mpConfig && (this._mpConfig = t.mpConfig)
                                  } catch (t) {
                                      l.a.log("AbConfigParser._init ".concat(t.message))
                                  }
                              }
                          }
                      }, {
                          key: "getConfig",
                          value: function(t) {
                              return this._init(),
                              this._mpConfig && this._mpConfig.hasOwnProperty(t) ? this._mpConfig[t] : null
                          }
                      }]),
                      t
                  }()
                    , wr = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          this._abConfig = e,
                          this._isInit = !1,
                          this._pids = new Set,
                          this._lines = new Set,
                          this._bitrateMap = new Map
                      }
                      return Object(a.a)(t, [{
                          key: "_init",
                          value: function() {
                              var t = this;
                              if (!this._isInit) {
                                  l.a.log("BitrateChange._init"),
                                  this._isInit = !0;
                                  var e = this._abConfig.getConfig("pidList");
                                  null !== e && 0 !== Number(e) && e.split(",").forEach((function(e) {
                                      t._pids.add(Number(e))
                                  }
                                  ));
                                  var i = this._abConfig.getConfig("lineList");
                                  null !== i && 0 !== Number(i) && i.split(",").forEach((function(e) {
                                      t._lines.add(Number(e))
                                  }
                                  ));
                                  var s = this._abConfig.getConfig("bitrateList");
                                  null !== s && 0 !== Number(s) && (s = s.split(",")).forEach((function(e) {
                                      var i = e.split(":");
                                      t._bitrateMap.set(Number(i[0]), Number(i[1]))
                                  }
                                  ))
                              }
                          }
                      }, {
                          key: "getBitrate",
                          value: function(t, e, i) {
                              return this._init(),
                              this._pids.has(Number(t)) && this._lines.has(Number(e)) && this._bitrateMap.has(Number(i)) && (i = this._bitrateMap.get(i)),
                              i
                          }
                      }]),
                      t
                  }()
                    , Or = 0;
                  sr.a && sr.a.getInstance && sr.a.getInstance().setLogCallback((function() {
                      var t = Array.apply(null, arguments);
                      l.a.log("HYCodec.setLogCallback", t.join(" "))
                  }
                  ));
                  var Dr = function() {
                      function t(e) {
                          Object(s.a)(this, t),
                          c.a.now();
                          var i = Number(localStorage.sdkLogLevel);
                          isNaN(i) || this.setLogLevel(i),
                          z.a.initUUId(),
                          this.uuid = z.a.uuid;
                          var a = _.a.platform + " " + _.a.name + " " + _.a.version.string;
                          l.a.warn("SDK ".concat(2202140215, " | ").concat("2022-02-14 02:15:56", " | ").concat("RELEASE", " | ").concat(a, " | ").concat(this.uuid)),
                          this.config = o.a,
                          this.config.init(e);
                          var n = ba();
                          this.on = n.on.bind(n),
                          this.off = n.off.bind(n),
                          this.trigger = n.trigger.bind(n),
                          this.stat = new Ia,
                          this.metrics = new T,
                          this.abConfig = new Lr,
                          this.tsdbUtil = new f({
                              stat: this.stat,
                              eventEmiter: this
                          }),
                          this.statSwitch = new ar(this.tsdbUtil,this.stat,this),
                          this.sampleController = new nr,
                          this.h265Proxy = new pr(this.stat,this.tsdbUtil),
                          this.autoMonitor = new Pr,
                          this.recSysStat = new Ir,
                          this.visibility = new yr(this),
                          this.autoForce = new br(this,this.abConfig),
                          this.bitrateChange = new wr(this.abConfig),
                          this._onStartPlayBind = this._onStartPlay.bind(this),
                          this._onTurntoH264Bind = this.onTurntoH264.bind(this),
                          this.statSwitch.init(this.autoMonitor, this.recSysStat, this.autoForce),
                          this.autoMonitor.init(this.stat),
                          this.volume = 1,
                          this._type = 0,
                          this.player = null,
                          this.lastFlvInfo = null,
                          this.lastP2PInfo = null,
                          this.noPictureP2PSended = !1,
                          this.noPictureFlvSended = !1,
                          this.noPictureWebrtcSended = !1,
                          this.playingMgr = null,
                          this.flacMgr = null,
                          this.flacLibURL = "flaclib.js",
                          this.videoPlaybackrateAccess = !_.a.firefox,
                          this.webrtcPlayerMgr = null,
                          this.videoPixelateMgr = new vr(this,this.stat),
                          this.enableLowLatency = !1,
                          this.webrtcErrored = !1,
                          this._isP2pPlayIng = !1,
                          this.isForceFlv = !1,
                          this.isGetPcdnMode = !1,
                          window.HYApplication && (window.HYApplication.tafHandler && u.default.setTafHandler(window.HYApplication.tafHandler),
                          window.HYApplication.config && this.config.init(window.HYApplication.config)),
                          this.on(r.c.FLV_TRY_TO_P2P, this.flvTryToP2P.bind(this)),
                          this.on(r.c.VIDEO_PLAY, this.onPlayVideo.bind(this)),
                          this.on(r.c.P2P_TIMEOUT, this.onP2pTimeout.bind(this)),
                          this.on(r.c.TURN_TO_H264, this.onTurntoH264.bind(this)),
                          this.on(r.c.H265_VIDEO_RETRY, this.onH265Retry.bind(this)),
                          this.on(r.c.H5_PLAYER_ERROR, this.onH5PlayerError.bind(this)),
                          this.on(r.c.AUTO_BITRATE_CHANGED, this.onAutoBitrateChanged.bind(this)),
                          this._mediaLink = new tr,
                          u.default.addListener("1200000", this._sendMuffledMessage.bind(this)),
                          this.startTs = 0,
                          this.costUs = 0,
                          this.isP2PUseH265 = !0,
                          this.isFlvUseH265 = !0,
                          this.getAIRequestTime = 0,
                          this.getVideoP2PBuffertEmptyTime = 0,
                          this.getVideoFlvBuffertEmptyTime = 0,
                          this.isAiSupportP2P = !0,
                          this.aiStartP2PCnt = 0,
                          this.aiStartFlvCnt = 0,
                          this.aiComp = 0,
                          this.sdkTurnToP2P = !0,
                          this.isPlayerStarted = !1,
                          this.pureAudioMgr = null,
                          this.muteData = [],
                          this.isBusiStop = !1,
                          this.sdkInRoomTs = Date.now(),
                          this.roomRecordStat = new hr(this),
                          this.isInitRoomTicker = !1,
                          this.noLoadAv1Count = 0,
                          this.lastTypeLineBitRateKey = "",
                          this.isTurnTo264 = !1,
                          this.startInfo = null,
                          this.mainLibUrl = "MainLib.js",
                          this.chatStreamMgr = null,
                          this.voiceMgr = null,
                          this.autoStartBitrate = 0,
                          this.inRoomTimeNow = c.a.now()
                      }
                      return Object(a.a)(t, null, [{
                          key: "isSupported",
                          value: function() {
                              return window.MediaSource && window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')
                          }
                      }, {
                          key: "isSupportedHevc",
                          value: function(t) {
                              if (sr.a && sr.a.getInstance) {
                                  var e = {
                                      enableWebH265: 1,
                                      baseCostUs: {
                                          2e3: 32e3,
                                          4e3: 3e4
                                      },
                                      loopCount: 100,
                                      singleThreadBitKbps: [10],
                                      multiThreadBitKbps: [4e3, 2e3, 500],
                                      threadCount: 2,
                                      degrade: 0,
                                      statIntervalMs: 1e3,
                                      fmt: 11,
                                      share: 0,
                                      wasmLoad: 500,
                                      core: {
                                          2e3: 3,
                                          4e3: 4
                                      },
                                      x86: {
                                          4e3: 1
                                      }
                                  }
                                    , i = {};
                                  v.b.is64bitSoftware() || (o.a.h265Config[3][1][1] = o.a.h265Config2[0]),
                                  1 == Number(o.a.h265Config2[1]) ? e.x86 = {
                                      4e3: 1
                                  } : e.x86 = {
                                      4e3: 0
                                  },
                                  o.a.h265Config[0][0].forEach((function(t, e) {
                                      i[t] = o.a.h265Config[0][1][e]
                                  }
                                  )),
                                  e.baseCostUs = i,
                                  e.multiThreadBitKbps = o.a.h265Config[1];
                                  var s = {};
                                  return o.a.h265Config[3][0].forEach((function(t, e) {
                                      s[t] = o.a.h265Config[3][1][e]
                                  }
                                  )),
                                  e.core = s,
                                  sr.a.getInstance().parseConfigs(e),
                                  sr.a.getInstance().isSupportH265(t).isSupport
                              }
                              return !1
                          }
                      }, {
                          key: "Events",
                          get: function() {
                              return r.c
                          }
                      }]),
                      Object(a.a)(t, [{
                          key: "loginMedia",
                          value: function(t, e, i) {
                              this._mediaLink.loginMedia(t, e, i)
                          }
                      }, {
                          key: "quitMedia",
                          value: function() {
                              this._mediaLink.quitMedia()
                          }
                      }, {
                          key: "onPlayVideo",
                          value: function(t, e) {
                              this.player && (this.player.setVolume(this.volume),
                              this.videoPixelateMgr.setVideoPixelate())
                          }
                      }, {
                          key: "checkCooling",
                          value: function() {
                              if (z.a.p2pCooling = !1,
                              this.stat.delDim(d.a.DIM_COM.P2P_COOL_FLAG),
                              localStorage.hasOwnProperty("p2p_cooling_time")) {
                                  var t = new Date
                                    , e = new Date(Number(localStorage.getItem("p2p_cooling_time")));
                                  z.a.p2pCooling = !(t.getFullYear() != e.getFullYear() || t.getMonth() != e.getMonth() || t.getDate() != e.getDate()),
                                  z.a.p2pCooling && this.stat.setComDim(d.a.DIM_COM.P2P_COOL_FLAG, 1)
                              }
                          }
                      }, {
                          key: "setIDs",
                          value: function() {}
                      }, {
                          key: "setExtendConfig",
                          value: function(t) {
                              var e = {};
                              t.p2pConfig && (Object.assign(e, t.p2pConfig),
                              delete t.p2pConfig),
                              t.sdk && (t.sdk.p2pConfig && (Object.assign(e, t.sdk.p2pConfig),
                              delete t.sdk.p2pConfig),
                              Object.assign(e, t.sdk),
                              delete t.sdk),
                              Object.assign(e, t),
                              this.config.init(e)
                          }
                      }, {
                          key: "setConfig",
                          value: function(t, e) {
                              this.config[t] != e && (this.config[t] = e,
                              l.a.log("HYPlayer.setConfig ".concat(t, "=").concat(e)))
                          }
                      }, {
                          key: "getConfig",
                          value: function(t) {
                              return this.config[t]
                          }
                      }, {
                          key: "getVolume",
                          value: function() {
                              return this.volume
                          }
                      }, {
                          key: "setVolume",
                          value: function(t) {
                              var e = Math.max(0, Number(t));
                              e = Math.min(1, e),
                              this.volume = e,
                              this.flacMgr && this.flacMgr.isPlaying() ? (e = 0,
                              this.flacMgr.setVolume(this.volume),
                              this.setVideoPlaybackrateAccess(!1)) : this.setVideoPlaybackrateAccess(!0),
                              this.player && this.player.setVolume(e),
                              this.voiceMgr && this.voiceMgr.huyaMgr && this.voiceMgr.huyaMgr.setVolume && this.voiceMgr.huyaMgr.setVolume(e)
                          }
                      }, {
                          key: "setLogLevel",
                          value: function(t) {
                              l.a.setLevel(t)
                          }
                      }, {
                          key: "getLog",
                          value: function() {
                              return l.a.getLog()
                          }
                      }, {
                          key: "getMetrics",
                          value: function() {
                              return this.metrics.getResult()
                          }
                      }, {
                          key: "getBufferLen",
                          value: function() {
                              return this.player && this.player.getBufferLen && this.player.getBufferLen() || 0
                          }
                      }, {
                          key: "getCurrentTime",
                          value: function() {
                              return this.player && this.player.getCurrentTime ? this.player.getCurrentTime() : 0
                          }
                      }, {
                          key: "getCurrentDts",
                          value: function() {
                              return this.player && this.player.getCurrentDts ? this.player.getCurrentDts() : 0
                          }
                      }, {
                          key: "getCurrentSeiOffsetDts",
                          value: function() {
                              return this.player && this.player.getCurrentSeiOffsetDts ? this.player.getCurrentSeiOffsetDts() : 0
                          }
                      }, {
                          key: "getCurrentSeiDts",
                          value: function() {
                              return this.getCurrentDts() - this.getCurrentSeiOffsetDts()
                          }
                      }, {
                          key: "getVideoInfo",
                          value: function() {
                              var t = 0
                                , e = NaN
                                , i = this.player;
                              if (i && i.mse) {
                                  var s = i.mse.video;
                                  t = s.currentTime,
                                  e = s.duration
                              }
                              return {
                                  currentTime: t,
                                  duration: e
                              }
                          }
                      }, {
                          key: "sendMetrics",
                          value: function(t) {
                              this.trigger(r.c.DATA_METRIC2, t)
                          }
                      }, {
                          key: "start",
                          value: function(e) {
                              e.appid && (z.a.appid = e.appid),
                              this.loadlMainLib(e.h5Root),
                              e.type === t.STREAM && o.a.isCloseP2P(e.uid) || (e.iBitRate = this.bitrateChange.getBitrate(e.presenterUid, e.lineType, e.iBitRate),
                              !e.isAuto || 0 !== this.autoStartBitrate && 1 != e.pullStreamFrom || (this.autoStartBitrate = e.curBitrate),
                              e._startBitrate = this.autoStartBitrate,
                              e._sessionId = this.sdkInRoomTs,
                              e.type !== t.STREAM && (o.a.setUseAV1(e),
                              o.a.setUseAuto(e.hasAutoBitrate || e.isAuto),
                              o.a.initByBitrate(e.curBitrate)),
                              e.type === t.STREAM || this.isInitRoomTicker || (k.a.add(this.onCheckTimer, this, 1e3),
                              this.isInitRoomTicker = !0),
                              e = Object.assign({
                                  uuid: this.uuid,
                                  type: 0,
                                  lineType: -1,
                                  curBitrate: 0,
                                  originalBitrate: 0
                              }, e),
                              this.stop("sdk"),
                              this.isBusiStop = !1,
                              e.isAuto && (e.isAuto = !o.a.isAutoClose(e.lineType, e.presenterUid)),
                              this.visibility.setStat(this.stat),
                              this.isTurnTo264 ? this.stat.setComDim("backup_field3", 1) : this.stat.setComDim("backup_field3", 2),
                              this.stat.setComDim(d.a.DIM_COM.AUTO_OPEN, e.hasAutoBitrate ? 1 : 0),
                              this.stat.setComDim(d.a.DIM_COM.START_CODERATEBPS, 1e3 * this.autoStartBitrate),
                              this.stat.setComDim(d.a.DIM_COM.AUTO_VERSION, 1),
                              this.stat.setComDim(d.a.DIM_COM.PLAYER_TYPE, e.type),
                              this.stat.setComDim(d.a.DIM_COM.LIVE_TYPE, e.liveType || 0),
                              this.stat.setComDim(d.a.DIM_COM.VR_ENABLE, e.type === t.VR ? 1 : 0),
                              this.stat.setComDim(d.a.DIM_COM.BROWSER_KERNEL, _.a.name),
                              this.stat.setComDim(d.a.DIM_COM.BROWSER_KERNEL_VERSION, _.a.version.major),
                              this.stat.setComDim(d.a.DIM_COM.SESSION_ID, this.sdkInRoomTs),
                              this.stat.setComDim(d.a.DIM_COM.AUTO_BITRATE, e.isAuto ? 1 : 0),
                              this.setAv1Ab(e),
                              z.a.sGuid = e.sGuid || z.a.sGuid,
                              z.a.uid = e.uid || z.a.uid,
                              z.a.roomId = e.uid || z.a.roomId,
                              0 === z.a.convertUid && z.a.uid > 0 && (z.a.convertUid = v.b.rotUid(z.a.uid, e.presenterUid)),
                              X.wsTimeSync(),
                              l.a.log("HYPlayer.start type=".concat(e.type, " convertUid=").concat(z.a.convertUid), e),
                              this.isAiSupportP2P = !0,
                              e.type === t.P2PFLV ? (e.iIsP2PSupport && (this.lastP2PInfo = e),
                              e.iIsP2PSupport ? e.type = t.P2P : e.type = t.FLV) : e.type === t.VR && e.iIsP2PSupport && !this.isForceFlv && (e.vr.playerType = 1),
                              this._type = e.type,
                              e.type === t.FLV || e.type === t.P2P ? k.a.once(this.onNoPictureFlv, this, 1e4) : e.type === t.HLS ? k.a.once(this.onNoPictureHls, this, 1e4) : this.webrtcErrored && e.type == t.HUYAWEBRTC && (l.a.log("HYPlayer.start type=".concat(e.type) + "  change to flv for error"),
                              e.type = t.FLV,
                              this._type = t.FLV),
                              this.startInfo = e,
                              this.startByCodec(e))
                          }
                      }, {
                          key: "startByCodec",
                          value: function(t) {
                              this.h265Proxy.initSupport(t),
                              this.startTs = c.a.now(),
                              l.a.log("HYPlayer.startNow", Date.now(), this.startTs),
                              this.h265Info = t,
                              this.h265Proxy.isSupported ? this.h265Proxy.loadDecoder(t.h5Root, {
                                  ready: this._onStartPlayBind,
                                  error: this._onTurntoH264Bind,
                                  timeout: this._onStartPlayBind
                              }) : this.startPlayer(t)
                          }
                      }, {
                          key: "_onStartPlay",
                          value: function() {
                              this.startPlayer(this.h265Info)
                          }
                      }, {
                          key: "startPlayer",
                          value: function(e) {
                              var i = this._type + e.lineType + e.iBitRate;
                              i !== this.lastTypeLineBitRateKey && (this.noLoadAv1Count = 0),
                              this.getAiSupportP2P(e),
                              this.getAbTestConfig(),
                              this._type !== t.P2P || this.isAiSupportP2P ? e.type === t.VR && e.vr.playerType && !this.isAiSupportP2P && (e.vr.playerType = 0) : (e.type = t.FLV,
                              this._type = t.FLV),
                              this.setAiP2PFlvComp(e),
                              this.roomRecordStat.anchoruid = e.presenterUid;
                              var s = {
                                  stat: this.stat,
                                  tsdb: this.tsdbUtil,
                                  statSwitch: this.statSwitch,
                                  sampleController: this.sampleController,
                                  h265Proxy: this.h265Proxy,
                                  autoMonitor: this.autoMonitor,
                                  recSysStat: this.recSysStat
                              };
                              switch (this.isPlayerStarted = !0,
                              e.type) {
                              case t.FLV:
                                  this.player = new hs(this,s),
                                  this.lastFlvInfo = e,
                                  this.lastP2PInfo && (this.player.backToP2P.lastP2PInfo = this.lastP2PInfo),
                                  this.roomRecordStat.liveType = d.a.LIVE_TYPE.FLV;
                                  break;
                              case t.P2P:
                                  if (!Xt.isSupportP2P() || o.a.isCloseP2P(e.uid))
                                      return this.lastP2PInfo = e,
                                      this.onP2pTimeout(),
                                      void l.a.error("xxxxxxx " + _.a.name + " " + _.a.version.major + " unsupport p2p !");
                                  this.player = new Ys(this,s),
                                  this.lastP2PInfo = e,
                                  k.a.once(this.onNoPictureP2P, this, 5e3),
                                  this._isP2pPlayIng = !0,
                                  this.p2pPlayingEvent(this._isP2pPlayIng),
                                  this.isForceFlv = !1,
                                  this.roomRecordStat.liveType = d.a.LIVE_TYPE.P2P;
                                  break;
                              case t.HLS:
                                  this.player = new ea(this,s),
                                  this.roomRecordStat.liveType = d.a.LIVE_TYPE.HLS;
                                  break;
                              case t.HUYAWEBRTC:
                                  this.player = new Xa(this,{
                                      config: this.config
                                  }),
                                  k.a.once(this.onNoPictureWebrtc, this, 1e4);
                                  break;
                              case t.STREAM:
                                  this.startChatStream(e);
                                  break;
                              case t.OBS:
                                  this.player = new Va(this,e.renderMode);
                                  break;
                              case t.VR:
                                  this.player = new $a(this,s);
                                  break;
                              case t.PLAYBACK:
                                  this.player = new er(this,s);
                                  break;
                              default:
                                  return void l.a.error("HYPlayer.start Unknown type[".concat(e.type, "]"))
                              }
                              this.checkCooling(),
                              e.type == t.P2P && e.p2purl ? this.player.startP2PUrl(e) : e.type == t.HUYA ? (this.player.init(e),
                              this.player.start(e.curBitrate)) : this._type != t.STREAM && this.player.start(e),
                              this.enableLowLatency && this.player && this.player.setEnableLowLatency && this.player.setEnableLowLatency(!0),
                              this._type !== t.STREAM && (this.initMeeting(),
                              this.voiceMgr.startVoiceStreamMgr(e)),
                              this.player && this.player.setPlaybackrateAccess && this.player.setPlaybackrateAccess(this.videoPlaybackrateAccess),
                              this.playingMgr = this.player,
                              this._type !== t.STREAM && (this.pcdnInfo = e,
                              this.isGetPcdnMode = !1,
                              this.getPcdnSchedule(e)),
                              this._setEnablePixelate(e),
                              this.typeLineBitRateKey = i
                          }
                      }, {
                          key: "startChatStream",
                          value: function(t) {
                              this.chatStreamMgr || (this.chatStreamMgr = new _r(this)),
                              this.chatStreamMgr && this.chatStreamMgr.play(t)
                          }
                      }, {
                          key: "getAiSupportP2P",
                          value: function(e) {
                              var i = this;
                              if (0 !== Number(o.a.isAiP2PToFlv))
                                  if (this.isGetAiSupportP2P)
                                      this.isGetAiSupportP2P = !0;
                                  else if (o.a.playerdata) {
                                      var s = o.a.playerdata.profileP2POpt;
                                      if (l.a.log("HYPlayer.getAiSupportP2P sProfileP2POpt", s),
                                      s && "" != s && 0 != s.length) {
                                          if (e.type === t.P2PFLV) {
                                              if (!e.iIsP2PSupport)
                                                  return
                                          } else if (e.type === t.VR && (!e.iIsP2PSupport || this.isForceFlv))
                                              return;
                                          var a = 0 == e.originalBitrate ? 0 : e.curBitrate
                                            , r = e.lineType
                                            , n = this.h265Proxy.isSupported ? "265" : "264"
                                            , h = JSON.parse(this.unescapeHTML(s));
                                          l.a.log("HYPlayer.getAiSupportP2P", h),
                                          h && (h.p2pKa.split(",").map((function(t) {
                                              var e = t.split("|")
                                                , s = e.length;
                                              4 == e.length && r == e[0] && a == e[1] && n == e[2] && (i.isAiSupportP2P = 0 == e[s - 1])
                                          }
                                          )),
                                          this.isAiSupportP2P ? this.aiStartP2PCnt++ : this.aiStartFlvCnt++)
                                      }
                                  }
                          }
                      }, {
                          key: "getAiStartStat",
                          value: function() {
                              var t = {
                                  aiStartP2PCnt: this.aiStartP2PCnt,
                                  aiStartFlvCnt: this.aiStartFlvCnt
                              };
                              return this.aiStartP2PCnt = 0,
                              this.aiStartFlvCnt = 0,
                              t
                          }
                      }, {
                          key: "getRandomUseH265",
                          value: function(t) {
                              var e = t.presenterUid
                                , i = !0;
                              return o.a.h265BlackUids.concat(o.a.useAV1PidList).forEach((function(t) {
                                  e && t.toString() == e.toString() && (i = !1)
                              }
                              )),
                              !!i
                          }
                      }, {
                          key: "isSupportedH265",
                          value: function(e) {
                              var i;
                              return i = e.iIsHEVCSupport > 0 && e.iHEVCBitRate >= 0 || this.getIsH265(e.iCodecType) && 0 === e.iBitRate,
                              this._type == t.P2P ? this.isP2PUseH265 && i : this._type == t.FLV ? this.isFlvUseH265 && i : void 0
                          }
                      }, {
                          key: "getIsH265",
                          value: function(t) {
                              return 1 === t || 4 === t || 6 === t || 8 === t
                          }
                      }, {
                          key: "getFrameData",
                          value: function() {
                              (new Date).getTime();
                              var t = null;
                              return this.player && this.player.getFrameData && (t = this.player.getFrameData()),
                              t
                          }
                      }, {
                          key: "updateLiveVodUrl",
                          value: function(t) {
                              this.player && this.player.updateLiveVodUrl && this.player.updateLiveVodUrl(t)
                          }
                      }, {
                          key: "getExceptionStat",
                          value: function() {
                              return this.player.exceptionStat ? this.player.exceptionStat.getStat() : ""
                          }
                      }, {
                          key: "seek",
                          value: function(t) {
                              this.player && this.player.seek && this.player.seek(t)
                          }
                      }, {
                          key: "onNoPictureP2P",
                          value: function() {
                              this.player && this.isP2P && !this.noPictureP2PSended && (this.noPictureP2PSended = !0,
                              this.onNoPicture())
                          }
                      }, {
                          key: "onNoPictureWebrtc",
                          value: function() {
                              this.player && this.isHuyaWebrtc && !this.noPictureWebrtcSended && (this.noPictureWebrtcSended = !0,
                              this.onNoPicture())
                          }
                      }, {
                          key: "onNoPictureFlv",
                          value: function() {
                              this.player && this.isFlv && !this.noPictureFlvSended && (this.noPictureFlvSended = !0,
                              this.onNoPicture())
                          }
                      }, {
                          key: "onNoPictureHls",
                          value: function() {
                              this.player && this.isHls && !this.noPictureHlsSended && (this.noPictureHlsSended = !0,
                              this.onNoPicture())
                          }
                      }, {
                          key: "onNoPicture",
                          value: function() {
                              var t = [this.player.hasPicture ? 0 : 100]
                                , e = this.player.getRecvInfo ? this.player.getRecvInfo() : []
                                , i = [this.stat.createAct(d.a.ACT.NO_PICTURE, {
                                  value: t.concat(e),
                                  str: [_.a.platform]
                              })];
                              this.stat.setActDim(d.a.DIM_LINK_STA.name, this.getExceptionStat()),
                              i.push(this.stat.createAct(d.a.ACT.LINK_STA, {
                                  value: [this.player.hasPicture ? 0 : 100],
                                  str: [_.a.platform]
                              })),
                              this.trigger(r.c.DATA_METRIC2, i),
                              1 == o.a.isAutoNoPicture && Math.floor(1e3 * Math.random()) < 50 && this.player && !this.player.hasPicture && (l.a.log("HYPlayer.onNoPicture auto report"),
                              this.trigger(r.c.P2P_REPORT))
                          }
                      }, {
                          key: "onWebrtcVideoError",
                          value: function(t) {
                              this.webrtcErrored = !0,
                              this.enableLowLatency = !0,
                              this.trigger(r.c.WEBRTC_VIDEO_ERROR)
                          }
                      }, {
                          key: "stop",
                          value: function(t) {
                              "sdk" != t && (this.isBusiStop = !0),
                              this.roomRecordStat.roomNoRenderStat.pause(),
                              l.a.group("HYPlayer.stop type=".concat(this.startInfo && this.startInfo.type)),
                              k.a.remove(this.onNoPictureFlv, this),
                              k.a.remove(this.onNoPictureP2P, this),
                              this.player && (this.player.stop(),
                              this.player.destroy && this.player.destroy(),
                              this.player = null),
                              this.visibility.delVisibilitychange(),
                              this.h265Proxy.stop(),
                              this.stopFlac(),
                              this.stopChatStream(),
                              5 !== this._type && this.voiceMgr && (this.voiceMgr.huyaMgr && this.voiceMgr.huyaMgr.stop(),
                              this.stopLiveMeeting()),
                              l.a.groupEnd(),
                              this._isP2pPlayIng = !1,
                              this.p2pPlayingEvent(this._isP2pPlayIng),
                              this.player && this.player.voiceEliminationData && (this.player.voiceEliminationData = []),
                              this.videoPixelateMgr.destory(),
                              this.costUs = 0,
                              this.stat.reset(),
                              this.isGetPcdnMode = !1,
                              this.voiceMgr && this.voiceMgr.pureAudioMgr && this.voiceMgr.pureAudioMgr.reset()
                          }
                      }, {
                          key: "stopStream",
                          value: function(t) {
                              l.a.log("HYPlayer.stopStream", t),
                              this.player && this.player.stopStream && this.player.stopStream(t)
                          }
                      }, {
                          key: "setTafHandler",
                          value: function(t) {
                              l.a.log("HYPlayer.setTafHandler success"),
                              u.default.setTafHandler(t),
                              X.start()
                          }
                      }, {
                          key: "flvTryToP2P",
                          value: function() {
                              this.lastP2PInfo && (this.metrics.setP2p(1),
                              z.a.flvTryToP2P = 1,
                              this.lastP2PInfo.type === t.VR ? this.lastP2PInfo.vr.playerType = 1 : this.lastP2PInfo.type = t.P2P,
                              this.trigger(r.c.FLV_TO_P2P),
                              this.start(this.lastP2PInfo),
                              this.isForceFlv = !1,
                              this.sdkTurnToP2P = !0,
                              k.a.once(this.tryPlayP2PTimeout, this, 3e3)),
                              this.flacMgr && this.player && (this.stopFlac(),
                              this.startFlac())
                          }
                      }, {
                          key: "onP2pTimeout",
                          value: function() {
                              this.stat.reset(),
                              this._isP2pPlayIng = !1,
                              this.p2pPlayingEvent(this._isP2pPlayIng),
                              this.isForceFlv = !0,
                              this.lastP2PInfo.type === t.VR ? this.lastP2PInfo.vr.playerType = 0 : this.lastP2PInfo.type = t.FLV,
                              this.start(this.lastP2PInfo)
                          }
                      }, {
                          key: "onTurntoH264",
                          value: function() {
                              l.a.log("HYPlayer.onTurntoH264, turn to h264"),
                              this.h265Proxy.onTurnToH264(this._type),
                              this.isTurnTo264 = !0,
                              this.lastFlvInfo && this.lastFlvInfo.type === t.FLV ? this.start(this.lastFlvInfo) : this.lastP2PInfo && this.lastP2PInfo.type === t.P2P && this.start(this.lastP2PInfo)
                          }
                      }, {
                          key: "onH265Retry",
                          value: function() {
                              l.a.log("HYPlayer.onH265Retry, H265 retry!"),
                              this.lastFlvInfo && this.lastFlvInfo.type === t.FLV ? this.start(this.lastFlvInfo) : this.lastP2PInfo && this.lastP2PInfo.type === t.P2P && this.start(this.lastP2PInfo)
                          }
                      }, {
                          key: "onAutoBitrateChanged",
                          value: function() {
                              if (this.player) {
                                  var t = this.player.info;
                                  if (t) {
                                      var e = {
                                          curBitrate: t.curBitrate,
                                          originalBitrate: t.originalBitrate,
                                          iBitRate: t.iBitRate,
                                          iCodecType: t.iCodecType,
                                          iHEVCBitRate: t.iHEVCBitRate
                                      };
                                      this.lastP2PInfo && Object.assign(this.lastP2PInfo, e),
                                      this.lastFlvInfo && Object.assign(this.lastFlvInfo, e)
                                  }
                              }
                          }
                      }, {
                          key: "onH5PlayerError",
                          value: function() {
                              this._type == t.P2P && (this.sdkTurnToP2P = !0)
                          }
                      }, {
                          key: "tryPlayP2PTimeout",
                          value: function() {
                              this.isP2P && this.player.isPlaying || this.trigger(r.c.P2P_TIMEOUT)
                          }
                      }, {
                          key: "switchLevel",
                          value: function(t) {
                              this.player && this.player.switchLevel(t)
                          }
                      }, {
                          key: "loadlMainLib",
                          value: function(t) {
                              0 == Or && (fr.loadLib(t, this),
                              Or++)
                          }
                      }, {
                          key: "initMeeting",
                          value: function() {
                              this.voiceMgr || (this.voiceMgr = new mr(this)),
                              this.voiceMgr.init()
                          }
                      }, {
                          key: "startLiveMeeting",
                          value: function(t, e, i, s, a) {
                              this.loadlMainLib(a),
                              this.initMeeting(),
                              this.voiceMgr.startLiveMeeting(t, e, i),
                              this.enableLowLatency = !0,
                              this.player && this.player.setEnableLowLatency && this.player.setEnableLowLatency(!0)
                          }
                      }, {
                          key: "setMeetingStat",
                          value: function(t) {
                              this.initMeeting(),
                              this.voiceMgr && this.voiceMgr.liveMeetingMgr && this.voiceMgr.liveMeetingMgr.setMeetingStat && this.voiceMgr.liveMeetingMgr.setMeetingStat(t)
                          }
                      }, {
                          key: "stopLiveMeeting",
                          value: function() {
                              this.initMeeting(),
                              this.voiceMgr && this.voiceMgr.liveMeetingMgr && this.voiceMgr.liveMeetingMgr.stop && this.voiceMgr.liveMeetingMgr.stop()
                          }
                      }, {
                          key: "startFlac",
                          value: function() {
                              var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}
                                , e = t.h5Root + this.flacLibURL;
                              this.flacMgr || (this.flacMgr = new ja(this,e)),
                              this.flacMgr && this.flacMgr.play(t)
                          }
                      }, {
                          key: "stopFlac",
                          value: function() {
                              this.flacMgr && this.flacMgr.stop()
                          }
                      }, {
                          key: "stopChatStream",
                          value: function() {
                              this.chatStreamMgr && this.chatStreamMgr.stop()
                          }
                      }, {
                          key: "updateAudioPlay",
                          value: function() {
                              var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : []
                                , e = arguments.length > 1 ? arguments[1] : void 0;
                              this.loadlMainLib(e),
                              this.initMeeting(),
                              this.voiceMgr.updateAudioPlay(t, !0)
                          }
                      }, {
                          key: "flacPlayStatusChange",
                          value: function() {
                              this.setVolume(this.volume)
                          }
                      }, {
                          key: "setVideoPlaybackrateAccess",
                          value: function(t) {
                              this.player && this.player.setPlaybackrateAccess && this.player.setPlaybackrateAccess(!!this.videoPlaybackrateAccess && t)
                          }
                      }, {
                          key: "reportLoadP2PLib",
                          value: function(t) {
                              var e = [this.stat.createAct(d.a.ACT.LOAD_P2PLIB_ERROR, {
                                  value: [t ? 100 : 0],
                                  str: [_.a.platform]
                              })];
                              this.trigger(r.c.DATA_METRIC2, e)
                          }
                      }, {
                          key: "p2pPlayingEvent",
                          value: function(t) {
                              this.trigger(r.c.P2P_PLAYING_EVENT, {
                                  isP2pPlayIng: t
                              })
                          }
                      }, {
                          key: "unescapeHTML",
                          value: function(t) {
                              return v.b.unescapeHTML(t)
                          }
                      }, {
                          key: "_sendMuffledMessage",
                          value: function(e) {
                              if (this._type !== t.STREAM && e && e.sMuteInfo) {
                                  var i = JSON.parse(this.unescapeHTML(e.sMuteInfo));
                                  this.sendMuffledMessage(i.voiceEliminationData)
                              }
                          }
                      }, {
                          key: "sendMuffledMessage",
                          value: function() {
                              var t = this
                                , e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : [];
                              if (this.player) {
                                  this.player.voiceEliminationData || (this.player.voiceEliminationData = []);
                                  var i = this.getCurrentDts()
                                    , s = this.getCurrentSeiOffsetDts();
                                  e.length > 0 && e.map((function(e) {
                                      var a = !1;
                                      0 === t.player.voiceEliminationData.length ? a = !0 : t.player.voiceEliminationData.map((function(t) {
                                          t.type === e.type && t.begin == t.begin && t.end === e.end || (a = !0)
                                      }
                                      )),
                                      a && (t.reportMuffledDelay(s, i, e),
                                      t.player.voiceEliminationData.push(e),
                                      l.a.log("HYPlayer._sendMuffledMessage currentDts: ".concat(t.getCurrentDts(), ", currentSeiOffsetDts: ").concat(t.getCurrentSeiOffsetDts()), JSON.stringify(e), t.player.mse.getBufferLen()))
                                  }
                                  ))
                              }
                          }
                      }, {
                          key: "reportMuffledDelay",
                          value: function(t, e, i) {
                              var s = i.begin
                                , a = i.end
                                , n = e;
                              0 == i.type && (s += t,
                              a += t,
                              n = e - t);
                              var h = 0;
                              e <= s ? h = 0 : e > s && e < a ? h = 2 : e >= a && (h = 1);
                              var u = [this.stat.createAct(d.a.ACT.MUTE_STATUS, {
                                  value: [h, i.type, n, i.begin, i.end],
                                  str: [i.reqKey]
                              })];
                              l.a.log("HYPlayer.reportMuffledDelay"),
                              this.muteData.push({
                                  begin: i.begin,
                                  end: i.end,
                                  reqKey: i.reqKey,
                                  value: h,
                                  type: i.type,
                                  currentDts: n
                              }),
                              1 == Number(o.a.isMuteAct) && this.trigger(r.c.DATA_METRIC2, u)
                          }
                      }, {
                          key: "getMuteStat",
                          value: function() {
                              var t = this.muteData;
                              return this.muteData = [],
                              {
                                  muteData: t
                              }
                          }
                      }, {
                          key: "getPcdnSchedule",
                          value: function(e) {
                              var i = this;
                              if (!o.a.isCloseP2P(e.uid) && (this.type === t.P2P || this.type === t.FLV))
                                  if (e.sStreamName) {
                                      if (o.a.notUsePcdnUids && o.a.notUsePcdnUids.length > 0) {
                                          var s = !1;
                                          if (o.a.notUsePcdnUids.map((function(t) {
                                              t === String(e.presenterUid) && (s = !0)
                                          }
                                          )),
                                          s)
                                              return
                                      }
                                      if (!(e.curBitrate && Number(e.curBitrate) > Number(o.a.closePcdnBitrate)))
                                          if (u.default.connected) {
                                              k.a.remove(this.timeoutGetPcdn),
                                              k.a.remove(this.httpsFetch),
                                              k.a.once(this.httpsFetch, this, 1e3);
                                              var a = this.getPcdnReq(e);
                                              l.a.log("HYPlayer.getPcdnSchedule tqf req", a),
                                              u.default.sendWup("hypcdngw", "clientQueryPcdnSchedule", a, (function(t) {
                                                  i.getPcdnRes(t)
                                              }
                                              ), !0, u.default.getRequestId()),
                                              k.a.once(this.timeoutGetPcdn, this, 1e3)
                                          } else
                                              u.default.on(u.default.TAFLINK_INITED, (function() {
                                                  l.a.log("HYPlayer.getPcdnSchedule taf inited"),
                                                  i.getPcdnSchedule(e)
                                              }
                                              ))
                                  } else
                                      l.a.log("HYPlayer.getPcdnSchedule has no sStreamName")
                          }
                      }, {
                          key: "getPcdnRes",
                          value: function(t) {
                              l.a.log("HYPlayer.getPcdnSchedule res", t),
                              this.isGetPcdnMode = !0,
                              !t || 0 != t.iErrCode && 7 != t.iErrCode || this.player && this.player.checkPcdnMode && this.player.checkPcdnMode(t.mPcdnModeSwitch.value, t.mPcdnModePcdnName.value)
                          }
                      }, {
                          key: "getPcdnReq",
                          value: function(t) {
                              var e = new us.default.ClientQueryPcdnScheduleReq;
                              e.lReqTs = Date.now(),
                              e.lUid = z.a.uid,
                              e.sGuid = z.a.sGuid,
                              e.lAnchorUid = t.presenterUid,
                              e.iCdnLine = t.lineType,
                              e.iCliType = us.default.EM_CLINET_TYPE.E_CLIENT_WEB,
                              e.lBucketPara = 1e4,
                              e.vPcdnMode.value = [us.default.EM_PCDN_MODE.E_PcdnMode_P2pHttpSubstream];
                              var i = new Fs.Vector(new Fs.STRING);
                              return i.value = ["xy", "ppio"],
                              1 === Number(o.a.pcdnFlv) && (e.vPcdnMode.value.push(us.default.EM_PCDN_MODE.E_PcdnMode_FlvOutsideSdkFullstream),
                              e.mPcdnModeCliSupportPcdns.value[us.default.EM_PCDN_MODE.E_PcdnMode_FlvOutsideSdkFullstream] = i),
                              e.iBusiType = us.default.EM_BUSI_TYPE.E_BusiType_Live,
                              e.sStreamName = t.sStreamName,
                              e
                          }
                      }, {
                          key: "httpsFetch",
                          value: function() {
                              var t = this;
                              if (!this.isGetPcdnMode) {
                                  l.a.log("HYPlayer.httpsFetch");
                                  var e = this.pcdnInfo
                                    , i = this.getPcdnReq(e);
                                  l.a.log("HYPlayer.httpsFetch req", i);
                                  var s = Date.now().toString(16)
                                    , a = "https://pcdngw.huya.com/huyalive/clientQueryPcdnSchedule";
                                  a += "?wsSecret=".concat(Se("clientQueryPcdnSchedule".concat(s, "1211huyalive")), "&wsTime=").concat(s);
                                  var r = new Fs.JceOutputStream;
                                  i.writeTo(r),
                                  fetch(a, {
                                      body: r.getBuffer(),
                                      method: "POST"
                                  }).then((function(e) {
                                      var i = e.body.getReader();
                                      t.pump.call(t, i)
                                  }
                                  ))
                              }
                          }
                      }, {
                          key: "pump",
                          value: function(t) {
                              var e = this;
                              t.read().then(function(i) {
                                  if (i.done)
                                      l.a.log("httpsFetch done");
                                  else {
                                      var s = i.value.buffer;
                                      e.pump(t);
                                      var a = new Fs.JceInputStream(s)
                                        , r = new us.default.ClientQueryPcdnScheduleRsp;
                                      r.readFrom(a),
                                      e.getPcdnRes(r)
                                  }
                              }
                              .bind(this))
                          }
                      }, {
                          key: "getAnticode",
                          value: function(t, e) {
                              var i = e.split("&")
                                , s = {};
                              return i.map((function(t) {
                                  var e = t.split("=");
                                  2 == e.length && (s[e[0]] = e[1])
                              }
                              )),
                              s[t] ? s[t] : ""
                          }
                      }, {
                          key: "timeoutGetPcdn",
                          value: function() {
                              l.a.log("HYPlayer.timeoutGetPcdn"),
                              this.isGetPcdnMode || this.getPcdnSchedule(this.pcdnInfo)
                          }
                      }, {
                          key: "pushVideoPixlateInfo",
                          value: function(t) {
                              this.videoPixelateMgr.pushVideoPixlateInfo(t)
                          }
                      }, {
                          key: "setVideoPixelateBox",
                          value: function(t) {
                              this.videoPixelateMgr.setVideoPixelateBox(t)
                          }
                      }, {
                          key: "containerResize",
                          value: function() {
                              var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                              this.videoPixelateMgr && this.videoPixelateMgr.containerResize(t),
                              this.player && this.player.h265Proxy && this.player.h265Proxy.containerResize(t)
                          }
                      }, {
                          key: "getUseAuto",
                          value: function() {
                              return this.autoForce.getUseAuto()
                          }
                      }, {
                          key: "getSupportAuto",
                          value: function() {
                              return !o.a.getEnableJumpBuffer()
                          }
                      }, {
                          key: "_setEnablePixelate",
                          value: function(t) {
                              this.videoPixelateMgr.setEnablePixelate(t)
                          }
                      }, {
                          key: "getDelayInfo",
                          value: function() {
                              return this.player && this.player.mse ? this.player.mse.getDelayInfo() : this._type === t.HUYAWEBRTC ? this.player.getDelayInfo() : null
                          }
                      }, {
                          key: "getRealBitrate",
                          value: function() {
                              return this.player && this.player.mse ? this.player.mse.getRealBitrate() : this._type === t.HUYAWEBRTC ? this.player.getRealBitrate() : 0
                          }
                      }, {
                          key: "getRandomUseAiP2PFlv",
                          value: function(t) {
                              var e = localStorage.aiP2PFlvPresentUid
                                , i = t.presenterUid
                                , s = !0
                                , a = o.a.aiBlackUids;
                              if (l.a.log("HYPlayer.getRandomUseAiP2PFlv blackUids", a),
                              a.forEach((function(t) {
                                  i && t.toString() == i.toString() && (s = !1)
                              }
                              )),
                              /\/huyalive/g.test(t.sFlvUrl))
                                  return l.a.log("HYPlayer.getRandomUseAiP2PFlv flvUrk huyalive"),
                                  2;
                              if (!s || 0 == t.iIsP2PSupport)
                                  return 2;
                              if (o.a.isCloseP2P(t.uid))
                                  return 2;
                              if (o.a.useAV1)
                                  return 2;
                              localStorage.randomAIP2PFlvPercent && e == i || (localStorage.randomAIP2PFlvPercent = o.a.randomAIP2PFlvPercent);
                              var r = Number(localStorage.randomAIP2PFlvPercent);
                              return localStorage.aiP2PFlvPresentUid = t.presenterUid,
                              1 == Number(o.a.allUidsAiP2P) ? 1 : r < o.a.aiABRandomPercent ? (this.stat.setComDim("backup_field4", 0),
                              0) : r >= o.a.aiABRandomPercent && r < 2 * o.a.aiABRandomPercent ? (this.stat.setComDim("backup_field4", 1),
                              1) : (this.stat.setComDim("backup_field4", 2),
                              1)
                          }
                      }, {
                          key: "setAiP2PFlvComp",
                          value: function(t) {
                              var e = this.getRandomUseAiP2PFlv(t);
                              this.aiComp = e,
                              this.stat.setComDim("backup_field1", e),
                              0 == e || 2 == e ? o.a.setAiP2PToFlv(0) : 1 == e && o.a.setAiP2PToFlv(1)
                          }
                      }, {
                          key: "getAbTestConfig",
                          value: function() {
                              if (!this._initAb) {
                                  this._initAb = !0;
                                  var t = localStorage.abConfig;
                                  if (l.a.log("HYPlayer.getAbTestConfig abConfig", t),
                                  !t)
                                      return null;
                                  "" != (t = JSON.parse(t)).mpExperiment && this.stat.setComDim(d.a.DIM_COM.OEXP, t.mpExperiment),
                                  t.mpConfig && t.mpConfig.hasOwnProperty("pcdnConnectData2") && (o.a.pcdnAbConnectData[0] = Number(t.mpConfig.pcdnConnectData2)),
                                  t.mpConfig && t.mpConfig.hasOwnProperty("useAv1") && (o.a.abUseAv1 = Number(t.mpConfig.useAv1)),
                                  t.mpConfig && t.mpConfig.hasOwnProperty("isWebAutoABBBB") && (o.a.isWebAutoAB = Number(t.mpConfig.isWebAutoABBBB))
                              }
                          }
                      }, {
                          key: "getSdkTestConfig",
                          value: function() {
                              return [].join(",")
                          }
                      }, {
                          key: "onCheckTimer",
                          value: function(e, i) {
                              this._type && this._type != t.STREAM && this.roomRecordStat.onCheckTimer(e, i)
                          }
                      }, {
                          key: "setAv1Ab",
                          value: function(t) {
                              if (o.a.useAV1)
                                  if (MediaSource.isTypeSupported('video/mp4; codecs="av01.0.08M.08"')) {
                                      var e = v.b.getAv1Random(t, o.a.av1PercentConfig) ? 1 : 2;
                                      this.stat.setComDim("backup_field2", e)
                                  } else
                                      this.stat.setComDim("backup_field2", 3);
                              else
                                  this.stat.setComDim("backup_field2", 4)
                          }
                      }, {
                          key: "isSupportP2P",
                          get: function() {
                              return Xt.isSupportP2P()
                          }
                      }, {
                          key: "isWebrtcSupport",
                          get: function() {
                              return Xt.isWebrtcSupport()
                          }
                      }, {
                          key: "type",
                          get: function() {
                              return this._type
                          }
                      }, {
                          key: "isFlv",
                          get: function() {
                              return this._type == t.FLV
                          }
                      }, {
                          key: "isP2P",
                          get: function() {
                              return this._type == t.P2P
                          }
                      }, {
                          key: "isHls",
                          get: function() {
                              return this._type == t.HLS
                          }
                      }, {
                          key: "isHuya",
                          get: function() {
                              return this._type == t.HUYA
                          }
                      }, {
                          key: "isHuyaWebrtc",
                          get: function() {
                              return this._type == t.HUYAWEBRTC
                          }
                      }, {
                          key: "isP2pPlayIng",
                          get: function() {
                              return this._isP2pPlayIng
                          }
                      }]),
                      t
                  }();
                  Dr.FLV = 1,
                  Dr.P2P = 2,
                  Dr.HLS = 3,
                  Dr.HUYA = 4,
                  Dr.STREAM = 5,
                  Dr.OBS = 6,
                  Dr.VR = 7,
                  Dr.HUYAWEBRTC = 8,
                  Dr.PLAYBACK = 9,
                  Dr.P2PFLV = 10;
                  var Nr = e.default = Dr;
                  window.HYPlayer = Dr,
                  window.H5Player = Dr
              }
              , function(t, e, i) {
                  "use strict";
                  i.r(e);
                  var s = i(2)
                    , a = i(3)
                    , r = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || window.oRequestAnimationFrame
                    , o = window.cancelAnimationFrame || window.mozCancelAnimationFrame || window.webkitCancelAnimationFrame || window.msCancelAnimationFrame || window.oCancelAnimationFrame
                    , h = i(0)
                    , u = i(4)
                    , l = i(6)
                    , c = i(8)
                    , d = i(1)
                    , p = i(5)
                    , f = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.count = 0,
                          this.arr = []
                      }
                      return Object(a.a)(t, [{
                          key: "inc",
                          value: function(t) {
                              this.count += t
                          }
                      }, {
                          key: "dec",
                          value: function(t) {
                              this.count -= t,
                              this.count < 0 && (this.count = 0)
                          }
                      }, {
                          key: "collect",
                          value: function() {
                              this.arr.push(this.count),
                              this.count = 0
                          }
                      }, {
                          key: "stat",
                          value: function() {
                              var t = this.arr;
                              return this.arr = [],
                              t
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              this.count = 0,
                              this.arr = []
                          }
                      }]),
                      t
                  }()
                    , _ = {
                      toDecode: 0,
                      decoded: 1,
                      render: 2,
                      throwFrame: 3,
                      throwRaw: 4,
                      rawList: 5,
                      frameList: 6
                  }
                    , m = function() {
                      function t() {
                          Object(s.a)(this, t),
                          this.toDecodeItem = new f,
                          this.decodedItem = new f,
                          this.renderItem = new f,
                          this.throwFraItem = new f,
                          this.throwRawItem = new f,
                          this.rawItem = new f,
                          this.frameItem = new f,
                          this.rafItem = new f,
                          this.items = [this.toDecodeItem, this.decodedItem, this.renderItem, this.throwFraItem, this.throwRawItem, this.rawItem, this.frameItem, this.rafItem],
                          this.reset()
                      }
                      return Object(a.a)(t, null, [{
                          key: "TYPES",
                          get: function() {
                              return _
                          }
                      }]),
                      Object(a.a)(t, [{
                          key: "inc",
                          value: function(t, e) {
                              for (var i = 0; i < t.length; i++) {
                                  var s = this.getItem(t[i]);
                                  s && s.inc(e[i])
                              }
                              this.collect()
                          }
                      }, {
                          key: "dec",
                          value: function(t, e) {
                              for (var i = 0; i < t.length; i++) {
                                  var s = this.getItem(t[i]);
                                  s && s.dec(e[i])
                              }
                              this.collect()
                          }
                      }, {
                          key: "collect",
                          value: function() {
                              var t = l.a.now();
                              if (0 == this.lastStatTime && (this.lastStatTime = t),
                              t - this.lastStatTime >= 1e3) {
                                  for (var e = 0; e < this.items.length; e++)
                                      this.items[e].collect();
                                  this.lastStatTime = t
                              }
                          }
                      }, {
                          key: "getStat",
                          value: function() {
                              return {
                                  toDecode: this.toDecodeItem.stat(),
                                  decoded: this.decodedItem.stat(),
                                  render: this.renderItem.stat(),
                                  rawList: this.rawItem.stat(),
                                  frameList: this.frameItem.stat()
                              }
                          }
                      }, {
                          key: "getItem",
                          value: function(t) {
                              return t >= this.items.length ? null : this.items[t]
                          }
                      }, {
                          key: "reset",
                          value: function() {
                              this.lastStatTime = 0;
                              for (var t = 0; t < this.items.length; t++)
                                  this.items[t].reset()
                          }
                      }]),
                      t
                  }()
                    , v = i(21);
                  function y(t, e) {
                      Object.keys(t).forEach((function(i) {
                          return e(i, t[i])
                      }
                      ))
                  }
                  var T = function() {
                      function t(e, i) {
                          Object(s.a)(this, t),
                          this.stat = e,
                          this.tsdb = i,
                          this.resetProps(),
                          this.bindEvents = {
                              play: this.onPlay.bind(this),
                              pause: this.onPaused.bind(this)
                          },
                          this.stat = new m,
                          this.fpsList = [],
                          this.avgFrameGap = 0,
                          this.rafTime = 0,
                          this.isHidden = !1,
                          this.retryFlvTimes = 0,
                          this.retryP2PTimes = 0,
                          this.rafFrameBind = this.rafFrame.bind(this),
                          this.onVisibilityChangedBind = this.onVisibilityChanged.bind(this)
                      }
                      return Object(a.a)(t, null, [{
                          key: "isSupported",
                          value: function() {
                              return "object" == ("undefined" == typeof WebAssembly ? "undefined" : n(WebAssembly))
                          }
                      }]),
                      Object(a.a)(t, [{
                          key: "addEvents",
                          value: function() {
                              document.addEventListener("visibilitychange", this.onVisibilityChangedBind, !1),
                              document.addEventListener("mozvisibilitychange", this.onVisibilityChangedBind, !1),
                              document.addEventListener("msvisibilitychange", this.onVisibilityChangedBind, !1)
                          }
                      }, {
                          key: "delEvents",
                          value: function() {
                              document.removeEventListener("visibilitychange", this.onVisibilityChangedBind, !1),
                              document.removeEventListener("mozvisibilitychange", this.onVisibilityChangedBind, !1),
                              document.removeEventListener("msvisibilitychange", this.onVisibilityChangedBind, !1)
                          }
                      }, {
                          key: "addTimer",
                          value: function() {
                              c.a.add(this.timerHandler, this, 1e3),
                              c.a.add(this.fasterTimerHandler, this, 100)
                          }
                      }, {
                          key: "delTimer",
                          value: function() {
                              c.a.remove(this.timerHandler, this),
                              c.a.remove(this.fasterTimerHandler, this)
                          }
                      }, {
                          key: "attachMse",
                          value: function(t) {
                              h.a.log("H265Player.attachMse"),
                              this.mse = t,
                              this.resetProps();
                              var e = l.a.now();
                              this.onVideoFrameTime = e,
                              this.pushVideoTime = 0,
                              this.workerHeartTime = e,
                              this.updteFpsTime = 0,
                              this.mediaElement = t.video.video,
                              this.rafId = null,
                              this.rafFrame(),
                              this._initGL(t),
                              this.addEvents(),
                              this.addTimer()
                          }
                      }, {
                          key: "_initGL",
                          value: function(t) {
                              var e = t.h265Proxy.decoder;
                              e.onMessageCb = this._onMessage.bind(this),
                              this.decoder = e.decoder,
                              this.decoder.postMessage({
                                  t: 8,
                                  d: u.a.h265Config
                              }),
                              this.isPlaying = !0,
                              this.canvas = document.createElement("canvas"),
                              this.canvas.width = t.getWidth(),
                              this.canvas.height = t.getHeight(),
                              h.a.log("H265Player._initGL width=".concat(t.getWidth(), " height=").concat(t.getHeight()));
                              var i = this.canvas.transferControlToOffscreen();
                              this.decoder.postMessage({
                                  t: 10,
                                  canvas: i,
                                  width: this.mse.getWidth(),
                                  height: this.mse.getHeight(),
                                  config: u.a.h265Config[6]
                              }, [i]),
                              this._initDecodeWorker(),
                              y(this.bindEvents, (function(e, i) {
                                  t.video.video.addEventListener(e, i)
                              }
                              ))
                          }
                      }, {
                          key: "updateSize",
                          value: function() {}
                      }, {
                          key: "resetProps",
                          value: function() {
                              this.canvas = null,
                              this.frameList = [],
                              this.isPlaying = !1,
                              this._audioErrorCnt = 0,
                              this.onVideoFrameTime = 0,
                              this.pushVideoTime = 0,
                              this.workerHeartTime = 0,
                              this.decodeNow = 0,
                              this.renderTime = 0,
                              this.curPic = null,
                              this.pauseDecode = !1,
                              this.avgFrameGap = 33,
                              this.updteFpsTime = 0,
                              this.rafTime = 0,
                              this.pauseCnt = 0,
                              this.countHeart = 0,
                              this.rafNoRenderCount = 0,
                              this.isFirsrToDecode = !1,
                              this.toDecodeStamp = 0,
                              this.isFirstDecoded = !1,
                              this.decodedStamp = 0,
                              this.isFirstRender = !1,
                              this.renderStamp = 0,
                              this.renderStat = [],
                              this.decodedStat = [],
                              this.toDecodeStat = [],
                              this.frameListStat = [],
                              this.rafStat = [],
                              this.rawListStat = []
                          }
                      }, {
                          key: "timerHandler",
                          value: function() {
                              var t = l.a.now();
                              this.checkTimer(t),
                              this.timerTime = t
                          }
                      }, {
                          key: "fasterTimerHandler",
                          value: function() {
                              this.isHidden && this.storeAudioDts()
                          }
                      }, {
                          key: "checkTimer",
                          value: function() {
                              var t = this
                                , e = l.a.now();
                              0 != this.workerHeartTime && e - this.workerHeartTime > 5e3 && this.mse.h265Proxy && (h.a.log("H265Player.checkTimer worker error"),
                              this.mse.h265Proxy.terminate(),
                              setTimeout((function() {
                                  t.handlerError(v.a.WORKER_ERROR)
                              }
                              ), 200)),
                              0 != this.pushVideoTime && e - this.pushVideoTime > u.a.h265NoPushVideoDis && (h.a.log("H265Player.checkTimer pushVideoFrame timeout"),
                              this.handlerError(v.a.NO_DATA))
                          }
                      }, {
                          key: "getQueryString",
                          value: function(t) {
                              var e = new RegExp("(^|&)" + t + "=([^&]*)(&|$)")
                                , i = window.location.search.substr(1).match(e);
                              return null != i ? unescape(i[2]) : null
                          }
                      }, {
                          key: "onVisibilityChanged",
                          value: function() {
                              document.hidden || document.webkitHidden || document.mozHidden || document.msHidden ? (h.a.log("H265Player.onVisibilityChanged isHidden true"),
                              this.isHidden = !0,
                              this.decoder && this.decoder.postMessage({
                                  t: 12
                              })) : (h.a.log("H265Player.onVisibilityChanged isHidden false"),
                              this.renderTime = 0,
                              this.isHidden = !1,
                              this.decoder && this.decoder.postMessage({
                                  t: 13
                              }))
                          }
                      }, {
                          key: "_onMessage",
                          value: function(t) {
                              var e = t.data;
                              switch (e.t) {
                              case 5:
                                  break;
                              case 7:
                                  if (!this.isPlaying)
                                      return;
                                  e.d.logList && e.d.logList.length > 0 && (h.a.log("H265Player.onmessage.worker.log", e.d.logList.join(",")),
                                  e.d.logList = []),
                                  this.onDecodeError(e.d.data);
                                  break;
                              case 9:
                                  if (0 == e.d.length)
                                      return;
                                  h.a.log("H265Player.onmessage.worker.log", e.d.join(",")),
                                  e.d = [];
                                  break;
                              case 10:
                                  var i = l.a.now();
                                  this.workerHeartTime = i,
                                  this.countHeart++,
                                  this.countHeart % 20 == 0 && h.a.log("H265Player.onmessage.webWorker.heart");
                                  break;
                              case 11:
                                  break;
                              case 12:
                                  this.handlerError(v.a.RECEIVE_LIST_OUT_LIMIT);
                                  break;
                              case 13:
                                  this.onRenderError(e.d);
                                  break;
                              case 14:
                                  var s = e.d.renderNow
                                    , a = e.d.decodedNow
                                    , r = Date.now() - s;
                                  h.a.log("H265Player.onmessage render play postMessage cost", r),
                                  this.isFirstDecoded || (this.decodedStamp = a,
                                  this.isFirstDecoded = !0),
                                  this.isFirstRender || (this.renderStamp = s,
                                  this.isFirstRender = !0,
                                  h.a.log("H265Player.onmessage 送帧到解码，解码到渲染耗时", this.decodedStamp - this.toDecodeStamp, this.renderStamp - this.decodedStamp)),
                                  this.mse && this.mse.handler && (this.mse.triggerH265Play(this.decodedStamp - this.toDecodeStamp, this.renderStamp - this.decodedStamp),
                                  this.mse.handler.isH265Playing = !0);
                                  break;
                              case 15:
                                  this.pauseCnt++,
                                  h.a.log("H265Player.onmessage pauseCnt", this.pauseCnt);
                                  break;
                              case 16:
                                  h.a.log("H265Player.onmessage worker noRender 10s", this.isHidden),
                                  this.handlerError(v.a.NO_RENDER),
                                  this.autoReport();
                                  break;
                              case 17:
                                  this.handlerError(v.a.NO_DECODE);
                                  break;
                              case 18:
                                  e.d.render.length > 0 && (this.renderStat = this.renderStat.concat(e.d.render)),
                                  e.d.decoded.length > 0 && (this.decodedStat = this.decodedStat.concat(e.d.decoded)),
                                  e.d.toDecode.length > 0 && (this.toDecodeStat = this.decodedStat.concat(e.d.toDecode)),
                                  e.d.frameList.length > 0 && (this.frameListStat = this.frameListStat.concat(e.d.frameList)),
                                  e.d.raf.length > 0 && (this.rafStat = this.rafStat.concat(e.d.raf)),
                                  e.d.rawList.length > 0 && (this.rawListStat = this.rawListStat.concat(e.d.rawList));
                                  break;
                              case 19:
                                  this.handlerError(v.a.YUV_OUT_LIMIT);
                                  break;
                              case 20:
                                  this.reportError(v.a.CREATE_WEBGL_FAIL),
                                  this.turnToH264();
                                  break;
                              case 21:
                                  this.reportError(v.a.AUDIO_FAST),
                                  this.turnToH264();
                                  break;
                              case 22:
                                  this.reportError(v.a.VIDEO_FAST),
                                  this.turnToH264();
                                  break;
                              case 23:
                                  var n = e.data.width
                                    , o = e.data.height;
                                  h.a.log("H265Player.onMessage 23 width=".concat(n, " height = ").concat(o)),
                                  this.mse.setResolution(n, o);
                                  break;
                              case 24:
                                  this.mse && e && e.d && (this.mse.setVideoCurrentTimeHand(e.d.minusBuffer, e.d.bufLen, e.d.type, e.d.timeNow),
                                  this.storeAudioDts())
                              }
                          }
                      }, {
                          key: "_initDecodeWorker",
                          value: function(t) {
                              var e = new SharedArrayBuffer(8);
                              this.audioDtsShareBuffer = new Uint32Array(e),
                              this.decoder.postMessage({
                                  t: 16,
                                  d: this.audioDtsShareBuffer
                              })
                          }
                      }, {
                          key: "rafFrame",
                          value: function() {
                              1 == Number(localStorage._print265RenderInterval) && !this.isRenderInterval && this.decoder && (this.isRenderInterval = !0,
                              this.isNotRenderInterval = !1,
                              this.decoder.postMessage({
                                  t: 14,
                                  d: 0
                              })),
                              0 == Number(localStorage._print265RenderInterval) && !this.isNotRenderInterval && this.decoder && (this.isNotRenderInterval = !0,
                              this.isRenderInterval = !1,
                              this.decoder.postMessage({
                                  t: 14,
                                  d: 1
                              })),
                              this.storeAudioDts(),
                              this.rafFrameBind && (this.rafId = r(this.rafFrameBind))
                          }
                      }, {
                          key: "getStats",
                          value: function() {
                              var t = this.stat.getStat();
                              t.decoded = [].slice.call(this.decodedStat),
                              t.render = [].slice.call(this.renderStat),
                              t.toDecode = [].slice.call(this.toDecodeStat),
                              t.frameList = [].slice.call(this.rafStat),
                              t.rawListWorker = [].slice.call(this.rawListStat);
                              var e = "H265Player.getStats\n";
                              for (var i in t)
                                  e += "".concat(i, ": ").concat(t[i].toString(), "\n");
                              h.a.log(e);
                              var s = {
                                  frameListLen: this.frameList.length,
                                  statProps: t,
                                  h265PauseCnt: this.pauseCnt
                              };
                              return this.pauseCnt = 0,
                              this.renderStat = [],
                              this.decodedStat = [],
                              this.toDecodeStat = [],
                              this.frameListStat = [],
                              this.rafStat = [],
                              this.rawListStat = [],
                              s
                          }
                      }, {
                          key: "pushVideoFrame",
                          value: function(t) {
                              t.vps,
                              t.sps,
                              t.pps;
                              var e = t.samples;
                              if (this.isPlaying) {
                                  for (var i, s = l.a.now(), a = 0; a < e.length; a++) {
                                      var r = {
                                          units: (i = e[a]).units,
                                          dtsInMs: i.dts / 90,
                                          ptsInMs: i.pts / 90,
                                          key: i.key ? 1 : 0
                                      };
                                      this.isFirsrToDecode || (this.toDecodeStamp = Date.now(),
                                      this.isFirsrToDecode = !0),
                                      this.decoder.postMessage({
                                          t: 4,
                                          d: r
                                      }, r.units[0].data.buffer)
                                  }
                                  if (this.stat.inc([m.TYPES.rawList], [e.length]),
                                  s - this.updteFpsTime >= 1e3) {
                                      if (this.fpsList.length >= 5) {
                                          var n = 0;
                                          this.fpsList.forEach((function(t) {
                                              n += t
                                          }
                                          ));
                                          var o = Math.floor(1e3 / (n / 5));
                                          this.avgFrameGap = o > this.avgFrameGap ? this.avgFrameGap : o,
                                          this.decoder.postMessage({
                                              t: 9,
                                              d: this.avgFrameGap
                                          })
                                      } else
                                          this.fpsList.push(this.mse.parser.fps.getFps());
                                      this.updteFpsTime = s
                                  }
                                  this.pushVideoTime = s
                              }
                          }
                      }, {
                          key: "getPts",
                          value: function() {
                              return this.mse && this.mse.getCurrentDts ? this.mse.getCurrentDts() : 0
                          }
                      }, {
                          key: "onPlay",
                          value: function() {}
                      }, {
                          key: "autoReport",
                          value: function() {
                              1 == u.a.isAutoH265 && this.mse && this.mse.handler && this.mse.handler.eventEmitter && (h.a.log("H265Player.autoReport"),
                              this.mse.handler.eventEmitter.trigger(p.c.P2P_REPORT))
                          }
                      }, {
                          key: "onPaused",
                          value: function() {}
                      }, {
                          key: "destroy",
                          value: function() {
                              var t = this;
                              this.delEvents(),
                              this.delTimer(),
                              this.getStats(),
                              h.a.log("H265Player.destroy, rafid=", this.rafId),
                              o(this.rafId),
                              this.rafId = null,
                              clearInterval(this.timerHandler),
                              this.onPaused(),
                              this.decoder && this.decoder.postMessage({
                                  t: 6
                              }),
                              y(this.bindEvents, (function(e, i) {
                                  t.mediaElement && t.mediaElement.removeEventListener(e, i)
                              }
                              )),
                              this.resetProps(),
                              this.mediaElement = null,
                              this.mse = null,
                              this.pauseDecode = !1,
                              this.stat.reset(),
                              this.audioDtsShareBuffer && Atomics.store(this.audioDtsShareBuffer, 0, 0)
                          }
                      }, {
                          key: "onDecodeError",
                          value: function() {
                              var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}
                                , e = t.code
                                , i = t.desc;
                              h.a.error("H265Player.onDecodeError desc", i, e),
                              7 == e ? (this.reportError(v.a.WASM_TIMEOUT),
                              this.turnToH264()) : (this.autoReport(),
                              this.handlerError(v.a.DECODE_ERROR, e))
                          }
                      }, {
                          key: "onRenderError",
                          value: function() {
                              var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}
                                , e = t.code
                                , i = t.desc;
                              h.a.error("H265Player.onRenderError desc", i, e),
                              this.handlerError(v.a.RENDER_ERROR)
                          }
                      }, {
                          key: "turnToH264",
                          value: function() {
                              this.mse && this.mse.turnToH264()
                          }
                      }, {
                          key: "retry",
                          value: function() {
                              if (this.mse && this.mse.handler && this.mse.handler.eventEmitter) {
                                  var t = this.mse.handler.eventEmitter.type;
                                  t == window.HYPlayer.FLV ? this.retryFlvTimes++ : t == window.HYPlayer.P2P && this.retryP2PTimes++
                              }
                              this.mse && this.mse.h265Retry()
                          }
                      }, {
                          key: "handlerError",
                          value: function(t, e) {
                              if (this.isPlaying && (h.a.log("H265Player.handlerError", t),
                              this.reportError(t, e),
                              this.mse && this.mse.handler && this.mse.handler.eventEmitter)) {
                                  var i = this.mse.handler.eventEmitter.type;
                                  i == window.HYPlayer.FLV ? this.retryFlvTimes >= 10 ? this.turnToH264() : this.retry() : i == window.HYPlayer.P2P && (this.retryP2PTimes >= 10 ? this.turnToH264() : this.retry())
                              }
                          }
                      }, {
                          key: "reportError",
                          value: function(t, e) {
                              if (this.isPlaying && (h.a.log("H265Player.reportError", t, v.a.dic[t]),
                              this.mse && this.mse.handler && this.mse.handler.eventEmitter)) {
                                  var i = {
                                      value: [1],
                                      str: [t, null != e ? e : 1e4]
                                  };
                                  this.mse.handler.eventEmitter.tsdbUtil.sendMetrics([this.mse.handler.stat.createAct(d.a.ACT.H265_STATUS, i)])
                              }
                          }
                      }, {
                          key: "reportDecodeRenderTime",
                          value: function(t, e) {
                              if (h.a.log("H265Player.reportDecodeRenderTime", t, e),
                              this.mse && this.mse.handler && this.mse.handler.eventEmitter) {
                                  var i = {
                                      value: [t, e]
                                  };
                                  this.mse.handler.eventEmitter.tsdbUtil.sendMetrics([this.mse.handler.stat.createAct("pcdn_video_load_ts", i)])
                              }
                          }
                      }, {
                          key: "containerResize",
                          value: function() {
                              var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};
                              if (this.canvas) {
                                  var e = this.canvas.clientWidth
                                    , i = this.canvas.clientHeight;
                                  t.width = e,
                                  t.height = i,
                                  this.decoder && this.decoder.postMessage({
                                      t: 15,
                                      d: t
                                  })
                              }
                          }
                      }, {
                          key: "storeAudioDts",
                          value: function() {
                              var t = this.getPts();
                              this.audioDtsShareBuffer && this.isPlaying && Atomics.store(this.audioDtsShareBuffer, 0, t)
                          }
                      }, {
                          key: "jumpBuffer",
                          value: function(t, e, i, s) {
                              this.decoder && this.decoder.postMessage({
                                  t: 17,
                                  d: {
                                      minusBuffer: t,
                                      bufLen: e,
                                      type: i,
                                      timeNow: s
                                  }
                              })
                          }
                      }]),
                      t
                  }();
                  e.default = T
              }
              ]).default
          }
          ,
          "object" == n(e) && "object" == n(t) ? t.exports = r() : (s = [],
          void 0 === (a = "function" == typeof (i = r) ? i.apply(e, s) : i) || (t.exports = a))
      }
      ).call(this, i("YuTi")(t))
  },
  xUJ5: function(t, e, i) {
      "use strict";
      i.r(e);
      var s = /\s+/;
      function a() {}
      a.prototype.on = function(t, e, i) {
          var a, r;
          if (!e)
              return this;
          for (a = this.__events || (this.__events = {}),
          t = t.split(s); r = t.shift(); )
              (a[r] || (a[r] = [])).push(e, i);
          return this
      }
      ,
      a.prototype.once = function(t, e, i) {
          var s = this;
          return this.on(t, (function a() {
              s.off(t, a),
              e.apply(i || s, arguments)
          }
          ), i)
      }
      ,
      a.prototype.off = function(t, e, i) {
          var a, n, o, h;
          if (!(a = this.__events))
              return this;
          if (!(t || e || i))
              return delete this.__events,
              this;
          for (t = t ? t.split(s) : r(a); n = t.shift(); )
              if (o = a[n])
                  if (e || i)
                      for (h = o.length - 2; h >= 0; h -= 2)
                          e && o[h] !== e || i && o[h + 1] !== i || o.splice(h, 2);
                  else
                      delete a[n];
          return this
      }
      ,
      a.prototype.trigger = function(t) {
          var e, i, a, r, o, h, u = [], l = !0;
          if (!(e = this.__events))
              return this;
          for (t = t.split(s),
          o = 1,
          h = arguments.length; o < h; o++)
              u[o - 1] = arguments[o];
          for (; i = t.shift(); )
              (a = e.all) && (a = a.slice()),
              (r = e[i]) && (r = r.slice()),
              "all" !== i && (l = n(r, u, this) && l),
              l = n(a, [i].concat(u), this) && l;
          return l
      }
      ,
      a.prototype.emit = a.prototype.trigger;
      var r = Object.keys;
      function n(t, e, i) {
          var s = !0;
          if (t) {
              var a = 0
                , r = t.length
                , n = e[0]
                , o = e[1]
                , h = e[2];
              switch (e.length) {
              case 0:
                  for (; a < r; a += 2)
                      s = !1 !== t[a].call(t[a + 1] || i) && s;
                  break;
              case 1:
                  for (; a < r; a += 2)
                      s = !1 !== t[a].call(t[a + 1] || i, n) && s;
                  break;
              case 2:
                  for (; a < r; a += 2)
                      s = !1 !== t[a].call(t[a + 1] || i, n, o) && s;
                  break;
              case 3:
                  for (; a < r; a += 2)
                      s = !1 !== t[a].call(t[a + 1] || i, n, o, h) && s;
                  break;
              default:
                  for (; a < r; a += 2)
                      s = !1 !== t[a].apply(t[a + 1] || i, e) && s
              }
          }
          return s
      }
      r || (r = function(t) {
          var e = [];
          for (var i in t)
              t.hasOwnProperty(i) && e.push(i);
          return e
      }
      ),
      a.mixTo = function(t) {
          var e;
          e = t,
          t = "[object Function]" === Object.prototype.toString.call(e) ? t.prototype : t;
          var i = a.prototype
            , s = new a;
          !function(t, e) {
              if (t.forEach)
                  return t.forEach(e);
              for (var i = 0, s = t.length; i < s; i += 1)
                  e(t[i], i, t)
          }(Object.keys(i), (function(e) {
              t[e] = function() {
                  return i[e].apply(s, Array.prototype.slice.call(arguments)),
                  this
              }
          }
          ))
      }
      ;
      var o = a
        , h = {};
      !function() {
          var t = self.navigator.userAgent.toLowerCase()
            , e = /(edge)\/([\w.]+)/.exec(t) || /(opr)[\/]([\w.]+)/.exec(t) || /(chrome)[ \/]([\w.]+)/.exec(t) || /(iemobile)[\/]([\w.]+)/.exec(t) || /(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(t) || /(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(t) || /(webkit)[ \/]([\w.]+)/.exec(t) || /(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t) || /(msie) ([\w.]+)/.exec(t) || t.indexOf("trident") >= 0 && /(rv)(?::| )([\w.]+)/.exec(t) || t.indexOf("compatible") < 0 && /(firefox)[ \/]([\w.]+)/.exec(t) || []
            , i = /(ipad)/.exec(t) || /(ipod)/.exec(t) || /(windows phone)/.exec(t) || /(iphone)/.exec(t) || /(kindle)/.exec(t) || /(android)/.exec(t) || /(windows)/.exec(t) || /(mac)/.exec(t) || /(linux)/.exec(t) || /(cros)/.exec(t) || []
            , s = {
              browser: e[5] || e[3] || e[1] || "",
              version: e[2] || e[4] || "0",
              majorVersion: e[4] || e[2] || "0",
              platform: i[0] || ""
          }
            , a = {};
          if (s.browser) {
              a[s.browser] = !0;
              var r = s.majorVersion.split(".");
              a.version = {
                  major: parseInt(s.majorVersion, 10),
                  string: s.version
              },
              r.length > 1 && (a.version.minor = parseInt(r[1], 10)),
              r.length > 2 && (a.version.build = parseInt(r[2], 10))
          }
          if (s.platform && (a[s.platform] = !0),
          (a.chrome || a.opr || a.safari) && (a.webkit = !0),
          a.rv || a.iemobile) {
              a.rv && delete a.rv;
              s.browser = "msie",
              a.msie = !0
          }
          if (a.edge) {
              delete a.edge;
              s.browser = "msedge",
              a.msedge = !0
          }
          if (a.opr) {
              s.browser = "opera",
              a.opera = !0
          }
          if (a.safari && a.android) {
              s.browser = "android",
              a.android = !0
          }
          for (var n in a.name = s.browser,
          a.platform = s.platform,
          h)
              h.hasOwnProperty(n) && delete h[n];
          Object.assign(h, a)
      }();
      var u = h
        , l = {
          getCookie: function(t) {
              for (var e = t + "=", i = document.cookie.split(";"), s = 0, a = i.length; s < a; s++) {
                  var r = i[s].trim();
                  if (0 == r.indexOf(e))
                      return r.substr(e.length)
              }
              return ""
          },
          getQueryString: function(t) {
              var e = new RegExp("(^|&)" + t + "=([^&]*)(&|$)")
                , i = window.location.search.substr(1).match(e);
              return null != i ? unescape(i[2]) : null
          },
          unescapeHTML: function(t) {
              return (t = "" + t).replace(/&lt;/g, "<").replace(/&gt;/g, ">").replace(/&amp;/g, "&").replace(/&quot;/g, '"').replace(/&apos;/g, "'")
          },
          padNum: function(t, e) {
              var i = t.toString().length;
              return "0".repeat(e - i) + t
          },
          getDateTimeStr: function() {
              var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : NaN
                , e = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1]
                , i = null
                , s = (i = t ? new Date(t) : new Date).getFullYear()
                , a = l.padNum(i.getMonth() + 1, 2)
                , r = l.padNum(i.getDate(), 2)
                , n = l.padNum(i.getHours(), 2)
                , o = l.padNum(i.getMinutes(), 2)
                , h = l.padNum(i.getSeconds(), 2)
                , u = "".concat(s, "-").concat(a, "-").concat(r, " ").concat(n, ":").concat(o, ":").concat(h);
              if (e) {
                  var c = l.padNum(i.getMilliseconds(), 3);
                  u += "." + c
              }
              return u
          },
          generateUUID: function(t, e) {
              var i, s, a = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""), r = [];
              if (e = e || a.length,
              t)
                  for (i = 0; i < t; i++)
                      r[i] = a[0 | Math.random() * e];
              else
                  for (r[8] = r[13] = r[18] = r[23] = "-",
                  r[14] = "4",
                  i = 0; i < 36; i++)
                      r[i] || (s = 0 | 16 * Math.random(),
                      r[i] = a[19 == i ? 3 & s | 8 : s]);
              return r.join("")
          }
      }
        , c = l;
      function d(t) {
          return (d = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(t) {
              return typeof t
          }
          : function(t) {
              return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t
          }
          )(t)
      }
      var p = 1 == localStorage.log ? 0 : 4
        , f = !0;
      //!!Number(localStorage._printLogTime);
      function _() {
          return c.getDateTimeStr() + ""
      }
      var m = {
          _data: [],
          _length: 0,
          _printAudioFrame: !!Number(localStorage._printAudioFrame),
          _printVideoFrame: !!Number(localStorage._printVideoFrame),
          getLogTimeState: function() {
              return f
          },
          setLogTimeState: function(t) {
              f != !!t && (m.log("setLogTimeState to " + !!t),
              f = !!t)
          },
          debug: function() {
              var t = _()
                , e = Array.apply(null, arguments);
              p <= -1 && (f && (e[0] = t + " " + e[0]),
              console.log.apply(console, e))
          },
          log: function(t) {
              var e = _()
                , i = Array.apply(null, arguments);
              p <= 0 && (f && (i[0] = e + " " + i[0]),
              console.log.apply(console, i)),
              m.record(e, i, "log")
          },
          info: function(t) {
              var e = _()
                , i = Array.apply(null, arguments);
              p <= 1 && (f && (i[0] = e + " " + i[0]),
              console.info.apply(console, i)),
              m.record(e, i, "info")
          },
          warn: function(t) {
              var e = _()
                , i = Array.apply(null, arguments);
              p <= 2 && (f && (i[0] = e + " " + i[0]),
              console.warn.apply(console, i)),
              m.record(e, i, "warn")
          },
          error: function(t) {
              var e = _()
                , i = Array.apply(null, arguments);
              p <= 3 && (f && (i[0] = e + " " + i[0]),
              console.error.apply(console, i)),
              m.record(e, i, "error")
          },
          group: function(t) {
              var e = _()
                , i = Array.apply(null, arguments);
              if (p <= 1) {
                  f && (i[0] = e + " " + i[0]);
                  var s = console.groupCollapsed || console.group || console.log;
                  s.apply(console, i)
              }
              m.record(e, i, "group")
          },
          groupEnd: function() {
              console.groupEnd && console.groupEnd.apply(console)
          },
          setLevel: function(t) {
              t != p && (console.log(_() + " set log level from " + p + " to " + t),
              p = t)
          },
          getLevel: function() {
              return p
          },
          record: function(t, e, i) {
              1100 === m._length && (m._data.splice(0, 100),
              m._length = 1e3);
              var s = 0
                , a = (e.shift() || "").toString();
              for (a = a.replace(/\%c/gi, (function(t, e) {
                  return s++,
                  ""
              }
              )); s-- && e.length; )
                  e.shift();
              for (var r = 0, n = e.length; r < n; r++) {
                  "object" == d(e[r]) && (e[r] = "")
              }
              e.unshift(t, a);
              var o = e.join(" ");
              m._length++,
              m._data.push("[".concat(i, "]").concat(o))
          },
          getLog: function() {
              return m._data.unshift(u.platform + " " + u.name + " " + u.version.string),
              m._data
          }
      }
        , v = m;
      function y(t) {
          return (y = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(t) {
              return typeof t
          }
          : function(t) {
              return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t
          }
          )(t)
      }
      var T = new function() {
          var t = ["1400", "7501", "6501", "7707", "6223", "6110", "6630", "8006", "6210", "8007", "3102", "3104", "1024344"]
            , e = {}
            , i = []
            , s = []
            , a = {}
            , r = {}
            , n = "player"
            , o = "ext"
            , h = 200;
          function u() {
              var t = i.join(",");
              return e.uri = t,
              e
          }
          function l(t) {
              return r[t]
          }
          function c(t, e) {
              null == a[t] && (a[t] = []),
              a[t].push(e)
          }
          window.getdd = function() {
              var t = l(n);
              console.log(t, "module", t.$$feedbackLimitModule.getListData())
          }
          ,
          window.makeUriLog = u,
          this.addLog = function(t) {
              S.h5Log.length > 100 && (S.h5Log = S.h5Log.slice(10));
              var e = ""
                , i = (new Date).toLocaleString();
              e = "object" == y(t) ? i + "  " + JSON.stringify(t) : i + "  " + t;
              var s = l(n);
              s ? s.$$feedbackLimitModule.push(e) : c(n, e),
              S.h5Log.push(e)
          }
          ,
          this.addUri = function(s) {
              var a = s.toString();
              if (-1 == t.indexOf(a))
                  i.push(a),
                  i.length > 200 && (i = i.slice(10));
              else {
                  var r = e[a];
                  r ? (r++,
                  e[a] = r) : e[a] = 1
              }
          }
          ,
          this.addExtLog = function(t) {
              localStorage.extLog && console.log(t);
              var e = l(o);
              e ? e.$$feedbackLimitModule.push(t) : c(o, t),
              s.push(t),
              s.length > 300 && (s = s.slice(10))
          }
          ,
          this.getExtLog = function() {
              return s
          }
          ,
          this.makeUriLog = u,
          this.feedbackSdkReady = function() {
              r[n] = S.feedbackSdk.setFbModule(n, h),
              r[o] = S.feedbackSdk.setFbModule(o, h),
              function() {
                  for (var t in a) {
                      var e = l(t);
                      if (e && e.$$feedbackLimitModule)
                          for (var i in a[t])
                              e.$$feedbackLimitModule.push(a[t][i])
                  }
              }(),
              r[n].livingInfo = JSON.stringify(S.livingInfo)
          }
      }
        , g = {
          ENV: null,
          vplayer: null,
          vplayerUI: null,
          logUtils: T,
          Event: k,
          menuItems: [],
          menuData: [[{
              text: "虎牙直播(H5)_2202141108"
          }], [], [{
              text: "查看视频信息",
              func: function() {
                  k.fireEvent(k.SHOW_VIDEO_INFO)
              }
          }, {
              text: "视频问题反馈",
              func: function() {
                  g.vplayerUI.showFeedback()
              }
          }, {
              text: "海量弹幕",
              func: function() {
                  k.fireEvent(k.CHAT_MODE_CHANGE)
              }
          }]],
          streamSetFlag: !1,
          sdkCommonAb: ""
      }
        , S = g;
      g.menuItems = [],
      g.beginTime = Date.now(),
      g.serverTimeGap = 0,
      g.getServerTime = function() {
          return Date.now() + g.serverTimeGap
      }
      ,
      g.yyuid = parseInt(c.getCookie("yyuid")) || parseInt(c.getCookie("udb_uid")) || 0,
      g.isLogin = g.yyuid > 0,
      g.anonymousUid = 0,
      g.setAnonymousUid = function() {
          g.isLogin || (g.anonymousUid = localStorage.anonymousUid ? parseInt(localStorage.anonymousUid) : c.generateUUID(13, 10))
      }
      ,
      g.setAnonymousUid(),
      g.resetLoginStatus = function() {
          g.yyuid = 0,
          g.setAnonymousUid(),
          g.userId && (g.userId.lUid = 0)
      }
      ,
      g.appid = 0,
      g.topsid = 0,
      g.subsid = 0,
      g.gameId = 0,
      g.mute = 0,
      g.vAppid = 66,
      g.vAppidTest = 67,
      g.videoLine = -1,
      g.flacFlv = "",
      g.livingInfoRecorded = null,
      g.wsurl = "",
      g.wsconnected = !1,
      g.reConnectTimes = 0,
      g.wsIps = [],
      g.httpWs = [],
      g.badWsIps = [],
      g.badCode = [],
      g.badReason = "",
      g.loginRegister = !1,
      g.userIn = !1,
      g.tafInited = !1,
      g.wsConnectTime = 0,
      g.loginRegisterTime = 0,
      g.userInTime = 0,
      g.livingInfoTime = 0,
      g.firstVideoTime = 0,
      g.userId = null,
      g.presenterUid = 0,
      g.hasVideo = !1,
      g.isPlaying = !1,
      g.isPause = !1,
      g.isServPlaying = !1,
      g.isUIPause = !1,
      g.enforceLowestBitRate = !1,
      g.is360Video = !1,
      g.lLiveCompatibleFlag = 0,
      g.isVideoMaster = function() {
          return "" != g.yyuid && 0 != g.yyuid && 0 != g.presenterUid && g.yyuid == g.presenterUid
      }
      ,
      g.nobleInfo = null,
      g.livingInfo = null,
      g.streamInfo = null,
      g.feedbackSdk = null,
      g.isH265 = !1,
      g.isSupportedHevc = !0,
      g.SrcBitRate = 0,
      g.curBitRate = 0,
      g.hasAutoBitrate = !1,
      g.isAutoBitrate = !1,
      g.autoCurBitrate = 0,
      g.pullStreamFrom = 0,
      g.getCurBitRate = function() {
          return g.curBitRate
      }
      ,
      g.isH265CodecType = function(t) {
          return 1 == t || 4 == t || 6 == t || 8 == t
      }
      ,
      g.getTrueBitRate = function() {
          var t = g.getCurBitRate();
          return 0 == t && (t = g.SrcBitRate),
          g.isAutoBitrate && g.autoCurBitrate && (t = g.autoCurBitrate),
          t
      }
      ,
      g.bitRateList1 = [],
      g.getBitRateList = function() {
          return g.bitRateList1
      }
      ,
      g.getBitRateData = function() {
          for (var t in g.bitRateList1)
              if (g.curBitRate == g.bitRateList1[t].iBitRate)
                  return g.bitRateList1[t];
          return null
      }
      ,
      g.H5ROOT = "//a.msstatic.com/huya/h5player/room/2202141108/",
      function() {
          for (var t = document.scripts, e = 0, i = t.length; e < i; e++) {
              var s = t[e].src
                , a = s.match(/\/vplayer.*?\.js/);
              if (a) {
                  g.H5ROOT = s.substring(0, a.index + 1);
                  break
              }
          }
      }(),
      g.propsDict = {},
      g.roomGiftDict = [],
      g.userInfo = null,
      g.isUserInfoInited = function() {
          return null != g.userInfo
      }
      ,
      g.getUserName = function() {
          return g.userInfo && g.userInfo.sPassport || c.getCookie("username")
      }
      ,
      g.getNickName = function() {
          return g.userInfo && g.userInfo.sNick || ""
      }
      ,
      g.encryptIps = localStorage.wssips,
      g.isFullSize = !1,
      g.isFullscreen = !1,
      g.screenStatus = 1,
      g.isShowDanmu = !0,
      g.isLoginTipShow = !1,
      g.isFromApp = !1,
      g.isYanzhi = !1,
      g.isPeiWan = !1,
      g.isMobileStarShow = !1,
      g.isMakeFriend = !1,
      g.makeFriendData = [],
      g.curSendGiftData = null,
      g.subscribedCount = 0,
      g.appSrc = "HUYA&ZH&2052",
      g.videoTimeData = null,
      g.onceLimitGreenBean = 0,
      g.udbAppid = 5700,
      g.udbAppkey = "Ol2lAiO05O8RwRGsK5xbo55bxtykKAFM",
      g._needTokenWup = [],
      g.needTokenWup = {};
      for (var P = 0, E = g._needTokenWup.length; P < E; P++) {
          var I = g._needTokenWup[P];
          g.needTokenWup[I] = !0
      }
      function A(t, e) {
          if (!t)
              return !1;
          for (var i = t.split(","), s = i.length, a = 0; a < s; a++)
              if (i[a] == e)
                  return !0;
          return !1
      }
      g.iAttendeeCount = 0,
      g.useHttps = !0,
      g.isReplay = !1,
      g.lGroupId = 0,
      g.lGroupType = 0,
      g.isKongZhong = !1,
      g.isCFMiNi = !1,
      g.h5Log = [],
      g.deleteOriginalPainting = function() {
          var t = g.ENV;
          if (!t.deleteOriginalPainting || "-1" == t.deleteOriginalPainting)
              return !1;
          for (var e, i, s = t.deleteOriginalPainting.split(","), a = 0; a < s.length; a++) {
              var r = s[a]
                , n = "string" == typeof r ? r.split("_") : [];
              if (n.length > 1) {
                  if (i = n[0],
                  e = n[1],
                  g.topsid == i && g.subsid == e)
                      return !0
              } else if (i = r,
              g.topsid == i)
                  return !0
          }
          return !1
      }
      ,
      g.iCdnPolicyLevel = 0,
      g.specialGameId = [2135, 2333, 2356, 2408, 2409],
      g.useHuyaSdk = !0,
      g.useP2p = !1,
      g.flvUseHttps = !0,
      g.isShowPresentRecommend = !1,
      g.isFirstVideoPlay = !1,
      g.isMaxDanmu = !1,
      g.ishowRecommend = !1,
      g.flvTokenList = [],
      g.priorityGiftShowNum = 8,
      g.allGiftShowNum = 8,
      g.volume = 0,
      g.isPlayAbs = !1,
      g.isPaused = !1,
      g.isP2pPlayIng = !1,
      g.questionBannerIdArr = [253, 7],
      g.liveid = "0",
      g.sSchedule = "",
      g.sDescription = "",
      g.extTafFunName = [],
      g.extTafUri = [],
      g.extVideoPlay = !1,
      g.extBarrageTags = [],
      g.isGodLiePlay = !1,
      g.accMasterData = null,
      g.isOBWatch = !1,
      g.isOBRoom = !1,
      g.obPerspectiveList = [],
      g.obCurrentPerspective = {},
      g.obVideoPos = {},
      g.obCurPid = 0,
      g.obStatus = 1,
      g.obVideoState = {
          state: 1004
      },
      g.vrSwitch = !0,
      g.extStreamVR = !1,
      g.vrNoStream = !1,
      g.matchReplayStatus = 0,
      g.matchReplayUrl = "",
      g.matchReplaySeekTime = 0,
      g.matchReplayCdnName = "",
      g.isDebug = function() {
          var t = window.location.host.split(".")[0];
          return "test" == t || "develop" == t || "test-www" == t
      }
      ,
      g.isHttps = function() {
          return !g.isDebug()
      }
      ,
      g.baseinfo = "",
      g.visibilityState = "visible",
      g.isUnion = !1,
      g.lXid = 0,
      g.isShieldingEffect = !1,
      g.isManager = !1,
      g.bDirector = !1,
      g.isOpenFlac = !1,
      g.flacSwitch = !0,
      g.freezeLevel = 0,
      g.isCheckDefBit = !1,
      g.paymentStatus = 0,
      g.isPip = !1,
      g.roomFeatures = null,
      g.uiActivated = !0,
      g.giftEffectEnable = !0,
      g.danmuGroudId = [],
      g.danmuLruCache = !0,
      g.hasDanmuMask = !1,
      g.dropDanmuOpen = !1,
      g.filterDanmuRatio = 0,
      g.dropDanmuCount = 0,
      g.danmuShowCount = 0,
      g.videoBadQualityCount = 0,
      g.isFilterDanmu = function() {
          return 0 != g.filterDanmuRatio && g.filterDanmuRatio > Math.random()
      }
      ,
      g.verifyCookiePass = !0,
      g.yaInit = !1,
      g.followList = null,
      g.calljsCache = {},
      g.hasMFVideo = !1,
      g.useCdnAll = !1,
      g.hasVirtualPk = !1,
      g.isSuperFans = !1,
      g.superFanstime = "",
      g.isAllChat = !1,
      g.isForeign = !1,
      g.isCopyright = !1,
      g.isSecret = !1,
      g.password = "",
      g.mountsList = [],
      g.from = "",
      g.turnToFlv = !1,
      g.noLineInLive = !1,
      g.isWebrtcSupport = !0,
      g.webrtcErr = !1,
      g.hasLine4 = !1,
      g.onlyLine4 = !1,
      g.streamInfoLine4,
      g.spliteSceenType = 0,
      g.splitScreenId = 0,
      g.guid = 0,
      g.getGuid = function() {
          return g.guid || c.getCookie("guid") || ""
      }
      ,
      g.judgPlayerData = function(t, e, i) {
          if (!e[t])
              return i;
          if (1 == e[t])
              return !0;
          if (0 == e[t])
              return !1;
          if ("openp2p" == t)
              return 1 == e[t];
          var s, a, r = e[t].split(",");
          if ("p2ppid" == t || "danmuMaskOpenPid" == t)
              return -1 != r.indexOf(g.presenterUid.toString());
          for (var n = 0; n < r.length; n++) {
              var o = r[n]
                , h = "string" == typeof o ? o.split("_") : [];
              if (h.length > 1) {
                  if (a = h[0],
                  s = h[1],
                  g.topsid == a && g.subsid == s)
                      return !0
              } else if (a = o,
              g.topsid == a)
                  return !0
          }
          return !1
      }
      ,
      g.playerConfig = {},
      g.openMFVideo = !0,
      g.isLowLatency = !1,
      g.renderMode = 1,
      g.obConfig = {},
      g.hlsLivePid = !1,
      g.setPlayerConfig = function() {
          try {
              var t = g.ENV.conf.playerConfig;
              t = c.unescapeHTML(t),
              g.playerConfig = JSON.parse(t),
              g.openMFVideo = !("0" == g.playerConfig.openMFVideo),
              g.isLowLatency = A(g.playerConfig.lowLatencyPid, g.presenterUid) || A(g.playerConfig.lowLatencyGameId, g.gameId),
              g.obConfig = g.playerConfig.ob || {},
              g.hlsLivePid = A(g.playerConfig.hlsLivePid, g.presenterUid),
              g.danmuMaskOpen = !("0" == g.playerConfig.danmuMaskOpen)
          } catch (t) {
              console.log("playerConfig error")
          }
      }
      ,
      g.sdkExtendConfig = {},
      g._sdkExtendConfig = {},
      g.p2pLineClose = [],
      g.danmuMask = !0,
      g.videoDns = !0,
      g.danmuP2P = !0,
      g.danmuMaskbroadcastGroup = "",
      g.setConfigData = function() {
          var t = g.ENV
            , e = {};
          try {
              e = t.conf.playerdata,
              e = c.unescapeHTML(e),
              g._sdkExtendConfig.sdk = JSON.parse(e).sdk,
              e = JSON.parse(e)
          } catch (t) {
              console.log("playerdata error")
          }
          var i = g.judgPlayerData("p2p", e, !1)
            , s = g.judgPlayerData("p2ppid", e, !1);
          g.flvUseHttps = g.judgPlayerData("flvhttps", e, g.flvUseHttps),
          g.useHttps = g.judgPlayerData("usehttps", e, g.useHttps),
          g.flacSwitch = g.judgPlayerData("flacSwitch", e, g.flacSwitch),
          g.danmuMask = g.judgPlayerData("danmuMask", e, g.danmuMask),
          g.videoDns = g.judgPlayerData("videoDns", e, g.videoDns),
          g.danmuP2P = g.judgPlayerData("danmuP2P", e, g.danmuP2P),
          g.sdkExtendConfig.sdk = e.sdk;
          var a = e.p2pLineClose;
          a && (g.p2pLineClose = a.split(",")),
          g.isHttps() && (g.flvUseHttps = !0);
          var r = 1 == i || 1 == s
            , n = g.judgPlayerData("openp2p", e, !0);
          g.useP2p = n ? !r : r
      }
      ,
      g.abConfig = null,
      g.aBTestShieldBitrate = -1,
      g.aBTestDefaultBitrate = -1,
      g.mpExperiment = "",
      g.enableTrace = 0,
      g.checkLowCpu = !0,
      g.setABTestConfig = function() {
          var t = localStorage.abConfig;
          if (t)
              try {
                  var e = (t = JSON.parse(t)).mpConfig;
                  e.pidList;
                  if (e && e.webDefaultBitRate > 0 && (g.aBTestDefaultBitrate = parseInt(e.webDefaultBitRate)),
                  e && e.delBitrate > 0 && (g.aBTestShieldBitrate = parseInt(e.delBitrate)),
                  g.mpExperiment = t.mpExperiment || "",
                  e.hasOwnProperty("trace.enableTrace"))
                      g.enableTrace = e["trace.enableTrace"];
                  else {
                      var i = Math.random() < .1;
                      g.enableTrace = i ? 1 : 0
                  }
              } catch (t) {
                  console.log("abtest设置错误", t)
              }
      }
      ,
      g.getVRType = function() {
          var t = g.lLiveCompatibleFlag;
          return 1 == (1 & t) || 128 == (128 & t) ? 2 == (2 & t) || 256 == (256 & t) ? 6 : 4 == (4 & t) || 512 == (512 & t) ? 5 : 4 : 1024 == (1024 & t) || 64 == (64 & t) ? 2 == (2 & t) || 256 == (256 & t) ? 3 : 4 == (4 & t) || 512 == (512 & t) ? 2 : 1 : 4
      }
      ,
      g.makeHttpsUrl = function(t) {
          return t = t.replace("http:", "https:")
      }
      ,
      g.getTraceId = function() {
          return "xxxxxxxxxxxxxxxx".replace(/[xy]/g, (function(t) {
              var e = 16 * Math.random() | 0;
              return ("x" == t ? e : 3 & e | 8).toString(16)
          }
          ))
      }
      ,
      g.browerPause = !1,
      g.isSupportWebp = !0,
      function() {
          var t = new Image;
          function e(e) {
              g.isSupportWebp = !(!e || "load" !== e.type) && 1 == t.width
          }
          t.onerror = e,
          t.onload = e,
          t.src = "data:image/webp;base64,UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA=="
      }();
      var C = {
          addEvent: function(t, e) {
              S.vplayer.on(t, e)
          },
          removeEvent: function(t, e) {
              S.vplayer.off(t, e)
          },
          fireEvent: function(t, e) {
              S.vplayer.trigger(t, e)
          },
          WEBSOCKET_INITED: "WEBSOCKET_INITED",
          VIDEO_FIRST_PLAY: "VIDEO_FIRST_PLAY",
          PLAYER_UI_INITED: "PLAYER_UI_INITED",
          USER_INFO_INITED: "USER_INFO_INITED",
          VIDEO_PLAY: "VIDEO_PLAY",
          VIDEO_STOP: "VIDEO_STOP",
          PROPS_INITED: "PROPS_INITED",
          DYNAMIC_LOGIN: "DYNAMIC_LOGIN",
          CHANGE_TO_FLASH: "CHANGE_TO_FLASH",
          SHOW_BITRATE_TIP: "SHOW_BITRATE_TIP",
          FUllSCREEN_CHANGE: "FUllSCREEN_CHANGE",
          FUll_OR_WEBFULL_SCREEN_CHANGE: "FUll_OR_WEBFULL_SCREEN_CHANGE",
          NEW_VIDEO: "NEW_VIDEO",
          SHOW_VIDEO_INFO: "SHOW_VIDEO_INFO",
          SHOW_MARQUEE: "SHOW_MARQUEE",
          ATTENDEE_COUNT_CHANGE: "ATTENDEE_COUNT_CHANGE",
          REPlAY_START_PLAY: "REPlAY_START_PLAY",
          PlAY_CHANNEl: "PlAY_CHANNEl",
          GET_GAMELIVE_HISUPON_REQ: "GET_GAMELIVE_HISUPON_REQ",
          PAUSE_VIDEO: "PAUSE_VIDEO",
          REFRESH_VISUALANGLE: "REFRESH_VISUALANGLE",
          SHOW_VR_UI: "SHOW_VR_UI",
          HIDE_VR_UI: "HIDE_VR_UI",
          SHOW_RECOMMEND: "SHOW_RECOMMEND",
          HIDE_RECOMMEND: "HIDE_RECOMMEND",
          SHOW_FORBID_RECOMMEND: "SHOW_FORBID_RECOMMEND",
          VOLUME_CHANGE: "VOLUME_CHANGE",
          AUTO_FEEDBACK: "AUTO_FEEDBACK",
          DATA_METRIC: "DATA_METRIC",
          DATA_METRIC2: "DATA_METRIC2",
          SAVE_BAG_SET: "saveBagSet",
          GIVE_GIFT: "giveGift",
          TONGJI_READY: "tongjiReady",
          PLAYER_FLOAT: "playerFloat",
          QUIT_FULL_SCREEN: "quitFullScreen",
          QUIT_FULL_MODE: "quitFullMode",
          MSG_SHIELD_CFG: "msgShieldCfg",
          BLOCK_WORDS_UPDATE: "blockWordsUpdate",
          SUBSCRIBE_STATUS_CHANGE: "subscribeStatusChangeToPlayer",
          SHIPIN_PLAY: "shipinPlay",
          SHIPIN_PAUSE: "shipinPause",
          CLEAR_DELIVERY_TIP: "clearDeliveryTips",
          SEND_METRIC: "sendMetric",
          PAYMENT_WATCH_STATUS_CHANGE: "paymentWatchStatusChange",
          SET_EMOTICON_DATA: "setEmoticonData",
          FOLLOW_LIST_READY: "followListReady",
          GET_FACE_DIRECTOR_ELM: "getFaceDirectorElm",
          FEEDBACK_SDK_READY: "feedbackSdkReady",
          OPEN_DIY_ACTIVITY_BY_ID: "openDIYActivityById",
          ADD_DIY_ICON: "addDiyIcon",
          SHOW_GIFT_TIP: "showGiftTip",
          SHOW_DIY_BADGE: "showDiyBadge",
          DEL_DIY_ICON: "delDiyIcon",
          EXT_FEEDBACK: "extFeedBack",
          EXT_PLAYVIDEO: "playVideo",
          EXT_RESUMELIVE: "resumeLive",
          SEND_GIFT_EXT: "sendGiftExt",
          SET_DISPLAY_BARRAGE_TAGS: "setDisplayBarrageTags",
          DOUBLE_TAPPED: "doubleTapped",
          SET_PERSPECTIVE: "setPerspective",
          EXT_CONTEXT_MENU: "EXT_CONTEXT_MENU",
          EXT_HOVER: "EXT_HOVER",
          EXT_WS_CONNECT: "EXT_WS_CONNECT",
          EXT_WS_SEND: "EXT_WS_SEND",
          EXT_WS_CLOSE: "EXT_WS_CLOSE",
          SHOW_FEEDBACK_BY_EXT: "SHOW_FEEDBACK_BY_EXT",
          PLAY_AGAIN: "PLAY_AGAIN",
          SWITCH_LINE: "SWITCH_LINE",
          UPDATE_BTS_VISIBLE: "updateBtnsVisible",
          CLEAR_PLAYER_EFFECT: "clearPlayerEffect",
          CHAT_MODE_CHANGE: "CHAT_MODE_CHANGE",
          GET_FLAC_TOKEN: "GET_FLAC_TOKEN",
          SHOW_BROWER_PAUSE_GUIDE: "SHOW_BROWER_PAUSE_GUIDE",
          HIDE_BROWER_PAUSE_GUIDE: "HIDE_BROWER_PAUSE_GUIDE",
          SET_SEI: "SET_SEI",
          LINK_MIC_STATE_CHANGE: "LINK_MIC_STATE_CHANGE",
          SHOW_COMMON_TOAST: "SHOW_COMMON_TOAST",
          HLS_FIRST_PLAY: "HLS_FIRST_PLAY",
          FORENOTICE_UPDATE: "FORENOTICE_UPDATE",
          MAKE_FRIEND_AUDIO_SOUND: "MAKE_FRIEND_AUDIO_SOUND",
          TAF_SUCCESS_REPORT: "TAF_SUCCESS_REPORT",
          ACTIVITY_ICON_COUNT_UPDATE: "ACTIVITY_ICON_COUNT_UPDATE",
          SEND_CARDPACKAGE_ITEMRSP: "SEND_CARDPACKAGE_ITEMRSP",
          ENTER_PIP: "ENTER_PIP",
          CF_MINI_JUMP: "CF_MINI_JUMP",
          MAKEFIREND_TEMPLATE_CHANGE: "MAKEFIREND_TEMPLATE_CHANGE",
          HUYA_AD_PLAY: "HUYA_AD_PLAY",
          ENTER_P2P_AFTER_REGISTER_GOURP: "ENTER_P2P_AFTER_REGISTER_GOURP",
          SHOW_OPEN_SUPER_FANS: "SHOW_OPEN_SUPER_FANS",
          HUYA_REPORT: "HUYA_REPORT",
          SCRIPTXSS_REPORT: "SCRIPTXSS_REPORT",
          SET_SUPERFANS_CARD_COUNT: "SET_SUPERFANS_CARD_COUNT",
          META_DATA_UPDATE: "META_DATA_UPDATE",
          STOP_SIGNAL_P2P: "STOP_SIGNAL_P2P",
          PROP_ACT_DATA: "PROP_ACT_DATA",
          OPEN_ACTIVITY_PANNEL: "OPEN_ACTIVITY_PANNEL",
          CLEAR_VIDEO_REPORT: "CLEAR_VIDEO_REPORT",
          SET_MEETING_STAT: "setMeetingStat",
          VR_MODEL_CHANGE: "VR_MODEL_CHANGE",
          GET_LIVING_INFO: "GET_LIVING_INFO",
          GET_VR_STREAM_ERR: "GET_VR_STREAM_ERR",
          HIDE_NO_VR_TIPS: "HIDE_NO_VR_TIPS",
          SHOW_ACCOMPANY_PANEL: "SHOW_ACCOMPANY_PANEL",
          HIDE_BITRATE_MENU: "HIDE_BITRATE_MENU",
          GET_MOUNTS_LIST_COMPLETE: "GET_MOUNTS_LIST_COMPLETE",
          MATCH_REPLAY_MODE_CHANGE: "MATCH_REPLAY_MODE_CHANGE",
          NEED_UPDATE_M3U8: "NEED_UPDATE_M3U8",
          PLAYBACK_UPDATE: "PLAYBACK_UPDATE",
          MATCHREPLAY_BACK_LIVE: "MATCHREPLAY_BACK_LIVE",
          PLAYBACK_M3U8_UPDATED: "PLAYBACK_M3U8_UPDATED",
          PLAYBACK_DIF_CDN: "PLAYBACK_DIF_CDN",
          CHANGE_OTHER_LINE: "CHANGE_OTHER_LINE",
          BITRATE_AUTO_CHANGE: "BITRATE_AUTO_CHANGE",
          ABTEST_INITED: "ABTEST_INITED",
          SET_LIVEROOM_REATURES: "SET_LIVEROOM_REATURES",
          HY_ACTION: "HY_ACTION",
          SHIELD_DANMU_AREA: "SHIELD_DANMU_AREA",
          IS_IN_LOW_FPS: "IS_IN_LOW_FPS",
          IS_IN_LOW_VOLUME: "IS_IN_LOW_VOLUME",
          ACTIVE_SHOW_CTRL: "ACTIVE_SHOW_CTRL",
          SET_MAKEFRIEND_VIDEO: "SET_MAKEFRIEND_VIDEO",
          GIFT_RESIZE: "GIFT_RESIZE"
      };
      S.Event = C;
      var k = C;
      function b(t, e) {
          var i = Object.keys(t);
          if (Object.getOwnPropertySymbols) {
              var s = Object.getOwnPropertySymbols(t);
              e && (s = s.filter((function(e) {
                  return Object.getOwnPropertyDescriptor(t, e).enumerable
              }
              ))),
              i.push.apply(i, s)
          }
          return i
      }
      function R(t, e, i) {
          return e in t ? Object.defineProperty(t, e, {
              value: i,
              enumerable: !0,
              configurable: !0,
              writable: !0
          }) : t[e] = i,
          t
      }
      function L(t, e) {
          for (var i = 0; i < e.length; i++) {
              var s = e[i];
              s.enumerable = s.enumerable || !1,
              s.configurable = !0,
              "value"in s && (s.writable = !0),
              Object.defineProperty(t, s.key, s)
          }
      }
      var w = function() {
          function t(e) {
              !function(t, e) {
                  if (!(t instanceof e))
                      throw new TypeError("Cannot call a class as a function")
              }(this, t),
              this.vplayer = e,
              this.h5player = null,
              this.video = null,
              this.canvas = null,
              this.container = $("#player-video"),
              this.lastGetTime = 0,
              this.isFirstPlay = !0,
              this.isFirstVideo = !0,
              this.cacheMetric2 = [],
              this.isMeetPlaying = !1,
              this.OBTranslateDuration = .5,
              this.row_ob = 4,
              this.column_ob = 4,
              this.width_ob = 1280,
              this.height_ob = 720,
              this.x_ob = S.obConfig.x || .41,
              this.y_ob = S.obConfig.y || .31,
              this.scale_ob = S.obConfig.scale || .23,
              this.scaleMax_ob = S.obConfig.scaleMax || 1,
              this.scaleMin_ob = S.obConfig.scaleMin || .15,
              this.renderMode_ob = S.obConfig.renderMode || 1,
              this.vrViewWidth = 0,
              this.vrViewHeight = 0,
              this.isLoginMedia = !1,
              this.vrPort = null,
              this.vrZoomMin = .55,
              this.vrZoomMax = 1.45,
              this.isDebug = S.isDebug(),
              this.curViewMode = 0,
              this.needPlayAgain = !1,
              this.initH5Player()
          }
          var e, i, s;
          return e = t,
          (i = [{
              key: "initH5Player",
              value: function() {
                  var t = this;
                  if (!H5Player.isSupported())
                      return console.log("H5Player not support."),
                      void k.fireEvent("playerError");
                  var e = new H5Player;
                  this.h5player = e,
                  S.h5player = e,
                  e.setIDs(S.presenterUid, S.topsid, S.subsid, S.yyuid),
                  e.on(H5Player.Events.VIDEO_PLAY, this.onPlayVideo.bind(this)),
                  e.on(H5Player.Events.FLV_URL_UNAVAILABLE, (function() {
                      return t.playAgain()
                  }
                  )),
                  e.on(H5Player.Events.H5_PLAYER_ERROR, (function() {
                      return t.playAgain()
                  }
                  )),
                  e.on(H5Player.Events.PLAY_STATUS, this.onPlayStatus.bind(this)),
                  e.on(H5Player.Events.NO_DATA_RECEIVED, (function() {
                      return t.playAgain()
                  }
                  )),
                  e.on(H5Player.Events.DATA_METRIC2, this.onDataMetric2.bind(this)),
                  e.on(H5Player.Events.P2P_TIMEOUT, this.onP2pTimeOut.bind(this)),
                  e.on(H5Player.Events.FLAC_AUDIO_NEED_RETRY, this.reStartFlac.bind(this)),
                  e.on(H5Player.Events.TRANS_END, this.onObTransEnd.bind(this)),
                  e.on(H5Player.Events.WEBRTC_VIDEO_ERROR, this.onWebrtcVideoError.bind(this)),
                  e.on(H5Player.Events.P2P_PLAYING_EVENT, this.onP2PPlaying.bind(this)),
                  e.on(H5Player.Events.BROWSER_PAUSE, this.onBrowerPause.bind(this)),
                  e.on(H5Player.Events.AUTO_BITRATE_CHANGED, this.onAutoBitrateChange.bind(this)),
                  e.on(H5Player.Events.VIDEO_BAD_QUALITY, (function(e) {
                      return t.onVideoBadQuality(e)
                  }
                  ));
                  var i = parseInt(localStorage.sdkLogLevel);
                  isNaN(i) || e.setLogLevel(i),
                  e.setConfig("jitBufLen", 4e3),
                  e.setExtendConfig(S.sdkExtendConfig),
                  e.setConfig("isProduce", this.isDebug ? 0 : 1),
                  e.setConfig("playerdata", function(t) {
                      for (var e = 1; e < arguments.length; e++) {
                          var i = null != arguments[e] ? arguments[e] : {};
                          e % 2 ? b(i, !0).forEach((function(e) {
                              R(t, e, i[e])
                          }
                          )) : Object.getOwnPropertyDescriptors ? Object.defineProperties(t, Object.getOwnPropertyDescriptors(i)) : b(i).forEach((function(e) {
                              Object.defineProperty(t, e, Object.getOwnPropertyDescriptor(i, e))
                          }
                          ))
                      }
                      return t
                  }({}, S.ENV)),
                  S.isWebrtcSupport = e.isWebrtcSupport,
                  $.isFunction(H5Player.isSupportedHevc) && (S.isSupportedHevc = H5Player.isSupportedHevc(0)),
                  v.log("是否支持webrtc", S.isWebrtcSupport),
                  v.log("是否支持HEVC", S.isSupportedHevc),
                  k.addEvent(k.PAUSE_VIDEO, this.pauseVideo.bind(this)),
                  k.addEvent(k.WEBSOCKET_INITED, this.onWebsocketInited.bind(this)),
                  k.addEvent(k.ENTER_PIP, this.enterPip.bind(this)),
                  k.addEvent(k.EXT_PLAYVIDEO, this.extPlayVideo.bind(this)),
                  k.addEvent(k.EXT_RESUMELIVE, this.extResumeLive.bind(this)),
                  k.addEvent(k.SET_MEETING_STAT, this.setMeetingStat.bind(this)),
                  k.addEvent(k.GET_FLAC_TOKEN, (function() {
                      return t.playFlac()
                  }
                  )),
                  $(window).resize(this.resize.bind(this)),
                  window.testdd = function() {
                      e.trigger(H5Player.Events.FLAC_AUDIO_START)
                  }
                  ,
                  localStorage._showH5Player && (window.h5SdkPlayer = e)
              }
          }, {
              key: "setTafHandler",
              value: function(t) {
                  this.h5player && this.h5player.setTafHandler && this.h5player.setTafHandler(t)
              }
          }, {
              key: "play",
              value: function() {
                  if (1 != S.paymentStatus)
                      if (S.extVideoPlay)
                          this.startExtVideoPlay();
                      else if (S.isMakeFriend && (this.isMeetPlaying || this.makeFriendPlay()),
                      !S.isMakeFriend || S.hasMFVideo || S.useCdnAll) {
                          this.isFirstPlay && (this.isFirstPlay = !1,
                          window.h5VideoRequest && window.h5VideoRequest());
                          var t = this.h5player
                            , e = S.streamInfo;
                          if (e) {
                              t.setConfig(100, e && e.iIsP2PSupport > 0 && e.sP2pUrl),
                              t.setConfig(101, !r && S.useP2p);
                              var i = S.getCurBitRate()
                                , s = S.hasAutoBitrate && S.isAutoBitrate;
                              s && S.autoCurBitrate && (i = S.autoCurBitrate);
                              var a = 0 == i ? 0 : 1
                                , r = -1 != S.p2pLineClose.indexOf(S.videoLine.toString())
                                , n = {
                                  uid: S.isLogin ? S.yyuid : S.anonymousUid,
                                  sGuid: S.getGuid(),
                                  sid: S.topsid,
                                  subSid: S.subsid,
                                  presenterUid: S.presenterUid,
                                  lineType: S.videoLine,
                                  roomId: S.ENV.profileRoom,
                                  sStreamName: e.sStreamName,
                                  h5Root: S.H5ROOT,
                                  liveType: 1,
                                  gameId: S.gameId
                              };
                              if (!S.hasMFVideo && S.useCdnAll && (n.isPureAudio = S.useCdnAll),
                              n.appid = this.isDebug && !S.ENV.online ? S.vAppidTest : S.vAppid,
                              n.originalBitrate = a,
                              n.curBitrate = 0 == i ? S.SrcBitRate : i,
                              n.iBitRate = i,
                              n.maxAutoBitrate = S.iWebDefaultBitRate,
                              n.bitrateList = this.getBitrateList(),
                              n.pullStreamFrom = S.pullStreamFrom,
                              v.log("低延迟标志信息:"),
                              v.log("isWebrtcSupport", t.isWebrtcSupport),
                              v.log("G.webrtcErr", S.webrtcErr),
                              this.curViewMode = 0,
                              S.videoCodec = "h264",
                              S.isH265Play = !1,
                              1 == S.matchReplayStatus)
                                  n.type = H5Player.PLAYBACK,
                                  n.isLive = !1,
                                  n.liveType = 2,
                                  n.seekTime = S.matchReplaySeekTime,
                                  n.url = S.matchReplayUrl,
                                  n.cndName = S.matchReplayCdnName,
                                  t.start(n);
                              else if (S.isOBWatch && 1 == S.obStatus)
                                  n.type = H5Player.OBS,
                                  n.gridWidth = this.width_ob,
                                  n.gridHeight = this.height_ob,
                                  n.column = this.column_ob,
                                  n.row = this.row_ob,
                                  n.x = this.x_ob,
                                  n.y = this.y_ob,
                                  n.scale = this.scale_ob,
                                  n.scaleMax = this.scaleMax_ob,
                                  n.scaleMin = this.scaleMin_ob,
                                  n.renderMode = this.renderMode_ob,
                                  n.sFlvUrl = e.sFlvUrl,
                                  S.flvUseHttps && (n.sFlvUrl = n.sFlvUrl.replace("http:", "https:")),
                                  n.sFlvUrlSuffix = e.sFlvUrlSuffix,
                                  n.sFlvAntiCode = e.sFlvAntiCode,
                                  n.container = document.querySelector("#player-video"),
                                  S.videoDns && e.vFlvIPList && (n.domainList = e.vFlvIPList.value.concat()),
                                  t.start(n);
                              else if (S.onlyLine4 || t.isWebrtcSupport && 4 == e.iLineIndex && !S.webrtcErr)
                                  n.type = H5Player.HUYAWEBRTC,
                                  t.start(n),
                                  this.curViewMode = 1;
                              else if (S.hlsLivePid)
                                  n.isLive = !0,
                                  n.type = H5Player.HLS,
                                  n.sHlsUrl = e.sHlsUrl,
                                  n.sHlsAntiCode = e.sHlsAntiCode,
                                  n.sHlsAntiCode = e.sHlsAntiCode.replace(/&amp;/g, "&"),
                                  n.sHlsUrlSuffix = e.sHlsUrlSuffix,
                                  t.start(n);
                              else {
                                  n.sFlvUrl = e.sFlvUrl,
                                  n.sFlvAntiCode = e.sFlvAntiCode,
                                  n.sFlvUrlSuffix = e.sFlvUrlSuffix,
                                  n.sP2pUrl = e.sP2pUrl,
                                  n.sP2pAntiCode = e.sP2pAntiCode.replace(/&amp;/g, "&"),
                                  n.sP2pUrlSuffix = e.sP2pUrlSuffix,
                                  n.iIsP2PSupport = e.iIsP2PSupport,
                                  n.iIsHEVCSupport = e.iIsHEVCSupport;
                                  var o = S.getBitRateData();
                                  if (o && (n.iCodecType = o.iCodecType,
                                  n.iHEVCBitRate = o.iHEVCBitRate),
                                  S.videoDns && (n.domainList = e.vP2pIPList.value.concat()),
                                  n.type = H5Player.P2PFLV,
                                  S.isOBWatch && (2 == S.obStatus || 3 == S.obStatus)) {
                                      var h = e.sStreamName + "-objs";
                                      n.sStreamName = h
                                  }
                                  n.isAuto = s,
                                  n.hasAutoBitrate = S.hasAutoBitrate,
                                  S.isLowLatency && (n.latencyLevel = 1),
                                  S.videoDns && e.vFlvIPList && (n.domainList = e.vFlvIPList.value.concat()),
                                  S.is360Video && (n.type = H5Player.VR,
                                  n.vr = {
                                      type: S.getVRType(),
                                      viewWidth: this.container.width(),
                                      viewHeight: this.container.height(),
                                      zoomMin: this.vrZoomMin,
                                      zoomMax: this.vrZoomMax
                                  }),
                                  v.log("====start", n),
                                  t.start(n)
                              }
                              S.lastIsAuto = n.isAuto,
                              S.isOpenFlac && this.playFlac(),
                              S.pullStreamFrom = 0
                          } else
                              v.log("G.streamInfo 异常", e)
                      }
              }
          }, {
              key: "getSdkTestConfig",
              value: function() {
                  var t = "";
                  return this.h5player.getSdkTestConfig && (t = this.h5player.getSdkTestConfig()),
                  v.log("sdkCommonAb", S.sdkCommonAb),
                  t
              }
          }, {
              key: "makeFriendPlay",
              value: function() {
                  this.isMeetPlaying = !0,
                  this.h5player.startLiveMeeting(S.presenterUid, S.topsid, S.subsid, S.yyuid, S.H5ROOT),
                  this.makeFriendDeal()
              }
          }, {
              key: "isP2PCooling",
              value: function() {
                  var t = Number(localStorage.getItem("interval_long_time"));
                  return t > 0 && (!((new Date).getTime() - t > 36e5) || (localStorage.removeItem("interval_long_time"),
                  !1))
              }
          }, {
              key: "getBitrateList",
              value: function() {
                  var t = []
                    , e = [];
                  S.livingInfo ? S.livingInfo.tNotice ? e = S.livingInfo.tNotice.vMultiStreamInfo.value : S.livingInfo.vStreamGearInfo && (e = S.livingInfo.vStreamGearInfo.value) : e = S.ENV.stream.vMultiStreamInfo;
                  for (var i = 0, s = e.length; i < s; i++) {
                      var a = e[i]
                        , r = a.iBitRate
                        , n = a.iCodecType
                        , o = a.iHEVCBitRate;
                      if (!(S.isSupportedHevc && r >= S.SrcBitRate)) {
                          var h = S.isH265CodecType(n);
                          if (S.isSupportedHevc || 0 != r || !h) {
                              var u = {
                                  iBitRate: r,
                                  iCodecType: n,
                                  iHEVCBitRate: o,
                                  iIsHEVCSupport: S.streamInfo.iIsHEVCSupport || 0
                              };
                              u.bitrate = 0 == r ? S.SrcBitRate : r,
                              t.push(u)
                          }
                      }
                  }
                  return t
              }
          }, {
              key: "getP2pInfoList",
              value: function() {
                  var t = []
                    , e = [];
                  S.livingInfo ? S.livingInfo.tNotice ? e = S.livingInfo.tNotice.vStreamInfo.value : S.livingInfo.vMediaStreamInfo && (e = S.livingInfo.vMediaStreamInfo.value) : e = S.ENV.stream.data[0].gameStreamInfoList;
                  for (var i = 0; i < e.length; i++) {
                      var s = e[i]
                        , a = s.iLineIndex
                        , r = -1 != S.p2pLineClose.indexOf(a.toString());
                      if (s.iIsP2PSupport > 0 && s.sP2pUrl && !r) {
                          var n = new Object;
                          n.sP2pUrl = s.sP2pUrl,
                          n.sP2pUrlSuffix = s.sP2pUrlSuffix,
                          n.iLineIndex = a,
                          t.push(n)
                      }
                  }
                  return t
              }
          }, {
              key: "reStartFlac",
              value: function() {
                  var t = Date.now();
                  if (t - this.lastGetTime < 2e3)
                      return !1;
                  this.lastGetTime = t,
                  S.isOpenFlac && (this.h5player.stopFlac(),
                  this.playFlac())
              }
          }, {
              key: "playFlac",
              value: function() {
                  var t = S.streamInfo
                    , e = {
                      uid: S.isLogin ? S.yyuid : S.anonymousUid,
                      presenterUid: S.presenterUid,
                      roomId: S.ENV.profileRoom,
                      sStreamName: t.sStreamName,
                      h5Root: S.H5ROOT,
                      sFlvUrl: t.sFlvUrl,
                      sFlvAntiCode: t.sFlvAntiCode,
                      sFlvUrlSuffix: t.sFlvUrlSuffix,
                      sP2pUrl: t.sP2pUrl,
                      sP2pAntiCode: t.sP2pAntiCode.replace(/&amp;/g, "&"),
                      sP2pUrlSuffix: t.sP2pUrlSuffix,
                      iIsP2PSupport: t.iIsP2PSupport
                  };
                  this.h5player.startFlac(e)
              }
          }, {
              key: "stopFlac",
              value: function() {
                  this.h5player.stopFlac()
              }
          }, {
              key: "playAgain",
              value: function() {
                  S.hasVideo && (!S.isMakeFriend || S.hasMFVideo || S.useCdnAll) && (S.tafInited ? k.fireEvent(k.PLAY_AGAIN) : this.needPlayAgain = !0,
                  S.pullStreamFrom = 3)
              }
          }, {
              key: "stop",
              value: function() {
                  S.isMakeFriend && (this.h5player.stopLiveMeeting(),
                  this.isMeetPlaying = !1),
                  this.h5player.stop()
              }
          }, {
              key: "setMosaicBox",
              value: function(t) {
                  this.h5player.setMosaicBox(t)
              }
          }, {
              key: "onPlayVideo",
              value: function(t, e) {
                  e.video.autoplay = !0;
                  var i, s = this.video;
                  if (s && s.pause && (s.pause(),
                  s.removeEventListener("enterpictureinpicture", this.onEnterPIP),
                  s.removeEventListener("leavepictureinpicture", this.onLeavePIP),
                  s.src = "",
                  S.isPip && document.exitPictureInPicture()),
                  s = e.video,
                  i = e.canvas,
                  this.video = s,
                  this.canvas = i,
                  this.video.addEventListener("enterpictureinpicture", this.onEnterPIP),
                  this.video.addEventListener("leavepictureinpicture", this.onLeavePIP),
                  this.addExtVideoEvent(),
                  $("#hy-video").remove(),
                  $(i || s).attr("id", "hy-video"),
                  this.vplayer.hideLoading(),
                  S.isMakeFriend ? k.fireEvent(k.SET_MAKEFRIEND_VIDEO, i || s) : (this.container.append(i || s),
                  S.isOBRoom && this.vplayer.trigger("perspectiveChange", S.obCurrentPerspective),
                  S.obVideoState = {
                      state: 1e3
                  },
                  this.vplayer.trigger("videoStateChange", S.obVideoState),
                  S.is360Video && (this.vrPort && this.setViewport(this.vrPort),
                  S.vplayerUI && S.vplayerUI.showPlayTip("vr-live"),
                  k.fireEvent(k.SHOW_VR_UI)),
                  this.resize()),
                  S.isPause = !1,
                  S.isPlaying = !0,
                  k.fireEvent(k.NEW_VIDEO),
                  this.isFirstVideo) {
                      this.isFirstVideo = !1,
                      S.isFirstVideoPlay = !0;
                      var a = e.connectTime
                        , r = e.recvDataTime;
                      S.videoTimeData = {
                          connectTime: a,
                          recvDataTime: r
                      },
                      k.fireEvent("videoOnLoad");
                      var n = Date.now() - S.beginTime;
                      S.firstVideoTime = n,
                      k.fireEvent(k.VIDEO_FIRST_PLAY),
                      S.mute ? this.h5player.setVolume(0) : this.setDefaultVolume()
                  }
                  S.isPip && (S.isPip = !1,
                  setTimeout(this.enterPip.bind(this), 1e3)),
                  S.hasLine4 && 1 == this.curViewMode && k.fireEvent(k.SHOW_COMMON_TOAST, "低延迟观看"),
                  e.videoCodec && (S.videoCodec = e.videoCodec,
                  "h265" == S.videoCodec && (S.isH265Play = !0))
              }
          }, {
              key: "setDefaultVolume",
              value: function() {
                  var t = c.getCookie("SoundValue");
                  t = parseFloat(t),
                  isNaN(t) && (t = .5),
                  t = Math.min(t, 1),
                  t = Math.max(t, 0),
                  this.h5player.setVolume(t)
              }
          }, {
              key: "makeFriendDeal",
              value: function() {
                  if (S.isPause = !1,
                  S.isPlaying = !0,
                  this.isFirstVideo) {
                      this.isFirstVideo = !1,
                      S.isFirstVideoPlay = !0,
                      k.fireEvent("videoOnLoad");
                      var t = Date.now() - S.beginTime;
                      S.firstVideoTime = t,
                      k.fireEvent(k.VIDEO_FIRST_PLAY)
                  } else
                      S.hasMFVideo || S.useCdnAll || this.vplayer.hideLoading()
              }
          }, {
              key: "onPlayStatus",
              value: function(t, e) {
                  var i = e.status;
                  "VIDEO_STOP" == i ? S.isPlaying = !1 : "VIDEO_PLAYING" == i && (S.isPlaying = !0),
                  "VIDEO_PLAYING" == i && S.isUIPause && k.fireEvent(k.HIDE_BROWER_PAUSE_GUIDE)
              }
          }, {
              key: "onDataMetric2",
              value: function(t, e) {
                  S.tafInited ? k.fireEvent(k.DATA_METRIC2, e) : this.cacheMetric2.push(e)
              }
          }, {
              key: "onP2pTimeOut",
              value: function(t, e) {
                  S.turnToFlv = !0
              }
          }, {
              key: "onWebrtcVideoError",
              value: function(t, e) {
                  v.log(t, e),
                  S.webrtcErr = !0,
                  k.fireEvent(k.CHANGE_OTHER_LINE)
              }
          }, {
              key: "onObTransEnd",
              value: function(t, e) {
                  var i = this.h5player.getViewport();
                  this.x_ob = i.x,
                  this.y_ob = i.y,
                  this.scale_ob = i.scale,
                  this.vplayer.trigger("viewportChange", i)
              }
          }, {
              key: "onWebsocketInited",
              value: function(t) {
                  this.sendMetric2Cache(),
                  this.needPlayAgain && (this.playAgain(),
                  this.needPlayAgain = !1)
              }
          }, {
              key: "sendMetric2Cache",
              value: function() {
                  for (var t = 0, e = this.cacheMetric2.length; t < e; t++)
                      this.onDataMetric2(H5Player.Events.DATA_METRIC2, this.cacheMetric2[t]);
                  this.cacheMetric2 = []
              }
          }, {
              key: "pauseVideo",
              value: function() {
                  var t = this.video;
                  t && ($(t).unbind(),
                  this.stop())
              }
          }, {
              key: "extPlayVideo",
              value: function(t) {
                  S.extVideoPlay = !0,
                  this.stop(),
                  this.extVideoUrl = t.url;
                  var e = t.startTime;
                  this.playExtVideo(e),
                  $(".player-videotype").hide()
              }
          }, {
              key: "extResumeLive",
              value: function() {
                  S.isGodLiePlay || (S.extVideoPlay = !1,
                  this.play(),
                  $(".player-videotype").show(),
                  S.extBarrageTags = [])
              }
          }, {
              key: "startExtVideoPlay",
              value: function() {
                  this.playExtVideo(0)
              }
          }, {
              key: "extFastBackward",
              value: function(t) {
                  var e = this.h5player.getVideoInfo().currentTime + t.time;
                  this.playExtVideo(e)
              }
          }, {
              key: "playExtVideo",
              value: function(t) {
                  this.h5player.setConfig(100, ""),
                  this.h5player.setConfig(101, !1);
                  var e = {
                      type: H5Player.HLS,
                      url: this.extVideoUrl,
                      isLive: !1,
                      seekTime: t
                  };
                  this.h5player.start(e),
                  S.vplayerUI && S.vplayerUI.turnPlayButtonOn()
              }
          }, {
              key: "setMeetingStat",
              value: function(t) {
                  this.isMeetPlaying && (S.hasMFVideo || S.useCdnAll || this.h5player.setMeetingStat(t))
              }
          }, {
              key: "getExtVideoInfo",
              value: function() {
                  if (!S.extVideoPlay)
                      return null;
                  var t = {}
                    , e = this.h5player.getVideoInfo();
                  return t.currentTime = e.currentTime,
                  t.duration = e.duration,
                  t.isPlaying = S.isPlaying,
                  t
              }
          }, {
              key: "addExtVideoEvent",
              value: function() {
                  S.extVideoPlay && (this.video.addEventListener("waiting", this.onVideoEvent.bind(this)),
                  this.video.addEventListener("seeking", this.onVideoEvent.bind(this)),
                  this.video.addEventListener("seeked", this.onVideoEvent.bind(this)),
                  this.video.addEventListener("playing", this.onVideoEvent.bind(this)),
                  this.video.addEventListener("ended", this.onVideoEvent.bind(this)),
                  this.video.addEventListener("canplay", this.onVideoEvent.bind(this)),
                  this.video.addEventListener("loadedmetadata", this.onVideoEvent.bind(this)),
                  this.video.addEventListener("pause", this.onVideoEvent.bind(this)),
                  this.video.addEventListener("play", this.onVideoEvent.bind(this)),
                  this.video.addEventListener("timeupdate", this.onVideoEvent.bind(this)))
              }
          }, {
              key: "onVideoEvent",
              value: function(t) {
                  this.vplayer.trigger("extVideoEvent", t.type)
              }
          }, {
              key: "showLoading",
              value: function() {
                  $(".player-loading").css("display", "block");
                  var t = "url(" + S.H5ROOT + "images/videoloading.gif?" + Math.random() + ") no-repeat";
                  $(".player-loading-progress").css("background", t)
              }
          }, {
              key: "onP2PPlaying",
              value: function(t, e) {
                  v.log("onP2PPlaying", t, e),
                  S.isP2pPlayIng = e.isP2pPlayIng
              }
          }, {
              key: "onBrowerPause",
              value: function(t, e) {
                  v.log(t, e),
                  S.browerPause = !0,
                  k.fireEvent(k.SHOW_BROWER_PAUSE_GUIDE)
              }
          }, {
              key: "onAutoBitrateChange",
              value: function(t, e) {
                  v.log("onAutoBitrateChange", t, e),
                  e.lastBitrate;
                  var i = e.curBitrate;
                  S.autoCurBitrate = i,
                  k.fireEvent(k.BITRATE_AUTO_CHANGE)
              }
          }, {
              key: "onVideoBadQuality",
              value: function(t) {
                  v.log("onVideoBadQuality", t)
              }
          }, {
              key: "enterPip",
              value: function() {
                  S.isPip || this.video && this.video.requestPictureInPicture().catch((function(t) {
                      console.log("Video failed to enter Picture-in-Picture mode."),
                      console.log(t.message)
                  }
                  ))
              }
          }, {
              key: "onEnterPIP",
              value: function() {
                  S.isPip = !0
              }
          }, {
              key: "onLeavePIP",
              value: function() {
                  var t = this;
                  window.requestAnimationFrame((function() {
                      S.isPip = !1,
                      t.play()
                  }
                  ))
              }
          }, {
              key: "setViewport",
              value: function(t) {
                  v.log("setViewport", t),
                  t.duration = this.OBTranslateDuration,
                  this.h5player.setViewport && this.h5player.setViewport(t)
              }
          }, {
              key: "getViewport",
              value: function() {
                  return this.h5player.getViewport ? this.h5player.getViewport() : -1
              }
          }, {
              key: "addViewport",
              value: function(t) {
                  this.h5player.addViewport && this.h5player.addViewport(t)
              }
          }, {
              key: "getFrameData",
              value: function() {
                  return this.h5player.getFrameData ? this.h5player.getFrameData() : -1
              }
          }, {
              key: "setSplitedOBStream",
              value: function(t) {
                  this.row_ob == t.row && this.column_ob == t.column && this.width_ob == t.width && this.height_ob == t.height || (this.row_ob = t.row,
                  this.column_ob = t.column,
                  this.width_ob = t.width,
                  this.height_ob = t.height,
                  this.playAgain())
              }
          }, {
              key: "loginMedia",
              value: function(t) {
                  this.isLoginMedia || (this.h5player.loginMedia(t.token, t.roomid, S.yyuid),
                  this.isLoginMedia = !0)
              }
          }, {
              key: "quitMedia",
              value: function() {
                  this.isLoginMedia = !1,
                  this.h5player.quitMedia()
              }
          }, {
              key: "setVRPort",
              value: function() {
                  S.is360Video && (this.vrPort = this.h5player.getViewport ? this.h5player.getViewport() : null)
              }
          }, {
              key: "seek",
              value: function() {
                  1 == S.matchReplayStatus && (v.log("seek", S.matchReplaySeekTime),
                  this.h5player.seek(S.matchReplaySeekTime))
              }
          }, {
              key: "updateLiveVodUrl",
              value: function() {
                  1 == S.matchReplayStatus && this.h5player.updateLiveVodUrl(S.matchReplayUrl, S.matchReplayCdnName)
              }
          }, {
              key: "getViewerLatencyMode",
              value: function() {
                  return {
                      res: 0,
                      msg: "",
                      data: {
                          mode: this.curViewMode
                      }
                  }
              }
          }, {
              key: "setViewerLatencyMode",
              value: function(t) {
                  return 1 == t.mode ? this.h5player.isWebrtcSupport ? 0 == S.hasLine4 ? {
                      res: 1,
                      msg: "没有线路4,设置失败"
                  } : S.webrtcErr ? {
                      res: 3,
                      msg: "webrtc播放错误"
                  } : (this.curViewMode = 1,
                  S.videoLine = 4,
                  S.streamInfo = S.streamInfoLine4,
                  this.play(),
                  {
                      res: 0,
                      msg: "设置低延迟成功"
                  }) : {
                      res: 2,
                      msg: "sdk不支持webrtc播放"
                  } : 0 == t.mode ? S.onlyLine4 ? {
                      res: 1,
                      msg: "只有一条低延迟线路"
                  } : (k.fireEvent(k.CHANGE_OTHER_LINE),
                  {
                      res: 0,
                      msg: "设置普通模式成功"
                  }) : {
                      res: 999,
                      msg: "未开放的模式"
                  }
              }
          }, {
              key: "updateAudioPlay",
              value: function(t) {
                  v.log("=== updateAudioPlay", t),
                  this.h5player.updateAudioPlay(t, S.H5ROOT)
              }
          }, {
              key: "getVideoSize",
              value: function() {
                  return {
                      width: this.canvas ? this.canvas.width : this.video ? this.video.videoWidth : 0,
                      height: this.canvas ? this.canvas.height : this.video ? this.video.videoHeight : 0
                  }
              }
          }, {
              key: "resize",
              value: function() {
                  var t = this.container.width()
                    , e = this.container.height()
                    , i = t
                    , s = e;
                  if (S.is360Video && S.hasVideo && S.isPlaying)
                      this.vrViewWidth = t,
                      this.vrViewHeight = e,
                      this.h5player.setSize(this.vrViewWidth, this.vrViewHeight),
                      S.obVideoPos = {
                          left: 0,
                          top: 0,
                          right: 0,
                          bottom: 0
                      };
                  else if (S.isOBWatch && 1 == S.obStatus) {
                      this.width_ob / this.height_ob > t / e ? ($("#hy-video").width("100%"),
                      $("#hy-video").height("auto")) : ($("#hy-video").width("auto"),
                      $("#hy-video").height("100%"));
                      var a = (t - $("#hy-video").width()) / 2
                        , r = (e - $("#hy-video").height()) / 2;
                      a = Math.max(a, 0),
                      r = Math.max(r, 0),
                      isNaN(a) && (a = 0),
                      isNaN(r) && (r = 0),
                      S.obVideoPos = {
                          left: a,
                          top: r,
                          right: a,
                          bottom: r
                      },
                      $("#hy-video").css({
                          left: a,
                          top: r
                      })
                  } else {
                      var n = this.video;
                      if (!n)
                          return;
                      var o = this.canvas ? this.canvas.width : n.videoWidth
                        , h = this.canvas ? this.canvas.height : n.videoHeight
                        , u = 0
                        , l = 0;
                      o / h > t / e ? (i = t,
                      l = (e - (s = h * t / o)) / 2) : (s = e,
                      u = (t - (i = o * e / h)) / 2),
                      $("#hy-video").width("100%"),
                      $("#hy-video").height("100%"),
                      $("#hy-video").css({
                          left: 0,
                          top: 0
                      }),
                      0 === o || 0 === h || isNaN(u) || isNaN(l) ? S.obVideoPos = {
                          left: 0,
                          top: 0,
                          right: 0,
                          bottom: 0
                      } : S.obVideoPos = {
                          left: u,
                          top: l,
                          right: u,
                          bottom: l
                      },
                      S.hasVideoPiexlate && $("#video-pixelate-box").css({
                          left: u,
                          top: l,
                          width: i,
                          height: s
                      })
                  }
                  $.isFunction(this.h5player.containerResize) && this.h5player.containerResize({
                      width: i,
                      height: s
                  })
              }
          }]) && L(e.prototype, i),
          s && L(e, s),
          t
      }()
        , O = !1
        , D = []
        , N = "";
      var F = !0
        , M = !1;
      var U = "";
      function B(t, e) {
          if (t) {
              k.fireEvent(k.HIDE_NO_VR_TIPS);
              var i = parseInt(t.lLiveCompatibleFlag);
              S.lLiveCompatibleFlag = i,
              S.extStreamVR = 128 == (128 & i) || 64 == (64 & i),
              S.is360Video = 1 == (1 & i) || 1024 == (1024 & i) || S.extStreamVR && S.vrSwitch,
              S.SrcBitRate = t.iBitRate;
              var s = t.vMediaStreamInfo.value
                , a = t.vStreamGearInfo.value
                , r = t.iWebDefaultBitRate;
              if (S.hasVideo = s.length > 0,
              S.isServPlaying = S.hasVideo,
              S.hasAutoBitrate = !1,
              t.sAntiCode = t.sAntiCode.replace(/&amp;/g, "&"),
              S.hasVideo) {
                  S.streamInfo = null;
                  var n = []
                    , o = 0
                    , h = -1
                    , u = [];
                  S.menuItems = [];
                  for (var l = !1, c = function(e, i) {
                      var a = s[e];
                      if (a.sFlvAntiCode = t.sAntiCode,
                      a.sP2pAntiCode = t.sAntiCode,
                      a.iWebPriorityRate < 0 || 4 == a.iLineIndex)
                          return u.push(e),
                          "continue";
                      var r = a.iLineIndex
                        , c = !1;
                      a.iIsP2PSupport > 0 && a.sP2pUrl && (c = !0),
                      S.videoLine == r && (l = !0);
                      var d, p = {
                          text: "直播线路" + r,
                          p2p: c,
                          line: r,
                          func: (d = r,
                          function() {
                              k.fireEvent(k.SWITCH_LINE, d)
                          }
                          )
                      };
                      S.menuItems[r] = p,
                      o += a.iWebPriorityRate,
                      n.push({
                          line: r,
                          rate: a.iWebPriorityRate
                      }),
                      100 == a.iWebPriorityRate && (h = r)
                  }, d = 0, p = s.length; d < p; d++)
                      c(d);
                  S.menuData[1] = S.menuItems;
                  for (var f = u.length - 1; f >= 0; f--) {
                      var _ = u[f];
                      s.splice(_, 1)
                  }
                  if (0 == s.length)
                      return void (e && e());
                  if (1 == s.length)
                      S.videoLine = s[0].iLineIndex;
                  else if (-1 != h)
                      S.videoLine = h;
                  else if (l && S.videoLine > 0)
                      S.videoLine = S.videoLine;
                  else {
                      S.videoLine = -1;
                      for (var m = 0, v = Math.random(), y = 0, T = n.length; y < T; y++) {
                          var g = n[y];
                          if (v <= (m += g.rate / o)) {
                              S.videoLine = g.line;
                              break
                          }
                      }
                  }
                  if (S.videoLine < 0) {
                      var P = Math.floor(Math.random() * s.length);
                      S.videoLine = s[P].iLineIndex
                  }
                  if (W(a),
                  S.videoLine > 0) {
                      j(r);
                      var E = S.getCurBitRate();
                      S.vplayerUI.setBitRateList({
                          list: S.getBitRateList(),
                          default: E
                      })
                  }
                  if (S.vplayerUI.setLineList(s),
                  S.videoLine > 0)
                      for (var I = 0, A = s.length; I < A; I++) {
                          var C = s[I];
                          C.iLineIndex == S.videoLine && (S.streamInfo = C,
                          G(t.sAntiCode))
                      }
                  S.livingInfo = t,
                  S.isUIPause || (S.vplayer.showLoading(),
                  S.vplayer.play()),
                  S.vplayerUI.updateBtnsVisible()
              }
          } else
              e && e()
      }
      function V() {
          S.isPlaying = !1,
          S.vplayer.stop(),
          S.vrNoStream = !0,
          U = "",
          k.fireEvent(k.GET_VR_STREAM_ERR)
      }
      function x(t) {
          var e = "";
          for (var i in t)
              S.videoLine == t[i].iLineIndex && (t[i].iWebPriorityRate < 0 && (e += t[i].iWebPriorityRate),
              e += t[i].sCdnType,
              e += t[i].sFlvUrl,
              e += t[i].iIsP2PSupport);
          return e
      }
      var H = 0;
      function G(t) {
          var e = S.streamInfo.sStreamName;
          S.flvTokenList[e] = t,
          S.streamInfo.sFlvAntiCode = t,
          clearTimeout(H),
          H = setTimeout((function(t) {
              for (var e in S.flvTokenList)
                  S.flvTokenList[e] = ""
          }
          ), 24e4, e)
      }
      function j(t) {
          if (!S.isCheckDefBit) {
              if (S.curBitRate = 0,
              S.deleteOriginalPainting())
                  return S.bitRateList1[1] && (S.curBitRate = S.bitRateList1[1].iBitRate),
                  void (S.isCheckDefBit = !0);
              if (S.isCheckDefBit = !0,
              !S.isLogin && localStorage.loginTipsCount > 295) {
                  var e = S.bitRateList1.length;
                  if (e > 0)
                      return void (S.curBitRate = S.bitRateList1[e - 1].iBitRate)
              }
              S.isAutoBitrate = S.h5player && S.h5player.getUseAuto();
              var i = c.getCookie("videoBitRate");
              i = parseInt(i) || 2147483647,
              t = S.aBTestDefaultBitrate > 0 ? S.aBTestDefaultBitrate : t || 2147483647,
              S.iWebDefaultBitRate = t;
              var s = Math.min(i, t)
                , a = !1
                , r = 0;
              for (r = 0; r < S.bitRateList1.length; r++) {
                  var n = S.bitRateList1[r].iBitRate
                    , o = n;
                  if (0 == o && (o = S.SrcBitRate),
                  o <= s) {
                      S.curBitRate = n,
                      a = !0;
                      break
                  }
              }
              if (0 == a)
                  for (r = S.bitRateList1.length - 1; r >= 0; r--) {
                      S.curBitRate = S.bitRateList1[r].iBitRate;
                      break
                  }
          }
      }
      function W(t) {
          for (var e = [], i = {}, s = t, a = function(t) {
              return t.length <= 1 ? -1 : S.aBTestShieldBitrate
          }(s), r = 0, n = s.length; r < n; r++) {
              var o = s[r];
              if (!(o.iBitRate > 0 && o.iBitRate <= 300) && !(S.isSupportedHevc && o.iBitRate >= S.SrcBitRate)) {
                  var h = S.isH265CodecType(o.iCodecType);
                  if (S.isSupportedHevc || 0 != o.iBitRate || !h) {
                      var u = Y(o);
                      if (!(a > 0 && a == u.iBitRate)) {
                          var l = i[u.sDisplayName];
                          l ? u.iBitRate > l.iBitRate && (i[u.sDisplayName] = u) : i[u.sDisplayName] = u
                      }
                  }
              }
          }
          for (var c in i) {
              var d = i[c];
              e.push(d)
          }
          S.bitRateList1 = e
      }
      function Y(t) {
          return {
              iBitRate: t.iBitRate,
              sDisplayName: t.sDisplayName,
              iCodecType: t.iCodecType,
              iHEVCBitRate: t.iHEVCBitRate
          }
      }
      function q(t) {
          for (var e = t.domain_list || [], i = [], s = [], a = 0, r = e.length; a < r; a++)
              if (S.videoLine == e[a].line_index) {
                  e[a].flv_domain_list && (i = e[a].flv_domain_list.concat()),
                  e[a].p2p_domain_list && (s = e[a].p2p_domain_list.concat());
                  break
              }
          S.streamInfo.vFlvIPList = {
              value: i
          },
          S.streamInfo.vP2pIPList = {
              value: s
          }
      }
      function K(t, e) {
          var i = t.domain_list || [];
          T.addLog(t.domain_list);
          for (var s = 0, a = i.length; s < a; s++)
              if (e == i[s].line_index) {
                  var r = i[s].line_ratio_web;
                  if (r)
                      return parseInt(r)
              }
          return null
      }
      var z = {
          setLiveInfoFromENV: function(t) {
              if (1 != S.isForeign)
                  if (function(t) {
                      var e = sessionStorage.roomIdStr
                        , i = e && e.split(",") || []
                        , s = i.indexOf(t.profileRoom);
                      return -1 != s ? t.profileRoom != i[0] && (i.splice(s, 1),
                      i.unshift(t.profileRoom),
                      sessionStorage.roomIdStr = i.join(","),
                      !0) : (i.unshift(t.profileRoom),
                      sessionStorage.roomIdStr = i.join(","),
                      !1)
                  }(t))
                      t.stream = null;
                  else if (1 != S.isSecret)
                      if (t && t.stream && t.stream.data && 0 != t.stream.data.length) {
                          T.addLog(t.stream),
                          O = !0;
                          var e = [];
                          e = t.stream.data[0].gameStreamInfoList.concat(),
                          D = e;
                          var i = t.stream.vMultiStreamInfo
                            , s = t.stream.iWebDefaultBitRate
                            , a = t.stream.data[0].gameLiveInfo
                            , r = parseInt(a.liveCompatibleFlag);
                          if (S.lLiveCompatibleFlag = r,
                          S.isOBWatch = 32 == (32 & r),
                          S.isOBWatch && (S.isOBRoom = !0),
                          S.is360Video = 1 == (1 & r) || 1024 == (1024 & r),
                          S.extStreamVR = 128 == (128 & r) || 64 == (64 & r),
                          !S.extStreamVR && (S.liveid = a.liveId,
                          S.SrcBitRate = a.bitRate,
                          S.isH265 = S.isH265CodecType(a.codecType),
                          S.hasVideo = e.length > 0,
                          t.roomInfo && 1 == t.roomInfo.isAutoBitrate && S.isLogin && S.h5player && S.h5player.getSupportAuto() && (S.hasAutoBitrate = !0),
                          S.hasVideo)) {
                              S.streamInfo = null;
                              var n = []
                                , o = 0
                                , h = -1
                                , u = [];
                              v.log("线路信息（直出）:", e.concat());
                              for (var l = 0, c = e.length; l < c; l++) {
                                  var d = e[l]
                                    , p = d.iLineIndex;
                                  4 == p && S.isWebrtcSupport && (S.hasLine4 = S.isWebrtcSupport,
                                  S.streamInfoLine4 = d);
                                  var f = K(t, p);
                                  null != f && (v.log("iWebPriorityRate已赋值:", p, d.iWebPriorityRate, f),
                                  d.iWebPriorityRate = f),
                                  d.iWebPriorityRate < 0 || 4 == p && !S.isWebrtcSupport ? u.push(l) : (o += d.iWebPriorityRate,
                                  n.push({
                                      line: p,
                                      rate: d.iWebPriorityRate
                                  }),
                                  100 == d.iWebPriorityRate && (h = p))
                              }
                              for (var _ = u.length - 1; _ >= 0; _--) {
                                  var m = u[_];
                                  e.splice(m, 1)
                              }
                              if (0 == e.length)
                                  return;
                              if (1 == e.length)
                                  S.videoLine = e[0].iLineIndex;
                              else if (-1 != h)
                                  S.videoLine = h;
                              else
                                  for (var y = 0, g = Math.random(), P = 0, E = n.length; P < E; P++) {
                                      var I = n[P];
                                      if (g <= (y += I.rate / o)) {
                                          S.videoLine = I.line;
                                          break
                                      }
                                  }
                              if (S.videoLine < 0 && (S.videoLine = e[Math.floor(Math.random() * e.length)].iLineIndex),
                              4 == S.videoLine && (S.isPlaying = !0,
                              S.loadUI = !0),
                              function(t) {
                                  for (var e in N = "",
                                  t) {
                                      var i = t[e]
                                        , s = i.iWebPriorityRate
                                        , a = i.iLineIndex;
                                      -1 != s && (N += a + ":" + s + ";")
                                  }
                              }(e),
                              W(i),
                              S.videoLine > 0 && j(s),
                              S.videoLine > 0)
                                  for (var A = 0, C = e.length; A < C; A++) {
                                      var k = e[A];
                                      k.iLineIndex == S.videoLine && (S.streamInfo = k,
                                      q(t),
                                      k.newCFlvAntiCode = k.newCFlvAntiCode.replace(/&amp;/g, "&"),
                                      G(k.newCFlvAntiCode))
                                  }
                          }
                      } else
                          v.warn("setLiveInfoFromENV NO stream!");
                  else
                      t.stream = null;
              else
                  t.stream = null
          },
          setLivingInfo: function t(e) {
              var i = S.ENV
                , s = !1;
              if (S.noLineInLive = !1,
              F) {
                  F = !1,
                  window.infoRequestEnd && infoRequestEnd();
                  var a = Date.now();
                  S.livingInfoTime = a - S.livingInfoTime,
                  O && 0 == (s = function(t) {
                      var e = S.ENV;
                      if (!e.stream || !e.stream.data || 0 == e.stream.data.length)
                          return !1;
                      var i = t.tNotice.vStreamInfo.value
                        , s = e.stream.data[0].gameStreamInfoList
                        , a = x(i)
                        , r = x(s);
                      if ("" == r || a != r)
                          return !1;
                      if (t.tStreamSettingNotice.iBitRate != e.stream.data[0].gameLiveInfo.bitRate)
                          return !1;
                      return !0
                  }(e)) && k.fireEvent(k.DATA_METRIC2, [{
                      type: "web.live_info_diff",
                      value: 1
                  }])
              } else
                  s = function(t) {
                      if (S.livingInfoRecorded) {
                          S.livingInfoRecorded.tNotice.vStreamInfo.value;
                          var e = t.tNotice.vStreamInfo.value
                            , i = 0
                            , s = S.livingInfoRecorded.tNotice.vMultiStreamInfo.value
                            , a = t.tNotice.vMultiStreamInfo.value;
                          if (S.livingInfoRecorded.tNotice.iSourceType != t.tNotice.iSourceType)
                              return !1;
                          if (S.livingInfoRecorded.tNotice.lLiveCompatibleFlag != t.tNotice.lLiveCompatibleFlag)
                              return !1;
                          if (s.length != a.length)
                              return !1;
                          if (S.streamInfo && e.length > 0)
                              for (i = 0; i < e.length; i++) {
                                  if (e[i].sStreamName != S.streamInfo.sStreamName && e[i].iLineIndex == S.streamInfo.iLineIndex)
                                      return S.streamSetFlag = !0,
                                      !1;
                                  if (e[i].iIsP2PSupport != S.streamInfo.iIsP2PSupport && e[i].iLineIndex == S.streamInfo.iLineIndex)
                                      return S.streamSetFlag = !0,
                                      !1
                              }
                          var r = S.getCurBitRate();
                          if (r = 0 == r ? S.SrcBitRate : r,
                          S.livingInfoRecorded.tStreamSettingNotice.iBitRate == r)
                              return S.curBitRate = 0,
                              !0;
                          if (t.tNotice.vMultiStreamInfo.value.length > 0)
                              for (i = 0; i < t.tNotice.vMultiStreamInfo.value.length; i++)
                                  if (t.tNotice.vMultiStreamInfo.value[i].iBitRate == S.getCurBitRate())
                                      return !0
                      }
                      return !1
                  }(e);
              !function(t) {
                  var e = ""
                    , i = t.tNotice.vStreamInfo.value;
                  for (var s in i)
                      -1 != i[s].iWebPriorityRate && (e += i[s].iLineIndex + ":" + i[s].iWebPriorityRate + ";");
                  T.addLog("compareLinePriorityRateChange" + N + "变更为：" + e),
                  v.log("compareLinePriorityRateChange", N, "变更为：", e),
                  N && N != e && S.vplayer.trigger("line_priority");
                  N = e
              }(e),
              v.log("isSame", s),
              T.addLog("getLivingInfoRsp");
              var r = e.tNotice
                , n = r.vStreamInfo.value
                , o = e.bIsLiving;
              i.online || S.presenterUid == i.eu || (n = []),
              S.hasVideo = n.length > 0,
              S.SrcBitRate = e.tStreamSettingNotice.iBitRate,
              S.hasAutoBitrate = 1 == r.iEnableAutoBitRate && S.isLogin && S.h5player.getSupportAuto(),
              S.isH265 = S.isH265CodecType(r.iCodecType);
              var h = parseInt(r.lLiveCompatibleFlag);
              S.lLiveCompatibleFlag = h,
              S.isOBWatch = 32 == (32 & h),
              S.isOBWatch && (S.isOBRoom = !0),
              S.extStreamVR = 128 == (128 & h) || 64 == (64 & h),
              S.is360Video = 1 == (1 & h) || 1024 == (1024 & h) || S.extStreamVR && S.vrSwitch,
              S.livingInfo = e;
              var u = !1;
              if (S.hasVideo && S.isMakeFriend && o && !S.isPlaying ? (S.vplayer.makeFriendPlay(),
              u = !0) : S.hasVideo || ((o || e.bcode < 0) && S.streamInfo && !t.hasIgnored ? (t.hasIgnored = !0,
              n = D,
              S.hasVideo = !0) : S.isMakeFriend ? S.isMakeFriend && !o && (k.fireEvent(k.SHOW_RECOMMEND),
              S.vplayer.hideLoading(),
              S.isPlaying = !1,
              S.vplayer.stop()) : (o ? (S.vplayer.showLoading(),
              S.noLineInLive = !0,
              k.fireEvent(k.HIDE_BITRATE_MENU)) : (k.fireEvent(k.SHOW_RECOMMEND),
              S.vplayer.hideLoading()),
              S.isPlaying = !1,
              S.vplayer.stop())),
              S.hasLine4 = !1,
              S.onlyLine4 = !1,
              v.log("线路信息:", n.concat()),
              S.hasVideo) {
                  S.streamInfo = null;
                  var l = []
                    , c = 0
                    , d = -1
                    , p = !1
                    , f = []
                    , _ = [];
                  S.menuItems = [];
                  for (var m = function(t, e) {
                      var i = n[t];
                      if (4 == i.iLineIndex && S.isWebrtcSupport && (S.hasLine4 = S.isWebrtcSupport,
                      S.streamInfoLine4 = i),
                      i.iWebPriorityRate < 0 || 4 == i.iLineIndex && !S.isWebrtcSupport)
                          return f.push(t),
                          "continue";
                      if (-1 != i.sFlvUrl.indexOf("yy.com"))
                          return "continue";
                      var s = i.iLineIndex;
                      S.videoLine == s && (p = !0);
                      var a = !1;
                      i.iIsP2PSupport > 0 && i.sP2pUrl && (a = !0);
                      var r, o = {
                          text: "直播线路" + s,
                          p2p: a,
                          line: s,
                          func: (r = s,
                          function() {
                              k.fireEvent(k.SWITCH_LINE, r)
                          }
                          )
                      };
                      if (S.menuItems[s] = o,
                      p)
                          return "continue";
                      c += i.iWebPriorityRate,
                      l.push({
                          line: s,
                          rate: i.iWebPriorityRate
                      }),
                      100 == i.iWebPriorityRate && (d = s)
                  }, y = 0, g = n.length; y < g; y++)
                      m(y);
                  S.menuData[1] = S.menuItems;
                  for (var P = f.length - 1; P >= 0; P--) {
                      var E = f[P];
                      _.push(n[E].iLineIndex),
                      n.splice(E, 1)
                  }
                  if (S.hasLine4 && 0 == n.length)
                      S.onlyLine4 = !0,
                      S.videoLine = 4,
                      S.streamInfo = S.streamInfoLine4;
                  else {
                      if (0 == n.length && !S.isMakeFriend && !S.onlyLine4)
                          return o ? (S.vplayer.showLoading(),
                          S.noLineInLive = !0,
                          k.fireEvent(k.HIDE_BITRATE_MENU)) : (k.fireEvent(k.SHOW_RECOMMEND),
                          S.vplayer.hideLoading()),
                          S.hasVideo = !1,
                          S.isPlaying = !1,
                          S.vplayer.stop(),
                          k.fireEvent(k.VIDEO_FIRST_PLAY),
                          S.obVideoState = {
                              state: 1003
                          },
                          void S.vplayer.trigger("videoStateChange", S.obVideoState);
                      k.fireEvent(k.HIDE_RECOMMEND)
                  }
                  if (!p)
                      if (1 == n.length)
                          S.videoLine = n[0].iLineIndex;
                      else if (-1 != d)
                          S.videoLine = d;
                      else
                          for (var I = 0, A = Math.random(), C = 0, b = l.length; C < b; C++) {
                              var R = l[C];
                              if (A <= (I += R.rate / c)) {
                                  S.videoLine = R.line;
                                  break
                              }
                          }
                  if (!S.onlyLine4 && (S.videoLine < 0 || -1 != _.indexOf(S.videoLine)) && (S.videoLine = n[Math.floor(Math.random() * n.length)].iLineIndex),
                  -1 == S.specialGameId.indexOf(parseInt(i.gameId)) && (S.isCheckDefBit = !1),
                  S.videoLine > 0) {
                      if (0 == s || S.extStreamVR || S.isH265)
                          W(r.vMultiStreamInfo.value),
                          j(S.livingInfo.tNotice.iWebDefaultBitRate);
                      var L = S.getCurBitRate();
                      S.vplayerUI.setBitRateList({
                          list: S.getBitRateList(),
                          default: L
                      })
                  }
                  if (S.vplayerUI.setLineList(n),
                  S.videoLine > 0)
                      for (var w = 0, U = n.length; w < U; w++) {
                          var B = n[w];
                          B.iLineIndex == S.videoLine && (S.streamInfo = B,
                          G(B.sFlvAntiCode))
                      }
                  if (u)
                      return;
                  if (i.stream && i.stream.data && i.stream.data[0].gameLiveInfo) {
                      var V = i.stream.data[0].gameLiveInfo.liveCompatibleFlag
                        , H = parseInt(r.lLiveCompatibleFlag);
                      S.is360Video && V != H && S.vplayer.play()
                  }
                  S.isUIPause || (S.isPlaying && p ? 0 != S.videoLine && (-1 != S.specialGameId.indexOf(parseInt(i.gameId)) ? s || S.vplayer.play() : S.streamSetFlag && (S.streamSetFlag = !1,
                  s || S.vplayer.play())) : S.vplayer.play())
              } else
                  console.warn("[getLivingInfo]此频道当前无直播！"),
                  k.fireEvent(k.VIDEO_FIRST_PLAY),
                  S.obVideoState = {
                      state: 1001
                  },
                  S.vplayer.trigger("videoStateChange", S.obVideoState),
                  !M && o && (M = !0,
                  k.fireEvent(k.DATA_METRIC2, [{
                      type: "web.no_video_line",
                      value: 1
                  }]));
              S.isServPlaying = S.hasVideo,
              k.fireEvent(k.UPDATE_BTS_VISIBLE),
              S.livingInfoRecorded = e
          },
          setStreamInfoByRoom: function(t, e) {
              var i = null
                , s = t.mMediaStreamInfoPack
                , a = ["vr180", "vr360"]
                , r = parseInt(S.lLiveCompatibleFlag)
                , n = 64 == (64 & r) ? a[0] : a[1];
              if (e && "" != U) {
                  var o = !1;
                  for (var h in s.value)
                      if (h == U) {
                          i = u,
                          o = !0;
                          break
                      }
                  if (!o)
                      return
              } else
                  for (var h in s.value) {
                      var u = s.value[h];
                      if (-1 != u.sStreamBusiProperty.indexOf(n) && r == u.lLiveCompatibleFlag) {
                          U = h,
                          i = u;
                          break
                      }
                  }
              S.vrNoStream = !1,
              B(i, V)
          },
          setStreamInfoByStreamName: function(t) {
              v.log("setStreamInfoByStreamName:", t),
              B(t, (function() {
                  k.fireEvent(k.SHOW_RECOMMEND)
              }
              ))
          },
          setFlvToken: G
      }
        , J = 0
        , Q = !1;
      function X() {
          $(".player-loading-changeline").hide()
      }
      function Z() {
          S.noLineInLive ? $(".player-loading-text").text("当前直播间暂无可用线路，请稍后再试") : function() {
              if (clearTimeout(J),
              !S.livingInfo || !S.livingInfo.tNotice && !S.livingInfo.vMediaStreamInfo)
                  return;
              var t = 0;
              S.livingInfo.tNotice ? t = S.livingInfo.tNotice.vStreamInfo.value.length : S.livingInfo.vMediaStreamInfo && (t = S.livingInfo.vMediaStreamInfo.value.length);
              if (t < 2)
                  return;
              $(".player-loading-changeline").show(),
              k.fireEvent(k.HUYA_REPORT, "pageview/zhibo/breakdown"),
              S.obVideoState = {
                  state: 1002
              },
              S.vplayer.trigger("videoStateChange", S.obVideoState)
          }()
      }
      var tt, et = {
          showLoading: function() {
              if (!Q) {
                  var t = "url(" + S.H5ROOT + "src/img/output/videoloading.gif?" + Math.random() + ") no-repeat";
                  $(".player-loading-progress").css("background", t),
                  Q = !0,
                  $(".player-loading-text").text("正在加载"),
                  $("#player-loading").show(),
                  X(),
                  k.fireEvent(k.HIDE_NO_VR_TIPS),
                  S.isReplay || (clearTimeout(J),
                  J = setTimeout(Z, 5e3))
              }
          },
          setLoadingGif: function() {
              var t = "url(" + S.H5ROOT + "src/img/output/videoloading.gif?" + Math.random() + ") no-repeat";
              $(".player-loading-progress").css("background", t)
          },
          hideLoading: function() {
              Q = !1,
              $(".player-loading").hide(),
              X(),
              clearTimeout(J)
          }
      };
      function it() {
          return $("#player-ext-wrap")
      }
      function st() {
          return $("#player-ext-wrap-under-barrage")
      }
      function at() {
          return $("#player-video")
      }
      function rt() {
          var t = null;
          return tt.vcore && (t = tt.vcore.getExtVideoInfo()),
          t
      }
      function nt(t) {
          tt.vcore && tt.vcore.extFastBackward(t)
      }
      function ot(t) {
          tt.vcore && tt.vcore.extFastBackward({
              time: -t.time
          })
      }
      function ht() {
          return tt.vcore ? tt.vcore.getViewport() : -1
      }
      function ut(t) {
          return tt.vcore ? (tt.vcore.setViewport(t),
          0) : -1
      }
      function lt(t) {
          return tt.vcore ? (tt.vcore.addViewport(t),
          0) : -1
      }
      function ct() {
          return tt.vcore ? tt.vcore.getFrameData() : -1
      }
      function dt() {
          return S.obVideoState
      }
      function pt() {
          return S.obVideoPos
      }
      function ft(t) {
          return tt.vcore ? (tt.vcore.setSplitedOBStream(t),
          0) : -1
      }
      function _t() {
          return this.vcore.getViewerLatencyMode()
      }
      function mt(t) {
          return this.vcore.setViewerLatencyMode(t)
      }
      function vt(t) {
          return this.vcore.updateAudioPlay(t),
          {
              res: 0,
              msg: "成功",
              data: {}
          }
      }
      function yt() {
          return tt.vcore.getVideoSize()
      }
      var Tt = {
          initAPI: function() {
              (tt = S.vplayer).getExtPopupContainer = it,
              tt.getExtContainerUnderBarrage = st,
              tt.getVideoContainer = at,
              tt.getVideoInfo = rt,
              tt.fastForward = nt,
              tt.fastBackward = ot,
              tt.getViewport = ht,
              tt.setViewport = ut,
              tt.addViewport = lt,
              tt.getFrameData = ct,
              tt.setSplitedOBStream = ft,
              tt.getVideoState = dt,
              tt.getVideoPosition = pt,
              tt.getViewerLatencyMode = _t,
              tt.setViewerLatencyMode = mt,
              tt.updateAudioPlay = vt,
              tt.getVideoSize = yt
          }
      };
      function gt(t, e) {
          for (var i = 0; i < e.length; i++) {
              var s = e[i];
              s.enumerable = s.enumerable || !1,
              s.configurable = !0,
              "value"in s && (s.writable = !0),
              Object.defineProperty(t, s.key, s)
          }
      }
      i("f08Q");
      var St = function() {
          function t(e) {
              var s = this;
              !function(t, e) {
                  if (!(t instanceof e))
                      throw new TypeError("Cannot call a class as a function")
              }(this, t),
              v.warn("vplayer ".concat(2202141108, " | ").concat("2022-02-14 11:08:37")),
              v.log("location", location.href, e);
              var a = i("bfxC")();
              $(e.idDom).html(a),
              e.isSimple && $("#player-gift-wrap").hide(),
              this.G = S;
              var r = e;
              S.ENV = this.ENV = r,
              S.vplayer = this,
              S.ENV.register(this),
              Tt.initAPI(),
              r.gameId = c.getQueryString("gameId") || r.gameId,
              r.online = c.getQueryString("online") || localStorage.online,
              r.isSimple = c.getQueryString("isSimple") || r.isSimple,
              r.phantomTest = c.getQueryString("phantomTest") || 0;
              var n = c.getQueryString("topSid")
                , o = c.getQueryString("subSid")
                , h = c.getQueryString("appid")
                , u = c.getQueryString("pid")
                , l = c.getQueryString("sourcetype") || r.iSourceType
                , d = c.getQueryString("from")
                , p = c.getQueryString("isReplay")
                , f = c.getQueryString("isSecret")
                , _ = c.getQueryString("mute");
              h = 3 == r.iSourceType ? 10506 : h,
              S.captionMode = c.getQueryString("captionMode") || 1,
              S.topsid = Number(n || r.chTopId),
              S.subsid = Number(o || r.subChId),
              S.appid = Number(h || r.vappid),
              S.from = d || "",
              S.isUnion = r.isUnion,
              S.isReplay = p || r.replay,
              S.vIdDom = r.idDom,
              S.gameId = Number(r.gameId),
              S.isFromApp = 2 == Number(l),
              S.isYanzhi = 2168 == Number(r.gameId),
              S.isPeiWan = 4079 == Number(r.gameId) || 3205 == Number(r.gameId),
              S.isMobileStarShow = 11 == Number(l),
              S.isKongZhong = r.isKongZhong,
              S.presenterUid = Number(u || r.eu),
              S.freezeLevel = Number(r.freezeLevel),
              S.isMakeFriend = 10 == Number(l),
              S.isCFMiNi = "huya_pc_225" == TT.promoter && window.IS_UNION,
              S.isForeign = r.isForeign || !1,
              S.isSecret = (1 == f || 1 == r.isSecret) && !r.isPayRoom,
              S.mute = _ || 0,
              S.setConfigData(),
              S.setPlayerConfig(),
              S.setABTestConfig(),
              v.log("频道信息aaa22: ", S.topsid + "_" + S.subsid);
              var m = parseInt(localStorage.closep2p);
              if (isNaN(m) || (S.useP2p = !1),
              r.phantomTest || et.showLoading(),
              S.isReplay || r.phantomTest || (this.vcore = new w(this),
              z.setLiveInfoFromENV(r),
              S.isMakeFriend ? this.makeFriendPlay() : this.play()),
              this.isUILoaded = !1,
              this.vplayerUI = null,
              S.loadUI || S.isMakeFriend || !S.streamInfo)
                  this._loadVPlayerUI();
              else {
                  k.addEvent(k.VIDEO_FIRST_PLAY, (function t() {
                      k.removeEvent(k.VIDEO_FIRST_PLAY, t),
                      clearTimeout(s.loadtime),
                      s._loadVPlayerUI()
                  }
                  )),
                  this.loadtime = setTimeout((function() {
                      s._loadVPlayerUI()
                  }
                  ), 1e3)
              }
          }
          var e, s, a;
          return e = t,
          (s = [{
              key: "play",
              value: function() {
                  v.log("VPlayer.play"),
                  (S.streamInfo || S.livingInfo) && this.vcore && this.vcore.play()
              }
          }, {
              key: "makeFriendPlay",
              value: function() {
                  this.vcore && this.vcore.makeFriendPlay()
              }
          }, {
              key: "stop",
              value: function() {
                  v.log("VPlayer.stop"),
                  this.vcore && this.vcore.stop()
              }
          }, {
              key: "playFlac",
              value: function() {
                  this.vcore.playFlac()
              }
          }, {
              key: "stopFlac",
              value: function() {
                  this.vcore.stopFlac()
              }
          }, {
              key: "_loadVPlayerUI",
              value: function() {
                  var t = this;
                  if (!this.isUILoaded) {
                      this.isUILoaded = !0;
                      var e = Date.now();
                      $.ajax({
                          url: S.H5ROOT + "vplayerUI.js",
                          dataType: "script",
                          cache: !0,
                          success: function() {
                              var i = Date.now();
                              v.log("vplayerUI loaded in " + (i - e) + "ms");
                              try {
                                  S.vplayerUI = t.vplayerUI = new VPlayerUI(t,2202141108)
                              } catch (t) {
                                  v.error("vplayerUI init error", t)
                              }
                          }
                          .bind(this)
                      })
                  }
              }
          }, {
              key: "setLivingInfo",
              value: function(t) {
                  v.log("VPlayer.setLivingInfo"),
                  z.setLivingInfo(t)
              }
          }, {
              key: "setStreamInfoByRoom",
              value: function(t, e) {
                  z.setStreamInfoByRoom(t, e)
              }
          }, {
              key: "setStreamInfoByStreamName",
              value: function(t) {
                  z.setStreamInfoByStreamName(t)
              }
          }, {
              key: "setFlvToken",
              value: function(t) {
                  z.setFlvToken(t)
              }
          }, {
              key: "switchBitrate",
              value: function(t) {
                  v.log("VPlayer.switchBitrate", t),
                  t = Number(t),
                  S.curBitRate = t
              }
          }, {
              key: "getVolume",
              value: function() {
                  return this.vcore.h5player.getVolume()
              }
          }, {
              key: "setVolume",
              value: function(t) {
                  this.vcore && this.vcore.h5player && this.vcore.h5player.setVolume(t)
              }
          }, {
              key: "setConfig",
              value: function(t, e) {
                  this.vcore.h5player.setConfig(t, e)
              }
          }, {
              key: "setTafHandler",
              value: function(t) {
                  this.vcore && this.vcore.setTafHandler(t)
              }
          }, {
              key: "getSDKLog",
              value: function() {
                  return this.vcore.h5player.getLog()
              }
          }, {
              key: "getMetrics",
              value: function() {
                  return this.vcore.h5player.getMetrics()
              }
          }, {
              key: "getCurrentTime",
              value: function() {
                  return this.vcore.h5player.getCurrentTime()
              }
          }, {
              key: "getCurrentSeiDts",
              value: function() {
                  return this.vcore.h5player.getCurrentSeiDts()
              }
          }, {
              key: "showLoading",
              value: function() {
                  et.showLoading()
              }
          }, {
              key: "hideLoading",
              value: function() {
                  et.hideLoading()
              }
          }, {
              key: "checkLogin",
              value: function(t) {
                  S.isLogin != t && (S.isLogin = t,
                  S.isLogin || S.resetLoginStatus())
              }
          }, {
              key: "callByJs",
              value: function(t, e) {
                  S.calljsCache[t] = e,
                  v.log("callByJs:", t, e)
              }
          }, {
              key: "loginMedia",
              value: function(t) {
                  this.vcore.loginMedia(t)
              }
          }, {
              key: "quitMedia",
              value: function() {
                  this.vcore.quitMedia()
              }
          }, {
              key: "setVRPort",
              value: function() {
                  this.vcore && this.vcore.setVRPort()
              }
          }, {
              key: "seek",
              value: function() {
                  this.vcore && this.vcore.seek()
              }
          }, {
              key: "updateLiveVodUrl",
              value: function() {
                  this.vcore && this.vcore.updateLiveVodUrl()
              }
          }, {
              key: "userId",
              get: function() {
                  return S.userId
              }
          }, {
              key: "videoStreamType",
              get: function() {
                  return S.isReplay ? 2 : S.isP2pPlayIng ? 1 : 0
              }
          }, {
              key: "videoData",
              get: function() {
                  if (!S.streamInfo)
                      return null;
                  var t = {}
                    , e = S.getCurBitRate();
                  t.video_p2p = S.isP2pPlayIng ? 1 : 0,
                  t.video_encode = "h264",
                  t.video_bitrate = e || S.SrcBitRate,
                  t.video_line = S.streamInfo.sCdnType,
                  t.line = S.videoLine + "";
                  for (var i = S.getBitRateList(), s = 0; s < i.length; s++)
                      i[s].iBitRate == e && (t.video_definition = i[s].sDisplayName);
                  return t
              }
          }, {
              key: "videoTime",
              get: function() {
                  return S.videoTimeData ? S.videoTimeData : null
              }
          }, {
              key: "videoStatus",
              get: function() {
                  return S.isPlaying && !S.isPause ? 0 : !S.isPlaying && S.isPause ? 1 : 2
              }
          }, {
              key: "hasVideo",
              get: function() {
                  return S.isMakeFriend ? !0 === S.hasMFVideo : S.hasVideo
              }
          }, {
              key: "getGiftData",
              get: function() {
                  return S.roomGiftDict
              }
          }]) && gt(e.prototype, s),
          a && gt(e, a),
          t
      }();
      e.default = St;
      o.mixTo(St),
      window.VPlayer = St
  }
});
